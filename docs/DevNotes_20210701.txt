select svyhdr.SVY_HDR_MAIN_ID SP_SV, svyhdr.SVY_HDR_ID SP_ID, CLR.LKP_DESC_A SP_CLR, svyhdr.SVY_HDR_NOD_ID SP_LOC, (CASE WHEN SP.SVY_POS_KP<=EP.SVY_POS_KP THEN SP.SVY_POS_KP ELSE EP.SVY_POS_KP END) AS SP_KS, 

(

CASE 
	WHEN  SP.SVY_POS_KP<=EP.SVY_POS_KP 
		THEN EP.SVY_POS_KP 
	ELSE 
		SP.SVY_POS_KP 
END

) AS SP_KE, 

svyhdr.SVY_INTEGER_A SP_HT, svyhdr.SVY_SINGLE_A SP_LEN, svyhdr.SVY_TEXT_A SP_STS, svyhdr.SVY_TEXT_B SP_STE, svyhdr.SVY_TEXT_C SP_STI, svyhdr.SVY_HDR_EVT_ID SP_TP 
from (((TBL_SVY_HEADER svyhdr 
        LEFT JOIN TBL_SVY_POSITION SP 
            ON svyhdr.SVY_HDR_START_POS_ID = SP.SVY_POS_ID) 
        LEFT JOIN TBL_SVY_POSITION EP 
            ON svyhdr.SVY_HDR_END_POS_ID = EP.SVY_POS_ID) 
        LEFT JOIN SYS_LOOKUPS CLR
            ON svyhdr.SVY_HDR_COLOUR = CLR.LKP_ID) 
where (svyhdr.SVY_HDR_EVT_ID in (25,26,5,41) Or (svyhdr.SVY_HDR_EVT_ID=1 AND SVY_TEXT_B='Strake')) and ((SP.SVY_POS_KP Is Not Null AND EP.SVY_POS_KP Is Not Null))
order by svyhdr.SVY_HDR_MAIN_ID desc, CASE WHEN SP.SVY_POS_KP<=EP.SVY_POS_KP THEN SP.SVY_POS_KP ELSE EP.SVY_POS_KP END


SELECT DEV_TBLDEVMAIN.DevID, DEV_TBLDEVMAIN.RefCode, DEV_TBLDEVMAIN.Revision, DEV_TBLDEVMAIN.DevTitle, DEV_TBLREFDEVSTATUS.dstStatus, DEV_TBLDEVMAIN.StatusCode, 

(
CASE WHEN DEV_TBLDEVMAIN.STATUSCODE = 'CL' 
	THEN 'Closed'
	ELSE (CASE WHEN DEV_TBLDEVMAIN.STATUSCODE = 'CA' THEN ''
		ELSE 'Raised'
		END
		)
	END
) AS RSCLSTAT


FROM DEV_QRYLATESTREF INNER JOIN (DEV_TBLDEVMAIN INNER JOIN DEV_TBLREFDEVSTATUS ON DEV_TBLDEVMAIN.StatusCode = DEV_TBLREFDEVSTATUS.dstStatusCode) ON (DEV_QRYLATESTREF.REVISION = DEV_TBLDEVMAIN.Revision) AND (DEV_QRYLATESTREF.REFCODE = DEV_TBLDEVMAIN.RefCode)
WHERE DEV_TBLDEVMAIN.StatusCode != 'CA'

SELECT DEV_TBLDEVMAIN.DevID, DEV_TBLDEVMAIN.RefCode, DEV_TBLDEVMAIN.Revision, DEV_TBLDEVMAIN.DevTitle, DEV_TBLREFDEVSTATUS.dstStatus, DEV_TBLDEVMAIN.StatusCode
FROM DEV_TBLDEVMAIN





================


SELECT DEV_TBLDEVMAIN.DevID, DEV_TBLDEVMAIN.RefCode, DEV_TBLDEVMAIN.Revision, DEV_TBLDEVMAIN.DevTitle, DEV_TBLDEVMAIN.StatusCode
, (CASE WHEN 1=1 THEN 'HELLO' ELSE 'WORLD' END) AS HW
FROM DEV_TBLDEVMAIN
WHERE DEV_TBLDEVMAIN.StatusCode != 'CA'



====


select svyhdr.SVY_HDR_MAIN_ID SP_SV, svyhdr.SVY_HDR_ID SP_ID, CLR.LKP_DESC_A SP_CLR, svyhdr.SVY_HDR_NOD_ID SP_LOC,   svyhdr.SVY_INTEGER_A SP_HT, svyhdr.SVY_SINGLE_A SP_LEN, svyhdr.SVY_TEXT_A SP_STS, svyhdr.SVY_TEXT_B SP_STE, svyhdr.SVY_TEXT_C SP_STI, svyhdr.SVY_HDR_EVT_ID SP_TP 
from (((TBL_SVY_HEADER svyhdr 
        LEFT JOIN TBL_SVY_POSITION SP 
            ON svyhdr.SVY_HDR_START_POS_ID = SP.SVY_POS_ID) 
        LEFT JOIN TBL_SVY_POSITION EP 
            ON svyhdr.SVY_HDR_END_POS_ID = EP.SVY_POS_ID) 
        LEFT JOIN SYS_LOOKUPS CLR
            ON svyhdr.SVY_HDR_COLOUR = CLR.LKP_ID) 
where (svyhdr.SVY_HDR_EVT_ID in (25,26,5,41) Or (svyhdr.SVY_HDR_EVT_ID=1 AND SVY_TEXT_B='Strake')) and ((SP.SVY_POS_KP Is Not Null AND EP.SVY_POS_KP Is Not Null))
order by svyhdr.SVY_HDR_MAIN_ID desc