--------------------------------------------------------
--  DDL for View QRY_SYS_LOOKUPS_MAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."QRY_SYS_LOOKUPS_MAIN" ("LKP_ID", "LKP_GRP_ID", "LKP_DESC_A", "LKP_DESC_B", "LKP_LONG_1", "LKP_LONG_2") AS 
  SELECT SYS_LOOKUPS.LKP_ID,
  SYS_LOOKUPS.LKP_GRP_ID,
  SYS_LOOKUPS.LKP_DESC_A,
  SYS_LOOKUPS.LKP_DESC_B,
  SYS_LOOKUPS.LKP_LONG_1,
  SYS_LOOKUPS.LKP_LONG_2
FROM SYS_LOOKUPS
WHERE SYS_LOOKUPS.LKP_ID  <> -1
AND SYS_LOOKUPS.LKP_GRP_ID = 1 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View QRY_USER_LOCATION
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."QRY_USER_LOCATION" ("USER_ID", "USER_LOCATION_ID", "USER_LOCATION_NAME") AS 
  SELECT TBL_USER_PARAMS.USER_ID,
  TBL_USER_PARAMS.PARAM_LKP_ID AS USER_LOCATION_ID,
  SYS_LOOKUPS.LKP_DESC_B       AS USER_LOCATION_NAME
FROM SYS_LOOKUPS
INNER JOIN TBL_USER_PARAMS
ON SYS_LOOKUPS.LKP_ID            = TBL_USER_PARAMS.PARAM_LKP_ID
WHERE (TBL_USER_PARAMS.PARAM_ID) = 8002 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View QRY_USER_PARAM
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."QRY_USER_PARAM" ("PARAM", "SETTING", "LKP_ID", "USER_ID", "PARAM_ID", "PARAM_LKP_ID", "PARAM_TEXT", "USER_PARAM_ID") AS 
  SELECT SYS_LOOKUPS.LKP_DESC_B PARAM,
  (
  CASE SYS_LOOKUPS.LKP_ID
    WHEN 8006
    THEN SYS_LOOKUPS_COMPDB_1.LKP_DESC_B
    WHEN 8001
    THEN SYS_LOOKUPS_COMPDB_1.LKP_DESC_B
    WHEN 8002
    THEN SYS_LOOKUPS_COMPDB_1.LKP_DESC_B
    ELSE TBL_USER_PARAMS.PARAM_TEXT
  END) AS SETTING,
  SYS_LOOKUPS.LKP_ID,
  TBL_USER_PARAMS.USER_ID,
  TBL_USER_PARAMS.PARAM_ID,
  TBL_USER_PARAMS.PARAM_LKP_ID,
  TBL_USER_PARAMS.PARAM_TEXT,
  TBL_USER_PARAMS.USER_PARAM_ID
FROM SYS_LOOKUPS SYS_LOOKUPS_COMPDB_1
INNER JOIN (SYS_LOOKUPS
INNER JOIN TBL_USER_PARAMS
ON SYS_LOOKUPS.LKP_ID          = TBL_USER_PARAMS.PARAM_ID)
ON SYS_LOOKUPS_COMPDB_1.LKP_ID = TBL_USER_PARAMS.PARAM_LKP_ID
WHERE SYS_LOOKUPS.LKP_ID       < 8009 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View QRY_USER_PARAM_ASSET_GROUP
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."QRY_USER_PARAM_ASSET_GROUP" ("LKP_ID", "LKP_DESC_B", "LKP_GRP_ID") AS 
  SELECT SYS_LOOKUPS.LKP_ID,
  SYS_LOOKUPS.LKP_DESC_B,
  SYS_LOOKUPS.LKP_GRP_ID
FROM SYS_LOOKUPS
WHERE (SYS_LOOKUPS.LKP_GRP_ID) = 8006 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View QRY_USER_PARAM_LOCATION
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."QRY_USER_PARAM_LOCATION" ("LKP_ID", "LKP_DESC_B", "LKP_GRP_ID") AS 
  SELECT SYS_LOOKUPS_1.LKP_ID,
  SYS_LOOKUPS.LKP_DESC_B
  || '-'
  || SYS_LOOKUPS_1.LKP_DESC_B AS LKP_DESC_B,
  SYS_LOOKUPS.LKP_GRP_ID
FROM SYS_LOOKUPS
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS_1
ON SYS_LOOKUPS.LKP_ID          = SYS_LOOKUPS_1.LKP_GRP_ID
WHERE (SYS_LOOKUPS.LKP_GRP_ID) = 101 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View QRY_USER_PARAM_ROLES
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."QRY_USER_PARAM_ROLES" ("LKP_ID", "LKP_DESC_B", "LKP_GRP_ID") AS 
  SELECT SYS_LOOKUPS.LKP_ID,
  SYS_LOOKUPS.LKP_DESC_B,
  SYS_LOOKUPS.LKP_GRP_ID
FROM SYS_LOOKUPS
WHERE ((SYS_LOOKUPS.LKP_GRP_ID) = 8001)
OR ((SYS_LOOKUPS.LKP_GRP_ID)    = 8057) WITH READ ONLY;
--------------------------------------------------------
--  DDL for View QRY_USER_PARAM_SETTINGS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."QRY_USER_PARAM_SETTINGS" ("LKP_ID", "LKP_DESC_B") AS 
  SELECT SYS_LOOKUPS.LKP_ID,
  SYS_LOOKUPS.LKP_DESC_B
FROM SYS_LOOKUPS
WHERE (SYS_LOOKUPS.LKP_GRP_ID) = 138 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View QRY_USERS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."QRY_USERS" ("USER_ID", "USER_NAME", "PARAM_TEXT", "PARAM_ID", "LKP_DESC_B", "USER_PARAM_ID") AS 
  SELECT TBL_USER_PARAMS.USER_ID,
  TBL_USERS.USER_NAME,
  TBL_USER_PARAMS.PARAM_TEXT,
  TBL_USER_PARAMS.PARAM_ID,
  SYS_LOOKUPS.LKP_DESC_B,
  TBL_USER_PARAMS.USER_PARAM_ID
FROM TBL_USERS
INNER JOIN (SYS_LOOKUPS
INNER JOIN TBL_USER_PARAMS
ON SYS_LOOKUPS.LKP_ID = TBL_USER_PARAMS.PARAM_ID)
ON TBL_USERS.USER_ID  = TBL_USER_PARAMS.USER_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_INT_MATRIKON_01
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_INT_MATRIKON_01" ("SAMPLE_ID", "SAMPLING_LOC_CODE", "SAMPLING_LOC", "SAMPLING_DATE", "STATUS", "GENERIC_NAME", "PRODUCT_NAME", "COMPANY_NAME", "ANALYSIS_VENDOR", "INJECTION_POINT", "RCMD_CONCENTRATION", "RCMD_TREAT_RATE", "ACTUAL_RATE", "BASIS") AS 
  SELECT TBL_CHD_HEADER.CHD_HDR_ID AS SAMPLE_ID, SYS_NODES_ATTRIB.NODE_ID AS SAMPLING_LOC_CODE,
SYS_NODES_ATTRIB.NODE_DESC AS SAMPLING_LOC, TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLING_DATE,
SYS_LOOKUPS.LKP_DESC_B AS STATUS, SYS_LOOKUPS_2.LKP_DESC_B AS GENERIC_NAME,
TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_PNAME AS PRODUCT_NAME, TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_CNAME
AS COMPANY_NAME, SYS_LOOKUPS_3.LKP_DESC_B AS ANALYSIS_VENDOR,
TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_IPOINT AS INJECTION_POINT,
TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_REC_CON AS RCMD_CONCENTRATION,
TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_REC_T AS RCMD_TREAT_RATE,
TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_ACT_RATE AS ACTUAL_RATE, SYS_LOOKUPS_1.LKP_DESC_B AS BASIS
FROM (((((SYS_NODES_ATTRIB INNER JOIN TBL_CHD_HEADER ON SYS_NODES_ATTRIB.REC_TAG =
TBL_CHD_HEADER.CHD_HDR_ASSET_ID) LEFT JOIN SYS_LOOKUPS ON TBL_CHD_HEADER.CHD_HDR_STATUS =
SYS_LOOKUPS.LKP_ID) INNER JOIN TBL_CHD_CHEM_TREAT ON TBL_CHD_HEADER.CHD_HDR_ID =
TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_ID) LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS_1 ON
TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_REC_CON_BASIS = SYS_LOOKUPS_1.LKP_ID) LEFT JOIN SYS_LOOKUPS
SYS_LOOKUPS_2 ON TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_GNAME = SYS_LOOKUPS_2.LKP_ID) LEFT JOIN
SYS_LOOKUPS SYS_LOOKUPS_3 ON TBL_CHD_HEADER.CHD_HDR_ANA_VEND = SYS_LOOKUPS_3.LKP_ID;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AMBER_COUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AMBER_COUNT" ("AMBER") AS 
  SELECT
 Count(AN_CURR_CLASS) AS Amber
FROM
 TBL_ANOM_MAIN
WHERE
 AN_CURR_CLASS=8471;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AMBER_DATE_COUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AMBER_DATE_COUNT" ("DATERAISED", "AMBER") AS 
  SELECT  distinct DateRaised, count(Amber ) AMBER
FROM
        (SELECT AN_RAISED_DATE         AS DateRaised,
                SYS_LOOKUPS.LKP_DESC_B AS Amber
        FROM    TBL_ANOM_MAIN
        INNER JOIN SYS_LOOKUPS
        ON      TBL_ANOM_MAIN.AN_CURR_CLASS = SYS_LOOKUPS.LKP_ID
        WHERE (TBL_ANOM_MAIN.AN_CURR_CLASS  =8471)
        ORDER BY SYS_LOOKUPS.LKP_DESC_B)
group by DateRaised;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_01
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_01" ("ASSET_GROUP", "ASSET", "ANOMALY_REFERENCE", "CURRENT_CLASS", "CURRENT_CLASS_SYSTEM_COLOR", "STATUS", "DESCRIPTION", "RECOMMENDATION", "ASSESSMENT_BY", "ASSESSMENT_DATE", "ACTION_PARTY", "ACTION_DATE", "ASSETID", "DATTYPE") AS 
  SELECT NODAT2.NODE_ID
  || '-'
  || NODAT2.NODE_DESC AS ASSET_GROUP,
  NODAT.NODE_ID
  || '-'
  || NODAT.NODE_DESC AS ASSET,
  ANMAIN.AN_REF      AS ANOMALY_REFERENCE,
  LKP1.LKP_DESC_B    AS CURRENT_CLASS,
  CASE
    WHEN UPPER(LKP1.LKP_DESC_B) = 'RED'
    THEN 'Red'
    WHEN UPPER(LKP1.LKP_DESC_B) = 'ORANGE'
    THEN 'Orange'
    WHEN UPPER(LKP1.LKP_DESC_B) = 'GREEN'
    THEN 'Green'
  END CURRENT_CLASS_SYSTEM_COLOR,
  LKP.LKP_DESC_B                                AS STATUS,
  ANMAIN.AN_DESC                                AS DESCRIPTION,
  ANMAIN.AN_RECCMD                              AS RECOMMENDATION,
  ANMAIN.AN_ASS_BY                              AS ASSESSMENT_BY,
  TO_CHAR(ANMAIN.AN_ASS_DATE, 'DD-MON-YYYY')    AS ASSESSMENT_DATE,
  ANMAIN.AN_ACT_PARTY                           AS ACTION_PARTY,
  TO_CHAR(ANMAIN.AN_ACT_BY_DATE, 'DD-MON-YYYY') AS ACTION_DATE,
  NODAT.REC_TAG                                 AS ASSETID,
  TREESTRUC.TRE_DAT_TYPE                        AS DATTYPE
FROM ((SYS_TREE_STRUC TREESTRUC
INNER JOIN (SYS_NODES_ATTRIB NODAT
INNER JOIN V_TBL_ANOM_MAIN ANMAIN
ON NODAT.REC_TAG         = ANMAIN.AN_ASSET_ID)
ON TREESTRUC.TRE_DAT_TAG = NODAT.REC_TAG)
INNER JOIN SYS_LOOKUPS LKP
ON ANMAIN.AN_STATUS = LKP.LKP_ID)
INNER JOIN SYS_LOOKUPS LKP1
ON ANMAIN.AN_CURR_CLASS = LKP1.LKP_ID
LEFT JOIN SYS_NODES_ATTRIB NODAT2
ON NODAT.NODE_ASSET_TYPE = NODAT2.REC_TAG
ORDER BY ANOMALY_REFERENCE DESC 
WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_02
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_02" ("ASSET_GROUP", "ASSET", "ANOMALY_REFERENCE", "CURRENT_CLASS", "CURRENT_CLASS_SYSTEM_COLOR", "STATUS", "DESCRIPTION", "RECOMMENDATION", "ASSESSMENT_BY", "ASSESSMENT_DATE", "ACTION_PARTY", "ACTION_DATE", "ASSETID", "DATTYPE") AS 
  SELECT NODAT2.NODE_ID
  || '-'
  || NODAT2.NODE_DESC AS ASSET_GROUP,
  NODAT.NODE_ID
  || '-'
  || NODAT.NODE_DESC AS ASSET,
  ANMAIN.AN_REF      AS ANOMALY_REFERENCE,
  LKP1.LKP_DESC_B    AS CURRENT_CLASS,
  CASE
    WHEN UPPER(LKP1.LKP_DESC_B) = 'RED'
    THEN 'Red'
    WHEN UPPER(LKP1.LKP_DESC_B) = 'ORANGE'
    THEN 'Orange'
    WHEN UPPER(LKP1.LKP_DESC_B) = 'GREEN'
    THEN 'Green'
  END CURRENT_CLASS_SYSTEM_COLOR,
  LKP.LKP_DESC_B                                AS STATUS,
  ANMAIN.AN_DESC                                AS DESCRIPTION,
  ANMAIN.AN_RECCMD                              AS RECOMMENDATION,
  ANMAIN.AN_ASS_BY                              AS ASSESSMENT_BY,
  TO_CHAR(ANMAIN.AN_ASS_DATE, 'DD-MON-YYYY')    AS ASSESSMENT_DATE,
  ANMAIN.AN_ACT_PARTY                           AS ACTION_PARTY,
  TO_CHAR(ANMAIN.AN_ACT_BY_DATE, 'DD-MON-YYYY') AS ACTION_DATE,
  NODAT.REC_TAG                                 AS ASSETID,
  TREESTRUC.TRE_DAT_TYPE                        AS DATTYPE
FROM ((SYS_TREE_STRUC TREESTRUC
INNER JOIN (SYS_NODES_ATTRIB NODAT
INNER JOIN V_TBL_ANOM_MAIN ANMAIN
ON NODAT.REC_TAG         = ANMAIN.AN_ASSET_ID)
ON TREESTRUC.TRE_DAT_TAG = NODAT.REC_TAG)
INNER JOIN SYS_LOOKUPS LKP
ON ANMAIN.AN_STATUS = LKP.LKP_ID)
INNER JOIN SYS_LOOKUPS LKP1
ON ANMAIN.AN_CURR_CLASS = LKP1.LKP_ID
LEFT JOIN SYS_NODES_ATTRIB NODAT2
ON NODAT.NODE_ASSET_TYPE = NODAT2.REC_TAG
ORDER BY ANOMALY_REFERENCE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_03
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_03" ("ASSET_GROUP", "ASSET", "ANOMALY_REFERENCE", "STATUS", "DESCRIPTION", "RECOMMENDATION", "ASSESSMENT_BY", "ASSESSMENT_DATE", "ACTION_PARTY", "ACTION_DATE", "ASSETID", "DATTYPE") AS 
  SELECT NODAT2.NODE_ID
  || '-'
  || NODAT2.NODE_DESC AS ASSET_GROUP,
  NODAT.NODE_ID
  || '-'
  || NODAT.NODE_DESC                            AS ASSET,
  ANMAIN.AN_REF                                 AS ANOMALY_REFERENCE,
  SYS_LOOKUPS.LKP_DESC_B                        AS STATUS,
  ANMAIN.AN_DESC                                AS DESCRIPTION,
  ANMAIN.AN_RECCMD                              AS RECOMMENDATION,
  ANMAIN.AN_ASS_BY                              AS ASSESSMENT_BY,
  TO_CHAR(ANMAIN.AN_ASS_DATE, 'DD-MON-YYYY')    AS ASSESSMENT_DATE,
  ANMAIN.AN_ACT_PARTY                           AS ACTION_PARTY,
  TO_CHAR(ANMAIN.AN_ACT_BY_DATE, 'DD-MON-YYYY') AS ACTION_DATE,
  NODAT.REC_TAG                                 AS ASSETID,
  TREESTRUC.TRE_DAT_TYPE                        AS DATTYPE
FROM ((SYS_NODES_ATTRIB NODAT
INNER JOIN V_TBL_ANOM_MAIN ANMAIN
ON NODAT.REC_TAG = ANMAIN.AN_ASSET_ID)
INNER JOIN SYS_TREE_STRUC TREESTRUC
ON NODAT.REC_TAG = TREESTRUC.TRE_DAT_TAG)
INNER JOIN SYS_LOOKUPS
ON ANMAIN.AN_STATUS = SYS_LOOKUPS.LKP_ID
LEFT JOIN SYS_NODES_ATTRIB NODAT2
ON NODAT.NODE_ASSET_TYPE = NODAT2.REC_TAG
ORDER BY ANOMALY_REFERENCE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_04
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_04" ("ANOMALY_REFERENCE", "ANOMALY_STATUS", "ANOMALY_TYPE", "REVISION", "RAISED_DATE", "IDENTIFIED_DATE", "ORIGINAL_CLASS", "ORIGINAL_CLASS_SYSTEM_COLOR", "CURRENT_CLASS", "CURRENT_CLASS_SYSTEM_COLOR", "ASSET", "EQ_FAILURE", "DESCRIPTION", "ASSESSMENT", "RECOMMENDATION", "ASSESSMENT_BY", "ASSESSMENT_DATE", "UPDATED_BY", "UPDATED_DATE", "TA_NAME", "TA_APPROVE_DATE", "WO_REFERENCE", "WO_STATUS", "ACTION_DATE", "ACTION_PARTY", "ANOMALY_TITLE", "ASSETID", "DATTYPE", "AN_STATUS") AS 
  SELECT ANMAIN.AN_REF                            AS ANOMALY_REFERENCE,
  LU1.LKP_DESC_B                                AS ANOMALY_STATUS,
  ANTYP.ANTYPE_NAME                             AS ANOMALY_TYPE,
  ANMAIN.AN_REVNO                               AS REVISION,
  TO_CHAR(ANMAIN.AN_RAISED_DATE, 'DD-MON-YYYY') AS RAISED_DATE,
  TO_CHAR(ANMAIN.AN_DATE_IDENT, 'DD-MON-YYYY')  AS IDENTIFIED_DATE,
  LU2.LKP_DESC_B                                AS ORIGINAL_CLASS,
  CASE
    WHEN UPPER(LU2.LKP_DESC_B) = 'RED'
    THEN 'Red'
    WHEN UPPER(LU2.LKP_DESC_B) = 'ORANGE'
    THEN 'Orange'
    WHEN UPPER(LU2.LKP_DESC_B) = 'GREEN'
    THEN 'Green'
  END                    AS ORIGINAL_CLASS_SYSTEM_COLOR,
  SYS_LOOKUPS.LKP_DESC_B AS CURRENT_CLASS,
  CASE
    WHEN UPPER(SYS_LOOKUPS.LKP_DESC_B) = 'RED'
    THEN 'Red'
    WHEN UPPER(SYS_LOOKUPS.LKP_DESC_B) = 'ORANGE'
    THEN 'Orange'
    WHEN UPPER(SYS_LOOKUPS.LKP_DESC_B) = 'GREEN'
    THEN 'Green'
  END AS CURRENT_CLASS_SYSTEM_COLOR,
  NODAT.NODE_ID
  || '-'
  || NODAT.NODE_DESC AS ASSET,
  CASE
    WHEN ANMAIN.AN_EQ_FAILURE = 0
    THEN 'NO'
    ELSE 'YES'
  END                                            AS EQ_FAILURE,
  ANMAIN.AN_DESC                                 AS DESCRIPTION,
  ANMAIN.AN_ASSMNT                               AS ASSESSMENT,
  ANMAIN.AN_RECCMD                               AS RECOMMENDATION,
  ANMAIN.AN_ASS_BY                               AS ASSESSMENT_BY,
  TO_CHAR(ANMAIN.AN_ASS_DATE, 'DD-MON-YYYY')     AS ASSESSMENT_DATE,
  ANMAIN.AN_UPD_BY                               AS UPDATED_BY,
  TO_CHAR(ANMAIN.AN_UPD_DATE, 'DD-MON-YYYY')     AS UPDATED_DATE,
  ANMAIN.AN_TA_NAME                              AS TA_NAME,
  TO_CHAR(ANMAIN.AN_TA_APPR_DATE, 'DD-MON-YYYY') AS TA_APPROVE_DATE,
  ANMAIN.AN_WO_REF                               AS WO_REFERENCE,
  ANMAIN.AN_WO_STATUS                            AS WO_STATUS,
  TO_CHAR(ANMAIN.AN_ACT_BY_DATE, 'DD-MON-YYYY')  AS ACTION_DATE,
  ANMAIN.AN_ACT_PARTY                            AS ACTION_PARTY,
  ANMAIN.AN_TITLE                                AS ANOMALY_TITLE,
  ANMAIN.AN_ASSET_ID                             AS ASSETID,
  SYS_TREE_STRUC.TRE_DAT_TYPE                    AS DATTYPE,
  ANMAIN.AN_STATUS
FROM ((((SYS_NODES_ATTRIB NODAT
INNER JOIN V_TBL_ANOM_MAIN ANMAIN
ON NODAT.REC_TAG = ANMAIN.AN_ASSET_ID)
INNER JOIN SYS_LOOKUPS LU1
ON ANMAIN.AN_STATUS = LU1.LKP_ID)
INNER JOIN SYS_LOOKUPS LU2
ON ANMAIN.AN_ORIG_CLASS = LU2.LKP_ID)
INNER JOIN SYS_LOOKUPS
ON ANMAIN.AN_CURR_CLASS = SYS_LOOKUPS.LKP_ID)
INNER JOIN SYS_TREE_STRUC
ON NODAT.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
LEFT JOIN TBL_ANOM_TYPES ANTYP
ON ANMAIN.AN_TYPE       = ANTYP.ANTYPE_ID
WHERE ANMAIN.AN_STATUS <> 8451
AND ANMAIN.AN_STATUS   <> 8453
ORDER BY ANOMALY_REFERENCE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_05
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_05" ("ANOMALY_REFERENCE", "CURRENT_CLASS", "CURRENT_CLASS_SYSTEM_COLOR", "ASSET", "ASSESSED_DATE", "ACTION_DATE", "ANOMALY_STATUS", "RECOMMENDATION", "WO_REFERENCE", "WO_STATUS_SYS", "DATTYPE", "ASSETID", "WO_STATUS") AS 
  SELECT ANMAIN.AN_REF AS ANOMALY_REFERENCE,
  LU2.LKP_DESC_B     AS CURRENT_CLASS,
  CASE
    WHEN UPPER(LU2.LKP_DESC_B) = 'RED'
    THEN 'Red'
    WHEN UPPER(LU2.LKP_DESC_B) = 'ORANGE'
    THEN 'Orange'
    WHEN UPPER(LU2.LKP_DESC_B) = 'GREEN'
    THEN 'Green'
  END CURRENT_CLASS_SYSTEM_COLOR,
  NODAT.NODE_ID
  || '-'
  || NODAT.NODE_DESC          AS ASSET,
  ANMAIN.AN_ASS_DATE          AS ASSESSED_DATE,
  ANMAIN.AN_ACT_BY_DATE       AS ACTION_DATE,
  LU1.LKP_DESC_B              AS ANOMALY_STATUS,
  ANMAIN.AN_RECCMD            AS RECOMMENDATION,
  ANMAIN.AN_WO_REF            AS WO_REFERENCE,
  ANMAIN.AN_WO_STATUS         AS WO_STATUS_SYS,
  SYS_TREE_STRUC.TRE_DAT_TYPE AS DATTYPE,
  NODAT.REC_TAG               AS ASSETID,
  SYS_LOOKUPS.LKP_DESC_B AS WO_STATUS
FROM SYS_LOOKUPS LU2
INNER JOIN ((SYS_NODES_ATTRIB NODAT
INNER JOIN V_TBL_ANOM_MAIN ANMAIN
ON NODAT.REC_TAG = ANMAIN.AN_ASSET_ID)
INNER JOIN SYS_LOOKUPS LU1
ON ANMAIN.AN_STATUS = LU1.LKP_ID)
ON LU2.LKP_ID       = ANMAIN.AN_CURR_CLASS
INNER JOIN SYS_TREE_STRUC
ON NODAT.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
INNER JOIN SYS_LOOKUPS
ON ANMAIN.AN_WO_STATUS = SYS_LOOKUPS.LKP_ID
ORDER BY ANOMALY_REFERENCE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_07
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_07" ("ANOMALY_TYPE", "SCREENING_CRITERIA", "APPLIES_TO", "COMMENTS") AS 
  SELECT ANOMALYTYPE ANOMALY_TYPE,
  SCREENINGCRITERIA SCREENING_CRITERIA,
  APPLIESTO APPLIES_TO,
  COMMENTS
FROM
  (SELECT ANTYP.ANTYPE_NAME AS ANOMALYTYPE,
    ANTYP.ANTYPE_LIMITS     AS SCREENINGCRITERIA,
    ANTYP.ANTYPE_APPLIESTO  AS APPLIESTO,
    ANTYP.ANTYPE_COMMENTS   AS COMMENTS
  FROM TBL_ANOM_TYPES ANTYP
  )
ORDER BY ANOMALY_TYPE WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_08
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_08" ("GREEN", "ORANGE", "RED") AS 
  SELECT
	GREEN,
  AMBER AS ORANGE,
  RED
FROM
SYS_Q_RPT_AN_GREEN, 
SYS_Q_RPT_AN_AMBER, 
SYS_Q_RPT_AN_RED 
GROUP BY 
	GREEN, AMBER, RED WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_09
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_09" ("ANOMALYYEAR", "DATERAISED", "GREEN", "AMBER", "RED") AS 
  SELECT
  "ANOMALYYEAR",
  "DATERAISED",
  "GREEN",
  "AMBER",
  "RED"
FROM(
SELECT TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE, 'YYYY')) AS ANOMALYYEAR,
  TO_DATE(TO_CHAR(T1.AN_RAISED_DATE, 'MM')
  || '/01/'
  || TO_CHAR(T1.AN_RAISED_DATE, 'YYYY'), 'MM/DD/YYYY') AS DATERAISED,
  (SELECT COUNT(T2.AN_ORIG_CLASS)
  FROM V_TBL_ANOM_MAIN T2
  WHERE T2.AN_ORIG_CLASS                            = 8470
  AND TO_NUMBER(TO_CHAR(T2.AN_RAISED_DATE, 'MM'))   = TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE, 'MM'))
  AND TO_NUMBER(TO_CHAR(T2.AN_RAISED_DATE, 'YYYY')) = TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE, 'YYYY'))
  ) AS GREEN,
  (SELECT COUNT(T2.AN_ORIG_CLASS)
  FROM V_TBL_ANOM_MAIN T2
  WHERE T2.AN_ORIG_CLASS                            = 8471
  AND TO_NUMBER(TO_CHAR(T2.AN_RAISED_DATE, 'MM'))   = TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE, 'MM'))
  AND TO_NUMBER(TO_CHAR(T2.AN_RAISED_DATE, 'YYYY')) = TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE, 'YYYY'))
  ) AS AMBER,
  (SELECT COUNT(T2.AN_ORIG_CLASS)
  FROM V_TBL_ANOM_MAIN T2
  WHERE T2.AN_ORIG_CLASS                            = 8472
  AND TO_NUMBER(TO_CHAR(T2.AN_RAISED_DATE, 'MM'))   = TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE, 'MM'))
  AND TO_NUMBER(TO_CHAR(T2.AN_RAISED_DATE, 'YYYY')) = TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE, 'YYYY'))
  ) AS RED
FROM V_TBL_ANOM_MAIN T1
)
GROUP BY
  ANOMALYYEAR,
  DATERAISED,
  GREEN,
  AMBER,
  RED;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_10
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_10" ("ASSETID", "PAR_ASSETID", "DATTYPE", "ASSET_ID", "ASSET_NAME", "MONTH_COUNT", "QUARTER_COUNT", "YEAR_COUNT", "CLOSED_COUNT", "OPEN_COUNT", "TRE_NOD_ORDER") AS 
  SELECT SYS_NODES_ATTRIB.REC_TAG AS ASSETID,
  SYS_TREE_STRUC1.TRE_DAT_TAG   AS PAR_ASSETID,
  SYS_TREE_STRUC.TRE_DAT_TYPE   AS DATTYPE,
  SYS_NODES_ATTRIB.NODE_ID      AS ASSET_ID,
  SYS_NODES_ATTRIB.NODE_DESC    AS ASSET_NAME,
  MONTH_T.MONTH_COUNT,
  QUARTER_T.QUARTER_COUNT,
  YEAR_T.YEAR_COUNT,
  CLOSED_T.CLOSED_COUNT,
  OPEN_T.OPEN_COUNT,
  SYS_TREE_STRUC.TRE_NOD_ORDER
FROM SYS_NODES_ATTRIB
LEFT JOIN
  (SELECT COUNT(AN_ID) MONTH_COUNT,
    TMP_ID AN_ASSET_ID
  FROM
    (SELECT T1.AN_ID,
      T2.TMP_ID,
      T1.AN_STATUS
    FROM
      (SELECT V_TBL_ANOM_MAIN.AN_ID,
        V_TBL_ANOM_MAIN.AN_STATUS,
        V_TBL_ANOM_MAIN.AN_ASSET_ID,
        V_TBL_ANOM_MAIN.AN_RAISED_DATE
      FROM V_TBL_ANOM_MAIN
      WHERE V_TBL_ANOM_MAIN.AN_RAISED_DATE >= (SysDate - 30)
      ) T1
    INNER JOIN
      (SELECT Connect_By_Root SYS_TREE_STRUC.TRE_DAT_TAG AS TMP_ID,
        SYS_TREE_STRUC.TRE_DAT_TAG
      FROM SYS_TREE_STRUC
      INNER JOIN SYS_NODES_ATTRIB
      ON SYS_TREE_STRUC.TRE_DAT_TAG                 = SYS_NODES_ATTRIB.REC_TAG
      WHERE SYS_TREE_STRUC.TRE_DAT_TYPE             = 1
        CONNECT BY NOCYCLE Prior SYS_TREE_STRUC.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG_PAR
      ) T2 ON T2.TRE_DAT_TAG                        = T1.AN_ASSET_ID
    )
  GROUP BY TMP_ID
  ) MONTH_T ON SYS_NODES_ATTRIB.REC_TAG = MONTH_T.AN_ASSET_ID
LEFT JOIN
  (SELECT COUNT(AN_ID) QUARTER_COUNT,
    TMP_ID AN_ASSET_ID
  FROM
    (SELECT T1.AN_ID,
      T2.TMP_ID,
      T1.AN_STATUS
    FROM
      (SELECT V_TBL_ANOM_MAIN.AN_ID,
        V_TBL_ANOM_MAIN.AN_STATUS,
        V_TBL_ANOM_MAIN.AN_ASSET_ID,
        V_TBL_ANOM_MAIN.AN_RAISED_DATE
      FROM V_TBL_ANOM_MAIN
      WHERE V_TBL_ANOM_MAIN.AN_RAISED_DATE >= (SysDate - 90)
      ) T1
    INNER JOIN
      (SELECT Connect_By_Root SYS_TREE_STRUC.TRE_DAT_TAG AS TMP_ID,
        SYS_TREE_STRUC.TRE_DAT_TAG
      FROM SYS_TREE_STRUC
      INNER JOIN SYS_NODES_ATTRIB
      ON SYS_TREE_STRUC.TRE_DAT_TAG                 = SYS_NODES_ATTRIB.REC_TAG
      WHERE SYS_TREE_STRUC.TRE_DAT_TYPE             = 1
        CONNECT BY NOCYCLE Prior SYS_TREE_STRUC.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG_PAR
      ) T2 ON T2.TRE_DAT_TAG                        = T1.AN_ASSET_ID
    )
  GROUP BY TMP_ID
  ) QUARTER_T ON SYS_NODES_ATTRIB.REC_TAG = QUARTER_T.AN_ASSET_ID
LEFT JOIN
  (SELECT COUNT(AN_ID) YEAR_COUNT,
    TMP_ID AN_ASSET_ID
  FROM
    (SELECT T1.AN_ID,
      T2.TMP_ID,
      T1.AN_STATUS
    FROM
      (SELECT V_TBL_ANOM_MAIN.AN_ID,
        V_TBL_ANOM_MAIN.AN_STATUS,
        V_TBL_ANOM_MAIN.AN_ASSET_ID,
        V_TBL_ANOM_MAIN.AN_RAISED_DATE
      FROM V_TBL_ANOM_MAIN
      WHERE V_TBL_ANOM_MAIN.AN_RAISED_DATE >= (SysDate - 365)
      ) T1
    INNER JOIN
      (SELECT Connect_By_Root SYS_TREE_STRUC.TRE_DAT_TAG AS TMP_ID,
        SYS_TREE_STRUC.TRE_DAT_TAG
      FROM SYS_TREE_STRUC
      INNER JOIN SYS_NODES_ATTRIB
      ON SYS_TREE_STRUC.TRE_DAT_TAG                 = SYS_NODES_ATTRIB.REC_TAG
      WHERE SYS_TREE_STRUC.TRE_DAT_TYPE             = 1
        CONNECT BY NOCYCLE Prior SYS_TREE_STRUC.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG_PAR
      ) T2 ON T2.TRE_DAT_TAG                        = T1.AN_ASSET_ID
    )
  GROUP BY TMP_ID
  ) YEAR_T ON SYS_NODES_ATTRIB.REC_TAG = YEAR_T.AN_ASSET_ID
LEFT JOIN
  (SELECT COUNT(AN_ID) CLOSED_COUNT,
    TMP_ID AN_ASSET_ID
  FROM
    (SELECT T1.AN_ID,
      T2.TMP_ID,
      T1.AN_STATUS
    FROM
      (SELECT V_TBL_ANOM_MAIN.AN_ID,
        V_TBL_ANOM_MAIN.AN_STATUS,
        V_TBL_ANOM_MAIN.AN_ASSET_ID
      FROM V_TBL_ANOM_MAIN
      WHERE V_TBL_ANOM_MAIN.AN_STATUS = 8453
      ) T1
    INNER JOIN
      (SELECT Connect_By_Root SYS_TREE_STRUC.TRE_DAT_TAG AS TMP_ID,
        SYS_TREE_STRUC.TRE_DAT_TAG
      FROM SYS_TREE_STRUC
      INNER JOIN SYS_NODES_ATTRIB
      ON SYS_TREE_STRUC.TRE_DAT_TAG                 = SYS_NODES_ATTRIB.REC_TAG
      WHERE SYS_TREE_STRUC.TRE_DAT_TYPE             = 1
        CONNECT BY NOCYCLE Prior SYS_TREE_STRUC.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG_PAR
      ) T2 ON T2.TRE_DAT_TAG                        = T1.AN_ASSET_ID
    )
  GROUP BY TMP_ID
  ) CLOSED_T ON SYS_NODES_ATTRIB.REC_TAG = CLOSED_T.AN_ASSET_ID
LEFT JOIN
  (SELECT COUNT(AN_ID) OPEN_COUNT,
    TMP_ID AN_ASSET_ID
  FROM
    (SELECT T1.AN_ID,
      T2.TMP_ID,
      T1.AN_STATUS
    FROM
      (SELECT V_TBL_ANOM_MAIN.AN_ID,
        V_TBL_ANOM_MAIN.AN_STATUS,
        V_TBL_ANOM_MAIN.AN_ASSET_ID
      FROM V_TBL_ANOM_MAIN
      WHERE V_TBL_ANOM_MAIN.AN_STATUS = 8450
      ) T1
    INNER JOIN
      (SELECT Connect_By_Root SYS_TREE_STRUC.TRE_DAT_TAG AS TMP_ID,
        SYS_TREE_STRUC.TRE_DAT_TAG
      FROM SYS_TREE_STRUC
      INNER JOIN SYS_NODES_ATTRIB
      ON SYS_TREE_STRUC.TRE_DAT_TAG                 = SYS_NODES_ATTRIB.REC_TAG
      WHERE SYS_TREE_STRUC.TRE_DAT_TYPE             = 1
        CONNECT BY NOCYCLE Prior SYS_TREE_STRUC.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG_PAR
      ) T2 ON T2.TRE_DAT_TAG                        = T1.AN_ASSET_ID
    )
  GROUP BY TMP_ID
  ) OPEN_T ON SYS_NODES_ATTRIB.REC_TAG = OPEN_T.AN_ASSET_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
INNER JOIN SYS_TREE_STRUC SYS_TREE_STRUC1
ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC1.TRE_NOD_TAG
WHERE SYS_NODES_ATTRIB.ITEM_USED  = -1
GROUP BY SYS_NODES_ATTRIB.REC_TAG,
  SYS_TREE_STRUC1.TRE_DAT_TAG,
  SYS_TREE_STRUC.TRE_DAT_TYPE,
  SYS_NODES_ATTRIB.NODE_ID,
  SYS_NODES_ATTRIB.NODE_DESC,
  MONTH_T.MONTH_COUNT,
  QUARTER_T.QUARTER_COUNT,
  YEAR_T.YEAR_COUNT,
  CLOSED_T.CLOSED_COUNT,
  OPEN_T.OPEN_COUNT,
  SYS_TREE_STRUC.TRE_NOD_ORDER
HAVING CLOSED_T.CLOSED_COUNT IS NOT NULL
AND OPEN_T.OPEN_COUNT        IS NOT NULL
ORDER BY SYS_TREE_STRUC.TRE_NOD_ORDER WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_10_SUB
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_10_SUB" ("ASSETID", "DATTYPE", "ASSET_ID", "ASSET_NAME", "MONTH_COUNT", "QUARTER_COUNT", "YEAR_COUNT", "CLOSED_COUNT", "OPEN_COUNT") AS 
  SELECT SYS_NODES_ATTRIB.REC_TAG AS ASSETID,
  SYS_TREE_STRUC.TRE_DAT_TYPE   AS DATTYPE,
  SYS_NODES_ATTRIB.NODE_ID      AS ASSET_ID,
  SYS_NODES_ATTRIB.NODE_DESC    AS ASSET_NAME,
  MONTH_T.MONTH_COUNT,
  QUARTER_T.QUARTER_COUNT,
  YEAR_T.YEAR_COUNT,
  CLOSED_T.CLOSED_COUNT,
  OPEN_T.OPEN_COUNT
FROM SYS_NODES_ATTRIB
LEFT JOIN
  (
SELECT COUNT(V_TBL_ANOM_MAIN.AN_ID) MONTH_COUNT,
  V_TBL_ANOM_MAIN.AN_ASSET_ID
FROM V_TBL_ANOM_MAIN
WHERE V_TBL_ANOM_MAIN.AN_RAISED_DATE >= (SysDate - 30)
GROUP BY V_TBL_ANOM_MAIN.AN_ASSET_ID  
  ) MONTH_T ON SYS_NODES_ATTRIB.REC_TAG = MONTH_T.AN_ASSET_ID
LEFT JOIN
  (
  SELECT COUNT(V_TBL_ANOM_MAIN.AN_ID) QUARTER_COUNT,
  V_TBL_ANOM_MAIN.AN_ASSET_ID
FROM V_TBL_ANOM_MAIN
WHERE V_TBL_ANOM_MAIN.AN_RAISED_DATE >= (SysDate - 90)
GROUP BY V_TBL_ANOM_MAIN.AN_ASSET_ID
  ) QUARTER_T ON SYS_NODES_ATTRIB.REC_TAG = QUARTER_T.AN_ASSET_ID
LEFT JOIN
  (
  SELECT COUNT(V_TBL_ANOM_MAIN.AN_ID) YEAR_COUNT,
  V_TBL_ANOM_MAIN.AN_ASSET_ID
FROM V_TBL_ANOM_MAIN
WHERE V_TBL_ANOM_MAIN.AN_RAISED_DATE >= (SysDate - 365)
GROUP BY V_TBL_ANOM_MAIN.AN_ASSET_ID  
  ) YEAR_T ON SYS_NODES_ATTRIB.REC_TAG = YEAR_T.AN_ASSET_ID
LEFT JOIN
  (
  SELECT COUNT(V_TBL_ANOM_MAIN.AN_ID) CLOSED_COUNT,
  V_TBL_ANOM_MAIN.AN_ASSET_ID
FROM V_TBL_ANOM_MAIN
WHERE V_TBL_ANOM_MAIN.AN_STATUS=8453
GROUP BY V_TBL_ANOM_MAIN.AN_ASSET_ID  
  ) CLOSED_T ON SYS_NODES_ATTRIB.REC_TAG = CLOSED_T.AN_ASSET_ID
LEFT JOIN
  (
  SELECT COUNT(V_TBL_ANOM_MAIN.AN_ID) OPEN_COUNT,
  V_TBL_ANOM_MAIN.AN_ASSET_ID
FROM V_TBL_ANOM_MAIN
WHERE V_TBL_ANOM_MAIN.AN_STATUS=8450
GROUP BY V_TBL_ANOM_MAIN.AN_ASSET_ID  
  ) OPEN_T ON SYS_NODES_ATTRIB.REC_TAG = OPEN_T.AN_ASSET_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
INNER JOIN SYS_TREE_STRUC SYS_TREE_STRUC1
ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC1.TRE_NOD_TAG
WHERE SYS_NODES_ATTRIB.ITEM_USED  = -1 
 GROUP BY 
SYS_NODES_ATTRIB.REC_TAG,
  SYS_TREE_STRUC.TRE_DAT_TYPE,
  SYS_NODES_ATTRIB.NODE_ID,
  SYS_NODES_ATTRIB.NODE_DESC,
  MONTH_T.MONTH_COUNT,
  QUARTER_T.QUARTER_COUNT,
  YEAR_T.YEAR_COUNT,
  CLOSED_T.CLOSED_COUNT,
  OPEN_T.OPEN_COUNT,
  SYS_TREE_STRUC.TRE_NOD_ORDER
ORDER BY SYS_TREE_STRUC.TRE_NOD_ORDER WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_11
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_11" ("GROUPCODE", "GROUPTITLE", "ASSETCODE", "ASSETTITLE", "ANOMALYREFERENCE", "ITVANOMALYREFERENCE", "MOBILIZATIONDATE", "VESSELTYPE", "VESSELNAME", "PLANNING", "ACTUALINTERVENTION", "WELLDOWNTIME", "AFETOTALGROSS", "AFESHELLSHARE", "ACTUALTG", "VESSELDAYRATE", "WBSNUMBER", "JOBSUMMARY", "LEARNING", "DATTYPE", "ASSETID") AS 
  SELECT NODAT2.NODE_ID        AS GROUPCODE,
  NODAT2.NODE_DESC           AS GROUPTITLE,
  NODAT.NODE_ID              AS ASSETCODE,
  NODAT.NODE_DESC            AS ASSETTITLE,
  ANMAIN.AN_REF              AS ANOMALYREFERENCE,
  ANMAIN.ITV_ANOM_REF        AS ITVANOMALYREFERENCE,
  ANMAIN.ITV_DATE_MOBIL      AS MOBILIZATIONDATE,
  SYS_LOOKUPS.LKP_DESC_B     AS VESSELTYPE,
  ANMAIN.ITV_VESSEL_NAME     AS VESSELNAME,
  ANMAIN.ITV_TIME_PLAN_PROC  AS PLANNING,
  ANMAIN.ITV_TIME_ACTUAL     AS ACTUALINTERVENTION,
  ANMAIN.ITV_TIME_MOBIL      AS WELLDOWNTIME,
  ANMAIN.ITV_AFE_COST        AS AFETOTALGROSS,
  ANMAIN.ITV_AFE_SHELL_SHARE AS AFESHELLSHARE,
  ANMAIN.ITV_ACTUAL_COST     AS ACTUALTG,
  ANMAIN.ITV_VESSEL_DAY_RATE AS VESSELDAYRATE,
  ANMAIN.ITV_WBS_NUMBER      AS WBSNUMBER,
  ANMAIN.ITV_SUMMARY         AS JOBSUMMARY,
  ANMAIN.ITV_LEARNING        AS LEARNING,
  TREESTRUC.TRE_DAT_TYPE     AS DATTYPE,
  NODAT.REC_TAG              AS ASSETID
FROM ((((SYS_NODES_ATTRIB NODAT
INNER JOIN V_TBL_ANOM_MAIN ANMAIN
ON NODAT.REC_TAG = ANMAIN.AN_ASSET_ID)
INNER JOIN SYS_TREE_STRUC TREESTRUC
ON NODAT.REC_TAG = TREESTRUC.TRE_DAT_TAG)
INNER JOIN SYS_TREE_STRUC
ON TREESTRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC.TRE_NOD_TAG)
INNER JOIN SYS_NODES_ATTRIB NODAT2
ON SYS_TREE_STRUC.TRE_DAT_TAG = NODAT2.REC_TAG)
LEFT JOIN SYS_LOOKUPS
ON ANMAIN.ITV_TYPE = SYS_LOOKUPS.LKP_ID
ORDER BY ANOMALYREFERENCE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_14
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_14" ("ANOMALY_TYPE", "APPLIES_TO", "ANOMALY_TYPE_GROUP", "COMMENTS", "LIMITS", "ANOMALY_TYPE_CORRELATED") AS 
  SELECT ANOMALY_TYPE,
  APPLIES_TO,
  ANOMALY_TYPE_GROUP,
  COMMENTS,
  LIMITS,
  ANOMALY_TYPE_CORRELATED
FROM
  (SELECT AN_TYPE.ANTYPE_CODE
    || '-'
    || AN_TYPE.ANTYPE_NAME   AS ANOMALY_TYPE,
    AN_TYPE.ANTYPE_APPLIESTO AS APPLIES_TO,
    LKP.LKP_DESC_B           AS ANOMALY_TYPE_GROUP,
    AN_TYPE.ANTYPE_COMMENTS  AS COMMENTS,
    AN_TYPE.ANTYPE_LIMITS    AS LIMITS,
    CASE
      WHEN ABS(AN_TYPE.ANTYPE_CORR_REL) > 0
      THEN 'YES'
      ELSE 'NO'
    END AS ANOMALY_TYPE_CORRELATED
  FROM TBL_ANOM_TYPES AN_TYPE
  INNER JOIN SYS_LOOKUPS LKP
  ON AN_TYPE.ANTYPE_GROUP = LKP.LKP_ID
  )
ORDER BY ANOMALY_TYPE WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_16
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_16" ("ASSET", "ANOMALY_REF", "RAISED_DATE", "IDENTIFIED_DATE", "ANOMALY_TYPE", "REVISION_NO", "ANOMALY_TITLE", "ANOMALY_DESCRIPTION", "STATUS", "NO_OF_ATTACHMENTS", "ORIGINAL_CLASS", "ORIGINAL_CLASS_SYSTEM_COLOR", "CURRENT_CLASS", "CURRENT_CLASS_SYSTEM_COLOR", "ORIGINAL_AVAIL", "ORIGINAL_AVAIL_SYSTEM_COLOR", "CURR_AVAILABILITY", "CURRENT_AVAIL_SYSTEM_COLOR", "ASSESSMENT", "RECOMMENDATION", "ACTION_DATE", "ACTION_PARTY", "ASSET_GROUP", "DATTYPE", "ASSETID", "RISK_LEVEL", "RISK_LEVEL_SYSTEM_COLOR") AS 
  SELECT ASSET,
  ANOMALY_REF,
  TO_CHAR(RAISED_DATE, 'DD-MON-YYYY')  RAISED_DATE,
  TO_CHAR(IDENTIFIED_DATE, 'DD-MON-YYYY')  IDENTIFIED_DATE,
  ANOMALY_TYPE,
  REVISION_NO,
  ANOMALY_TITLE,
  ANOMALY_DESCRIPTION,
  STATUS,
  NO_OF_ATTACHMENTS,
  ORIGINAL_CLASS,
  ORIGINAL_CLASS_SYSTEM_COLOR,
  CURRENT_CLASS,
  CURRENT_CLASS_SYSTEM_COLOR,
  ORIGINAL_AVAIL,
  ORIGINAL_AVAIL_SYSTEM_COLOR,
  CURR_AVAILABILITY,
  CURRENT_AVAIL_SYSTEM_COLOR,
  ASSESSMENT,
  RECOMMENDATION,
  TO_CHAR(ACTION_DATE, 'DD-MON-YYYY')  ACTION_DATE,
  ACTION_PARTY,
  ASSET_GROUP,
  DATTYPE,
  ASSETID,
  RISK_LEVEL,
  CASE
    WHEN RISK_LEVEL = '0A'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '0B'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '0C'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '0D'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '0E'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '1A'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '1B'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '1C'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '1D'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '1E'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '2A'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '2B'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '2C'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '3A'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '3B'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '4A'
    THEN 'RoyalBlue'
    WHEN RISK_LEVEL = '2D'
    THEN 'Gray'
    WHEN RISK_LEVEL = '2E'
    THEN 'Gray'
    WHEN RISK_LEVEL = '3C'
    THEN 'Gray'
    WHEN RISK_LEVEL = '3D'
    THEN 'Gray'
    WHEN RISK_LEVEL = '4B'
    THEN 'Gray'
    WHEN RISK_LEVEL = '4C'
    THEN 'Gray'
    WHEN RISK_LEVEL = '5A'
    THEN 'Gray'
    WHEN RISK_LEVEL = '5B'
    THEN 'Gray'
    WHEN RISK_LEVEL = '3E'
    THEN 'Red'
    WHEN RISK_LEVEL = '4D'
    THEN 'Red'
    WHEN RISK_LEVEL = '4E'
    THEN 'Red'
    WHEN RISK_LEVEL = '5C'
    THEN 'Red'
    WHEN RISK_LEVEL = '5D'
    THEN 'Red'
    WHEN RISK_LEVEL = '5E'
    THEN 'Red'
    ELSE 'Transparent'
  END RISK_LEVEL_SYSTEM_COLOR
FROM
  (SELECT NA.NODE_DESC         AS ASSET,
    AN.AN_REF                  AS ANOMALY_REF,
    AN.AN_RAISED_DATE          AS RAISED_DATE,
    AN.AN_DATE_IDENT           AS IDENTIFIED_DATE,
    TBL_ANOM_TYPES.ANTYPE_NAME AS ANOMALY_TYPE,
    AN.AN_REVNO                AS REVISION_NO,
    AN.AN_TITLE                AS ANOMALY_TITLE,
    AN.AN_DESC                 AS ANOMALY_DESCRIPTION,
    LKP.LKP_DESC_B             AS STATUS,
    AN.AN_ATTACHMENTS          AS NO_OF_ATTACHMENTS,
    LKP1.LKP_DESC_B            AS ORIGINAL_CLASS,
    CASE
      WHEN UPPER(LKP1.LKP_DESC_B) = 'RED'
      THEN 'Red'
      WHEN UPPER(LKP1.LKP_DESC_B) = 'ORANGE'
      THEN 'Orange'
      WHEN UPPER(LKP1.LKP_DESC_B) = 'GREEN'
      THEN 'Green'
    END ORIGINAL_CLASS_SYSTEM_COLOR,
    LKP2.LKP_DESC_B AS CURRENT_CLASS,
    CASE
      WHEN UPPER(LKP2.LKP_DESC_B) = 'RED'
      THEN 'Red'
      WHEN UPPER(LKP2.LKP_DESC_B) = 'ORANGE'
      THEN 'Orange'
      WHEN UPPER(LKP2.LKP_DESC_B) = 'GREEN'
      THEN 'Green'
    END CURRENT_CLASS_SYSTEM_COLOR,
    LKP3.LKP_DESC_B AS ORIGINAL_AVAIL,
    CASE
      WHEN UPPER(LKP3.LKP_DESC_B) = 'RED'
      THEN 'Red'
      WHEN UPPER(LKP3.LKP_DESC_B) = 'ORANGE'
      THEN 'Orange'
      WHEN UPPER(LKP3.LKP_DESC_B) = 'GREEN'
      THEN 'Green'
    END ORIGINAL_AVAIL_SYSTEM_COLOR,
    LKP4.LKP_DESC_B AS CURR_AVAILABILITY,
    CASE
      WHEN UPPER(LKP4.LKP_DESC_B) = 'RED'
      THEN 'Red'
      WHEN UPPER(LKP4.LKP_DESC_B) = 'ORANGE'
      THEN 'Orange'
      WHEN UPPER(LKP4.LKP_DESC_B) = 'GREEN'
      THEN 'Green'
    END CURRENT_AVAIL_SYSTEM_COLOR,
    AN.AN_ASSMNT                 AS ASSESSMENT,
    AN.AN_RECCMD                 AS RECOMMENDATION,
    AN.AN_ACT_BY_DATE            AS ACTION_DATE,
    AN.AN_ACT_PARTY              AS ACTION_PARTY,
    NA.NODE_GROUP                AS ASSET_GROUP,
    SYS_TREE_STRUC1.TRE_DAT_TYPE AS DATTYPE,
    NA.REC_TAG                   AS ASSETID,
    SYS_LOOKUPS1.LKP_DESC_A
    || SYS_LOOKUPS2.LKP_DESC_A AS RISK_LEVEL
  FROM ((((((V_TBL_ANOM_MAIN AN
  INNER JOIN SYS_NODES_ATTRIB NA
  ON AN.AN_ASSET_ID = NA.REC_TAG)
  INNER JOIN SYS_LOOKUPS LKP
  ON AN.AN_STATUS = LKP.LKP_ID)
  INNER JOIN SYS_LOOKUPS LKP1
  ON AN.AN_ORIG_CLASS = LKP1.LKP_ID)
  INNER JOIN SYS_LOOKUPS LKP2
  ON AN.AN_CURR_CLASS = LKP2.LKP_ID)
  INNER JOIN SYS_LOOKUPS LKP3
  ON AN.AN_ORIG_AVAIL_CLASS = LKP3.LKP_ID)
  INNER JOIN SYS_LOOKUPS LKP4
  ON AN.AN_CURR_AVAIL_CLASS = LKP4.LKP_ID)
  INNER JOIN SYS_TREE_STRUC SYS_TREE_STRUC1
  ON NA.REC_TAG = SYS_TREE_STRUC1.TRE_DAT_TAG
  INNER JOIN SYS_LOOKUPS SYS_LOOKUPS1
  ON AN.AN_RISK_RANK_SEVERITY = SYS_LOOKUPS1.LKP_ID
  INNER JOIN SYS_LOOKUPS SYS_LOOKUPS2
  ON AN.AN_RISK_RANK_LIKELIHOOD = SYS_LOOKUPS2.LKP_ID
  INNER JOIN TBL_ANOM_TYPES
  ON AN.AN_TYPE = TBL_ANOM_TYPES.ANTYPE_ID
  )
ORDER BY ANOMALY_REF DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_17
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_17" ("TMP", "AN_ASSET_ID", "NODE_ID", "NODE_DESC", "AN_REF", "AN_TITLE", "ANTYPE_NAME", "AN_DATE_IDENT", "ITV_DATE_MOBIL", "ITV_DATE_PROD_RSTO", "ITV_TYPE", "ITV_TYPE_SYS", "ITV_VESSEL_TYPE", "ITV_VESSEL_TYPE_SYS", "ITV_CATEGORY", "ITV_TIME_DIAGNOSTIC", "ITV_TIME_PLAN_PROC", "ITV_TIME_MOBIL", "ITV_TIME_ACTUAL", "ITV_TIME_DEMOB", "ITV_TTIME_WEATHER", "ITV_TTIME_ROV", "ITV_TTIME_VESSEL", "ITV_TTIME_VEND_EQPT", "ITV_TTIME_OTHER", "ITV_AFE_COST", "ITV_ACTUAL_COST", "ITV_DATE_ACTUAL_COST", "ITV_WBS_NUMBER", "ITV_UPDATED", "ITV_UPDATED_BY", "ITV_SUMMARY", "ITV_LEARNING", "ITV_VESSEL_NAME", "ITV_AFE_SHELL_SHARE", "ITV_VESSEL_DAY_RATE", "ITV_WELL_DOWNTIME", "ASSETLOCATION", "AN_YEAR_IDENT") AS 
  SELECT
  'A' AS TMP,
  V_TBL_ANOM_MAIN.AN_ASSET_ID,
  SYS_NODES_ATTRIB.NODE_ID,
  SYS_NODES_ATTRIB.NODE_DESC,
  V_TBL_ANOM_MAIN.AN_REF,
  V_TBL_ANOM_MAIN.AN_TITLE,
  TBL_ANOM_TYPES.ANTYPE_NAME,
  V_TBL_ANOM_MAIN.AN_DATE_IDENT,
  V_TBL_ANOM_MAIN.ITV_DATE_MOBIL,
  V_TBL_ANOM_MAIN.ITV_DATE_PROD_RSTO,
  V_TBL_ANOM_MAIN.ITV_TYPE,
  LKP.LKP_DESC_B AS ITV_TYPE_SYS,
  V_TBL_ANOM_MAIN.ITV_VESSEL_TYPE,
  LKP1.LKP_DESC_B AS ITV_VESSEL_TYPE_SYS,
  V_TBL_ANOM_MAIN.ITV_CATEGORY,
  V_TBL_ANOM_MAIN.ITV_TIME_DIAGNOSTIC,
  V_TBL_ANOM_MAIN.ITV_TIME_PLAN_PROC,
  V_TBL_ANOM_MAIN.ITV_TIME_MOBIL,
  V_TBL_ANOM_MAIN.ITV_TIME_ACTUAL,
  V_TBL_ANOM_MAIN.ITV_TIME_DEMOB,
  V_TBL_ANOM_MAIN.ITV_TTIME_WEATHER,
  V_TBL_ANOM_MAIN.ITV_TTIME_ROV,
  V_TBL_ANOM_MAIN.ITV_TTIME_VESSEL,
  V_TBL_ANOM_MAIN.ITV_TTIME_VEND_EQPT,
  V_TBL_ANOM_MAIN.ITV_TTIME_OTHER,
  V_TBL_ANOM_MAIN.ITV_AFE_COST,
  V_TBL_ANOM_MAIN.ITV_ACTUAL_COST,
  V_TBL_ANOM_MAIN.ITV_DATE_ACTUAL_COST,
  V_TBL_ANOM_MAIN.ITV_WBS_NUMBER,
  V_TBL_ANOM_MAIN.ITV_UPDATED,
  V_TBL_ANOM_MAIN.ITV_UPDATED_BY,
  V_TBL_ANOM_MAIN.ITV_SUMMARY,
  V_TBL_ANOM_MAIN.ITV_LEARNING,
  V_TBL_ANOM_MAIN.ITV_VESSEL_NAME,
  V_TBL_ANOM_MAIN.ITV_AFE_SHELL_SHARE,
  V_TBL_ANOM_MAIN.ITV_VESSEL_DAY_RATE,
  V_TBL_ANOM_MAIN.ITV_WELL_DOWNTIME,
  SYS_TREE_STRUC.TRE_NOD_LOC AS ASSETLOCATION,
  To_Char(AN_DATE_IDENT,'YYYY') AS AN_YEAR_IDENT
FROM
  ((SYS_TREE_STRUC INNER JOIN
    ((SYS_NODES_ATTRIB INNER JOIN V_TBL_ANOM_MAIN
    ON SYS_NODES_ATTRIB.REC_TAG = V_TBL_ANOM_MAIN.AN_ASSET_ID)
    INNER JOIN TBL_ANOM_TYPES
    ON V_TBL_ANOM_MAIN.AN_TYPE = TBL_ANOM_TYPES.ANTYPE_ID)
  ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG)
  LEFT JOIN SYS_LOOKUPS LKP
  ON V_TBL_ANOM_MAIN.ITV_TYPE = LKP.LKP_ID)
  LEFT JOIN SYS_LOOKUPS LKP1
  ON V_TBL_ANOM_MAIN.ITV_VESSEL_TYPE = LKP1.LKP_ID
WHERE
  (((TBL_ANOM_TYPES.ANTYPE_ID)=37 Or (TBL_ANOM_TYPES.ANTYPE_ID)=40))
WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_18
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_18" ("ANOMALY_TITLE", "ACTION_ITEM_REFERENCE", "TARGET_DATE", "ACTION_PARTY_1", "TARGET_DATE_SYSTEM_COLOR", "DETAILS", "STATUS", "DATTYPE", "ASSETID", "RAISED_DATE", "ACTION") AS 
  SELECT AN.AN_TITLE AS ANOMALY_TITLE,
  AI.AI_REF_NO     AS ACTION_ITEM_REFERENCE,
  TO_CHAR(AI.AI_TARGET_DATE, 'DD-MON-YYYY') TARGET_DATE,
  AI.AI_ACT_PARTY1 AS ACTION_PARTY_1,
  CASE
    WHEN (TO_DATE(AI.AI_TARGET_DATE) < SysDate)
    AND AI.AI_STAT                  <> 8903
    THEN 'Red'
  END TARGET_DATE_SYSTEM_COLOR,
  AI.AI_DETAILS                             AS DETAILS,
  LKP.LKP_DESC_B                            AS STATUS,
  TS.TRE_DAT_TYPE                           AS DATTYPE,
  NA.REC_TAG                                AS ASSETID,
  TO_CHAR(AN.AN_RAISED_DATE, 'DD-MON-YYYY') AS RAISED_DATE,
  SYS_LOOKUPS.LKP_DESC_B                    AS ACTION
FROM (SYS_NODES_ATTRIB NA
INNER JOIN (V_TBL_ANOM_MAIN AN
LEFT JOIN (TBL_ANOM_ACT_ITEMS AI
LEFT JOIN SYS_LOOKUPS LKP
ON AI.AI_STAT = LKP.LKP_ID)
ON AN.AN_ID   = AI.AI_AN_ID)
ON NA.REC_TAG = AN.AN_ASSET_ID)
INNER JOIN SYS_TREE_STRUC TS
ON NA.REC_TAG = TS.TRE_DAT_TAG
LEFT JOIN SYS_LOOKUPS
ON AI.AI_PRIORITY = SYS_LOOKUPS.LKP_ID
ORDER BY ACTION_PARTY_1,
  ACTION_ITEM_REFERENCE WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_19
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_19" ("ASSET", "ANOMALY_REFERENCE", "RAISED_DATE", "IDENTIFIED_DATE", "ANOMALY_TYPE", "ANOMALY_STATUS", "ACTION_PARTY", "ORIGINAL_CLASS", "ORIGINAL_CLASS_SYSTEM_COLOR", "CURRENT_CLASS", "CURRENT_CLASS_SYSTEM_COLOR", "ANOMALY_DESCRIPTION", "ASSESTMENT", "RECOMMENDATION", "ASSESSED_BY", "DATTYPE", "ASSETID") AS 
  SELECT NA.NODE_ID
  || '-'
  || NA.NODE_DESC AS ASSET,
  AN_MAIN.AN_REF  AS ANOMALY_REFERENCE,
  TO_CHAR(AN_MAIN.AN_RAISED_DATE, 'DD-MON-YYYY') RAISED_DATE,
  TO_CHAR(AN_MAIN.AN_DATE_IDENT, 'DD-MON-YYYY') IDENTIFIED_DATE,
  AN_TYPES.ANTYPE_NAME AS ANOMALY_TYPE,
  LKP.LKP_DESC_B       AS ANOMALY_STATUS,
  AN_MAIN.AN_ACT_PARTY AS ACTION_PARTY,
  LKP1.LKP_DESC_B      AS ORIGINAL_CLASS,
  CASE
    WHEN UPPER(LKP1.LKP_DESC_B) = 'RED'
    THEN 'Red'
    WHEN UPPER(LKP1.LKP_DESC_B) = 'ORANGE'
    THEN 'Orange'
    WHEN UPPER(LKP1.LKP_DESC_B) = 'GREEN'
    THEN 'Green'
  END ORIGINAL_CLASS_SYSTEM_COLOR,
  LKP2.LKP_DESC_B AS CURRENT_CLASS,
  CASE
    WHEN UPPER(LKP2.LKP_DESC_B) = 'RED'
    THEN 'Red'
    WHEN UPPER(LKP2.LKP_DESC_B) = 'ORANGE'
    THEN 'Orange'
    WHEN UPPER(LKP2.LKP_DESC_B) = 'GREEN'
    THEN 'Green'
  END CURRENT_CLASS_SYSTEM_COLOR,
  AN_MAIN.AN_DESC   AS ANOMALY_DESCRIPTION,
  AN_MAIN.AN_ASSMNT AS ASSESTMENT,
  AN_MAIN.AN_RECCMD AS RECOMMENDATION,
  AN_MAIN.AN_ASS_BY AS ASSESSED_BY,
  TS.TRE_DAT_TYPE   AS DATTYPE,
  NA.REC_TAG        AS ASSETID
FROM SYS_TREE_STRUC TS
INNER JOIN (SYS_NODES_ATTRIB NA
INNER JOIN (SYS_LOOKUPS LKP2
INNER JOIN (SYS_LOOKUPS LKP1
INNER JOIN ((V_TBL_ANOM_MAIN AN_MAIN
LEFT JOIN TBL_ANOM_TYPES AN_TYPES
ON AN_MAIN.AN_TYPE = AN_TYPES.ANTYPE_ID)
INNER JOIN SYS_LOOKUPS LKP
ON AN_MAIN.AN_STATUS    = LKP.LKP_ID)
ON LKP1.LKP_ID          = AN_MAIN.AN_ORIG_CLASS)
ON LKP2.LKP_ID          = AN_MAIN.AN_CURR_CLASS)
ON NA.REC_TAG           = AN_MAIN.AN_ASSET_ID)
ON TS.TRE_DAT_TAG       = NA.REC_TAG
WHERE AN_MAIN.AN_STATUS = 8450
ORDER BY ANOMALY_REFERENCE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_20
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_20" ("ANOMALYID", "ANOMALYREFERENCE", "ANOMALYSTATUS", "ANOMALYTYPE", "REVISION", "RAISEDDATE", "DATEIDENTIFIED", "ORIGINALCLASS", "CURRENTCLASS", "ASSETINDICATOR", "ASSETNAME", "EQUIPMENTFAILURE", "ANOMALYDESCRIPTION", "ASSESTMENT", "RECOMMENDATION", "ASSESTBY", "ASSESTDATE", "UPDATEDBY", "UPDATEDDATE", "TA_NAME", "TA_APPROVEDATE", "FAILURETREAT_CODE", "FAILURETREAT_NAME", "FAILURETREAT_TYPE", "FAILURETREATDESCRIPTION", "WORKORDER_REFERENCE", "WORKORDER_STATUS", "ACTIONBYDATE", "ACTIONPARTY", "ANOMALYREFERENCE_FILE", "REFERENCETYPE", "ANOMALYTITLE", "ASSETID", "DATTYPE", "AN_STATUS") AS 
  SELECT ANMAIN.AN_ID           AS AnomalyID,
  ANMAIN.AN_REF               AS AnomalyReference,
  LU1.LKP_DESC_B              AS AnomalyStatus,
  ANTYP.ANTYPE_NAME           AS AnomalyType,
  ANMAIN.AN_REVNO             AS Revision,
  ANMAIN.AN_RAISED_DATE       AS RaisedDate,
  ANMAIN.AN_DATE_IDENT        AS DateIdentified,
  LU2.LKP_DESC_B              AS OriginalClass,
  SYS_LOOKUPS.LKP_DESC_B      AS CurrentClass,
  NODAT.NODE_ID               AS AssetIndicator,
  NODAT.NODE_DESC             AS AssetName,
  ANMAIN.AN_EQ_FAILURE        AS EquipmentFailure,
  ANMAIN.AN_DESC              AS AnomalyDescription,
  ANMAIN.AN_ASSMNT            AS Assestment,
  ANMAIN.AN_RECCMD            AS Recommendation,
  ANMAIN.AN_ASS_BY            AS AssestBy,
  ANMAIN.AN_ASS_DATE          AS AssestDate,
  ANMAIN.AN_UPD_BY            AS UpdatedBy,
  ANMAIN.AN_UPD_DATE          AS UpdatedDate,
  ANMAIN.AN_TA_NAME           AS TA_Name,
  ANMAIN.AN_TA_APPR_DATE      AS TA_ApproveDate,
  ANFT.FT_CODE                AS FailureTreat_Code,
  ANFT.FT_NAME                AS FailureTreat_Name,
  LU4.LKP_DESC_B              AS FailureTreat_Type,
  ANFT.FT_DESC                AS FailureTreatDescription,
  ANMAIN.AN_WO_REF            AS WorkOrder_Reference,
  ANMAIN.AN_WO_STATUS         AS WorkOrder_Status,
  ANMAIN.AN_ACT_BY_DATE       AS ActionByDate,
  ANMAIN.AN_ACT_PARTY         AS ActionParty,
  TBL_REFERENCE_FILES.RF_DESC AS AnomalyReference_File,
  SYS_LOOKUPS_1.LKP_DESC_B    AS ReferenceType,
  ANMAIN.AN_TITLE             AS AnomalyTitle,
  ANMAIN.AN_ASSET_ID          AS AssetID,
  SYS_TREE_STRUC.TRE_DAT_TYPE AS DatType,
  ANMAIN.AN_STATUS
FROM (((((((SYS_NODES_ATTRIB NODAT
INNER JOIN V_TBL_ANOM_MAIN ANMAIN
ON NODAT.REC_TAG = ANMAIN.AN_ASSET_ID)
INNER JOIN SYS_LOOKUPS LU1
ON ANMAIN.AN_STATUS = LU1.LKP_ID)
INNER JOIN SYS_LOOKUPS LU2
ON ANMAIN.AN_ORIG_CLASS = LU2.LKP_ID)
INNER JOIN SYS_LOOKUPS
ON ANMAIN.AN_CURR_CLASS = SYS_LOOKUPS.LKP_ID)
LEFT JOIN (LNK_REF_ANOMMAIN
LEFT JOIN TBL_REFERENCE_FILES
ON LNK_REF_ANOMMAIN.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID)
ON ANMAIN.AN_ID               = LNK_REF_ANOMMAIN.LNK_TAG_B)
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS_1
ON TBL_REFERENCE_FILES.RF_TYPE = SYS_LOOKUPS_1.LKP_ID)
LEFT JOIN LNK_AN_FT
ON ANMAIN.AN_ID = LNK_AN_FT.LNK_TAG_B)
LEFT JOIN (TBL_ANOM_FT ANFT
LEFT JOIN SYS_LOOKUPS LU4
ON ANFT.FT_TYPE        = LU4.LKP_ID)
ON LNK_AN_FT.LNK_TAG_A = ANFT.FT_ID
INNER JOIN SYS_TREE_STRUC
ON NODAT.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
LEFT JOIN TBL_ANOM_TYPES ANTYP
ON ANMAIN.AN_TYPE = ANTYP.ANTYPE_ID
ORDER BY AnomalyReference DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_21A
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_21A" ("LKP_ID", "EQUIPMENT_TYPE", "ACTIVE_ANOMALIES", "RAISED_ANOMALIES", "UPDATED_ANOMALIES", "CLOSED_ANOMALIES") AS 
  SELECT 
  LKP_ID, 
  LKP_DESC_B AS EQUIPMENT_TYPE, 
  (SELECT COUNT(1) FROM V_TBL_ANOM_MAIN WHERE 
    (NODE_GROUP LIKE ('%' || LKP_DESC_A || '%')) AND 
    (AN_STATUS <> 8453 AND AN_STATUS <> 8451)  
  ) AS ACTIVE_ANOMALIES, 
  (SELECT COUNT(1) FROM V_TBL_ANOM_MAIN WHERE 
    (NODE_GROUP LIKE ('%' || LKP_DESC_A || '%')) 
  ) AS RAISED_ANOMALIES, 
  (SELECT COUNT(1) FROM V_TBL_ANOM_MAIN WHERE 
    (NODE_GROUP LIKE ('%' || LKP_DESC_A || '%')) AND 
    (AN_STATUS<>8453)
  ) AS UPDATED_ANOMALIES,
  (SELECT COUNT(1) FROM V_TBL_ANOM_MAIN WHERE 
    (NODE_GROUP LIKE ('%' || LKP_DESC_A || '%')) AND 
    (AN_STATUS=8453)
  ) AS CLOSED_ANOMALIES  
  FROM SYS_LOOKUPS WHERE LKP_GRP_ID=8006 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_21B
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_21B" ("AN_ID", "NODE_DESC", "AN_REF", "AN_TITLE", "AN_RAISED_DATE", "AN_DATE_IDENT", "AN_UPD_DATE", "ANTYPE_NAME", "AN_REVNO", "AN_STATUS_SYS", "AN_ATTACHMENTS", "NODE_GROUP", "AN_ACT_BY_DATE", "AN_ORIG_CLASS_SYS", "AN_CURR_CLASS_SYS") AS 
  SELECT AN_ID,NODE_DESC,AN_REF,AN_TITLE,AN_RAISED_DATE,AN_DATE_IDENT,AN_UPD_DATE,ANTYPE_NAME,AN_REVNO,AN_STATUS_SYS,AN_ATTACHMENTS,NODE_GROUP,
    AN_ACT_BY_DATE,AN_ORIG_CLASS_SYS,AN_CURR_CLASS_SYS FROM V_TBL_ANOM_MAIN WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_21C
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_21C" ("AN_ID", "NODE_DESC", "AN_REF", "AN_TITLE", "AN_RAISED_DATE", "AN_DATE_IDENT", "AN_UPD_DATE", "ANTYPE_NAME", "AN_REVNO", "AN_STATUS_SYS", "AN_ATTACHMENTS", "NODE_GROUP", "AN_ACT_BY_DATE", "AN_ORIG_CLASS_SYS", "AN_CURR_CLASS_SYS") AS 
  SELECT AN_ID,NODE_DESC,AN_REF,AN_TITLE,AN_RAISED_DATE,AN_DATE_IDENT,AN_UPD_DATE,ANTYPE_NAME,AN_REVNO,AN_STATUS_SYS,AN_ATTACHMENTS,NODE_GROUP,
    AN_ACT_BY_DATE,AN_ORIG_CLASS_SYS,AN_CURR_CLASS_SYS FROM V_TBL_ANOM_MAIN WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_21D
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_21D" ("AN_ID", "NODE_DESC", "AN_REF", "AN_TITLE", "AN_RAISED_DATE", "AN_DATE_IDENT", "AN_UPD_DATE", "ANTYPE_NAME", "AN_REVNO", "AN_STATUS_SYS", "AN_ATTACHMENTS", "NODE_GROUP", "AN_ACT_BY_DATE", "AN_ORIG_CLASS_SYS", "AN_CURR_CLASS_SYS") AS 
  SELECT AN_ID,NODE_DESC,AN_REF,AN_TITLE,AN_RAISED_DATE,AN_DATE_IDENT,AN_UPD_DATE,ANTYPE_NAME,AN_REVNO,AN_STATUS_SYS,AN_ATTACHMENTS,NODE_GROUP,
    AN_ACT_BY_DATE,AN_ORIG_CLASS_SYS,AN_CURR_CLASS_SYS FROM V_TBL_ANOM_MAIN WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_21E
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_21E" ("AN_ID", "NODE_DESC", "AN_REF", "AN_TITLE", "AN_RAISED_DATE", "AN_DATE_IDENT", "AN_UPD_DATE", "ANTYPE_NAME", "AN_REVNO", "AN_STATUS_SYS", "AN_ATTACHMENTS", "NODE_GROUP", "AN_ACT_BY_DATE", "AN_ORIG_CLASS_SYS", "AN_CURR_CLASS_SYS") AS 
  SELECT AN_ID,NODE_DESC,AN_REF,AN_TITLE,AN_RAISED_DATE,AN_DATE_IDENT,AN_UPD_DATE,ANTYPE_NAME,AN_REVNO,AN_STATUS_SYS,AN_ATTACHMENTS,NODE_GROUP,
    AN_ACT_BY_DATE,AN_ORIG_CLASS_SYS,AN_CURR_CLASS_SYS FROM V_TBL_ANOM_MAIN WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_22
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_22" ("ASSET", "ANOMALY_REFERENCE", "RAISED_DATE", "IDENTIFIED_DATE", "ANOMALY_TITLE", "ANOMALY_TYPE", "ANOMALY_STATUS", "ACTION_PARTY", "ORIGINAL_CLASS", "ORIGINAL_CLASS_SYSTEM_COLOR", "CURRENT_CLASS", "CURRENT_CLASS_SYSTEM_COLOR", "SCE", "CE", "SGS", "DATTYPE", "ASSETID") AS 
  SELECT NA.NODE_ID
  || '-'
  || NA.NODE_DESC AS ASSET,
  AN_MAIN.AN_REF  AS ANOMALY_REFERENCE,
  TO_CHAR(AN_MAIN.AN_RAISED_DATE, 'DD-MON-YYYY') RAISED_DATE,
  TO_CHAR(AN_MAIN.AN_DATE_IDENT, 'DD-MON-YYYY') IDENTIFIED_DATE,
  AN_MAIN.AN_TITLE     AS ANOMALY_TITLE,
  AN_TYPES.ANTYPE_NAME AS ANOMALY_TYPE,
  LKP.LKP_DESC_B       AS ANOMALY_STATUS,
  AN_MAIN.AN_ACT_PARTY AS ACTION_PARTY,
  LKP1.LKP_DESC_B      AS ORIGINAL_CLASS,
  CASE
    WHEN UPPER(LKP1.LKP_DESC_B) = 'RED'
    THEN 'Red'
    WHEN UPPER(LKP1.LKP_DESC_B) = 'ORANGE'
    THEN 'Orange'
    WHEN UPPER(LKP1.LKP_DESC_B) = 'GREEN'
    THEN 'Green'
  END ORIGINAL_CLASS_SYSTEM_COLOR,
  LKP2.LKP_DESC_B AS CURRENT_CLASS,
  CASE
    WHEN UPPER(LKP2.LKP_DESC_B) = 'RED'
    THEN 'Red'
    WHEN UPPER(LKP2.LKP_DESC_B) = 'ORANGE'
    THEN 'Orange'
    WHEN UPPER(LKP2.LKP_DESC_B) = 'GREEN'
    THEN 'Green'
  END CURRENT_CLASS_SYSTEM_COLOR,
  NA.SCE          AS SCE,
  NA.CE           AS CE,
  NA.SGS          AS SGS,
  TS.TRE_DAT_TYPE AS DATTYPE,
  NA.REC_TAG      AS ASSETID
FROM SYS_TREE_STRUC TS
INNER JOIN (SYS_NODES_ATTRIB NA
INNER JOIN (SYS_LOOKUPS LKP2
INNER JOIN (SYS_LOOKUPS LKP1
INNER JOIN ((V_TBL_ANOM_MAIN AN_MAIN
LEFT JOIN TBL_ANOM_TYPES AN_TYPES
ON AN_MAIN.AN_TYPE = AN_TYPES.ANTYPE_ID)
INNER JOIN SYS_LOOKUPS LKP
ON AN_MAIN.AN_STATUS    = LKP.LKP_ID)
ON LKP1.LKP_ID          = AN_MAIN.AN_ORIG_CLASS)
ON LKP2.LKP_ID          = AN_MAIN.AN_CURR_CLASS)
ON NA.REC_TAG           = AN_MAIN.AN_ASSET_ID)
ON TS.TRE_DAT_TAG       = NA.REC_TAG
WHERE AN_MAIN.AN_STATUS = 8450
ORDER BY ANOMALY_REFERENCE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_23
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_23" ("ASSET", "ANOMALY_REFERENCE", "ACTION_DETAIL", "ACTION_TITLE", "TARGET_DATE", "ACTION_PARTY_1", "ACTION_PARTY_2", "TARGET_DATE_SYSTEM_COLOR", "DATTYPE", "ASSETID", "RAISED_BY", "RAISED_DATE") AS 
  SELECT NA.NODE_ID
  || '-'
  || NA.NODE_DESC AS ASSET,
  AN.AN_REF       AS ANOMALY_REFERENCE,
  AI.AI_DETAILS   AS ACTION_DETAIL,
  AI.AI_TITLE     AS ACTION_TITLE,
  TO_CHAR(AI.AI_TARGET_DATE, 'DD-MON-YYYY') TARGET_DATE,
  AI.AI_ACT_PARTY1 AS ACTION_PARTY_1,
  AI.AI_ACT_PARTY2 AS ACTION_PARTY_2,
  CASE
    WHEN TO_DATE(AI.AI_TARGET_DATE, 'DD-MON-YYYY') < TO_DATE(SysDate, 'DD-MON-YYYY')
    THEN 'Red'
  END TARGET_DATE_SYSTEM_COLOR,
  TS.TRE_DAT_TYPE AS DATTYPE,
  NA.REC_TAG      AS ASSETID,
  AN.AN_RAISED_BY AS RAISED_BY,
  AN.AN_RAISED_DATE AS RAISED_DATE 
FROM ((SYS_NODES_ATTRIB NA
INNER JOIN (V_TBL_ANOM_MAIN AN
LEFT JOIN (TBL_ANOM_ACT_ITEMS AI
LEFT JOIN SYS_LOOKUPS LKP
ON AI.AI_STAT = LKP.LKP_ID)
ON AN.AN_ID   = AI.AI_AN_ID)
ON NA.REC_TAG = AN.AN_ASSET_ID)
LEFT JOIN TBL_ANOM_TYPES AN_TYPE
ON AN.AN_TYPE = AN_TYPE.ANTYPE_ID)
INNER JOIN SYS_TREE_STRUC TS
ON NA.REC_TAG = TS.TRE_DAT_TAG
LEFT JOIN SYS_NODES_ATTRIB NA1
ON NA.NODE_ASSET_TYPE = NA1.REC_TAG
WHERE (AI.AI_STAT     = 8900)
OR (AI.AI_STAT        = 8903) WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_24
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_24" ("ANOMALY_TITLE", "ACTION_ITEM_REFERENCE", "TARGET_DATE", "ACTION_PARTY_1", "TARGET_DATE_SYSTEM_COLOR", "DETAILS", "STATUS", "DATTYPE", "ASSETID", "RAISED_DATE", "ACTION") AS 
  SELECT AN.AN_TITLE AS ANOMALY_TITLE,
  AI.AI_REF_NO     AS ACTION_ITEM_REFERENCE,
  TO_CHAR(AI.AI_TARGET_DATE, 'DD-MON-YYYY') TARGET_DATE,
  AI.AI_ACT_PARTY1 AS ACTION_PARTY_1,
  CASE
    WHEN (TO_DATE(AI.AI_TARGET_DATE) < SysDate)
    AND AI.AI_STAT                  <> 8903
    THEN 'Red'
  END TARGET_DATE_SYSTEM_COLOR,
  AI.AI_DETAILS                             AS DETAILS,
  LKP.LKP_DESC_B                            AS STATUS,
  TS.TRE_DAT_TYPE                           AS DATTYPE,
  NA.REC_TAG                                AS ASSETID,
  TO_CHAR(AN.AN_RAISED_DATE, 'DD-MON-YYYY') AS RAISED_DATE,
  SYS_LOOKUPS.LKP_DESC_B                    AS ACTION
FROM (SYS_NODES_ATTRIB NA
INNER JOIN (V_TBL_ANOM_MAIN AN
LEFT JOIN (TBL_ANOM_ACT_ITEMS AI
LEFT JOIN SYS_LOOKUPS LKP
ON AI.AI_STAT = LKP.LKP_ID)
ON AN.AN_ID   = AI.AI_AN_ID)
ON NA.REC_TAG = AN.AN_ASSET_ID)
INNER JOIN SYS_TREE_STRUC TS
ON NA.REC_TAG = TS.TRE_DAT_TAG
INNER JOIN SYS_LOOKUPS
ON AI.AI_PRIORITY = SYS_LOOKUPS.LKP_ID
WHERE ((AI.AI_STAT = 8900 OR AI.AI_STAT    = 8903) 
AND AN.AN_TYPE    = 37)
ORDER BY ACTION_PARTY_1,
  ACTION_ITEM_REFERENCE WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_AMBER
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_AMBER" ("AMBER") AS 
  SELECT COUNT(AN_CURR_CLASS) AS AMBER FROM V_TBL_ANOM_MAIN WHERE AN_CURR_CLASS=8471 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_AMBER_DATECOUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_AMBER_DATECOUNT" ("DATERAISED", "AMBER") AS 
  SELECT
	DateRaised,
        Amber
FROM (SELECT
	AN_RAISED_DATE         AS DateRaised,
        SYS_LOOKUPS.LKP_DESC_B AS Amber
FROM
	V_TBL_ANOM_MAIN INNER JOIN SYS_LOOKUPS
        ON V_TBL_ANOM_MAIN.AN_CURR_CLASS = SYS_LOOKUPS.LKP_ID
WHERE
	V_TBL_ANOM_MAIN.AN_CURR_CLASS=8471
ORDER BY
	SYS_LOOKUPS.LKP_DESC_B
);
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_ARC
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_ARC" ("AN_ID", "AN_REF", "AN_ASSET_ID", "AN_TYPE", "AN_STATUS", "AN_RAISED_BY", "AN_RAISED_DATE", "AN_ORIG_CLASS", "AN_CURR_CLASS", "AN_REVNO", "AN_ASS_DATE", "AN_ASS_BY", "AN_ACT_BY_DATE", "AN_ACT_PARTY", "AN_MAINT_REQ", "AN_WO_REF", "AN_WO_STATUS", "AN_DATE_IDENT", "AN_ACT_REQ", "AN_EQ_FAILURE", "AN_TA_APPROVED", "AN_TA_NAME", "AN_TA_APPR_DATE", "AN_ORIG_AVAIL_CLASS", "AN_CURR_AVAIL_CLASS", "AN_AVAIL_UPD_DATE", "AN_AVAIL_UPD_BY", "AN_UPD_DATE", "AN_UPD_BY", "AN_FNCR_REQUIRED", "AN_FNCR", "AN_LIFE_TERM", "AN_PORTFOLIO_APPL", "AN_RISK_RANK_SEVERITY", "AN_RISK_RANK_LIKELIHOOD", "AN_START_EAST", "AN_END_EAST", "AN_DESC", "AN_START_NORTH", "AN_END_NORTH", "AN_NOTIFICATION_REF", "AN_RECCMD", "AN_NOTIFICATION_STATUS", "AN_ASSMNT", "AN_DELETED", "AN_AVAIL_COMMENTS", "AN_TITLE", "AN_ATTACHMENTS", "AN_RISK_RANK_COMMENTS", "ITV_ANOM_REF", "ITV_DATE_MOBIL", "ITV_DATE_PROD_RSTO", "ITV_TYPE", "ITV_TIME_DIAGNOSTIC", "ITV_VESSEL_TYPE", "ITV_CATEGORY", "ITV_TIME_PLAN_PROC", "ITV_TIME_MOBIL", "ITV_TIME_ACTUAL", "ITV_TIME_DEMOB", "ITV_TTIME_WEATHER", "ITV_TTIME_ROV", "ITV_TTIME_VESSEL", "ITV_TTIME_VEND_EQPT", "ITV_TTIME_OTHER", "ITV_AFE_COST", "ITV_ACTUAL_COST", "ITV_DATE_ACTUAL_COST", "ITV_WBS_NUMBER", "ITV_UPDATED", "ITV_UPDATED_BY", "ITV_SUMMARY", "ITV_VESSEL_NAME", "ITV_PARENT_ANOM_REV", "ITV_LEARNING", "ITV_AFE_SHELL_SHARE", "ITV_VESSEL_DAY_RATE", "ITV_WELL_DOWNTIME", "NODE_ID", "NODE_DESC", "AN_CURR_AVAIL_CLASS_SYS", "AN_ORIG_AVAIL_CLASS_SYS", "AN_CURR_CLASS_SYS", "AN_ORIG_CLASS_SYS") AS 
  SELECT
  A."AN_ID",A."AN_REF",A."AN_ASSET_ID",A."AN_TYPE",A."AN_STATUS",A."AN_RAISED_BY",A."AN_RAISED_DATE",A."AN_ORIG_CLASS",A."AN_CURR_CLASS",A."AN_REVNO",A."AN_ASS_DATE",A."AN_ASS_BY",A."AN_ACT_BY_DATE",A."AN_ACT_PARTY",A."AN_MAINT_REQ",A."AN_WO_REF",A."AN_WO_STATUS",A."AN_DATE_IDENT",A."AN_ACT_REQ",A."AN_EQ_FAILURE",A."AN_TA_APPROVED",A."AN_TA_NAME",A."AN_TA_APPR_DATE",A."AN_ORIG_AVAIL_CLASS",A."AN_CURR_AVAIL_CLASS",A."AN_AVAIL_UPD_DATE",A."AN_AVAIL_UPD_BY",A."AN_UPD_DATE",A."AN_UPD_BY",A."AN_FNCR_REQUIRED",A."AN_FNCR",A."AN_LIFE_TERM",A."AN_PORTFOLIO_APPL",A."AN_RISK_RANK_SEVERITY",A."AN_RISK_RANK_LIKELIHOOD",A."AN_START_EAST",A."AN_END_EAST",A."AN_DESC",A."AN_START_NORTH",A."AN_END_NORTH",A."AN_NOTIFICATION_REF",A."AN_RECCMD",A."AN_NOTIFICATION_STATUS",A."AN_ASSMNT",A."AN_DELETED",A."AN_AVAIL_COMMENTS",A."AN_TITLE",A."AN_ATTACHMENTS",A."AN_RISK_RANK_COMMENTS",A."ITV_ANOM_REF",A."ITV_DATE_MOBIL",A."ITV_DATE_PROD_RSTO",A."ITV_TYPE",A."ITV_TIME_DIAGNOSTIC",A."ITV_VESSEL_TYPE",A."ITV_CATEGORY",A."ITV_TIME_PLAN_PROC",A."ITV_TIME_MOBIL",A."ITV_TIME_ACTUAL",A."ITV_TIME_DEMOB",A."ITV_TTIME_WEATHER",A."ITV_TTIME_ROV",A."ITV_TTIME_VESSEL",A."ITV_TTIME_VEND_EQPT",A."ITV_TTIME_OTHER",A."ITV_AFE_COST",A."ITV_ACTUAL_COST",A."ITV_DATE_ACTUAL_COST",A."ITV_WBS_NUMBER",A."ITV_UPDATED",A."ITV_UPDATED_BY",A."ITV_SUMMARY",A."ITV_VESSEL_NAME",A."ITV_PARENT_ANOM_REV",A."ITV_LEARNING",A."ITV_AFE_SHELL_SHARE",A."ITV_VESSEL_DAY_RATE",A."ITV_WELL_DOWNTIME",
  N.NODE_ID,
  N.NODE_DESC,
  CLS_AC.LKP_DESC_B AS AN_CURR_AVAIL_CLASS_SYS,
  CLS_AO.LKP_DESC_B AS AN_ORIG_AVAIL_CLASS_SYS,
  CLS_IC.LKP_DESC_B AS AN_CURR_CLASS_SYS,
  CLS_IO.LKP_DESC_B AS AN_ORIG_CLASS_SYS
FROM
  ((((TBL_ARC_ANOM_MAIN A
  INNER JOIN SYS_NODES_ATTRIB N
  ON A.AN_ASSET_ID = N.REC_TAG)
  LEFT JOIN SYS_LOOKUPS CLS_IO
  ON A.AN_ORIG_CLASS = CLS_IO.LKP_ID)
  LEFT JOIN SYS_LOOKUPS CLS_IC
  ON A.AN_CURR_CLASS = CLS_IC.LKP_ID)
  LEFT JOIN SYS_LOOKUPS CLS_AO
  ON A.AN_ORIG_AVAIL_CLASS = CLS_AO.LKP_ID)
  LEFT JOIN SYS_LOOKUPS CLS_AC
  ON A.AN_CURR_AVAIL_CLASS = CLS_AC.LKP_ID 
WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_ARC_MAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_ARC_MAIN" ("AN_ID", "AN_REF", "AN_ASSET_ID", "AN_TYPE", "AN_STATUS", "AN_RAISED_BY", "AN_RAISED_DATE", "AN_ORIG_CLASS", "AN_CURR_CLASS", "AN_REVNO", "AN_ASS_DATE", "AN_ASS_BY", "AN_ACT_BY_DATE", "AN_ACT_PARTY", "AN_MAINT_REQ", "AN_WO_REF", "AN_WO_STATUS", "AN_DATE_IDENT", "AN_ACT_REQ", "AN_EQ_FAILURE", "AN_TA_APPROVED", "AN_TA_NAME", "AN_TA_APPR_DATE", "AN_ORIG_AVAIL_CLASS", "AN_CURR_AVAIL_CLASS", "AN_AVAIL_UPD_DATE", "AN_AVAIL_UPD_BY", "AN_UPD_DATE", "AN_UPD_BY", "AN_FNCR_REQUIRED", "AN_FNCR", "AN_LIFE_TERM", "AN_PORTFOLIO_APPL", "AN_RISK_RANK_SEVERITY", "AN_RISK_RANK_LIKELIHOOD", "AN_START_EAST", "AN_END_EAST", "AN_DESC", "AN_START_NORTH", "AN_END_NORTH", "AN_NOTIFICATION_REF", "AN_RECCMD", "AN_NOTIFICATION_STATUS", "AN_ASSMNT", "AN_DELETED", "AN_AVAIL_COMMENTS", "AN_TITLE", "AN_ATTACHMENTS", "AN_RISK_RANK_COMMENTS", "ITV_ANOM_REF", "ITV_DATE_MOBIL", "ITV_DATE_PROD_RSTO", "ITV_TYPE", "ITV_TIME_DIAGNOSTIC", "ITV_VESSEL_TYPE", "ITV_CATEGORY", "ITV_TIME_PLAN_PROC", "ITV_TIME_MOBIL", "ITV_TIME_ACTUAL", "ITV_TIME_DEMOB", "ITV_TTIME_WEATHER", "ITV_TTIME_ROV", "ITV_TTIME_VESSEL", "ITV_TTIME_VEND_EQPT", "ITV_TTIME_OTHER", "ITV_AFE_COST", "ITV_ACTUAL_COST", "ITV_DATE_ACTUAL_COST", "ITV_WBS_NUMBER", "ITV_UPDATED", "ITV_UPDATED_BY", "ITV_SUMMARY", "ITV_VESSEL_NAME", "ITV_PARENT_ANOM_REV", "ITV_LEARNING", "ITV_AFE_SHELL_SHARE", "ITV_VESSEL_DAY_RATE", "ITV_WELL_DOWNTIME", "NODE_ID", "NODE_DESC", "AN_CURR_AVAIL_CLASS_SYS", "AN_ORIG_AVAIL_CLASS_SYS", "AN_CURR_CLASS_SYS", "AN_ORIG_CLASS_SYS") AS 
  SELECT
 A."AN_ID",A."AN_REF",A."AN_ASSET_ID",A."AN_TYPE",A."AN_STATUS",A."AN_RAISED_BY",A."AN_RAISED_DATE",A."AN_ORIG_CLASS",A."AN_CURR_CLASS",A."AN_REVNO",A."AN_ASS_DATE",A."AN_ASS_BY",A."AN_ACT_BY_DATE",A."AN_ACT_PARTY",A."AN_MAINT_REQ",A."AN_WO_REF",A."AN_WO_STATUS",A."AN_DATE_IDENT",A."AN_ACT_REQ",A."AN_EQ_FAILURE",A."AN_TA_APPROVED",A."AN_TA_NAME",A."AN_TA_APPR_DATE",A."AN_ORIG_AVAIL_CLASS",A."AN_CURR_AVAIL_CLASS",A."AN_AVAIL_UPD_DATE",A."AN_AVAIL_UPD_BY",A."AN_UPD_DATE",A."AN_UPD_BY",A."AN_FNCR_REQUIRED",A."AN_FNCR",A."AN_LIFE_TERM",A."AN_PORTFOLIO_APPL",A."AN_RISK_RANK_SEVERITY",A."AN_RISK_RANK_LIKELIHOOD",A."AN_START_EAST",A."AN_END_EAST",A."AN_DESC",A."AN_START_NORTH",A."AN_END_NORTH",A."AN_NOTIFICATION_REF",A."AN_RECCMD",A."AN_NOTIFICATION_STATUS",A."AN_ASSMNT",A."AN_DELETED",A."AN_AVAIL_COMMENTS",A."AN_TITLE",A."AN_ATTACHMENTS",A."AN_RISK_RANK_COMMENTS",A."ITV_ANOM_REF",A."ITV_DATE_MOBIL",A."ITV_DATE_PROD_RSTO",A."ITV_TYPE",A."ITV_TIME_DIAGNOSTIC",A."ITV_VESSEL_TYPE",A."ITV_CATEGORY",A."ITV_TIME_PLAN_PROC",A."ITV_TIME_MOBIL",A."ITV_TIME_ACTUAL",A."ITV_TIME_DEMOB",A."ITV_TTIME_WEATHER",A."ITV_TTIME_ROV",A."ITV_TTIME_VESSEL",A."ITV_TTIME_VEND_EQPT",A."ITV_TTIME_OTHER",A."ITV_AFE_COST",A."ITV_ACTUAL_COST",A."ITV_DATE_ACTUAL_COST",A."ITV_WBS_NUMBER",A."ITV_UPDATED",A."ITV_UPDATED_BY",A."ITV_SUMMARY",A."ITV_VESSEL_NAME",A."ITV_PARENT_ANOM_REV",A."ITV_LEARNING",A."ITV_AFE_SHELL_SHARE",A."ITV_VESSEL_DAY_RATE",A."ITV_WELL_DOWNTIME",
 N.NODE_ID,
 N.NODE_DESC,
 CLS_AC.LKP_DESC_B AS AN_CURR_AVAIL_CLASS_SYS,
 CLS_AO.LKP_DESC_B AS AN_ORIG_AVAIL_CLASS_SYS,
 CLS_IC.LKP_DESC_B AS AN_CURR_CLASS_SYS,
 CLS_IO.LKP_DESC_B AS AN_ORIG_CLASS_SYS
FROM
 ((((TBL_ARC_ANOM_MAIN A INNER JOIN SYS_NODES_ATTRIB N
 ON A.AN_ASSET_ID = N.REC_TAG)
 LEFT JOIN SYS_LOOKUPS CLS_IO
 ON A.AN_ORIG_CLASS = CLS_IO.LKP_ID)
 LEFT JOIN SYS_LOOKUPS CLS_IC
 ON A.AN_CURR_CLASS = CLS_IC.LKP_ID)
 LEFT JOIN SYS_LOOKUPS CLS_AO
 ON A.AN_ORIG_AVAIL_CLASS = CLS_AO.LKP_ID)
 LEFT JOIN SYS_LOOKUPS CLS_AC
 ON A.AN_CURR_AVAIL_CLASS = CLS_AC.LKP_ID
WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_COUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_COUNT" ("RED", "AMBER", "GREEN") AS 
  SELECT
 SYS_Q_RPT_RED_COUNT.Red,
 SYS_Q_RPT_AMBER_COUNT.Amber,
 SYS_Q_RPT_GREEN_COUNT.Green
FROM
 SYS_Q_RPT_AMBER_COUNT,
 SYS_Q_RPT_GREEN_COUNT,
 SYS_Q_RPT_RED_COUNT
GROUP BY
 SYS_Q_RPT_RED_COUNT.Red,
 SYS_Q_RPT_AMBER_COUNT.Amber,
 SYS_Q_RPT_GREEN_COUNT.Green
WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_DATECOUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_DATECOUNT" ("ANOMALYYEAR", "DATERAISED", "GREEN", "AMBER", "RED") AS 
  SELECT "ANOMALYYEAR","DATERAISED","GREEN","AMBER","RED" FROM SYS_Q_RPT_AN_DATECOUNT_SUB GROUP BY ANOMALYYEAR, DATERAISED, GREEN, AMBER, RED;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_DATECOUNT_SUB
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_DATECOUNT_SUB" ("ANOMALYYEAR", "DATERAISED", "GREEN", "AMBER", "RED") AS 
  SELECT
 TO_NUMBER(TO_CHAR(AN_RAISED_DATE, 'YYYY')) AS AnomalyYear,
  TO_DATE(TO_CHAR(AN_RAISED_DATE, 'MM') || '/01/' || TO_CHAR(AN_RAISED_DATE, 'YYYY'), 'MM/DD/YYYY') AS DateRaised,
  (SELECT COUNT(AN_ORIG_CLASS)
 FROM V_TBL_ANOM_MAIN T2
 WHERE AN_ORIG_CLASS=8470 AND
TO_NUMBER(TO_CHAR(AN_RAISED_DATE,'MM'))=TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE,'MM')) AND
TO_NUMBER(TO_CHAR(AN_RAISED_DATE,'YYYY'))=TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE,'YYYY'))
 ) AS Green,
   (SELECT COUNT(AN_ORIG_CLASS)
 FROM V_TBL_ANOM_MAIN T2
 WHERE AN_ORIG_CLASS=8471 AND
TO_NUMBER(TO_CHAR(AN_RAISED_DATE,'MM'))=TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE,'MM')) AND
TO_NUMBER(TO_CHAR(AN_RAISED_DATE,'YYYY'))=TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE,'YYYY'))
 ) AS Amber,
  (SELECT COUNT(AN_ORIG_CLASS)
 FROM V_TBL_ANOM_MAIN T2
 WHERE AN_ORIG_CLASS=8472 AND
TO_NUMBER(TO_CHAR(AN_RAISED_DATE,'MM'))=TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE,'MM')) AND
TO_NUMBER(TO_CHAR(AN_RAISED_DATE,'YYYY'))=TO_NUMBER(TO_CHAR(T1.AN_RAISED_DATE,'YYYY'))
 ) AS Red
FROM
 V_TBL_ANOM_MAIN T1
WHERE
 T1.AN_ORIG_CLASS IS NOT NULL;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_GREEN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_GREEN" ("GREEN") AS 
  SELECT COUNT(AN_CURR_CLASS) AS GREEN FROM V_TBL_ANOM_MAIN WHERE AN_CURR_CLASS=8470 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_GREEN_DATECOUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_GREEN_DATECOUNT" ("DATERAISED", "GREEN") AS 
  SELECT
	distinct DateRaised,
	Green
FROM (SELECT
	AN_RAISED_DATE AS DateRaised,
	SYS_LOOKUPS.LKP_DESC_B AS Green
FROM
	V_TBL_ANOM_MAIN INNER JOIN SYS_LOOKUPS
	ON V_TBL_ANOM_MAIN.AN_CURR_CLASS = SYS_LOOKUPS.LKP_ID
WHERE
	V_TBL_ANOM_MAIN.AN_CURR_CLASS=8470
ORDER BY
	SYS_LOOKUPS.LKP_ID
);
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_RED
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_RED" ("RED") AS 
  SELECT COUNT(AN_CURR_CLASS) AS RED FROM V_TBL_ANOM_MAIN WHERE AN_CURR_CLASS=8472 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_AN_RED_DATECOUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_AN_RED_DATECOUNT" ("DATERAISED", "RED") AS 
  SELECT
	DateRaised,
	Red
FROM (SELECT
	AN_RAISED_DATE AS DateRaised,
	SYS_LOOKUPS.LKP_DESC_B AS Red
FROM
	V_TBL_ANOM_MAIN INNER JOIN SYS_LOOKUPS
	ON V_TBL_ANOM_MAIN.AN_CURR_CLASS = SYS_LOOKUPS.LKP_ID
WHERE
	V_TBL_ANOM_MAIN.AN_CURR_CLASS=8472
ORDER BY
	SYS_LOOKUPS.LKP_ID
);
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_ANNUAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_ANNUAL" ("TRE_DAT_TAG", "TRE_NOD_LOC", "AN_ASSET_ID_SYS", "AN_ID", "AN_REF", "AN_DESC", "AN_CURR_CLASS_SYS", "AN_STATUS", "AN_CURR_CLASS", "AN_ACT_BY_DATE") AS 
  SELECT
 SYS_TREE_STRUC.TRE_DAT_TAG,
 SYS_TREE_STRUC.TRE_NOD_LOC,
 SYS_NODES_ATTRIB.NODE_ID || ' - ' || SYS_NODES_ATTRIB.NODE_DESC AS AN_ASSET_ID_SYS,
 TBL_ANOM_MAIN.AN_ID,
 TBL_ANOM_MAIN.AN_REF,
 TBL_ANOM_MAIN.AN_DESC,
 SYS_LOOKUPS.LKP_DESC_B AS AN_CURR_CLASS_SYS,
 TBL_ANOM_MAIN.AN_STATUS,
 TBL_ANOM_MAIN.AN_CURR_CLASS,
 TBL_ANOM_MAIN.AN_ACT_BY_DATE
FROM
 SYS_LOOKUPS INNER JOIN
  ((TBL_ANOM_MAIN INNER JOIN SYS_TREE_STRUC
  ON TBL_ANOM_MAIN.AN_ASSET_ID = SYS_TREE_STRUC.TRE_DAT_TAG)
  INNER JOIN SYS_NODES_ATTRIB
  ON TBL_ANOM_MAIN.AN_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
 ON SYS_LOOKUPS.LKP_ID = TBL_ANOM_MAIN.AN_CURR_CLASS
ORDER BY
 SYS_NODES_ATTRIB.NODE_ID || ' - ' || SYS_NODES_ATTRIB.NODE_DESC,
 TBL_ANOM_MAIN.AN_REF;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_ANNUAL_PL_ACTANOM
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_ANNUAL_PL_ACTANOM" ("ASSET", "ANOMALYREF", "RAISEDDATE", "IDENTIFIEDDATE", "ANOMALYTYPE", "REVISIONNO", "ANOMALYTITLE", "ANOMALYDESC", "STATUS", "NOATT", "ORIGCLASS", "CURRCLASS", "ORIGAVAIL", "CURRAVAIL", "ASSESSMENT", "RECOMMENDATION", "ACTIONBYDATE", "ACTIONPARTY", "RISKLEVEL", "ASSETLOCATION", "ASSETGROUP") AS 
  SELECT
  NA.NODE_ID || ' - ' || NA.NODE_DESC AS Asset,
  AN.AN_REF AS AnomalyRef,
  AN.AN_RAISED_DATE AS RaisedDate,
  AN.AN_DATE_IDENT AS IdentifiedDate,
  AN_FT.ANTYPE_NAME AS AnomalyType,
  AN.AN_REVNO AS RevisionNo,
  AN.AN_TITLE AS AnomalyTitle,
  AN.AN_DESC AS AnomalyDesc,
  LKP.LKP_DESC_B AS Status,
  AN.AN_ATTACHMENTS AS NoAtt,
  LKP1.LKP_DESC_B AS OrigClass,
  LKP2.LKP_DESC_B AS CurrClass,
  LKP3.LKP_DESC_B AS OrigAvail,
  LKP4.LKP_DESC_B AS CurrAvail,
  AN.AN_ASSMNT AS Assessment,
  AN.AN_RECCMD AS Recommendation,
  AN.AN_ACT_BY_DATE AS ActionByDate,
  AN.AN_ACT_PARTY AS ActionParty,
  LKP5.LKP_DESC_A || LKP6.LKP_DESC_A AS RiskLevel,
  TS.TRE_NOD_LOC AS AssetLocation,
  NA.NODE_GROUP AS AssetGroup
FROM
  (((((((((TBL_ANOM_MAIN  AN INNER JOIN SYS_NODES_ATTRIB NA
  ON AN.AN_ASSET_ID = NA.REC_TAG)
  LEFT JOIN SYS_LOOKUPS LKP
  ON AN.AN_STATUS = LKP.LKP_ID)
  LEFT JOIN SYS_LOOKUPS LKP1
  ON AN.AN_ORIG_CLASS = LKP1.LKP_ID)
  LEFT JOIN SYS_LOOKUPS LKP2
  ON AN.AN_CURR_CLASS = LKP2.LKP_ID)
  LEFT JOIN SYS_LOOKUPS LKP3
  ON AN.AN_ORIG_AVAIL_CLASS = LKP3.LKP_ID)
  LEFT JOIN SYS_LOOKUPS LKP4
  ON AN.AN_CURR_AVAIL_CLASS = LKP4.LKP_ID)
  LEFT JOIN SYS_LOOKUPS LKP5
  ON AN.AN_RISK_RANK_SEVERITY = LKP5.LKP_ID)
  LEFT JOIN SYS_LOOKUPS LKP6
  ON AN.AN_RISK_RANK_LIKELIHOOD = LKP6.LKP_ID)
  INNER JOIN TBL_ANOM_TYPES AN_FT
  ON AN.AN_TYPE = AN_FT.ANTYPE_ID)
  INNER JOIN SYS_TREE_STRUC TS
  ON NA.REC_TAG = TS.TRE_DAT_TAG
WHERE
  AN.AN_STATUS=8450 OR AN.AN_STATUS=17442
ORDER BY
  TS.TRE_NOD_LOC;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_01
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_01" ("CHEMICALGROUP", "SAMPLEDATE", "ASSETCODE", "ASSETTITLE", "STATUS", "VENDOR", "DATTYPE", "ASSETID") AS 
  SELECT CMOD.CHD_MOD_NAME  AS CHEMICALGROUP,
  CHEAD.CHD_HDR_SAMP_DATE AS SAMPLEDATE,
  NODAT.NODE_ID           AS ASSETCODE,
  NODAT.NODE_DESC         AS ASSETTITLE,
  LU2.LKP_DESC_B          AS STATUS,
  LU1.LKP_DESC_B          AS VENDOR,
  TREESTRUC.TRE_DAT_TYPE  AS DATTYPE,
  NODAT.REC_TAG           AS ASSETID
FROM SYS_TREE_STRUC TREESTRUC
INNER JOIN ((((TBL_CHD_HEADER CHEAD
INNER JOIN TBL_CHD_SUB_MODULES CMOD
ON CHEAD.CHD_HDR_TYPE = CMOD.CHD_MOD_ID)
INNER JOIN SYS_NODES_ATTRIB NODAT
ON CHEAD.CHD_HDR_ASSET_ID = NODAT.REC_TAG)
LEFT JOIN SYS_LOOKUPS LU1
ON CHEAD.CHD_HDR_ANA_VEND = LU1.LKP_ID)
LEFT JOIN SYS_LOOKUPS LU2
ON CHEAD.CHD_HDR_STATUS  = LU2.LKP_ID)
ON TREESTRUC.TRE_DAT_TAG = NODAT.REC_TAG
ORDER BY SAMPLEDATE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_02
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_02" ("CHEMICALGROUP", "SAMPLEDATE", "ASSETCODE", "ASSETTITLE", "STATUS", "VENDOR", "DATTYPE", "ASSETID") AS 
  SELECT CMOD.CHD_MOD_NAME  AS CHEMICALGROUP,
  CHEAD.CHD_HDR_SAMP_DATE AS SAMPLEDATE,
  NODAT.NODE_ID           AS ASSETCODE,
  NODAT.NODE_DESC         AS ASSETTITLE,
  LU2.LKP_DESC_B          AS STATUS,
  LU1.LKP_DESC_B          AS VENDOR,
  TREESTRUC.TRE_DAT_TYPE  AS DATTYPE,
  NODAT.REC_TAG           AS ASSETID
FROM SYS_TREE_STRUC TREESTRUC
INNER JOIN ((((TBL_CHD_HEADER CHEAD
INNER JOIN TBL_CHD_SUB_MODULES CMOD
ON CHEAD.CHD_HDR_TYPE = CMOD.CHD_MOD_ID)
INNER JOIN SYS_NODES_ATTRIB NODAT
ON CHEAD.CHD_HDR_ASSET_ID = NODAT.REC_TAG)
LEFT JOIN SYS_LOOKUPS LU1
ON CHEAD.CHD_HDR_ANA_VEND = LU1.LKP_ID)
LEFT JOIN SYS_LOOKUPS LU2
ON CHEAD.CHD_HDR_STATUS  = LU2.LKP_ID)
ON TREESTRUC.TRE_DAT_TAG = NODAT.REC_TAG
ORDER BY SAMPLEDATE DESC  WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_03
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_03" ("CHEMICALGROUP", "SAMPLEDATE", "ASSETCODE", "ASSETTITLE", "STATUS", "VENDORS", "VENDOR", "DATTYPE", "ASSETID") AS 
  SELECT CMOD.CHD_MOD_NAME  AS CHEMICALGROUP,
  CHEAD.CHD_HDR_SAMP_DATE AS SAMPLEDATE,
  NODAT.NODE_ID           AS ASSETCODE,
  NODAT.NODE_DESC         AS ASSETTITLE,
  LU2.LKP_DESC_B          AS STATUS,
  LU1.LKP_DESC_B          AS VENDORS,
  LU1.LKP_DESC_B          AS VENDOR,
  TREESTRUC.TRE_DAT_TYPE  AS DATTYPE,
  NODAT.REC_TAG           AS ASSETID
FROM SYS_TREE_STRUC TREESTRUC
INNER JOIN ((((TBL_CHD_HEADER CHEAD
INNER JOIN TBL_CHD_SUB_MODULES CMOD
ON CHEAD.CHD_HDR_TYPE = CMOD.CHD_MOD_ID)
INNER JOIN SYS_NODES_ATTRIB NODAT
ON CHEAD.CHD_HDR_ASSET_ID = NODAT.REC_TAG)
LEFT JOIN SYS_LOOKUPS LU1
ON CHEAD.CHD_HDR_ANA_VEND = LU1.LKP_ID)
LEFT JOIN SYS_LOOKUPS LU2
ON CHEAD.CHD_HDR_STATUS  = LU2.LKP_ID)
ON TREESTRUC.TRE_DAT_TAG = NODAT.REC_TAG
ORDER BY SAMPLEDATE DESC  WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_04
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_04" ("ASSETID", "SAMPLE_DATE", "CO2", "H2S", "SAMPLING_LOCATION", "CHEMICAL_STATUS", "DATTYPE") AS 
  SELECT SYS_NODES_ATTRIB.REC_TAG    AS ASSETID,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLE_DATE,
  TBL_CHD_GAP.CHD_GAP_CO2          AS CO2,
  TBL_CHD_GAP.CHD_GAP_H2S          AS H2S,
  SYS_NODES_ATTRIB.NODE_DESC       AS SAMPLING_LOCATION,
  SYS_LOOKUPS.LKP_DESC_B           AS CHEMICAL_STATUS,
  SYS_TREE_STRUC.TRE_DAT_TYPE      AS DATTYPE
FROM ((SYS_NODES_ATTRIB
RIGHT JOIN TBL_CHD_HEADER
ON SYS_NODES_ATTRIB.REC_TAG = TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
INNER JOIN TBL_CHD_GAP
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_GAP.CHD_GAP_ID)
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
ORDER BY SAMPLE_DATE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_05
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_05" ("SAMPLE_DATE", "API_GRAVITY", "INHIBITOR", "CLOUD_POINT", "POUR_POINT", "PARAFFIN_BY_WT", "ASPHALTENE_BY_WT", "SAMPLING_LOCATION", "CHEMICAL_STATUS", "DATTYPE", "ASSETID") AS 
  SELECT TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLE_DATE,
  TBL_CHD_OWA.CHD_OWA_GRAVITY           AS API_GRAVITY,
  TBL_CHD_OWA.CHD_OWA_INHIBITOR         AS INHIBITOR,
  TBL_CHD_OWA.CHD_OWA_CLOUD_PT          AS CLOUD_POINT,
  TBL_CHD_OWA.CHD_OWA_POUR_PT           AS POUR_POINT,
  TBL_CHD_OWA.CHD_OWA_PARAFFIN          AS PARAFFIN_BY_WT,
  TBL_CHD_OWA.CHD_OWA_ASPHALTENE        AS ASPHALTENE_BY_WT,
  SYS_NODES_ATTRIB.NODE_DESC            AS SAMPLING_LOCATION,
  SYS_LOOKUPS.LKP_DESC_B                AS CHEMICAL_STATUS,
  SYS_TREE_STRUC.TRE_DAT_TYPE           AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG              AS ASSETID
FROM ((SYS_NODES_ATTRIB
RIGHT JOIN TBL_CHD_HEADER
ON SYS_NODES_ATTRIB.REC_TAG = TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
INNER JOIN TBL_CHD_OWA
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_OWA.CHD_OWA_ID)
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
ORDER BY SAMPLE_DATE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_06
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_06" ("SAMPLE_DATE", "PSRB", "PGRB", "PNRB", "PNRSOB", "SSRB", "SGRB", "SNRB", "SNRSOB", "SAMPLING_LOCATION", "CHEMICAL_STATUS", "DATTYPE", "ASSETID") AS 
  SELECT TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLE_DATE,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_PSRB      AS PSRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_PGRB      AS PGRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_PNRB      AS PNRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_PNRSOB    AS PNRSOB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_SSRB      AS SSRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_SGRB      AS SGRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_SNRB      AS SNRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_SNRSOB    AS SNRSOB,
  SYS_NODES_ATTRIB.NODE_DESC            AS SAMPLING_LOCATION,
  SYS_LOOKUPS.LKP_DESC_B                AS CHEMICAL_STATUS,
  SYS_TREE_STRUC.TRE_DAT_TYPE           AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG              AS ASSETID
FROM ((SYS_NODES_ATTRIB
RIGHT JOIN TBL_CHD_HEADER
ON SYS_NODES_ATTRIB.REC_TAG = TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
INNER JOIN TBL_CHD_BAC_BAC
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_BAC_BAC.CHD_BAC_BAC_ID)
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
ORDER BY SAMPLE_DATE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_07
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_07" ("SAMPLING_LOCATION", "SAMPLE_DATE", "SPECIFIC_GRAVITY", "TEMPERATURE", "HARDNESS", "TOTAL_DISSOLVED_SOLID", "ANION_CATION_RATIO", "TOTAL_SUSPENDED_SOLID", "SULFATE", "SCALING_TENDENCY", "RESISTIVITY_QTY", "PH", "O2", "H2S", "SODIUM", "CALCIUM", "MAGNESIUM", "BROMIDE", "POTASSIUM", "CONDUCTIVITY_QTY", "MANGANESE", "ZINC", "IRON_SOLID", "IRON_DISSOLVED", "BARIUM", "CHLORIDE", "CARBONATE", "BICARBONATE", "CHEMICAL_STATUS", "DATTYPE", "ASSETID") AS 
  SELECT NA.NODE_DESC           AS SAMPLING_LOCATION,
  CHD_HDR.CHD_HDR_SAMP_DATE   AS SAMPLE_DATE,
  CHD_PWA.CHD_PWA_SPGR        AS SPECIFIC_GRAVITY,
  CHD_PWA.CHD_PWA_TEMP        AS TEMPERATURE,
  CHD_PWA.CHD_PWA_HARDNESS    AS HARDNESS,
  CHD_PWA.CHD_PWA_TDS         AS TOTAL_DISSOLVED_SOLID,
  CHD_PWA.CHD_PWA_ACR         AS ANION_CATION_RATIO,
  CHD_PWA.CHD_PWA_TSS         AS TOTAL_SUSPENDED_SOLID,
  CHD_PWA.CHD_PWA_SULFATE     AS SULFATE,
  CHD_PWA.CHD_PWA_SCALETEN    AS SCALING_TENDENCY,
  CHD_PWA.CHD_PWA_RESQTY      AS RESISTIVITY_QTY,
  CHD_PWA.CHD_PWA_PH          AS PH,
  CHD_PWA.CHD_PWA_O2          AS O2,
  CHD_PWA.CHD_PWA_H2S         AS H2S,
  CHD_PWA.CHD_PWA_SODIUM      AS SODIUM,
  CHD_PWA.CHD_PWA_CALCIUM     AS CALCIUM,
  CHD_PWA.CHD_PWA_MAGNESIUM   AS MAGNESIUM,
  CHD_PWA.CHD_PWA_BROMIDE     AS BROMIDE,
  CHD_PWA.CHD_PWA_POTASSIUM   AS POTASSIUM,
  CHD_PWA.CHD_PWA_CONQTY      AS CONDUCTIVITY_QTY,
  CHD_PWA.CHD_PWA_MANGANESE   AS MANGANESE,
  CHD_PWA.CHD_PWA_ZINC        AS ZINC,
  CHD_PWA.CHD_PWA_IRONSOLID   AS IRON_SOLID,
  CHD_PWA.CHD_PWA_IRONDISS    AS IRON_DISSOLVED,
  CHD_PWA.CHD_PWA_BARIUM      AS BARIUM,
  CHD_PWA.CHD_PWA_CHLORIDE    AS CHLORIDE,
  CHD_PWA.CHD_PWA_CARBONATE   AS CARBONATE,
  CHD_PWA.CHD_PWA_BICARB      AS BICARBONATE,
  LKP.LKP_DESC_B              AS CHEMICAL_STATUS,
  SYS_TREE_STRUC.TRE_DAT_TYPE AS DATTYPE,
  NA.REC_TAG                  AS ASSETID
FROM ((TBL_CHD_HEADER CHD_HDR
INNER JOIN TBL_CHD_PWA CHD_PWA
ON CHD_HDR.CHD_HDR_ID = CHD_PWA.CHD_PWA_ID)
LEFT JOIN SYS_LOOKUPS LKP
ON CHD_HDR.CHD_HDR_STATUS = LKP.LKP_ID)
INNER JOIN SYS_NODES_ATTRIB NA
ON CHD_HDR.CHD_HDR_ASSET_ID = NA.REC_TAG
INNER JOIN SYS_TREE_STRUC
ON NA.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
ORDER BY SAMPLE_DATE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_08
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_08" ("SAMPLE_DATE", "ANALYSIS_VENDOR", "SAMPLING_LOCATION", "CHEMICAL_STATUS", "SOLID_TYPE", "DATTYPE", "ASSETID") AS 
  SELECT TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLE_DATE,
  TBL_CHD_HEADER.CHD_HDR_ANA_VEND       AS ANALYSIS_VENDOR,
  SYS_NODES_ATTRIB.NODE_DESC            AS SAMPLING_LOCATION,
  SYS_LOOKUPS.LKP_DESC_B                AS CHEMICAL_STATUS,
  SYS_LOOKUPS_1.LKP_DESC_B              AS SOLID_TYPE,
  SYS_TREE_STRUC.TRE_DAT_TYPE           AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG              AS ASSETID
FROM (((SYS_NODES_ATTRIB
INNER JOIN TBL_CHD_HEADER
ON SYS_NODES_ATTRIB.REC_TAG = TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS_1
ON TBL_CHD_HEADER.CHD_HDR_INT = SYS_LOOKUPS_1.LKP_ID)
INNER JOIN TBL_CHD_COUP_SCALE
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_COUP_SCALE.CHD_COUP_SC_ID)
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
ORDER BY SAMPLE_DATE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_09
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_09" ("SAMPLING_LOCATION", "SAMPLE_DATE", "COMMENTS", "ANALYSIS_VENDOR", "CHEMICAL_STATUS", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC  AS SAMPLING_LOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLE_DATE,
  TBL_CHD_HEADER.CHD_HDR_COMMENTS  AS COMMENTS,
  SYS_LOOKUPS_2.LKP_DESC_B         AS ANALYSIS_VENDOR,
  SYS_LOOKUPS.LKP_DESC_B           AS CHEMICAL_STATUS,
  SYS_TREE_STRUC.TRE_DAT_TYPE      AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG         AS ASSETID
FROM (((TBL_CHD_HEADER
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS_1
ON TBL_CHD_HEADER.CHD_HDR_INT = SYS_LOOKUPS_1.LKP_ID)
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS_2
ON TBL_CHD_HEADER.CHD_HDR_ANA_VEND = SYS_LOOKUPS_2.LKP_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG       = SYS_TREE_STRUC.TRE_DAT_TAG
WHERE TBL_CHD_HEADER.CHD_HDR_TYPE = 6
ORDER BY SAMPLE_DATE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_10
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_10" ("SAMPLING_LOCATION", "SAMPLE_DATE", "COMMENTS", "ANALYSIS_VENDOR", "CHEMICAL_STATUS", "ASSETID", "DATTYPE") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC  AS SAMPLING_LOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLE_DATE,
  TBL_CHD_HEADER.CHD_HDR_COMMENTS  AS COMMENTS,
  SYS_LOOKUPS_1.LKP_DESC_B         AS ANALYSIS_VENDOR,
  SYS_LOOKUPS.LKP_DESC_B           AS CHEMICAL_STATUS,
  SYS_NODES_ATTRIB.REC_TAG         AS ASSETID,
  SYS_TREE_STRUC.TRE_DAT_TYPE      AS DATTYPE
FROM ((TBL_CHD_HEADER
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS_1
ON TBL_CHD_HEADER.CHD_HDR_ANA_VEND = SYS_LOOKUPS_1.LKP_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG       = SYS_TREE_STRUC.TRE_DAT_TAG
WHERE TBL_CHD_HEADER.CHD_HDR_TYPE = 7
ORDER BY SAMPLE_DATE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_11
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_11" ("SAMPLE_DATE", "SAMPLING_LOCATION", "CHEMICAL_STATUS", "COMMENTS", "DATE_INSTALLED", "DATE_REMOVED", "DAYS_EXPOSED", "GENERAL_MPY", "PITTING_MPY", "SAMPLINGLOCATION", "STATUS", "ASSETID", "DATTYPE") AS 
  SELECT TBL_CHD_HEADER.CHD_HDR_SAMP_DATE       AS SAMPLE_DATE,
  SYS_NODES_ATTRIB.NODE_DESC                  AS SAMPLING_LOCATION,
  SYS_LOOKUPS.LKP_DESC_B                      AS CHEMICAL_STATUS,
  TBL_CHD_HEADER.CHD_HDR_COMMENTS             AS COMMENTS,
  TBL_CHD_COUP_CORR.CHD_COUP_CORR_DT_INST     AS DATE_INSTALLED,
  TBL_CHD_COUP_CORR.CHD_COUP_CORR_DT_REM      AS DATE_REMOVED,
  TBL_CHD_COUP_CORR.CHD_COUP_CORR_DAYS_EXP    AS DAYS_EXPOSED,
  TBL_CHD_COUP_CORR.CHD_COUP_CORR_GEN_MPY     AS GENERAL_MPY,
  TBL_CHD_COUP_CORR.CHD_COUP_CORR_PITTING_MPY AS PITTING_MPY,
  SYS_NODES_ATTRIB.NODE_DESC                  AS SAMPLINGLOCATION,
  SYS_LOOKUPS.LKP_DESC_B                      AS STATUS,
  SYS_NODES_ATTRIB.REC_TAG                    AS ASSETID,
  SYS_TREE_STRUC.TRE_DAT_TYPE                 AS DATTYPE
FROM (SYS_NODES_ATTRIB
INNER JOIN (TBL_CHD_HEADER
INNER JOIN TBL_CHD_COUP_CORR
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_COUP_CORR.CHD_COUP_CORR_ID)
ON SYS_NODES_ATTRIB.REC_TAG  = TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
ORDER BY SAMPLE_DATE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_11A
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_11A" ("SAMPLE_DATE", "SAMPLING_LOCATION", "CHEMICAL_STATUS", "COMMENTS", "DATE_INSTALLED", "DATE_REMOVED", "DAYS_EXPOSED", "GENERAL_MPY", "PITTING_MPY", "SAMPLINGLOCATION", "STATUS") AS 
  SELECT
TBL_CHD_HEADER.CHD_HDR_SAMP_DATE as Sample_Date,
SYS_NODES_ATTRIB.NODE_DESC AS Sampling_Location,
SYS_LOOKUPS.LKP_DESC_B AS Chemical_Status,
TBL_CHD_HEADER.CHD_HDR_COMMENTS AS Comments,
TBL_CHD_COUP_CORR.CHD_COUP_CORR_DT_INST as Date_Installed,
TBL_CHD_COUP_CORR.CHD_COUP_CORR_DT_REM as Date_Removed,
TBL_CHD_COUP_CORR.CHD_COUP_CORR_DAYS_EXP as Days_Exposed,
TBL_CHD_COUP_CORR.CHD_COUP_CORR_GEN_MPY as General_MPY,
TBL_CHD_COUP_CORR.CHD_COUP_CORR_PITTING_MPY as Pitting_MPY,
SYS_NODES_ATTRIB.NODE_DESC AS SamplingLocation,
SYS_LOOKUPS.LKP_DESC_B AS Status
FROM (SYS_NODES_ATTRIB
RIGHT JOIN
(TBL_CHD_HEADER
INNER JOIN TBL_CHD_COUP_CORR
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_COUP_CORR.CHD_COUP_CORR_ID)
ON SYS_NODES_ATTRIB.REC_TAG = TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_12
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_12" ("SAMPLE_DATE", "SAMPLING_LOCATION", "CHEMICAL_STATUS", "COMMENTS", "DATE_INSTALLED", "DATE_REMOVED", "DAYS_EXPOSED", "WAIT_GAIN", "WAIT_GAIN_PER_DAY", "SAMPLINGLOCATION", "STATUS", "ASSETID", "DATTYPE") AS 
  SELECT TBL_CHD_HEADER.CHD_HDR_SAMP_DATE   AS SAMPLE_DATE,
  SYS_NODES_ATTRIB.NODE_DESC              AS SAMPLING_LOCATION,
  SYS_LOOKUPS.LKP_DESC_B                  AS CHEMICAL_STATUS,
  TBL_CHD_HEADER.CHD_HDR_COMMENTS         AS COMMENTS,
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_DT_INST  AS DATE_INSTALLED,
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_DT_REM   AS DATE_REMOVED,
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_DAYS_EXP AS DAYS_EXPOSED,
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_WTGN     AS WAIT_GAIN,
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_WTGN_DY  AS WAIT_GAIN_PER_DAY,
  SYS_NODES_ATTRIB.NODE_DESC              AS SAMPLINGLOCATION,
  SYS_LOOKUPS.LKP_DESC_B                  AS STATUS,
  SYS_NODES_ATTRIB.REC_TAG                AS ASSETID,
  SYS_TREE_STRUC.TRE_DAT_TYPE             AS DATTYPE
FROM ((SYS_NODES_ATTRIB
INNER JOIN TBL_CHD_HEADER
ON SYS_NODES_ATTRIB.REC_TAG = TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
INNER JOIN TBL_CHD_COUP_SCALE
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_COUP_SCALE.CHD_COUP_SC_ID)
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
ORDER BY SAMPLE_DATE DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_12A
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_12A" ("SAMPLE_DATE", "SAMPLING_LOCATION", "CHEMICAL_STATUS", "COMMENTS", "DATE_INSTALLED", "DATE_REMOVED", "DAYS_EXPOSED", "WAIT_GAIN", "WAIT_GAIN_PER_DAY", "SAMPLINGLOCATION", "STATUS") AS 
  SELECT
TBL_CHD_HEADER.CHD_HDR_SAMP_DATE as Sample_Date,
SYS_NODES_ATTRIB.NODE_DESC AS Sampling_Location,
SYS_LOOKUPS.LKP_DESC_B AS Chemical_Status,
TBL_CHD_HEADER.CHD_HDR_COMMENTS AS Comments,
TBL_CHD_COUP_SCALE.CHD_COUP_SC_DT_INST as Date_Installed,
TBL_CHD_COUP_SCALE.CHD_COUP_SC_DT_REM as Date_Removed,
TBL_CHD_COUP_SCALE.CHD_COUP_SC_DAYS_EXP as Days_Exposed,
TBL_CHD_COUP_SCALE.CHD_COUP_SC_WTGN as Wait_Gain,
TBL_CHD_COUP_SCALE.CHD_COUP_SC_WTGN_DY as Wait_Gain_per_day,
SYS_NODES_ATTRIB.NODE_DESC AS SamplingLocation,
SYS_LOOKUPS.LKP_DESC_B AS Status
FROM ((SYS_NODES_ATTRIB
RIGHT JOIN TBL_CHD_HEADER
ON SYS_NODES_ATTRIB.REC_TAG = TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
INNER JOIN TBL_CHD_COUP_SCALE
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_COUP_SCALE.CHD_COUP_SC_ID)
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_13
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_13" ("SAMPLING_LOCATION", "SAMPLE_DATE", "COMMENTS", "CHEMICAL_STATUS", "ANALYSIS_VENDOR", "ASSETID", "DATTYPE") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC  AS SAMPLING_LOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLE_DATE,
  TBL_CHD_HEADER.CHD_HDR_COMMENTS  AS COMMENTS,
  SYS_LOOKUPS.LKP_DESC_B           AS CHEMICAL_STATUS,
  SYS_LOOKUPS_1.LKP_DESC_B         AS ANALYSIS_VENDOR,
  SYS_NODES_ATTRIB.REC_TAG         AS ASSETID,
  SYS_TREE_STRUC.TRE_DAT_TYPE      AS DATTYPE
FROM ((TBL_CHD_HEADER
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS_1
ON TBL_CHD_HEADER.CHD_HDR_ANA_VEND = SYS_LOOKUPS_1.LKP_ID)
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG       = SYS_TREE_STRUC.TRE_DAT_TAG
WHERE TBL_CHD_HEADER.CHD_HDR_TYPE = 10 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_13A
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_13A" ("SAMPLING_LOCATION", "SAMPLE_DATE", "COMMENTS", "CHEMICAL_STATUS", "ANALYSIS_VENDOR") AS 
  SELECT
SYS_NODES_ATTRIB.NODE_DESC AS Sampling_Location,
TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS Sample_Date,
TBL_CHD_HEADER.CHD_HDR_COMMENTS AS Comments,
SYS_LOOKUPS.LKP_DESC_B AS Chemical_Status,
SYS_LOOKUPS_1.LKP_DESC_B AS Analysis_Vendor
FROM ((TBL_CHD_HEADER
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS_1
ON TBL_CHD_HEADER.CHD_HDR_ANA_VEND = SYS_LOOKUPS_1.LKP_ID)
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID
WHERE (((TBL_CHD_HEADER.CHD_HDR_TYPE) =10)) WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_14
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_14" ("SAMPLINGLOCATION", "SAMPLINGDATE", "STATUS", "OPERATORINITIAL", "ESTIMATERATE", "O2READING", "FIELDIR", "LABIR", "WSO", "MNLYIRVENDOR", "MNLYIRGRAVIMETRIC", "ASSETID", "DATTYPE") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC  AS SAMPLINGLOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLINGDATE,
  SYS_LOOKUPS.LKP_DESC_B           AS STATUS,
  TBL_CHD_WQA.CHD_WQA_OP_INIT      AS OPERATORINITIAL,
  TBL_CHD_WQA.CHD_WQA_EST_RATE     AS ESTIMATERATE,
  TBL_CHD_WQA.CHD_WQA_O2           AS O2READING,
  TBL_CHD_WQA.CHD_WQA_FIELD_IR     AS FIELDIR,
  TBL_CHD_WQA.CHD_WQA_LAB_IR       AS LABIR,
  TBL_CHD_WQA.CHD_WQA_WSO_IR       AS WSO,
  TBL_CHD_WQA.CHD_WQA_MNLY_IR      AS MNLYIRVENDOR,
  TBL_CHD_WQA.CHD_WQA_MNLY_LAB     AS MNLYIRGRAVIMETRIC,
  SYS_TREE_STRUC.TRE_DAT_TYPE      AS ASSETID,
  SYS_NODES_ATTRIB.REC_TAG         AS DATTYPE
FROM SYS_TREE_STRUC
INNER JOIN (((TBL_CHD_HEADER
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
INNER JOIN TBL_CHD_WQA
ON TBL_CHD_HEADER.CHD_HDR_ID  = TBL_CHD_WQA.CHD_WQA_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
ORDER BY SAMPLINGDATE DESC  WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_15
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_15" ("SAMPLINGLOCATION", "SAMPLINGDATE", "STATUS", "SUSPENDEDSOLID", "TOTALHYDROCARBON", "TOTALDISSOLVESOLID", "PH", "FOAMING", "FOAMINGTIME", "H2O", "IRON", "CALCIUM", "POTASSIUM", "MAGNESIUM", "SODIUM", "SPECGRAV", "CHLORIDE", "FLASHPOINT", "MEG", "DEG", "TEG", "TTEG", "OTHERS", "RESIDUE", "APEARRANCE", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC  AS SAMPLINGLOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLINGDATE,
  SYS_LOOKUPS.LKP_DESC_B           AS STATUS,
  TBL_CHD_GLY.CHD_GLY_TSS          AS SUSPENDEDSOLID,
  TBL_CHD_GLY.CHD_GLY_THC          AS TOTALHYDROCARBON,
  TBL_CHD_GLY.CHD_GLY_TDS          AS TOTALDISSOLVESOLID,
  TBL_CHD_GLY.CHD_GLY_PH           AS PH,
  TBL_CHD_GLY.CHD_GLY_FOAMING      AS FOAMING,
  TBL_CHD_GLY.CHD_GLY_FOAMING_TIME AS FOAMINGTIME,
  TBL_CHD_GLY.CHD_GLY_H2O          AS H2O,
  TBL_CHD_GLY.CHD_GLY_IRON         AS IRON,
  TBL_CHD_GLY.CHD_GLY_CALCIUM      AS CALCIUM,
  TBL_CHD_GLY.CHD_GLY_POTASSIUM    AS POTASSIUM,
  TBL_CHD_GLY.CHD_GLY_MAGNESIUM    AS MAGNESIUM,
  TBL_CHD_GLY.CHD_GLY_SODIUM       AS SODIUM,
  TBL_CHD_GLY.CHD_GLY_SPGR         AS SPECGRAV,
  TBL_CHD_GLY.CHD_GLY_CHLORIDE     AS CHLORIDE,
  TBL_CHD_GLY.CHD_GLY_FLASH        AS FLASHPOINT,
  TBL_CHD_GLY.CHD_GLY_MEG          AS MEG,
  TBL_CHD_GLY.CHD_GLY_DEG          AS DEG,
  TBL_CHD_GLY.CHD_GLY_TEG          AS TEG,
  TBL_CHD_GLY.CHD_GLY_TTEG         AS TTEG,
  TBL_CHD_GLY.CHD_GLY_OTHER        AS OTHERS,
  TBL_CHD_GLY.CHD_GLY_RESID        AS RESIDUE,
  TBL_CHD_GLY.CHD_GLY_APP          AS APEARRANCE,
  SYS_TREE_STRUC.TRE_DAT_TYPE      AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG         AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (((TBL_CHD_HEADER
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
INNER JOIN TBL_CHD_GLY
ON TBL_CHD_HEADER.CHD_HDR_ID  = TBL_CHD_GLY.CHD_GLY_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_16
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_16" ("SAMPLINGLOCATION", "SAMPLINGDATE", "STATUS", "OPERETORINITIAL", "PH", "NITRATE", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC     AS SAMPLINGLOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE    AS SAMPLINGDATE,
  SYS_LOOKUPS.LKP_DESC_B              AS STATUS,
  TBL_CHD_WHRU_WHRU.CHD_WHRU_WHRU_OI  AS OPERETORINITIAL,
  TBL_CHD_WHRU_WHRU.CHD_WHRU_WHRU_PH  AS PH,
  TBL_CHD_WHRU_WHRU.CHD_WHRU_WHRU_NIT AS NITRATE,
  SYS_TREE_STRUC.TRE_DAT_TYPE         AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG            AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (((TBL_CHD_HEADER
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
INNER JOIN TBL_CHD_WHRU_WHRU
ON TBL_CHD_HEADER.CHD_HDR_ID  = TBL_CHD_WHRU_WHRU.CHD_WHRU_WHRU_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_17
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_17" ("SAMPLINGLOCATION", "SAMPLINGDATE", "STATUS", "OPERATORINITIAL", "PH", "SULFITERESIDUAL", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC         AS SAMPLINGLOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE        AS SAMPLINGDATE,
  SYS_LOOKUPS.LKP_DESC_B                  AS STATUS,
  TBL_CHD_WHRU_JACKET.CHD_WHRU_JACKET_OI  AS OPERATORINITIAL,
  TBL_CHD_WHRU_JACKET.CHD_WHRU_JACKET_PH  AS PH,
  TBL_CHD_WHRU_JACKET.CHD_WHRU_JACKET_SUL AS SULFITERESIDUAL,
  SYS_TREE_STRUC.TRE_DAT_TYPE             AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG                AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (((TBL_CHD_HEADER
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
INNER JOIN TBL_CHD_WHRU_JACKET
ON TBL_CHD_HEADER.CHD_HDR_ID  = TBL_CHD_WHRU_JACKET.CHD_WHRU_JACKET_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_18
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_18" ("SAMPLINGLOCATION", "SAMPLINGDATE", "STATUS", "TOTALDISSOLVESOLID", "TOTALSUSPENDEDSOLID", "IRONDISSOLVE", "SPECIFICGRAVITY", "CONDUCTIVITY", "HARDNESS", "SODIUM", "CALCIUM", "PH", "TEMPERATURE", "MAGNESIUM", "CHLORIDE", "SULFATE", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC             AS SAMPLINGLOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE            AS SAMPLINGDATE,
  SYS_LOOKUPS.LKP_DESC_B                      AS STATUS,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_TDS       AS TOTALDISSOLVESOLID,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_TSS       AS TOTALSUSPENDEDSOLID,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_IRON      AS IRONDISSOLVE,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_SPGR      AS SPECIFICGRAVITY,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_COND      AS CONDUCTIVITY,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_HARDNESS  AS HARDNESS,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_SODIUM    AS SODIUM,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_CALCIUM   AS CALCIUM,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_PH        AS PH,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_TEMP      AS TEMPERATURE,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_MAGNESIUM AS MAGNESIUM,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_CHLORIDE  AS CHLORIDE,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_SULFATE   AS SULFATE,
  SYS_TREE_STRUC.TRE_DAT_TYPE                 AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG                    AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (((TBL_CHD_HEADER
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
INNER JOIN TBL_CHD_WHRU_WATER
ON TBL_CHD_HEADER.CHD_HDR_ID  = TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_19
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_19" ("SAMPLINGLOCATION", "SAMPLINGDATE", "STATUS", "GENERICNAME", "PRODUCTNAME", "COMPANYNAME", "INJECTIONPOINT", "RECOMMENDEDTREATMENT", "ACTUALRATE", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC            AS SAMPLINGLOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE           AS SAMPLINGDATE,
  SYS_LOOKUPS.LKP_DESC_B                     AS STATUS,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_GNAME    AS GENERICNAME,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_PNAME    AS PRODUCTNAME,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_CNAME    AS COMPANYNAME,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_IPOINT   AS INJECTIONPOINT,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_REC_T    AS RECOMMENDEDTREATMENT,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_ACT_RATE AS ACTUALRATE,
  SYS_TREE_STRUC.TRE_DAT_TYPE                AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (((SYS_NODES_ATTRIB
INNER JOIN TBL_CHD_HEADER
ON SYS_NODES_ATTRIB.REC_TAG = TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
INNER JOIN TBL_CHD_CHEM_TREAT
ON TBL_CHD_HEADER.CHD_HDR_ID  = TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_19_CON
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_19_CON" ("SAMPLINGLOCATION", "SAMPLINGDATE", "SILICATES", "ELASTOMERS", "FIBERS", "PRECIPITATES", "GEL", "NASCLASS", "OIL", "YELLOWMETAL", "BRIGHTMETAL", "BLACKMETAL", "GREASE", "RUST", "OLIGMERS", "SILICA", "OTHERS", "OTHERSR", "PASSFAIL", "STATUS", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.NODE_DESC   AS SamplingLocation,
        TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SamplingDate,
        TBL_CHD_HFA.CHD_HFA_SIL          AS Silicates,
        TBL_CHD_HFA.CHD_HFA_ELAS         AS Elastomers,
        TBL_CHD_HFA.CHD_HFA_FIBERS       AS Fibers,
        TBL_CHD_HFA.CHD_HFA_PREC         AS Precipitates,
        TBL_CHD_HFA.CHD_HFA_GEL          AS Gel,
        TBL_CHD_HFA.CHD_HFA_NAS_CL       AS NASClass,
        TBL_CHD_HFA.CHD_HFA_OIL          AS Oil,
        TBL_CHD_HFA.CHD_HFA_YELL_MET     AS YellowMetal,
        TBL_CHD_HFA.CHD_HFA_BRT_MET      AS BrightMetal,
        TBL_CHD_HFA.CHD_HFA_BLK_MET      AS BlackMetal,
        TBL_CHD_HFA.CHD_HFA_GREASE       AS Grease,
        TBL_CHD_HFA.CHD_HFA_RUST         AS Rust,
        TBL_CHD_HFA.CHD_HFA_OLIG         AS Oligmers,
        TBL_CHD_HFA.CHD_HFA_SILICA       AS Silica,
        TBL_CHD_HFA.CHD_HFA_OTHERS       AS Others,
        TBL_CHD_HFA.CHD_HFA_OTHERS_R     AS OthersR,
        TBL_CHD_HFA.CHD_HFA_PASS_FAIL    AS PassFail,
        SYS_LOOKUPS.LKP_DESC_B           AS Status,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  (((TBL_CHD_HEADER LEFT JOIN SYS_NODES_ATTRIB
  ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID =
  SYS_NODES_ATTRIB.REC_TAG)
  INNER JOIN TBL_CHD_HFA
  ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_HFA.CHD_HFA_ID)
  INNER JOIN SYS_LOOKUPS
  ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_19_GEN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_19_GEN" ("SAMPLINGLOCATION", "SAMPLINGDATE", "DATETAKEN", "DATERECEIVE", "DATETESTED", "DATEISSUED", "REPORTTO", "EMAILFAX", "FLUIDNAME", "SOURCE", "INSTSITE", "CHECKFILTER", "ELIMINATESOURCE", "SUBMITADDITIONALSAMPLE", "STATUS", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.NODE_DESC   AS SamplingLocation,
        TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SamplingDate,
        TBL_CHD_HFA.CHD_HFA_DTAKEN       AS DateTaken,
        TBL_CHD_HFA.CHD_HFA_DREC         AS DateReceive,
        TBL_CHD_HFA.CHD_HFA_DTESTED      AS DateTested,
        TBL_CHD_HFA.CHD_HFA_DISSUED      AS DateIssued,
        TBL_CHD_HFA.CHD_HFA_REP_TO       AS ReportTo,
        TBL_CHD_HFA.CHD_HFA_EMAIL_FAX    AS EmailFax,
        TBL_CHD_HFA.CHD_HFA_FNAME        AS FluidName,
        TBL_CHD_HFA.CHD_HFA_SOURCE       AS Source,
        TBL_CHD_HFA.CHD_HFA_INSTSITE     AS InstSite,
        TBL_CHD_HFA.CHD_HFA_CHK_FILT     AS CheckFilter,
        TBL_CHD_HFA.CHD_HFA_ELIM_SRC     AS EliminateSource,
        TBL_CHD_HFA.CHD_HFA_SUB_ADD_SAMP AS SubmitAdditionalSample,
        SYS_LOOKUPS.LKP_DESC_B           AS Status,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  (((TBL_CHD_HEADER LEFT JOIN SYS_NODES_ATTRIB
  ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID =
  SYS_NODES_ATTRIB.REC_TAG)
  INNER JOIN TBL_CHD_HFA
  ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_HFA.CHD_HFA_ID)
  INNER JOIN SYS_LOOKUPS
  ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_19_PRO
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_19_PRO" ("SAMPLINGLOCATION", "SAMPLINGDATE", "COLOR", "GLYCOLCONTENT", "LIQUIDCORROSION", "PHVALUE", "CONDUCTIVITY", "WATERHARDNESS", "SPECGRAV", "BACTERIACOUNT", "FUNGICOUNT", "COLORR", "GLYCOLCONTENTR", "LIQUIDCORROSIONR", "PHVALUER", "CONDUCTIVITYR", "WATERHARDNESSR", "SPECGRAVR", "BACTERIACOUNTR", "FUNGICOUNTR", "STATUS", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.NODE_DESC   AS SamplingLocation,
        TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SamplingDate,
        TBL_CHD_HFA.CHD_HFA_COLOR        AS Color,
        TBL_CHD_HFA.CHD_HFA_GLYCOL       AS GlycolContent,
        TBL_CHD_HFA.CHD_HFA_LIQ_COR      AS LiquidCorrosion,
        TBL_CHD_HFA.CHD_HFA_PH           AS PHValue,
        TBL_CHD_HFA.CHD_HFA_COND         AS Conductivity,
        TBL_CHD_HFA.CHD_HFA_WATER_H      AS WaterHardness,
        TBL_CHD_HFA.CHD_HFA_SPGR         AS SpecGrav,
        TBL_CHD_HFA.CHD_HFA_BAC_CNT      AS BacteriaCount,
        TBL_CHD_HFA.CHD_HFA_FUNGI_CNT    AS FungiCount,
        TBL_CHD_HFA.CHD_HFA_COLOR_R      AS ColorR,
        TBL_CHD_HFA.CHD_HFA_GLYCOL_R     AS GlycolContentR,
        TBL_CHD_HFA.CHD_HFA_LIQ_COR_R    AS LiquidCorrosionR,
        TBL_CHD_HFA.CHD_HFA_PH_R         AS PHValueR,
        TBL_CHD_HFA.CHD_HFA_COND_R       AS ConductivityR,
        TBL_CHD_HFA.CHD_HFA_WATER_H_R    AS WaterHardnessR,
        TBL_CHD_HFA.CHD_HFA_SPGR_R       AS SpecGravR,
        TBL_CHD_HFA.CHD_HFA_BAC_CNT_R    AS BacteriaCountR,
        TBL_CHD_HFA.CHD_HFA_FUNGI_CNT_R  AS FungiCountR,
        SYS_LOOKUPS.LKP_DESC_B           AS Status,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  (((TBL_CHD_HEADER LEFT JOIN SYS_NODES_ATTRIB
  ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID=SYS_NODES_ATTRIB.REC_TAG)
  INNER JOIN TBL_CHD_HFA
  ON TBL_CHD_HEADER.CHD_HDR_ID=TBL_CHD_HFA.CHD_HFA_ID)
  INNER JOIN SYS_LOOKUPS
  ON TBL_CHD_HEADER.CHD_HDR_STATUS=SYS_LOOKUPS.LKP_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_20
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_20" ("SAMPLINGLOCATION", "SAMPLINGDATE", "GENERICNAME", "PRODUCTNAME", "COMPANYNAME", "RECOMMENDEDTREATMENT", "STATUS", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC       AS SAMPLINGLOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE      AS SAMPLINGDATE,
  TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_GNAME AS GENERICNAME,
  TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_PNAME AS PRODUCTNAME,
  TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_CNAME AS COMPANYNAME,
  TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_REC_T AS RECOMMENDEDTREATMENT,
  SYS_LOOKUPS.LKP_DESC_B                AS STATUS,
  SYS_TREE_STRUC.TRE_DAT_TYPE           AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG              AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (((SYS_NODES_ATTRIB
INNER JOIN TBL_CHD_HEADER
ON SYS_NODES_ATTRIB.REC_TAG = TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
INNER JOIN TBL_CHD_CHEM_QUAL
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_ID)
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG    = SYS_NODES_ATTRIB.REC_TAG;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_21
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_21" ("SAMPLINGLOCATION", "SAMPLINGDATE", "SRDESCRIPTION", "SRNOTE", "TMDESCRIPTION", "TMNOTE", "PFDDESCRIPTION", "PFDNOTE", "STATUS", "DATTYPE", "ASSETID") AS 
  SELECT NODAT.NODE_DESC        AS SAMPLINGLOCATION,
  CHD_HEAD.CHD_HDR_SAMP_DATE  AS SAMPLINGDATE,
  TO_CHAR(REF3.RF_DESC)       AS SRDESCRIPTION,
  LU3.LKP_DESC_B              AS SRNOTE,
  TO_CHAR(REF1.RF_DESC)       AS TMDESCRIPTION,
  LU1.LKP_DESC_B              AS TMNOTE,
  TO_CHAR(REF2.RF_DESC)       AS PFDDESCRIPTION,
  LU2.LKP_DESC_B              AS PFDNOTE,
  SYS_LOOKUPS.LKP_DESC_B      AS STATUS,
  SYS_TREE_STRUC.TRE_DAT_TYPE AS DATTYPE,
  NODAT.REC_TAG               AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (TBL_CHD_HEADER CHD_HEAD
INNER JOIN SYS_NODES_ATTRIB NODAT
ON CHD_HEAD.CHD_HDR_ASSET_ID = NODAT.REC_TAG
LEFT JOIN LNK_CHEM_TREATINGMANUAL_REF LNK_TM
ON CHD_HEAD.CHD_HDR_ID = LNK_TM.LNK_TAG_B
LEFT JOIN (TBL_REFERENCE_FILES REF1
LEFT JOIN SYS_LOOKUPS LU1
ON REF1.RF_CLASS    = LU1.LKP_ID)
ON LNK_TM.LNK_TAG_A = REF1.RF_ID
LEFT JOIN LNK_CHEM_PFD_REF PFD
ON CHD_HEAD.CHD_HDR_ID = PFD.LNK_TAG_B
LEFT JOIN TBL_REFERENCE_FILES REF2
ON PFD.LNK_TAG_A = REF2.RF_ID
LEFT JOIN SYS_LOOKUPS LU2
ON REF2.RF_CLASS = LU2.LKP_ID
LEFT JOIN LNK_CHEM_SR_REF
ON CHD_HEAD.CHD_HDR_ID = LNK_CHEM_SR_REF.LNK_TAG_B
LEFT JOIN (TBL_REFERENCE_FILES REF3
LEFT JOIN SYS_LOOKUPS LU3
ON REF3.RF_CLASS             = LU3.LKP_ID)
ON LNK_CHEM_SR_REF.LNK_TAG_A = REF3.RF_ID
INNER JOIN SYS_LOOKUPS
ON CHD_HEAD.CHD_HDR_STATUS    = SYS_LOOKUPS.LKP_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG = NODAT.REC_TAG;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_22
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_22" ("SAMPLINGLOCATION", "SAMPLINGDATE", "SILICATES", "ELASTOMERS", "FIBERS", "PRECIPITATES", "GEL", "NASCLASS", "OIL", "YELLOWMETAL", "BRIGHTMETAL", "BLACKMETAL", "GREASE", "RUST", "OLIGMERS", "SILICA", "OTHERS", "OTHERSR", "PASSFAIL", "STATUS", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC  AS SAMPLINGLOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLINGDATE,
  TBL_CHD_HFA.CHD_HFA_SIL          AS SILICATES,
  TBL_CHD_HFA.CHD_HFA_ELAS         AS ELASTOMERS,
  TBL_CHD_HFA.CHD_HFA_FIBERS       AS FIBERS,
  TBL_CHD_HFA.CHD_HFA_PREC         AS PRECIPITATES,
  TBL_CHD_HFA.CHD_HFA_GEL          AS GEL,
  TBL_CHD_HFA.CHD_HFA_NAS_CL       AS NASCLASS,
  TBL_CHD_HFA.CHD_HFA_OIL          AS OIL,
  TBL_CHD_HFA.CHD_HFA_YELL_MET     AS YELLOWMETAL,
  TBL_CHD_HFA.CHD_HFA_BRT_MET      AS BRIGHTMETAL,
  TBL_CHD_HFA.CHD_HFA_BLK_MET      AS BLACKMETAL,
  TBL_CHD_HFA.CHD_HFA_GREASE       AS GREASE,
  TBL_CHD_HFA.CHD_HFA_RUST         AS RUST,
  TBL_CHD_HFA.CHD_HFA_OLIG         AS OLIGMERS,
  TBL_CHD_HFA.CHD_HFA_SILICA       AS SILICA,
  TBL_CHD_HFA.CHD_HFA_OTHERS       AS OTHERS,
  TBL_CHD_HFA.CHD_HFA_OTHERS_R     AS OTHERSR,
  TBL_CHD_HFA.CHD_HFA_PASS_FAIL    AS PASSFAIL,
  SYS_LOOKUPS.LKP_DESC_B           AS STATUS,
  SYS_TREE_STRUC.TRE_DAT_TYPE      AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG         AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (((TBL_CHD_HEADER
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
INNER JOIN TBL_CHD_HFA
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_HFA.CHD_HFA_ID)
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG    = SYS_NODES_ATTRIB.REC_TAG;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_23
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_23" ("SAMPLINGLOCATION", "SAMPLINGDATE", "DATETAKEN", "DATERECEIVE", "DATETESTED", "DATEISSUED", "REPORTTO", "EMAILFAX", "FLUIDNAME", "SOURCE", "INSTSITE", "CHECKFILTER", "ELIMINATESOURCE", "SUBMITADDITIONALSAMPLE", "STATUS", "ASSETID", "DATTYPE") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC  AS SAMPLINGLOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLINGDATE,
  TBL_CHD_HFA.CHD_HFA_DTAKEN       AS DATETAKEN,
  TBL_CHD_HFA.CHD_HFA_DREC         AS DATERECEIVE,
  TBL_CHD_HFA.CHD_HFA_DTESTED      AS DATETESTED,
  TBL_CHD_HFA.CHD_HFA_DISSUED      AS DATEISSUED,
  TBL_CHD_HFA.CHD_HFA_REP_TO       AS REPORTTO,
  TBL_CHD_HFA.CHD_HFA_EMAIL_FAX    AS EMAILFAX,
  TBL_CHD_HFA.CHD_HFA_FNAME        AS FLUIDNAME,
  TBL_CHD_HFA.CHD_HFA_SOURCE       AS SOURCE,
  TBL_CHD_HFA.CHD_HFA_INSTSITE     AS INSTSITE,
  TBL_CHD_HFA.CHD_HFA_CHK_FILT     AS CHECKFILTER,
  TBL_CHD_HFA.CHD_HFA_ELIM_SRC     AS ELIMINATESOURCE,
  TBL_CHD_HFA.CHD_HFA_SUB_ADD_SAMP AS SUBMITADDITIONALSAMPLE,
  SYS_LOOKUPS.LKP_DESC_B           AS STATUS,
  SYS_NODES_ATTRIB.REC_TAG         AS ASSETID,
  SYS_TREE_STRUC.TRE_DAT_TYPE      AS DATTYPE
FROM SYS_TREE_STRUC
INNER JOIN (((TBL_CHD_HEADER
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
INNER JOIN TBL_CHD_HFA
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_HFA.CHD_HFA_ID)
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG    = SYS_NODES_ATTRIB.REC_TAG;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_24
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_24" ("SAMPLINGLOCATION", "SAMPLINGDATE", "COLOR", "GLYCOLCONTENT", "LIQUIDCORROSION", "PHVALUE", "CONDUCTIVITY", "WATERHARDNESS", "SPECGRAV", "BACTERIACOUNT", "FUNGICOUNT", "COLORR", "GLYCOLCONTENTR", "LIQUIDCORROSIONR", "PHVALUER", "CONDUCTIVITYR", "WATERHARDNESSR", "SPECGRAVR", "BACTERIACOUNTR", "FUNGICOUNTR", "STATUS", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC  AS SAMPLINGLOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SAMPLINGDATE,
  TBL_CHD_HFA.CHD_HFA_COLOR        AS COLOR,
  TBL_CHD_HFA.CHD_HFA_GLYCOL       AS GLYCOLCONTENT,
  TBL_CHD_HFA.CHD_HFA_LIQ_COR      AS LIQUIDCORROSION,
  TBL_CHD_HFA.CHD_HFA_PH           AS PHVALUE,
  TBL_CHD_HFA.CHD_HFA_COND         AS CONDUCTIVITY,
  TBL_CHD_HFA.CHD_HFA_WATER_H      AS WATERHARDNESS,
  TBL_CHD_HFA.CHD_HFA_SPGR         AS SPECGRAV,
  TBL_CHD_HFA.CHD_HFA_BAC_CNT      AS BACTERIACOUNT,
  TBL_CHD_HFA.CHD_HFA_FUNGI_CNT    AS FUNGICOUNT,
  TBL_CHD_HFA.CHD_HFA_COLOR_R      AS COLORR,
  TBL_CHD_HFA.CHD_HFA_GLYCOL_R     AS GLYCOLCONTENTR,
  TBL_CHD_HFA.CHD_HFA_LIQ_COR_R    AS LIQUIDCORROSIONR,
  TBL_CHD_HFA.CHD_HFA_PH_R         AS PHVALUER,
  TBL_CHD_HFA.CHD_HFA_COND_R       AS CONDUCTIVITYR,
  TBL_CHD_HFA.CHD_HFA_WATER_H_R    AS WATERHARDNESSR,
  TBL_CHD_HFA.CHD_HFA_SPGR_R       AS SPECGRAVR,
  TBL_CHD_HFA.CHD_HFA_BAC_CNT_R    AS BACTERIACOUNTR,
  TBL_CHD_HFA.CHD_HFA_FUNGI_CNT_R  AS FUNGICOUNTR,
  SYS_LOOKUPS.LKP_DESC_B           AS STATUS,
  SYS_TREE_STRUC.TRE_DAT_TYPE      AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG         AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (((TBL_CHD_HEADER
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
INNER JOIN TBL_CHD_HFA
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_HFA.CHD_HFA_ID)
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG    = SYS_NODES_ATTRIB.REC_TAG;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_25
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_25" ("SAMPLINGLOCATION", "SAMPLINGDATE", "GENERICNAME", "PRODUCTNAME", "COMPANYNAME", "RECOMMENDEDTREATMENT", "ACTUALRATE", "INJECTIONPOINT", "STATUS", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC        AS SAMPLINGLOCATION,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE       AS SAMPLINGDATE,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_GNAME    AS GENERICNAME,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_PNAME    AS PRODUCTNAME,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_CNAME    AS COMPANYNAME,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_REC_T    AS RECOMMENDEDTREATMENT,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_ACT_RATE AS ACTUALRATE,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_IPOINT   AS INJECTIONPOINT,
  SYS_LOOKUPS.LKP_DESC_B                 AS STATUS,
  SYS_TREE_STRUC.TRE_DAT_TYPE            AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG               AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (((SYS_NODES_ATTRIB
INNER JOIN TBL_CHD_HEADER
ON SYS_NODES_ATTRIB.REC_TAG = TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
INNER JOIN TBL_CHD_CHEM_RSD
ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_ID)
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG    = SYS_NODES_ATTRIB.REC_TAG;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_26
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_26" ("SAMPLINGLOCATION", "STATUS", "SAMPLEDATE", "COMMENTS", "SERVICEREPORTDESCRIPTION", "SERVICEREPORTNOTES", "SERVICEREPORTREVISIONDATE", "ASSETID", "DATTYPE") AS 
  SELECT SYS_NODES_ATTRIB.NODE_DESC          AS SamplingLocation,
  SYS_LOOKUPS.LKP_DESC_B                   AS Status,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE         AS SampleDate,
  TO_CHAR(TBL_CHD_HEADER.CHD_HDR_COMMENTS) AS Comments,
  TO_CHAR(TBL_REFERENCE_FILES.RF_DESC)     AS ServiceReportDescription,
  TO_CHAR(TBL_REFERENCE_FILES.RF_NOTES)    AS ServiceReportNotes,
  TBL_REFERENCE_FILES.RF_REVDATE           AS ServiceReportRevisionDate,
  SYS_NODES_ATTRIB.REC_TAG                 AS AssetID,
  SYS_TREE_STRUC.TRE_DAT_TYPE              AS DatType
FROM TBL_REFERENCE_FILES
INNER JOIN LNK_CHEM_SR_REF
ON LNK_CHEM_SR_REF.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID
INNER JOIN TBL_CHD_HEADER
ON LNK_CHEM_SR_REF.LNK_TAG_B = TBL_CHD_HEADER.CHD_HDR_ID
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG       = SYS_TREE_STRUC.TRE_DAT_TAG
WHERE TBL_CHD_HEADER.CHD_HDR_TYPE = 18
GROUP BY SYS_NODES_ATTRIB.NODE_DESC,
  SYS_LOOKUPS.LKP_DESC_B,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  TO_CHAR(TBL_CHD_HEADER.CHD_HDR_COMMENTS),
  TO_CHAR(TBL_REFERENCE_FILES.RF_DESC),
  TO_CHAR(TBL_REFERENCE_FILES.RF_NOTES),
  TBL_REFERENCE_FILES.RF_REVDATE,
  SYS_NODES_ATTRIB.REC_TAG,
  SYS_TREE_STRUC.TRE_DAT_TYPE
ORDER BY SampleDate DESC,
  ServiceReportRevisionDate DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_27
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_27" ("SAMPLINGLOCATION", "STATUS", "SAMPLEDATE", "COMMENTS", "TREATINGMANUALDESCRIPTION", "TREATINGMANUALNOTES", "TREATINGMANUALREVISIONDATE", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC            AS SamplingLocation,
  SYS_LOOKUPS.LKP_DESC_B                   AS Status,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE         AS SampleDate,
  TO_CHAR(TBL_CHD_HEADER.CHD_HDR_COMMENTS) AS Comments,
  TO_CHAR(TBL_REFERENCE_FILES.RF_DESC)     AS TreatingManualDescription,
  TO_CHAR(TBL_REFERENCE_FILES.RF_NOTES)    AS TreatingManualNotes,
  TBL_REFERENCE_FILES.RF_REVDATE           AS TreatingManualRevisionDate,
  SYS_NODES_ATTRIB.REC_TAG                 AS DatType,
  SYS_TREE_STRUC.TRE_DAT_TYPE              AS AssetID
FROM TBL_REFERENCE_FILES
INNER JOIN LNK_CHEM_TREATINGMANUAL_REF
ON LNK_CHEM_TREATINGMANUAL_REF.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID
INNER JOIN TBL_CHD_HEADER
ON LNK_CHEM_TREATINGMANUAL_REF.LNK_TAG_B = TBL_CHD_HEADER.CHD_HDR_ID
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG       = SYS_TREE_STRUC.TRE_DAT_TAG
WHERE TBL_CHD_HEADER.CHD_HDR_TYPE = 18
GROUP BY SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC,
  SYS_LOOKUPS.LKP_DESC_B,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  TO_CHAR(TBL_CHD_HEADER.CHD_HDR_COMMENTS),
  TO_CHAR(TBL_REFERENCE_FILES.RF_DESC),
  TO_CHAR(TBL_REFERENCE_FILES.RF_NOTES),
  TBL_REFERENCE_FILES.RF_REVDATE,
  SYS_NODES_ATTRIB.REC_TAG,
  SYS_TREE_STRUC.TRE_DAT_TYPE
ORDER BY SamplingLocation,
  SampleDate DESC,
  TreatingManualRevisionDate DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_28
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_28" ("SAMPLINGLOCATION", "STATUS", "SAMPLEDATE", "COMMENTS", "CHEMPFDDESCRIPTION", "CHEMPFDNOTES", "CHEMPFDREVISIONDATE", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC            AS SamplingLocation,
  SYS_LOOKUPS.LKP_DESC_B                   AS Status,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE         AS SampleDate,
  TO_CHAR(TBL_CHD_HEADER.CHD_HDR_COMMENTS) AS Comments,
  TO_CHAR(TBL_REFERENCE_FILES.RF_DESC)     AS ChemPFDDescription,
  TO_CHAR(TBL_REFERENCE_FILES.RF_NOTES)    AS ChemPFDNotes,
  TBL_REFERENCE_FILES.RF_REVDATE           AS ChemPFDRevisionDate,
  SYS_NODES_ATTRIB.REC_TAG                 AS DatType,
  SYS_TREE_STRUC.TRE_DAT_TYPE              AS AssetID
FROM TBL_REFERENCE_FILES
INNER JOIN LNK_CHEM_PFD_REF
ON LNK_CHEM_PFD_REF.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID
INNER JOIN TBL_CHD_HEADER
ON LNK_CHEM_PFD_REF.LNK_TAG_B = TBL_CHD_HEADER.CHD_HDR_ID
INNER JOIN SYS_LOOKUPS
ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG       = SYS_TREE_STRUC.TRE_DAT_TAG
WHERE TBL_CHD_HEADER.CHD_HDR_TYPE = 18
GROUP BY SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC,
  SYS_LOOKUPS.LKP_DESC_B,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  TO_CHAR(TBL_CHD_HEADER.CHD_HDR_COMMENTS),
  TO_CHAR(TBL_REFERENCE_FILES.RF_DESC),
  TO_CHAR(TBL_REFERENCE_FILES.RF_NOTES),
  TBL_REFERENCE_FILES.RF_REVDATE,
  SYS_NODES_ATTRIB.REC_TAG,
  SYS_TREE_STRUC.TRE_DAT_TYPE
ORDER BY SampleDate DESC,
  ChemPFDRevisionDate DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_SL_01
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_SL_01" ("SAMPLINGLOCATION", "STATUS", "SAMPLEDATE", "COMMENTS", "SERVICEREPORTDESCRIPTION", "SERVICEREPORTNOTES", "SERVICEREPORTREVISIONDATE") AS 
  SELECT
 "SamplingLocation",
 "Status",
 "SampleDate",
 "Comments",
 "ServiceReportDescription",
 "ServiceReportNotes",
 "ServiceReportRevisionDate"
FROM (SELECT
 SYS_NODES_ATTRIB.NODE_ID || ' - ' || SYS_NODES_ATTRIB.NODE_DESC AS
 "SamplingLocation",
 SYS_LOOKUPS.LKP_DESC_B AS "Status",
 TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS "SampleDate",
 TBL_CHD_HEADER.CHD_HDR_COMMENTS AS "Comments",
 TBL_REFERENCE_FILES.RF_DESC AS "ServiceReportDescription",
 TBL_REFERENCE_FILES.RF_NOTES AS "ServiceReportNotes",
 TBL_REFERENCE_FILES.RF_REVDATE AS "ServiceReportRevisionDate"
FROM
 TBL_REFERENCE_FILES RIGHT JOIN LNK_CHEM_SR_REF
 ON LNK_CHEM_SR_REF.LNK_TAG_A=TBL_REFERENCE_FILES.RF_ID
 LEFT JOIN TBL_CHD_HEADER
 ON LNK_CHEM_SR_REF.LNK_TAG_B=TBL_CHD_HEADER.CHD_HDR_ID
 LEFT JOIN SYS_LOOKUPS
 ON TBL_CHD_HEADER.CHD_HDR_STATUS=SYS_LOOKUPS.LKP_ID
 LEFT JOIN SYS_NODES_ATTRIB
 ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID=SYS_NODES_ATTRIB.REC_TAG
WHERE
 TBL_CHD_HEADER.CHD_HDR_TYPE=18
GROUP BY
 SYS_NODES_ATTRIB.NODE_ID || ' - ' || SYS_NODES_ATTRIB.NODE_DESC,
 SYS_LOOKUPS.LKP_DESC_B,
 TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
 TBL_CHD_HEADER.CHD_HDR_COMMENTS,
 TBL_REFERENCE_FILES.RF_DESC,
 TBL_REFERENCE_FILES.RF_NOTES,
 TBL_REFERENCE_FILES.RF_REVDATE
ORDER BY
 SYS_NODES_ATTRIB.NODE_ID || ' - ' || SYS_NODES_ATTRIB.NODE_DESC,
 TBL_CHD_HEADER.CHD_HDR_SAMP_DATE DESC,
 TBL_REFERENCE_FILES.RF_REVDATE DESC
) WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_SL_02
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_SL_02" ("SAMPLINGLOCATION", "STATUS", "SAMPLEDATE", "COMMENTS", "TREATINGMANUALDESCRIPTION", "TREATINGMANUALNOTES", "TREATINGMANUALREVISIONDATE") AS 
  SELECT
 "SamplingLocation",
 "Status",
 "SampleDate",
 "Comments",
 "TreatingManualDescription",
 "TreatingManualNotes",
 "TreatingManualRevisionDate"
FROM (SELECT
 SYS_NODES_ATTRIB.NODE_ID || ' - ' || SYS_NODES_ATTRIB.NODE_DESC AS
 "SamplingLocation",
 SYS_LOOKUPS.LKP_DESC_B AS "Status",
 TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS "SampleDate",
 TBL_CHD_HEADER.CHD_HDR_COMMENTS AS "Comments",
 TBL_REFERENCE_FILES.RF_DESC AS "TreatingManualDescription",
 TBL_REFERENCE_FILES.RF_NOTES AS "TreatingManualNotes",
 TBL_REFERENCE_FILES.RF_REVDATE AS "TreatingManualRevisionDate"
FROM
 TBL_REFERENCE_FILES RIGHT JOIN LNK_CHEM_TREATINGMANUAL_REF
 ON LNK_CHEM_TREATINGMANUAL_REF.LNK_TAG_A=TBL_REFERENCE_FILES.RF_ID
 LEFT JOIN TBL_CHD_HEADER
 ON LNK_CHEM_TREATINGMANUAL_REF.LNK_TAG_B=TBL_CHD_HEADER.CHD_HDR_ID
 LEFT JOIN  SYS_LOOKUPS
 ON TBL_CHD_HEADER.CHD_HDR_STATUS=SYS_LOOKUPS.LKP_ID
 LEFT JOIN SYS_NODES_ATTRIB
 ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID=SYS_NODES_ATTRIB.REC_TAG
WHERE
 TBL_CHD_HEADER.CHD_HDR_TYPE=18
GROUP BY
 SYS_NODES_ATTRIB.NODE_ID || ' - ' || SYS_NODES_ATTRIB.NODE_DESC,
 SYS_LOOKUPS.LKP_DESC_B,
 TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
 TBL_CHD_HEADER.CHD_HDR_COMMENTS,
 TBL_REFERENCE_FILES.RF_DESC,
 TBL_REFERENCE_FILES.RF_NOTES,
 TBL_REFERENCE_FILES.RF_REVDATE
ORDER BY
 SYS_NODES_ATTRIB.NODE_ID || ' - ' || SYS_NODES_ATTRIB.NODE_DESC,
 TBL_CHD_HEADER.CHD_HDR_SAMP_DATE DESC,
 TBL_REFERENCE_FILES.RF_REVDATE DESC
) WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CH_SL_03
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CH_SL_03" ("SAMPLINGLOCATION", "STATUS", "SAMPLEDATE", "COMMENTS", "CHEMPFDDESCRIPTION", "CHEMPFDNOTES", "CHEMPFDREVISIONDATE") AS 
  SELECT
 "SamplingLocation",
 "Status",
 "SampleDate",
 "Comments",
 "ChemPFDDescription",
 "ChemPFDNotes",
 "ChemPFDRevisionDate"
FROM (SELECT
 SYS_NODES_ATTRIB.NODE_ID || ' - ' || SYS_NODES_ATTRIB.NODE_DESC AS
 "SamplingLocation",
 SYS_LOOKUPS.LKP_DESC_B AS "Status",
 TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS "SampleDate",
 TBL_CHD_HEADER.CHD_HDR_COMMENTS AS "Comments",
 TBL_REFERENCE_FILES.RF_DESC AS "ChemPFDDescription",
 TBL_REFERENCE_FILES.RF_NOTES AS "ChemPFDNotes",
 TBL_REFERENCE_FILES.RF_REVDATE AS "ChemPFDRevisionDate"
FROM
 TBL_REFERENCE_FILES RIGHT JOIN LNK_CHEM_PFD_REF
 ON LNK_CHEM_PFD_REF.LNK_TAG_A=TBL_REFERENCE_FILES.RF_ID
 LEFT JOIN TBL_CHD_HEADER
 ON LNK_CHEM_PFD_REF.LNK_TAG_B=TBL_CHD_HEADER.CHD_HDR_ID
 LEFT JOIN SYS_LOOKUPS
 ON TBL_CHD_HEADER.CHD_HDR_STATUS=SYS_LOOKUPS.LKP_ID
 LEFT JOIN SYS_NODES_ATTRIB
 ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID=SYS_NODES_ATTRIB.REC_TAG
WHERE
 TBL_CHD_HEADER.CHD_HDR_TYPE=18
GROUP BY
 SYS_NODES_ATTRIB.NODE_ID || ' - ' || SYS_NODES_ATTRIB.NODE_DESC,
 SYS_LOOKUPS.LKP_DESC_B,
 TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
 TBL_CHD_HEADER.CHD_HDR_COMMENTS,
 TBL_REFERENCE_FILES.RF_DESC,
 TBL_REFERENCE_FILES.RF_NOTES,
 TBL_REFERENCE_FILES.RF_REVDATE
ORDER BY
 TBL_CHD_HEADER.CHD_HDR_SAMP_DATE DESC,
 TBL_REFERENCE_FILES.RF_REVDATE DESC
) WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_BAC
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_BAC" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_BAC_BAC_ID", "CHD_BAC_BAC_REC_TYPE", "CHD_BAC_BAC_PSRB", "CHD_BAC_BAC_PGRB", "CHD_BAC_BAC_PNRB", "CHD_BAC_BAC_PNRSOB", "CHD_BAC_BAC_SSRB", "CHD_BAC_BAC_SGRB", "CHD_BAC_BAC_SNRB", "CHD_BAC_BAC_SNRSOB", "CHD_UPDATE_DATE", "SAMPLINGLOCATION", "STATUS", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER. "CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_BAC_BAC."CHD_BAC_BAC_ID",TBL_CHD_BAC_BAC."CHD_BAC_BAC_REC_TYPE",TBL_CHD_BAC_BAC."CHD_BAC_BAC_PSRB",TBL_CHD_BAC_BAC."CHD_BAC_BAC_PGRB",TBL_CHD_BAC_BAC."CHD_BAC_BAC_PNRB",TBL_CHD_BAC_BAC."CHD_BAC_BAC_PNRSOB",TBL_CHD_BAC_BAC."CHD_BAC_BAC_SSRB",TBL_CHD_BAC_BAC."CHD_BAC_BAC_SGRB",TBL_CHD_BAC_BAC."CHD_BAC_BAC_SNRB",TBL_CHD_BAC_BAC."CHD_BAC_BAC_SNRSOB",TBL_CHD_BAC_BAC."CHD_UPDATE_DATE",
        SYS_NODES_ATTRIB.NODE_DESC AS SamplingLocation,
        SYS_LOOKUPS.LKP_DESC_B     AS Status,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  (((SYS_NODES_ATTRIB RIGHT JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_BAC_BAC
  ON TBL_CHD_HEADER.CHD_HDR_ID =
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_ID)
  LEFT JOIN SYS_LOOKUPS
  ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_BSW
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_BSW" ("REC_TAG", "NODE_ID", "NODE_DESC", "NODE_GROUP", "NODE_CLASS", "NODE_TAG", "NODE_ASSET_TYPE", "SAP_REF", "SAP_TAG", "SAP_DESC", "REF_DWG", "SPLI", "VUL_EQUT", "VUL_CAT", "NODE_GROUP_B", "ITEM_TYPE", "OREDA_CLSS", "OREDA_SUBUNIT", "OREDA_CPNT", "LL_FOLDER_OBJID", "REC_UPDATED", "ITEM_TYPE_TAG", "HAZ_REFERENCE", "POF_GROUP_ID", "RBI_INCLUDE", "SCE", "SAMPLINGLOCATION", "CHD_HDR_SAMP_DATE", "SAMPLEDATE", "COMMENTS", "STATUS", "ANALYSISVENDOR", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.*,
        SYS_NODES_ATTRIB.NODE_DESC       AS SamplingLocation,
        TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS CHD_HDR_SAMP_DATE,
        TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SampleDate,
        TBL_CHD_HEADER.CHD_HDR_COMMENTS  AS Comments,
        SYS_LOOKUPS.LKP_DESC_B           AS Status,
        SYS_LOOKUPS_1.LKP_DESC_B         AS AnalysisVendor,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  (((TBL_CHD_HEADER INNER JOIN SYS_NODES_ATTRIB
  ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID =
  SYS_NODES_ATTRIB.REC_TAG)
  LEFT JOIN SYS_LOOKUPS  SYS_LOOKUPS_1
  ON TBL_CHD_HEADER.CHD_HDR_ANA_VEND =
  SYS_LOOKUPS_1.LKP_ID)
  LEFT JOIN SYS_LOOKUPS
  ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 ((TBL_CHD_HEADER.CHD_HDR_TYPE=10) AND
 (SYS_TREE_STRUC.TRE_DAT_TYPE=1));
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_CORR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_CORR" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_COUP_CORR_ID", "CHD_COUP_CORR_DT_INST", "CHD_COUP_CORR_DT_REM", "CHD_COUP_CORR_DAYS_EXP", "CHD_COUP_CORR_GEN_MPY", "CHD_COUP_CORR_PITTING_MPY", "CHD_UPDATE_DATE", "SAMPLINGLOCATION", "STATUS", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER.   "CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_COUP_CORR."CHD_COUP_CORR_ID",TBL_CHD_COUP_CORR."CHD_COUP_CORR_DT_INST",TBL_CHD_COUP_CORR."CHD_COUP_CORR_DT_REM",TBL_CHD_COUP_CORR."CHD_COUP_CORR_DAYS_EXP",TBL_CHD_COUP_CORR."CHD_COUP_CORR_GEN_MPY",TBL_CHD_COUP_CORR."CHD_COUP_CORR_PITTING_MPY",TBL_CHD_COUP_CORR."CHD_UPDATE_DATE",
        SYS_NODES_ATTRIB.NODE_DESC AS SamplingLocation,
        SYS_LOOKUPS.LKP_DESC_B     AS Status,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  ((SYS_NODES_ATTRIB RIGHT JOIN
          (TBL_CHD_HEADER INNER JOIN TBL_CHD_COUP_CORR
          ON TBL_CHD_HEADER.CHD_HDR_ID =
   TBL_CHD_COUP_CORR.CHD_COUP_CORR_ID)
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  LEFT JOIN SYS_LOOKUPS
  ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_FA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_FA" ("REC_TAG", "NODE_ID", "NODE_DESC", "NODE_GROUP", "NODE_CLASS", "NODE_TAG", "NODE_ASSET_TYPE", "SAP_REF", "SAP_TAG", "SAP_DESC", "REF_DWG", "SPLI", "VUL_EQUT", "VUL_CAT", "NODE_GROUP_B", "ITEM_TYPE", "OREDA_CLSS", "OREDA_SUBUNIT", "OREDA_CPNT", "LL_FOLDER_OBJID", "REC_UPDATED", "ITEM_TYPE_TAG", "HAZ_REFERENCE", "POF_GROUP_ID", "RBI_INCLUDE", "SCE", "SAMPLINGLOCATION", "CHD_HDR_SAMP_DATE", "SAMPLEDATE", "STATUS", "COMMENTS", "ANALYSISVENDOR", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.*,
        SYS_NODES_ATTRIB.NODE_DESC   AS SamplingLocation,
        TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS CHD_HDR_SAMP_DATE,
        TBL_CHD_HEADER.CHD_HDR_SAMP_DATE AS SampleDate,
        SYS_LOOKUPS.LKP_DESC_B           AS Status,
        TBL_CHD_HEADER.CHD_HDR_COMMENTS  AS Comments,
        SYS_LOOKUPS_2.LKP_DESC_B         AS AnalysisVendor,
         SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  ((((TBL_CHD_HEADER LEFT JOIN SYS_LOOKUPS
  ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
  LEFT JOIN SYS_LOOKUPS  SYS_LOOKUPS_1
  ON TBL_CHD_HEADER.CHD_HDR_INT = SYS_LOOKUPS_1.LKP_ID)
  INNER JOIN SYS_NODES_ATTRIB
  ON TBL_CHD_HEADER.CHD_HDR_ASSET_ID =
  SYS_NODES_ATTRIB.REC_TAG)
  LEFT JOIN SYS_LOOKUPS  SYS_LOOKUPS_2
  ON TBL_CHD_HEADER.CHD_HDR_ANA_VEND = SYS_LOOKUPS_2.LKP_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 ((SYS_TREE_STRUC.TRE_DAT_TYPE=1) AND
 (TBL_CHD_HEADER.CHD_HDR_TYPE=6));
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_GAP
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_GAP" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_GAP_ID", "CHD_GAP_CO2", "CHD_GAP_H2S", "CHD_UPDATE_DATE", "SAMPLINGLOCATION", "STATUS", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_GAP.   "CHD_GAP_ID",TBL_CHD_GAP."CHD_GAP_CO2",TBL_CHD_GAP."CHD_GAP_H2S",TBL_CHD_GAP."CHD_UPDATE_DATE",
        SYS_NODES_ATTRIB.NODE_DESC AS SamplingLocation,
        SYS_LOOKUPS.LKP_DESC_B     AS Status,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  (((SYS_NODES_ATTRIB RIGHT JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_GAP
  ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_GAP.CHD_GAP_ID)
  LEFT JOIN SYS_LOOKUPS
  ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_GLY
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_GLY" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_GLY_ID", "CHD_GLY_TSS", "CHD_GLY_THC", "CHD_GLY_TDS", "CHD_GLY_PH", "CHD_GLY_FOAMING", "CHD_GLY_FOAMING_TIME", "CHD_GLY_H2O", "CHD_GLY_IRON", "CHD_GLY_CALCIUM", "CHD_GLY_POTASSIUM", "CHD_GLY_MAGNESIUM", "CHD_GLY_SODIUM", "CHD_GLY_SPGR", "CHD_GLY_CHLORIDE", "CHD_GLY_FLASH", "CHD_GLY_MEG", "CHD_GLY_DEG", "CHD_GLY_TEG", "CHD_GLY_TTEG", "CHD_GLY_OTHER", "CHD_GLY_RESID", "CHD_GLY_APP", "CHD_UPDATE_DATE", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_GLY.   "CHD_GLY_ID",TBL_CHD_GLY."CHD_GLY_TSS",TBL_CHD_GLY."CHD_GLY_THC",TBL_CHD_GLY."CHD_GLY_TDS",TBL_CHD_GLY."CHD_GLY_PH",TBL_CHD_GLY."CHD_GLY_FOAMING",TBL_CHD_GLY."CHD_GLY_FOAMING_TIME",TBL_CHD_GLY."CHD_GLY_H2O",TBL_CHD_GLY."CHD_GLY_IRON",TBL_CHD_GLY."CHD_GLY_CALCIUM",TBL_CHD_GLY."CHD_GLY_POTASSIUM",TBL_CHD_GLY."CHD_GLY_MAGNESIUM",TBL_CHD_GLY."CHD_GLY_SODIUM",TBL_CHD_GLY."CHD_GLY_SPGR",TBL_CHD_GLY."CHD_GLY_CHLORIDE",TBL_CHD_GLY."CHD_GLY_FLASH",TBL_CHD_GLY."CHD_GLY_MEG",TBL_CHD_GLY."CHD_GLY_DEG",TBL_CHD_GLY."CHD_GLY_TEG",TBL_CHD_GLY."CHD_GLY_TTEG",TBL_CHD_GLY."CHD_GLY_OTHER",TBL_CHD_GLY."CHD_GLY_RESID",TBL_CHD_GLY."CHD_GLY_APP",TBL_CHD_GLY."CHD_UPDATE_DATE",
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  ((SYS_NODES_ATTRIB INNER JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_GLY
  ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_GLY.CHD_GLY_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_HFA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_HFA" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_HFA_ID", "CHD_HFA_DTAKEN", "CHD_HFA_DREC", "CHD_HFA_DTESTED", "CHD_HFA_DISSUED", "CHD_HFA_REP_TO", "CHD_HFA_EMAIL_FAX", "CHD_HFA_FNAME", "CHD_HFA_SOURCE", "CHD_HFA_INSTSITE", "CHD_HFA_CHK_FILT", "CHD_HFA_ELIM_SRC", "CHD_HFA_SUB_ADD_SAMP", "CHD_HFA_COLOR", "CHD_HFA_GLYCOL", "CHD_HFA_LIQ_COR", "CHD_HFA_PH", "CHD_HFA_COND", "CHD_HFA_WATER_H", "CHD_HFA_SPGR", "CHD_HFA_BAC_CNT", "CHD_HFA_FUNGI_CNT", "CHD_HFA_COLOR_R", "CHD_HFA_GLYCOL_R", "CHD_HFA_LIQ_COR_R", "CHD_HFA_PH_R", "CHD_HFA_COND_R", "CHD_HFA_WATER_H_R", "CHD_HFA_SPGR_R", "CHD_HFA_BAC_CNT_R", "CHD_HFA_FUNGI_CNT_R", "CHD_HFA_SIL", "CHD_HFA_ELAS", "CHD_HFA_FIBERS", "CHD_HFA_PREC", "CHD_HFA_GEL", "CHD_HFA_NAS_CL", "CHD_HFA_OIL", "CHD_HFA_YELL_MET", "CHD_HFA_BLK_MET", "CHD_HFA_BRT_MET", "CHD_HFA_GREASE", "CHD_HFA_RUST", "CHD_HFA_OLIG", "CHD_HFA_SILICA", "CHD_HFA_OTHERS", "CHD_HFA_OTHERS_R", "CHD_HFA_PASS_FAIL", "CHD_UPDATE_DATE", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_HFA.   "CHD_HFA_ID",TBL_CHD_HFA."CHD_HFA_DTAKEN",TBL_CHD_HFA."CHD_HFA_DREC",TBL_CHD_HFA."CHD_HFA_DTESTED",TBL_CHD_HFA."CHD_HFA_DISSUED",TBL_CHD_HFA."CHD_HFA_REP_TO",TBL_CHD_HFA."CHD_HFA_EMAIL_FAX",TBL_CHD_HFA."CHD_HFA_FNAME",TBL_CHD_HFA."CHD_HFA_SOURCE",TBL_CHD_HFA."CHD_HFA_INSTSITE",TBL_CHD_HFA."CHD_HFA_CHK_FILT",TBL_CHD_HFA."CHD_HFA_ELIM_SRC",TBL_CHD_HFA."CHD_HFA_SUB_ADD_SAMP",TBL_CHD_HFA."CHD_HFA_COLOR",TBL_CHD_HFA."CHD_HFA_GLYCOL",TBL_CHD_HFA."CHD_HFA_LIQ_COR",TBL_CHD_HFA."CHD_HFA_PH",TBL_CHD_HFA."CHD_HFA_COND",TBL_CHD_HFA."CHD_HFA_WATER_H",TBL_CHD_HFA."CHD_HFA_SPGR",TBL_CHD_HFA."CHD_HFA_BAC_CNT",TBL_CHD_HFA."CHD_HFA_FUNGI_CNT",TBL_CHD_HFA."CHD_HFA_COLOR_R",TBL_CHD_HFA."CHD_HFA_GLYCOL_R",TBL_CHD_HFA."CHD_HFA_LIQ_COR_R",TBL_CHD_HFA."CHD_HFA_PH_R",TBL_CHD_HFA."CHD_HFA_COND_R",TBL_CHD_HFA."CHD_HFA_WATER_H_R",TBL_CHD_HFA."CHD_HFA_SPGR_R",TBL_CHD_HFA."CHD_HFA_BAC_CNT_R",TBL_CHD_HFA."CHD_HFA_FUNGI_CNT_R",TBL_CHD_HFA."CHD_HFA_SIL",TBL_CHD_HFA."CHD_HFA_ELAS",TBL_CHD_HFA."CHD_HFA_FIBERS",TBL_CHD_HFA."CHD_HFA_PREC",TBL_CHD_HFA."CHD_HFA_GEL",TBL_CHD_HFA."CHD_HFA_NAS_CL",TBL_CHD_HFA."CHD_HFA_OIL",TBL_CHD_HFA."CHD_HFA_YELL_MET",TBL_CHD_HFA."CHD_HFA_BLK_MET",TBL_CHD_HFA."CHD_HFA_BRT_MET",TBL_CHD_HFA."CHD_HFA_GREASE",TBL_CHD_HFA."CHD_HFA_RUST",TBL_CHD_HFA."CHD_HFA_OLIG",TBL_CHD_HFA."CHD_HFA_SILICA",TBL_CHD_HFA."CHD_HFA_OTHERS",TBL_CHD_HFA."CHD_HFA_OTHERS_R",TBL_CHD_HFA."CHD_HFA_PASS_FAIL",TBL_CHD_HFA."CHD_UPDATE_DATE",
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  ((SYS_NODES_ATTRIB INNER JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_HFA
  ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_HFA.CHD_HFA_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_JACKET
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_JACKET" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_WHRU_JACKET_ID", "CHD_WHRU_JACKET_OI", "CHD_WHRU_JACKET_PH", "CHD_WHRU_JACKET_SUL", "CHD_UPDATE_DATE", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_WHRU_JACKET."CHD_WHRU_JACKET_ID",TBL_CHD_WHRU_JACKET."CHD_WHRU_JACKET_OI",TBL_CHD_WHRU_JACKET."CHD_WHRU_JACKET_PH",TBL_CHD_WHRU_JACKET."CHD_WHRU_JACKET_SUL",TBL_CHD_WHRU_JACKET."CHD_UPDATE_DATE",
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  ((SYS_NODES_ATTRIB INNER JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_WHRU_JACKET
  ON TBL_CHD_HEADER.CHD_HDR_ID =
  TBL_CHD_WHRU_JACKET.CHD_WHRU_JACKET_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_OWA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_OWA" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_OWA_ID", "CHD_OWA_GRAVITY", "CHD_OWA_INHIBITOR", "CHD_OWA_CLOUD_PT", "CHD_OWA_POUR_PT", "CHD_OWA_PARAFFIN", "CHD_OWA_ASPHALTENE", "CHD_UPDATE_DATE", "SAMPLINGLOCATION", "STATUS", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_OWA."CHD_OWA_ID",TBL_CHD_OWA."CHD_OWA_GRAVITY",TBL_CHD_OWA."CHD_OWA_INHIBITOR",TBL_CHD_OWA."CHD_OWA_CLOUD_PT",TBL_CHD_OWA."CHD_OWA_POUR_PT",TBL_CHD_OWA."CHD_OWA_PARAFFIN",TBL_CHD_OWA."CHD_OWA_ASPHALTENE",TBL_CHD_OWA."CHD_UPDATE_DATE",
        SYS_NODES_ATTRIB.NODE_DESC AS SamplingLocation,
        SYS_LOOKUPS.LKP_DESC_B     AS Status,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  (((SYS_NODES_ATTRIB RIGHT JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_OWA
  ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_OWA.CHD_OWA_ID)
  LEFT JOIN SYS_LOOKUPS
  ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_PWA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_PWA" ("REC_TAG", "NODE_ID", "NODE_DESC", "NODE_GROUP", "NODE_CLASS", "NODE_TAG", "NODE_ASSET_TYPE", "SAP_REF", "SAP_TAG", "SAP_DESC", "REF_DWG", "SPLI", "VUL_EQUT", "VUL_CAT", "NODE_GROUP_B", "ITEM_TYPE", "OREDA_CLSS", "OREDA_SUBUNIT", "OREDA_CPNT", "LL_FOLDER_OBJID", "REC_UPDATED", "ITEM_TYPE_TAG", "ITEM_USED", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_PWA_ID", "CHD_PWA_SPGR", "CHD_PWA_TEMP", "CHD_PWA_HARDNESS", "CHD_PWA_TDS", "CHD_PWA_ACR", "CHD_PWA_TSS", "CHD_PWA_FE", "CHD_PWA_SULFATE", "CHD_PWA_PH", "CHD_PWA_O2", "CHD_PWA_H2S", "CHD_PWA_SODIUM", "CHD_PWA_CALCIUM", "CHD_PWA_MAGNESIUM", "CHD_PWA_BARIUM", "CHD_PWA_BROMIDE", "CHD_PWA_POTASSIUM", "CHD_PWA_MANGANESE", "CHD_PWA_IRONSOLID", "CHD_PWA_IRONDISS", "CHD_PWA_ZINC", "CHD_PWA_CHLORIDE", "CHD_PWA_CARBONATE", "CHD_PWA_BICARB", "CHD_PWA_SCALETEN", "CHD_PWA_RESQTY", "CHD_PWA_CONQTY", "CHD_UPDATE_DATE", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB."REC_TAG",SYS_NODES_ATTRIB."NODE_ID",SYS_NODES_ATTRIB."NODE_DESC",SYS_NODES_ATTRIB."NODE_GROUP",SYS_NODES_ATTRIB."NODE_CLASS",SYS_NODES_ATTRIB."NODE_TAG",SYS_NODES_ATTRIB."NODE_ASSET_TYPE",SYS_NODES_ATTRIB."SAP_REF",SYS_NODES_ATTRIB."SAP_TAG",SYS_NODES_ATTRIB."SAP_DESC",SYS_NODES_ATTRIB."REF_DWG",SYS_NODES_ATTRIB."SPLI",SYS_NODES_ATTRIB."VUL_EQUT",SYS_NODES_ATTRIB."VUL_CAT",SYS_NODES_ATTRIB."NODE_GROUP_B",SYS_NODES_ATTRIB."ITEM_TYPE",SYS_NODES_ATTRIB."OREDA_CLSS",SYS_NODES_ATTRIB."OREDA_SUBUNIT",SYS_NODES_ATTRIB."OREDA_CPNT",SYS_NODES_ATTRIB."LL_FOLDER_OBJID",SYS_NODES_ATTRIB."REC_UPDATED",SYS_NODES_ATTRIB."ITEM_TYPE_TAG",SYS_NODES_ATTRIB."ITEM_USED",
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_PWA."CHD_PWA_ID",TBL_CHD_PWA."CHD_PWA_SPGR",TBL_CHD_PWA."CHD_PWA_TEMP",TBL_CHD_PWA."CHD_PWA_HARDNESS",TBL_CHD_PWA."CHD_PWA_TDS",TBL_CHD_PWA."CHD_PWA_ACR",TBL_CHD_PWA."CHD_PWA_TSS",TBL_CHD_PWA."CHD_PWA_FE",TBL_CHD_PWA."CHD_PWA_SULFATE",TBL_CHD_PWA."CHD_PWA_PH",TBL_CHD_PWA."CHD_PWA_O2",TBL_CHD_PWA."CHD_PWA_H2S",TBL_CHD_PWA."CHD_PWA_SODIUM",TBL_CHD_PWA."CHD_PWA_CALCIUM",TBL_CHD_PWA."CHD_PWA_MAGNESIUM",TBL_CHD_PWA."CHD_PWA_BARIUM",TBL_CHD_PWA."CHD_PWA_BROMIDE",TBL_CHD_PWA."CHD_PWA_POTASSIUM",TBL_CHD_PWA."CHD_PWA_MANGANESE",TBL_CHD_PWA."CHD_PWA_IRONSOLID",TBL_CHD_PWA."CHD_PWA_IRONDISS",TBL_CHD_PWA."CHD_PWA_ZINC",TBL_CHD_PWA."CHD_PWA_CHLORIDE",TBL_CHD_PWA."CHD_PWA_CARBONATE",TBL_CHD_PWA."CHD_PWA_BICARB",TBL_CHD_PWA."CHD_PWA_SCALETEN",TBL_CHD_PWA."CHD_PWA_RESQTY",TBL_CHD_PWA."CHD_PWA_CONQTY",TBL_CHD_PWA."CHD_UPDATE_DATE",
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  ((SYS_NODES_ATTRIB INNER JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_PWA
  ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_PWA.CHD_PWA_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_QUAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_QUAL" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_CHEM_QUAL_ID", "CHD_CHEM_QUAL_GNAME", "CHD_CHEM_QUAL_PNAME", "CHD_CHEM_QUAL_CNAME", "CHD_CHEM_QUAL_REC_T", "CHD_UPDATE_DATE", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_CHEM_QUAL."CHD_CHEM_QUAL_ID",TBL_CHD_CHEM_QUAL."CHD_CHEM_QUAL_GNAME",TBL_CHD_CHEM_QUAL."CHD_CHEM_QUAL_PNAME",TBL_CHD_CHEM_QUAL."CHD_CHEM_QUAL_CNAME",TBL_CHD_CHEM_QUAL."CHD_CHEM_QUAL_REC_T",TBL_CHD_CHEM_QUAL."CHD_UPDATE_DATE",
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  ((SYS_NODES_ATTRIB INNER JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_CHEM_QUAL
  ON TBL_CHD_HEADER.CHD_HDR_ID =
  TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_RSD
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_RSD" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_CHEM_RSD_ID", "CHD_CHEM_RSD_GNAME", "CHD_CHEM_RSD_PNAME", "CHD_CHEM_RSD_CNAME", "CHD_CHEM_RSD_IPOINT", "CHD_CHEM_RSD_REC_T", "CHD_CHEM_RSD_ACT_RATE", "CHD_UPDATE_DATE", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_CHEM_RSD."CHD_CHEM_RSD_ID",TBL_CHD_CHEM_RSD."CHD_CHEM_RSD_GNAME",TBL_CHD_CHEM_RSD."CHD_CHEM_RSD_PNAME",TBL_CHD_CHEM_RSD."CHD_CHEM_RSD_CNAME",TBL_CHD_CHEM_RSD."CHD_CHEM_RSD_IPOINT",TBL_CHD_CHEM_RSD."CHD_CHEM_RSD_REC_T",TBL_CHD_CHEM_RSD."CHD_CHEM_RSD_ACT_RATE",TBL_CHD_CHEM_RSD."CHD_UPDATE_DATE",
 SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  ((SYS_NODES_ATTRIB INNER JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_CHEM_RSD
  ON TBL_CHD_HEADER.CHD_HDR_ID =
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_SA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_SA" ("REC_TAG", "NODE_ID", "NODE_DESC", "NODE_GROUP", "NODE_CLASS", "NODE_TAG", "NODE_ASSET_TYPE", "SAP_REF", "SAP_TAG", "SAP_DESC", "REF_DWG", "SPLI", "VUL_EQUT", "VUL_CAT", "NODE_GROUP_B", "ITEM_TYPE", "OREDA_CLSS", "OREDA_SUBUNIT", "OREDA_CPNT", "LL_FOLDER_OBJID", "REC_UPDATED", "ITEM_TYPE_TAG", "HAZ_REFERENCE", "POF_GROUP_ID", "RBI_INCLUDE", "SCE", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_COUP_SC_ID", "CHD_COUP_SC_DT_INST", "CHD_COUP_SC_DT_REM", "CHD_COUP_SC_DAYS_EXP", "CHD_COUP_SC_WTGN", "CHD_COUP_SC_WTGN_DY", "CHD_UPDATE_DATE", "SAMPLINGLOCATION", "STATUS", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.*,
        TBL_CHD_HEADER.*,
        TBL_CHD_COUP_SCALE.*,
        SYS_NODES_ATTRIB.NODE_DESC AS SamplingLocation,
        SYS_LOOKUPS.LKP_DESC_B     AS Status,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  (((SYS_NODES_ATTRIB RIGHT JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_COUP_SCALE
  ON TBL_CHD_HEADER.CHD_HDR_ID =
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_ID)
  LEFT JOIN SYS_LOOKUPS
  ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_SCALE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_SCALE" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_COUP_SC_ID", "CHD_COUP_SC_DT_INST", "CHD_COUP_SC_DT_REM", "CHD_COUP_SC_DAYS_EXP", "CHD_COUP_SC_WTGN", "CHD_COUP_SC_WTGN_DY", "CHD_UPDATE_DATE", "SAMPLINGLOCATION", "STATUS", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_COUP_SCALE."CHD_COUP_SC_ID",TBL_CHD_COUP_SCALE."CHD_COUP_SC_DT_INST",TBL_CHD_COUP_SCALE."CHD_COUP_SC_DT_REM",TBL_CHD_COUP_SCALE."CHD_COUP_SC_DAYS_EXP",TBL_CHD_COUP_SCALE."CHD_COUP_SC_WTGN",TBL_CHD_COUP_SCALE."CHD_COUP_SC_WTGN_DY",TBL_CHD_COUP_SCALE."CHD_UPDATE_DATE",
        SYS_NODES_ATTRIB.NODE_DESC AS SamplingLocation,
        SYS_LOOKUPS.LKP_DESC_B     AS Status,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  (((SYS_NODES_ATTRIB RIGHT JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_COUP_SCALE
  ON TBL_CHD_HEADER.CHD_HDR_ID =
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_ID)
  LEFT JOIN SYS_LOOKUPS
  ON TBL_CHD_HEADER.CHD_HDR_STATUS = SYS_LOOKUPS.LKP_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_TREAT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_TREAT" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_CHEM_TREAT_ID", "CHD_CHEM_TREAT_GNAME", "CHD_CHEM_TREAT_PNAME", "CHD_CHEM_TREAT_CNAME", "CHD_CHEM_TREAT_IPOINT", "CHD_CHEM_TREAT_REC_T", "CHD_CHEM_TREAT_ACT_RATE", "CHD_UPDATE_DATE", "CHD_CHEM_TREAT_REC_CON", "CHD_CHEM_TREAT_REC_CON_BASIS", "TRE_DAT_TYPE", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_CHEM_TREAT."CHD_CHEM_TREAT_ID",TBL_CHD_CHEM_TREAT."CHD_CHEM_TREAT_GNAME",TBL_CHD_CHEM_TREAT."CHD_CHEM_TREAT_PNAME",TBL_CHD_CHEM_TREAT."CHD_CHEM_TREAT_CNAME",TBL_CHD_CHEM_TREAT."CHD_CHEM_TREAT_IPOINT",TBL_CHD_CHEM_TREAT."CHD_CHEM_TREAT_REC_T",TBL_CHD_CHEM_TREAT."CHD_CHEM_TREAT_ACT_RATE",TBL_CHD_CHEM_TREAT."CHD_UPDATE_DATE",TBL_CHD_CHEM_TREAT."CHD_CHEM_TREAT_REC_CON",TBL_CHD_CHEM_TREAT."CHD_CHEM_TREAT_REC_CON_BASIS",
        SYS_TREE_STRUC.TRE_DAT_TYPE,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN (
  SYS_NODES_ATTRIB INNER JOIN
          (TBL_CHD_HEADER INNER JOIN TBL_CHD_CHEM_TREAT
          ON TBL_CHD_HEADER.CHD_HDR_ID =
   TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_ID)
         ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
        ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1
WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_WATER
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_WATER" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_WHRU_WATER_ID", "CHD_WHRU_WATER_TDS", "CHD_WHRU_WATER_TSS", "CHD_WHRU_WATER_IRON", "CHD_WHRU_WATER_SPGR", "CHD_WHRU_WATER_COND", "CHD_WHRU_WATER_HARDNESS", "CHD_WHRU_WATER_SODIUM", "CHD_WHRU_WATER_CALCIUM", "CHD_WHRU_WATER_PH", "CHD_WHRU_WATER_TEMP", "CHD_WHRU_WATER_MAGNESIUM", "CHD_WHRU_WATER_CHLORIDE", "CHD_WHRU_WATER_SULFATE", "CHD_UPDATE_DATE", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_ID",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_TDS",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_TSS",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_IRON",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_SPGR",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_COND",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_HARDNESS",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_SODIUM",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_CALCIUM",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_PH",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_TEMP",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_MAGNESIUM",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_CHLORIDE",TBL_CHD_WHRU_WATER."CHD_WHRU_WATER_SULFATE",TBL_CHD_WHRU_WATER."CHD_UPDATE_DATE",
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  ((SYS_NODES_ATTRIB INNER JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_WHRU_WATER
  ON TBL_CHD_HEADER.CHD_HDR_ID =
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_WHRU
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_WHRU" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_WHRU_WHRU_ID", "CHD_WHRU_WHRU_OI", "CHD_WHRU_WHRU_PH", "CHD_WHRU_WHRU_NIT", "CHD_UPDATE_DATE", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_WHRU_WHRU."CHD_WHRU_WHRU_ID",TBL_CHD_WHRU_WHRU."CHD_WHRU_WHRU_OI",TBL_CHD_WHRU_WHRU."CHD_WHRU_WHRU_PH",TBL_CHD_WHRU_WHRU."CHD_WHRU_WHRU_NIT",TBL_CHD_WHRU_WHRU."CHD_UPDATE_DATE",
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  ((SYS_NODES_ATTRIB INNER JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_WHRU_WHRU
  ON TBL_CHD_HEADER.CHD_HDR_ID =
  TBL_CHD_WHRU_WHRU.CHD_WHRU_WHRU_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_CHARTING_WQA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_CHARTING_WQA" ("REC_TAG", "CHD_HDR_ID", "CHD_HDR_TYPE", "CHD_HDR_ASSET_ID", "CHD_HDR_SAMP_DATE", "CHD_HDR_ANA_VEND", "CHD_HDR_STATUS", "CHD_HDR_INT", "CHD_HDR_DBL", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_COMMENTS", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE", "CHD_WQA_ID", "CHD_WQA_OP_INIT", "CHD_WQA_EST_RATE", "CHD_WQA_O2", "CHD_WQA_FIELD_IR", "CHD_WQA_LAB_IR", "CHD_WQA_WSO_IR", "CHD_WQA_MNLY_IR", "CHD_WQA_MNLY_LAB", "CHD_UPDATE_DATE", "ASSETLOCATION") AS 
  SELECT
 SYS_NODES_ATTRIB.REC_TAG,
        TBL_CHD_HEADER."CHD_HDR_ID",TBL_CHD_HEADER."CHD_HDR_TYPE",TBL_CHD_HEADER."CHD_HDR_ASSET_ID",TBL_CHD_HEADER."CHD_HDR_SAMP_DATE",TBL_CHD_HEADER."CHD_HDR_ANA_VEND",TBL_CHD_HEADER."CHD_HDR_STATUS",TBL_CHD_HEADER."CHD_HDR_INT",TBL_CHD_HEADER."CHD_HDR_DBL",TBL_CHD_HEADER."CHD_HDR_TXT1",TBL_CHD_HEADER."CHD_HDR_TXT2",TBL_CHD_HEADER."CHD_HDR_COMMENTS",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE",TBL_CHD_HEADER."CHD_HDR_LAST_UPDATE_BY",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_DATE",TBL_CHD_HEADER."CHD_HDR_CLASS_OVERRIDE_BY",TBL_CHD_HEADER."CHD_HDR_UPDATE_DATE",
        TBL_CHD_WQA."CHD_WQA_ID",TBL_CHD_WQA."CHD_WQA_OP_INIT",TBL_CHD_WQA."CHD_WQA_EST_RATE",TBL_CHD_WQA."CHD_WQA_O2",TBL_CHD_WQA."CHD_WQA_FIELD_IR",TBL_CHD_WQA."CHD_WQA_LAB_IR",TBL_CHD_WQA."CHD_WQA_WSO_IR",TBL_CHD_WQA."CHD_WQA_MNLY_IR",TBL_CHD_WQA."CHD_WQA_MNLY_LAB",TBL_CHD_WQA."CHD_UPDATE_DATE",
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN
  ((SYS_NODES_ATTRIB INNER JOIN TBL_CHD_HEADER
  ON SYS_NODES_ATTRIB.REC_TAG =
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID)
  INNER JOIN TBL_CHD_WQA
  ON TBL_CHD_HEADER.CHD_HDR_ID = TBL_CHD_WQA.CHD_WQA_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_DAYS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_DAYS" ("USER_ID", "LOGDATE", "TOTALMINUTES", "TOTAL") AS 
  SELECT
 USERS.USER_ID,
 TO_DATE(TO_CHAR(MAIN.EVT_LOG_DATE_TIME,'MONTH DD YYYY')
  ,'MONTH DD YYYY') LogDate,
 sum(case MAIN.EVT_LOG_MODULE
  when 'LOGOUT' then to_char(MAIN.EVT_LOG_DATE_TIME,'MI')
  else '1440' end +
  ((case MAIN.EVT_LOG_MODULE
   when 'LOGOUT' then to_char(MAIN.EVT_LOG_DATE_TIME,'HH24')
   else '0' end)*60)) -
  CASE
   WHEN
   sum(case MAIN.EVT_LOG_MODULE
    when 'LOGOUT' then '1'
    else '0' end) >
   sum(case MAIN.EVT_LOG_MODULE
    when 'LOGIN' then '1'
    else '0' end) THEN
    (sum(case MAIN.EVT_LOG_MODULE
     when 'LOGIN' then to_char(MAIN.EVT_LOG_DATE_TIME,'MI')
     else '1440' end +
    ( (case MAIN.EVT_LOG_MODULE
     when 'LOGIN' then to_char(MAIN.EVT_LOG_DATE_TIME,'HH24')
      else '0' end) *60 ) ) ) -
    ((sum(case MAIN.EVT_LOG_MODULE
     when 'LOGOUT' then '1'
     else '0' end) -
    sum(case MAIN.EVT_LOG_MODULE
     when 'LOGIN' then '1'
     else '0' end)) * 1440)
   ELSE
   sum(case MAIN.EVT_LOG_MODULE
    when 'LOGIN' then to_char(MAIN.EVT_LOG_DATE_TIME,'MI')
    else '1440' end +
   ((case MAIN.EVT_LOG_MODULE
    when 'LOGIN' then to_char(MAIN.EVT_LOG_DATE_TIME,'HH24')
    else '0'end) * 60 ) )
   END TotalMinutes,
 (sum(case MAIN.EVT_LOG_MODULE
  when 'LOGOUT' then to_char(MAIN.EVT_LOG_DATE_TIME,'MI')
  else '1440' end +
  ((case MAIN.EVT_LOG_MODULE
   when 'LOGOUT' then to_char(MAIN.EVT_LOG_DATE_TIME,'HH24')
   else '0' end)*60)) -
  CASE
   WHEN
   sum(case MAIN.EVT_LOG_MODULE
    when 'LOGOUT' then '1'
    else '0' end) >
   sum(case MAIN.EVT_LOG_MODULE
    when 'LOGIN' then '1'
    else '0' end) THEN
    (sum(case MAIN.EVT_LOG_MODULE
     when 'LOGIN' then to_char(MAIN.EVT_LOG_DATE_TIME,'MI')
     else '1440' end +
    ( (case MAIN.EVT_LOG_MODULE
     when 'LOGIN' then to_char(MAIN.EVT_LOG_DATE_TIME,'HH24')
     else '0' end) *60 ) ) ) -
    ((sum(case MAIN.EVT_LOG_MODULE
     when 'LOGOUT' then '1'
     else '0' end) -
    sum(case MAIN.EVT_LOG_MODULE
     when 'LOGIN' then '1'
     else '0' end)) * 1440)
   ELSE
   sum(case MAIN.EVT_LOG_MODULE
    when 'LOGIN' then to_char(MAIN.EVT_LOG_DATE_TIME,'MI')
    else '1440' end +
   ((case MAIN.EVT_LOG_MODULE
    when 'LOGIN' then to_char(MAIN.EVT_LOG_DATE_TIME,'HH24')
    else '0' end) * 60 ) )
   END)/60 Total
FROM
 TBL_USERS USERS INNER JOIN TBL_EVENT_LOG MAIN
 ON USERS.USER_NAME LIKE MAIN.EVT_LOG_USER_ID
WHERE
 ((MAIN.EVT_LOG_USER_ID) LIKE USERS.USER_NAME) And
 (MAIN.EVT_LOG_MODULE='LOGOUT' or MAIN.EVT_LOG_MODULE='LOGIN')
GROUP BY
 USERS.USER_ID,
 TO_CHAR(MAIN.EVT_LOG_DATE_TIME,'MONTH DD YYYY');
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_DD_01
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_DD_01" ("ASSETCODE", "ASSETTITLE", "DATADESIGNPARAMETERTYPE", "DATADESIGNPARAMETERNAME", "DATADESIGNPARAMETERVALUE", "UNITOFMEASURE", "DATTYPE", "ASSETID") AS 
  SELECT NODAT.NODE_ID      AS ASSETCODE,
    NODAT.NODE_DESC          AS ASSETTITLE,
    LU1.LKP_DESC_B           AS DATADESIGNPARAMETERTYPE,
    DDPARAMS.DD_PARAM_NAME   AS DATADESIGNPARAMETERNAME,
    DDMAIN.DD_PARAM_VALUE    AS DATADESIGNPARAMETERVALUE,
    LU2.LKP_DESC_B           AS UNITOFMEASURE,
    TREESTRUC.TRE_DAT_TYPE   AS DATTYPE,
    NODAT.REC_TAG            AS ASSETID
  FROM SYS_TREE_STRUC TREESTRUC
  INNER JOIN ((((TBL_DESIGN_DATA_MAIN DDMAIN
  LEFT JOIN TBL_DESIGN_DATA_PARAMS DDPARAMS
  ON DDMAIN.DD_PARAM = DDPARAMS.DD_PARAM)
  LEFT JOIN SYS_LOOKUPS LU1
  ON DDPARAMS.DD_PARAM_TYPE = LU1.LKP_ID)
  LEFT JOIN SYS_LOOKUPS LU2
  ON DDMAIN.DD_PARAM_UNIT = LU2.LKP_ID)
  RIGHT JOIN SYS_NODES_ATTRIB NODAT
  ON DDMAIN.DD_ASSET       = NODAT.REC_TAG)
  ON TREESTRUC.TRE_DAT_TAG = NODAT.REC_TAG
  INNER JOIN SYS_TREE_STRUC
  ON TREESTRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC.TRE_NOD_TAG
  INNER JOIN SYS_NODES_ATTRIB
  ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
  ORDER BY DATADESIGNPARAMETERTYPE,
    DATADESIGNPARAMETERNAME
  WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_DD_02
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_DD_02" ("ASSETCODE", "ASSETTITLE", "DATADESIGNPARAMETERTYPE", "DATADESIGNPARAMETERNAME", "DATADESIGNPARAMETERVALUE", "UNITOFMEASURE", "DATTYPE", "ASSETID") AS 
  SELECT SYS_NODES_ATTRIB.NODE_ID AS ASSETCODE,
    SYS_NODES_ATTRIB.NODE_DESC     AS ASSETTITLE,
    LU1.LKP_DESC_B                 AS DATADESIGNPARAMETERTYPE,
    DDPARAMS.DD_PARAM_NAME         AS DATADESIGNPARAMETERNAME,
    DDMAIN.DD_PARAM_VALUE          AS DATADESIGNPARAMETERVALUE,
    LU2.LKP_DESC_B                 AS UNITOFMEASURE,
    TREESTRUC.TRE_DAT_TYPE         AS DATTYPE,
    SYS_NODES_ATTRIB.REC_TAG       AS ASSETID
  FROM SYS_TREE_STRUC TREESTRUC
  INNER JOIN (SYS_NODES_ATTRIB
  LEFT JOIN (((TBL_DESIGN_DATA_MAIN DDMAIN
  LEFT JOIN TBL_DESIGN_DATA_PARAMS DDPARAMS
  ON DDMAIN.DD_PARAM = DDPARAMS.DD_PARAM)
  LEFT JOIN SYS_LOOKUPS LU1
  ON DDPARAMS.DD_PARAM_TYPE = LU1.LKP_ID)
  LEFT JOIN SYS_LOOKUPS LU2
  ON DDMAIN.DD_PARAM_UNIT     = LU2.LKP_ID)
  ON SYS_NODES_ATTRIB.REC_TAG = DDMAIN.DD_ASSET)
  ON TREESTRUC.TRE_DAT_TAG    = SYS_NODES_ATTRIB.REC_TAG
  INNER JOIN SYS_TREE_STRUC
  ON TREESTRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC.TRE_NOD_TAG
  INNER JOIN SYS_NODES_ATTRIB SYS_NODES_ATTRIB1
  ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB1.REC_TAG
  ORDER BY DATADESIGNPARAMETERTYPE,
    DATADESIGNPARAMETERNAME;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_DD_03
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_DD_03" ("HISTORYID", "ASSETID", "ASSETCODE", "ASSETTITLE", "LOGTYPE", "ASSETCODETRANSFROM", "ASSETTITLETRANSFROM", "ASSETCODETRANSTO", "ASSETTITLETRANSTO", "DATEFROM", "DATETO", "HISTORYREMARKS", "DURATIONYEAR", "DURATIONMONTH", "DURATIONDAY") AS 
  SELECT
  HistoryID,
  AssetID,
  AssetCode,
  AssetTitle,
  LogType,
  AssetCodeTransFrom,
  AssetTitleTransFrom,
  AssetCodeTransTo,
  AssetTitleTransTo,
  DateFrom,
  CASE
    WHEN DateTo IS NULL THEN TO_DATE(TO_CHAR(CURRENT_DATE),'DD/MM/YYYY')
    ELSE DateTo
  END DateTo,
  HistoryRemarks,
  CASE
    WHEN DateTo IS NULL THEN
      TRUNC((TO_DATE(TO_CHAR(CURRENT_DATE),'DD/MM/YYYY') - DateFrom) / 365)
    ELSE  TRUNC((DateTo - DateFrom) / 365)
   END  DURATIONYEAR,
   CASE
    WHEN DateTo IS NULL THEN
      TRUNC(MOD(TO_DATE(TO_CHAR(CURRENT_DATE),'DD/MM/YYYY') - DateFrom, 365) / 30.44)
    ELSE  TRUNC(MOD(DateTo - DateFrom, 365) / 30.44)
   END  DURATIONMONTH,
   CASE
    WHEN DateTo IS NULL THEN
      TRUNC(MOD(MOD((TO_DATE(TO_CHAR(CURRENT_DATE),'DD/MM/YYYY') - DateFrom), 365), 30.44))
    ELSE  TRUNC(MOD(MOD((DateTo - DateFrom), 365), 30.44))
   END  DURATIONDAY
FROM (SELECT
  HIST.DD_HIST_ID AS HistoryID,
  HIST.DD_HIST_ASSET_ID AS AssetID,
  NA.NODE_ID AS AssetCode,
  NA.NODE_DESC AS AssetTitle,
  NA2.NODE_ID AS AssetCodeTransFrom,
  NA2.NODE_DESC AS AssetTitleTransFrom,
  NA3.NODE_ID AS AssetCodeTransTo,
  NA3.NODE_DESC AS AssetTitleTransTo,
  HIST.DD_HIST_DATE AS DateFrom,
  (SELECT  DD_HIST_DATE
  FROM
    (SELECT DD_HIST_ID, DD_HIST_ASSET_ID,  DD_HIST_DATE
    FROM TBL_DESIGN_DATA_HISTORY
    ORDER BY DD_HIST_ID, DD_HIST_DATE DESC)
  WHERE
    DD_HIST_ID > HIST.DD_HIST_ID AND
    DD_HIST_ASSET_ID= HIST.DD_HIST_ASSET_ID AND
    ROWNUM < 2) AS DateTo,
  HIST.DD_HIST_DESC AS HistoryRemarks,
  SYS_LOOKUPS.LKP_DESC_B AS LogType
FROM
  (((TBL_DESIGN_DATA_HISTORY HIST
  INNER JOIN SYS_NODES_ATTRIB NA
  ON HIST.DD_HIST_ASSET_ID = NA.REC_TAG)
  INNER JOIN SYS_NODES_ATTRIB NA3
  ON HIST.DD_HIST_ASSET_TO = NA3.REC_TAG)
  INNER JOIN SYS_NODES_ATTRIB NA2
  ON HIST.DD_HIST_ASSET_FR = NA2.REC_TAG)
  INNER JOIN SYS_LOOKUPS
  ON HIST.DD_HIST_LOG_TYPE = SYS_LOOKUPS.LKP_ID
ORDER BY
  NA.NODE_ID,
  NA.NODE_DESC,
  HIST.DD_HIST_ID DESC
) WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_DS_01
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_DS_01" ("HOST", "TIEBACKS", "D1", "D2", "D3", "D4", "D5", "D6", "D7", "D8", "D9", "D10", "D11", "D12", "D13", "D14", "D15", "D16", "D17", "D18", "D19", "D20", "D21", "D22", "D23", "D24", "D25", "D26", "D27", "D28", "D29", "D30", "D31") AS 
  SELECT SYS_NODES_ATTRIB_HOST.NODE_DESC HOST,
      SYS_NODES_ATTRIB_TIEBACK.NODE_DESC TIEBACKS,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('01-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('010716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '01-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('01-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('010716', 'DDMMYY'), 'YYYYMMDD')) D1,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('02-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('020716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '02-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('02-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('020716', 'DDMMYY'), 'YYYYMMDD')) D2,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('03-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('030716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '03-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('03-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('030716', 'DDMMYY'), 'YYYYMMDD')) D3,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('04-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('040716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '04-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('04-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('040716', 'DDMMYY'), 'YYYYMMDD')) D4,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('05-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('050716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '05-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('05-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('050716', 'DDMMYY'), 'YYYYMMDD')) D5,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('06-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('060716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '06-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('06-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('060716', 'DDMMYY'), 'YYYYMMDD')) D6,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('07-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('070716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '07-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('07-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('070716', 'DDMMYY'), 'YYYYMMDD')) D7,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('08-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('080716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '08-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('08-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('080716', 'DDMMYY'), 'YYYYMMDD')) D8,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('09-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('090716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '09-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('09-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('090716', 'DDMMYY'), 'YYYYMMDD')) D9,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('10-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('100716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '10-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('10-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('100716', 'DDMMYY'), 'YYYYMMDD')) D10,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('11-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('110716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '11-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('11-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('110716', 'DDMMYY'), 'YYYYMMDD')) D11,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('12-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('120716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '12-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('12-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('120716', 'DDMMYY'), 'YYYYMMDD')) D12,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('13-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('130716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '13-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('13-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('130716', 'DDMMYY'), 'YYYYMMDD')) D13,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('14-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('140716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '14-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('14-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('140716', 'DDMMYY'), 'YYYYMMDD')) D14,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('15-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('150716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '15-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('15-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('150716', 'DDMMYY'), 'YYYYMMDD')) D15,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('16-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('160716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '16-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('16-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('160716', 'DDMMYY'), 'YYYYMMDD')) D16,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('17-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('170716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '17-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('17-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('170716', 'DDMMYY'), 'YYYYMMDD')) D17,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('18-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('180716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '18-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('18-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('180716', 'DDMMYY'), 'YYYYMMDD')) D18,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('19-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('190716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '19-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('19-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('190716', 'DDMMYY'), 'YYYYMMDD')) D19,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('20-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('200716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '20-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('20-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('200716', 'DDMMYY'), 'YYYYMMDD')) D20,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('21-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('210716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '21-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('21-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('210716', 'DDMMYY'), 'YYYYMMDD')) D21,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('22-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('220716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '22-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('22-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('220716', 'DDMMYY'), 'YYYYMMDD')) D22,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('23-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('230716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '23-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('23-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('230716', 'DDMMYY'), 'YYYYMMDD')) D23,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('24-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('240716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '24-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('24-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('240716', 'DDMMYY'), 'YYYYMMDD')) D24,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('25-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('250716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '25-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('25-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('250716', 'DDMMYY'), 'YYYYMMDD')) D25,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('26-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('260716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '26-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('26-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('260716', 'DDMMYY'), 'YYYYMMDD')) D26,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('27-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('270716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '27-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('27-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('270716', 'DDMMYY'), 'YYYYMMDD')) D27,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('28-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('280716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '28-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('28-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('280716', 'DDMMYY'), 'YYYYMMDD')) D28,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('29-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('290716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '29-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('29-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('290716', 'DDMMYY'), 'YYYYMMDD')) D29,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('30-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('300716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '30-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('30-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('300716', 'DDMMYY'), 'YYYYMMDD')) D30,
      NVL(
      (SELECT NVL(TBL_SURV_DTL.SURV_DTL_COMPLETED, 0)
        || '-'
        || TO_CHAR(TO_DATE('31-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('310716', 'DDMMYY'), 'YYYYMMDD') COMPLETED
      FROM TBL_SURV_DTL
      LEFT JOIN TBL_SURV_HDR
      ON TBL_SURV_DTL.SURV_DTL_HDR_ID         = TBL_SURV_HDR.SURV_HDR_ID
      WHERE (TBL_SURV_DTL.SURV_DTL_TIEBACK_ID = MAINQRY.TB_TIEBACK_ID
      AND TBL_SURV_HDR.SURV_HDR_DATE          = '31-JUL-16')
      OR (TBL_SURV_HDR.SURV_HDR_DATE         IS NULL)
      ), 0
      || '-'
      || TO_CHAR(TO_DATE('31-JUL-16', 'DD-MON-YY'), 'D') || '-' || TO_CHAR(TO_DATE('310716', 'DDMMYY'), 'YYYYMMDD')) D31
    FROM TBL_SURV_TIEBACKS MAINQRY
    INNER JOIN SYS_NODES_ATTRIB SYS_NODES_ATTRIB_HOST
    ON MAINQRY.TB_HOST_ID = SYS_NODES_ATTRIB_HOST.REC_TAG
    INNER JOIN SYS_NODES_ATTRIB SYS_NODES_ATTRIB_TIEBACK
    ON MAINQRY.TB_TIEBACK_ID = SYS_NODES_ATTRIB_TIEBACK.REC_TAG
    ORDER BY HOST;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_GREEN_COUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_GREEN_COUNT" ("GREEN") AS 
  SELECT
 Count(AN_CURR_CLASS) AS Green
FROM
 TBL_ANOM_MAIN
WHERE
 AN_CURR_CLASS=8470;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_GREEN_DATE_COUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_GREEN_DATE_COUNT" ("DATERAISED", "GREEN") AS 
  SELECT
 distinct DateRaised,
 COUNT(Green) Green
FROM (SELECT
 AN_RAISED_DATE AS DateRaised,
 SYS_LOOKUPS.LKP_DESC_B AS Green
FROM
 TBL_ANOM_MAIN INNER JOIN SYS_LOOKUPS
 ON TBL_ANOM_MAIN.AN_CURR_CLASS = SYS_LOOKUPS.LKP_ID
WHERE
 TBL_ANOM_MAIN.AN_CURR_CLASS=8470
ORDER BY
 SYS_LOOKUPS.LKP_ID
)GROUP BY
 DateRaised;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_01
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_01" ("ASSET_GROUP", "ASSET_CODE", "SCE", "CE", "SGS", "HEALTH", "SAFETY", "ENVIRONMENT", "ASSETS", "REP", "OVERALL", "NOTES", "HAZARD_REFERENCE", "ASSETID", "DATTYPE") AS 
  SELECT GROUPCODE || '-' || GROUPTITLE AS ASSET_GROUP,
  ASSETCODE || '-' || ASSETTITLE AS ASSET_CODE,
  SCE,
  CE,
  SGS,
  HEALTH,
  SAFETY,
  ENV ENVIRONMENT,
  ASSETS,
  REP,
  OVERALL,
  NOTES,
  HAZREF HAZARD_REFERENCE,
  ASSETID,
  DATTYPE
FROM
  (SELECT NA1.NODE_ID        AS GROUPCODE,
    NA1.NODE_DESC            AS GROUPTITLE,
    NA.NODE_ID               AS ASSETCODE,
    NA.NODE_DESC             AS ASSETTITLE,
    ABS(NA.SCE)              AS SCE,
    ABS(NA.CE)               AS CE,
    ABS(NA.SGS)              AS SGS,
    SYS_LOOKUPS.LKP_DESC_A   AS HEALTH,
    SYS_LOOKUPS_1.LKP_DESC_A AS SAFETY,
    SYS_LOOKUPS_2.LKP_DESC_A AS ENV,
    SYS_LOOKUPS_3.LKP_DESC_A AS ASSETS,
    SYS_LOOKUPS_4.LKP_DESC_A AS REP,
    COF.RBI_COF_OVERALL      AS OVERALL,
    COF.RBI_COF_COF_NOTES    AS NOTES,
    COF.RBI_COF_NODE_HAZ_REF AS HAZREF,
    NA.REC_TAG               AS ASSETID,
    TS.TRE_DAT_TYPE          AS DATTYPE
  FROM ((((((TBL_RBI_COF COF
  INNER JOIN SYS_NODES_ATTRIB NA
  ON COF.RBI_COF_NODE_ID = NA.REC_TAG)
  INNER JOIN SYS_TREE_STRUC TS
  ON NA.REC_TAG = TS.TRE_DAT_TAG)
  INNER JOIN SYS_LOOKUPS
  ON COF.RBI_COF_HEALTH = SYS_LOOKUPS.LKP_ID)
  INNER JOIN SYS_LOOKUPS SYS_LOOKUPS_1
  ON COF.RBI_COF_SAFETY = SYS_LOOKUPS_1.LKP_ID)
  INNER JOIN SYS_LOOKUPS SYS_LOOKUPS_2
  ON COF.RBI_COF_ENV = SYS_LOOKUPS_2.LKP_ID)
  INNER JOIN SYS_LOOKUPS SYS_LOOKUPS_3
  ON COF.RBI_COF_ASSETS = SYS_LOOKUPS_3.LKP_ID)
  INNER JOIN SYS_LOOKUPS SYS_LOOKUPS_4
  ON COF.RBI_COF_REP = SYS_LOOKUPS_4.LKP_ID
  INNER JOIN SYS_NODES_ATTRIB NA1
  ON NA.NODE_ASSET_TYPE = NA1.REC_TAG
  ) WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_02
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_02" ("ASSET_GROUP", "ASSET", "FAILURE_THREAT", "CONFIDENCE_LEVEL", "ASSESSOR_NOTES", "ASSETID", "DATTYPE") AS 
  SELECT NA1.NODE_ID
  || '-'
  || NA1.NODE_DESC AS ASSET_GROUP,
  NA.NODE_ID
  || '-'
  || NA.NODE_DESC AS ASSET,
  TBL_ANOM_FT.FT_CODE
  || '-'
  || TBL_ANOM_FT.FT_NAME   AS FAILURE_THREAT,
  SYS_LOOKUPS.LKP_DESC_B   AS CONFIDENCE_LEVEL,
  POF.RBI_POF_CONF_COMMENT AS ASSESSOR_NOTES,
  NA.REC_TAG               AS ASSETID,
  TS.TRE_DAT_TYPE          AS DATTYPE
FROM (((TBL_RBI_POF POF
INNER JOIN SYS_NODES_ATTRIB NA
ON POF.RBI_POF_NODE_ID = NA.REC_TAG)
INNER JOIN TBL_ANOM_FT
ON POF.RBI_POF_FT_ID = TBL_ANOM_FT.FT_ID)
LEFT JOIN SYS_NODES_ATTRIB NA1
ON NA.NODE_ASSET_TYPE = NA1.REC_TAG
INNER JOIN SYS_TREE_STRUC TS
ON NA.REC_TAG = TS.TRE_DAT_TAG)
INNER JOIN SYS_LOOKUPS
ON POF.RBI_POF_CONF_STATUS = SYS_LOOKUPS.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_03
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_03" ("GROUPCODE", "GROUPTITLE", "ASSETCODE", "ASSETTITLE", "FAILURETHREATCODE", "FAILURETHREATNAME", "HEALTH", "SAFETY", "ENVIRONMENT", "ASSETS", "REPUTATIONS", "OVERALL", "INITIALPOF", "CURRENTPOF", "IPOF", "CPOF", "ASSETLOCATION", "ASSETID", "DATTYPE") AS 
  SELECT NA1.NODE_ID    AS GroupCode,
  NA1.NODE_DESC       AS GroupTitle,
  NA.NODE_ID          AS AssetCode,
  NA.NODE_DESC        AS AssetTitle,
  ANFT.FT_CODE        AS FailureThreatCode,
  ANFT.FT_NAME        AS FailureThreatName,
  LKP2.LKP_DESC_A     AS Health,
  LKP3.LKP_DESC_A     AS Safety,
  LKP4.LKP_DESC_A     AS Environment,
  LKP5.LKP_DESC_A     AS Assets,
  LKP6.LKP_DESC_A     AS Reputations,
  COF.RBI_COF_OVERALL AS Overall,
  LKP.LKP_DESC_A      AS InitialPOF,
  LKP1.LKP_DESC_A     AS CurrentPOF,
  COF.RBI_COF_OVERALL
  || LKP.LKP_DESC_A AS IPOF,
  COF.RBI_COF_OVERALL
  || LKP1.LKP_DESC_A AS CPOF,
  TS.TRE_NOD_LOC     AS AssetLocation,
  NA1.REC_TAG        AS ASSETID,
  TS.TRE_DAT_TYPE    AS DATTYPE
FROM ((((SYS_LOOKUPS LKP
INNER JOIN (SYS_LOOKUPS LKP1
INNER JOIN (SYS_LOOKUPS LKP6
INNER JOIN (SYS_LOOKUPS LKP5
INNER JOIN (SYS_LOOKUPS LKP4
INNER JOIN (SYS_LOOKUPS LKP3
INNER JOIN (SYS_LOOKUPS LKP2
INNER JOIN ((TBL_RBI_COF COF
INNER JOIN TBL_RBI_POF POF
ON COF.RBI_COF_NODE_ID = POF.RBI_POF_NODE_ID)
INNER JOIN TBL_ANOM_FT ANFT
ON POF.RBI_POF_FT_ID = ANFT.FT_ID)
ON LKP2.LKP_ID       = COF.RBI_COF_HEALTH)
ON LKP3.LKP_ID       = COF.RBI_COF_SAFETY)
ON LKP4.LKP_ID       = COF.RBI_COF_ENV)
ON LKP5.LKP_ID       = COF.RBI_COF_ASSETS)
ON LKP6.LKP_ID       = COF.RBI_COF_REP)
ON LKP1.LKP_ID       = POF.RBI_POF_NPOF)
ON LKP.LKP_ID        = POF.RBI_POF_IPOF)
INNER JOIN SYS_NODES_ATTRIB NA
ON POF.RBI_POF_NODE_ID = NA.REC_TAG)
INNER JOIN SYS_TREE_STRUC TS
ON NA.REC_TAG = TS.TRE_DAT_TAG)
INNER JOIN SYS_TREE_STRUC TS1
ON TS.TRE_NOD_TAG_PAR = TS1.TRE_NOD_TAG)
INNER JOIN SYS_NODES_ATTRIB NA1
ON TS1.TRE_DAT_TAG         = NA1.REC_TAG
WHERE COF.RBI_COF_OVERALL IS NOT NULL
AND TS.TRE_DAT_TYPE        = 1;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_04
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_04" ("MITIGATION", "MITIGATION_TYPE") AS 
  SELECT MITIGATION,
  MITIGATION_TYPE 
FROM
  (SELECT TBL_RBI_MIT.RBI_MIT_CODE || '-' || TBL_RBI_MIT.RBI_MIT_DESC       AS MITIGATION,
    SYS_LOOKUPS.LKP_DESC_A   || '-' || SYS_LOOKUPS.LKP_DESC_B         AS MITIGATION_TYPE
  FROM TBL_RBI_MIT
  INNER JOIN SYS_LOOKUPS
  ON TBL_RBI_MIT.RBI_MIT_TYPE_ID = SYS_LOOKUPS.LKP_ID
  ORDER BY MITIGATION,
    MITIGATION_TYPE
  )
ORDER BY MITIGATION WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_05
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_05" ("ASSET_GROUP", "ASSET_CODE", "FAILURE_THREAT", "ASSESSMENT_DATE", "POF_INITIAL", "POF_NEW", "NOTES", "ASSETID", "DATTYPE", "ASSESSOR") AS 
  SELECT ASSET_GROUP,
  ASSET_CODE,
  FAILURE_THREAT,
  ASSESSMENT_DATE,
  POF_INITIAL,
  POF_NEW,
  NOTES,
  ASSETID,
  DATTYPE,
  ASSESSOR
FROM
  (SELECT ASSETGROUP.NODE_ID
    || '-'
    || ASSETGROUP.NODE_DESC AS ASSET_GROUP,
    ASSET.NODE_ID
    || '-'
    || ASSET.NODE_DESC AS ASSET_CODE,
    TBL_ANOM_FT.FT_CODE
    || '-'
    || TBL_ANOM_FT.FT_NAME                                        AS FAILURE_THREAT,
    IPOF.LKP_DESC_A                                               AS POF_INITIAL,
    NPOF.LKP_DESC_A                                               AS POF_NEW,
    TO_CHAR(TBL_RBI_POF.RBI_POF_ASS_DATE, 'DD-MON-YYYY HH:MM:SS') AS ASSESSMENT_DATE,
    TBL_RBI_POF.RBI_POF_POF_NOTES                                 AS NOTES,
    ASSET.REC_TAG                                                 AS ASSETID,
    SYS_TREE_STRUC.TRE_DAT_TYPE                                   AS DATTYPE,
    TBL_RBI_POF.RBI_POF_ASS_BY                                    AS ASSESSOR
  FROM (((TBL_RBI_POF
  INNER JOIN ((SYS_NODES_ATTRIB ASSET
  INNER JOIN SYS_TREE_STRUC
  ON ASSET.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG)
  LEFT JOIN SYS_NODES_ATTRIB ASSETGROUP
  ON ASSET.NODE_ASSET_TYPE       = ASSETGROUP.REC_TAG)
  ON TBL_RBI_POF.RBI_POF_NODE_ID = ASSET.REC_TAG)
  INNER JOIN TBL_ANOM_FT
  ON TBL_RBI_POF.RBI_POF_FT_ID = TBL_ANOM_FT.FT_ID)
  INNER JOIN SYS_LOOKUPS NPOF
  ON TBL_RBI_POF.RBI_POF_NPOF = NPOF.LKP_ID)
  INNER JOIN SYS_LOOKUPS IPOF
  ON TBL_RBI_POF.RBI_POF_IPOF = IPOF.LKP_ID
  ) WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_06
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_06" ("ASSET_GROUP", "ASSET", "MITIGATION", "RBFF", "DUE_DATE", "DUE_DATE_SYSTEM_COLOR", "ASSETID", "DATTYPE") AS 
  SELECT ASSET_GROUP,
  ASSET,
  MITIGATION,
  RBFF,
  DUE_DATE,
  CASE 
   WHEN SYSTEMFIELD = '1/1/1111'
    THEN 'SandyBrown'
    WHEN SYSTEMFIELD = '2/2/2222'
    THEN 'OliveDrab'
    WHEN SYSTEMFIELD = '3/3/3333'
    THEN 'IndianRed'
    WHEN SYSTEMFIELD = '4/4/4444'
    THEN 'OliveDrab'
    ELSE
      CASE
        WHEN TO_DATE(SYSTEMFIELD) < ADD_MONTHS(SysDate, 12)
        THEN
          CASE
            WHEN TO_DATE(SYSTEMFIELD) < SysDate
            THEN 'IndianRed'
            ELSE 'SandyBrown'
          END
        ELSE
          CASE
            WHEN RBFF = '**'
            THEN 'IndianRed'
            ELSE 'OliveDrab'
          END
      END
  END DUE_DATE_SYSTEM_COLOR,
  ASSETID,
  DATTYPE 
FROM
  (SELECT T1.ASSET_GROUP,
    T1.ASSET,
    T1.MITIGATION,
    T1.DUEDATE DUE_DATE,
    SYSTEMFIELD,
    ROW_NUMBER() Over (Partition BY ASSET_GROUP, ASSET, MITIGATION, ASSETID, DATTYPE Order By SP_TODATE(SYSTEMFIELD)) SEQ,
    T1.ASSETID,
    T1.DATTYPE,
    T1.RBFF
  FROM
    (SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE
      || '-'
      || SYS_Q_RPT_RBI_COMMON.GROUPNAME AS ASSET_GROUP,
      SYS_Q_RPT_RBI_COMMON.ASSETCODE
      || '-'
      || SYS_Q_RPT_RBI_COMMON.ASSETNAME AS ASSET,
      SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE
      || '-'
      || SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME AS MITIGATION,
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
        THEN '4/4/4444'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
            THEN '1/1/1111'
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
            THEN '2/2/2222'
            ELSE
              CASE
                WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
                OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -1
                THEN '3/3/3333'
                ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF))
              END
          END
      END SYSTEMFIELD,
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
        THEN 'N/A'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
            THEN 'CONTINUOUS'
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
            THEN 'AD-HOC'
            ELSE
              CASE
                WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
                OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -2
                OR SYS_Q_RPT_RBI_COMMON.RBFF         = '**'
                THEN 'IMMEDIATE ACTION'
                ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF), 'DD-MON-YYYY')
              END
          END
      END DUEDATE,
      SYS_Q_RPT_RBI_COMMON.ASSETID,
      SYS_Q_RPT_RBI_COMMON.DATTYPE,
      SYS_Q_RPT_RBI_COMMON.RBFF
    FROM SYS_Q_RPT_RBI_COMMON
    ) T1
  )
--WHERE ASSET    = 'MA-02CSS1.000-CGS Shaft 1 Concrete Structure and minor appurtenances'
--AND MITIGATION = 'GV-General external visual inspection'
WHERE SEQ = 1
ORDER BY ASSET_GROUP,
  ASSET,
  MITIGATION WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_07
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_07" ("ASSET_GROUP", "ASSET", "MITIGATION", "RBFF", "DUE_DATE", "DUE_DATE_SYSTEM_COLOR", "ASSETID", "DATTYPE") AS 
  SELECT ASSET_GROUP,
  ASSET,
  MITIGATION,
  RBFF,
  DUE_DATE,
 CASE
    WHEN SYSTEMFIELD = '1/1/1111'
    THEN 'SandyBrown'
    WHEN SYSTEMFIELD = '2/2/2222'
    THEN 'OliveDrab'
    WHEN SYSTEMFIELD = '3/3/3333'
    THEN 'IndianRed'
    WHEN SYSTEMFIELD = '4/4/4444'
    THEN 'OliveDrab'
    ELSE
      CASE
        WHEN TO_DATE(SYSTEMFIELD) < ADD_MONTHS(SysDate, 12)
        THEN
          CASE
            WHEN TO_DATE(SYSTEMFIELD) < SysDate
            THEN 'IndianRed'
            ELSE 'SandyBrown'
          END
        ELSE
          CASE
            WHEN RBFF = '**'
            THEN 'IndianRed'
            ELSE 'OliveDrab'
          END
      END
  END DUE_DATE_SYSTEM_COLOR,  
  ASSETID,
  DATTYPE 
--  ,SYSTEMFIELD 
--  ,SEQ
FROM
  (SELECT T1.ASSET_GROUP,
    T1.ASSET,
    T1.MITIGATION,
    T1.DUEDATE DUE_DATE,
    T1.SYSTEMFIELD,
    ROW_NUMBER() Over (Partition BY T1.ASSET_GROUP, T1.ASSET, T1.MITIGATION, T1.ASSETID, T1.DATTYPE Order By SP_TODATE(T1.SYSTEMFIELD) ASC) SEQ,
    T1.ASSETID,
    T1.DATTYPE,
    T1.RBFF
  FROM
    (SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE
      || '-'
      || SYS_Q_RPT_RBI_COMMON.GROUPNAME AS ASSET_GROUP,
      SYS_Q_RPT_RBI_COMMON.ASSETCODE
      || '-'
      || SYS_Q_RPT_RBI_COMMON.ASSETNAME AS ASSET,
      SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE
      || '-'
      || SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME AS MITIGATION,
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
        THEN '4/4/4444'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
            THEN '1/1/1111'
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
            THEN '2/2/2222'
            ELSE
              CASE
                WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
                OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -1
                THEN '3/3/3333'
                ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF))
              END
          END
      END SYSTEMFIELD,
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
        THEN 'N/A'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
            THEN 'CONTINUOUS'
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
            THEN 'AD-HOC'
            ELSE
              CASE
                WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
                OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -2
                OR SYS_Q_RPT_RBI_COMMON.RBFF         = '**'
                THEN 'IMMEDIATE ACTION'
                ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF), 'DD-MON-YYYY')
              END
          END
      END DUEDATE,
      SYS_Q_RPT_RBI_COMMON.ASSETID,
      SYS_Q_RPT_RBI_COMMON.DATTYPE,
      SYS_Q_RPT_RBI_COMMON.RBFF
    FROM SYS_Q_RPT_RBI_COMMON
    ) T1
  )
--WHERE ASSET    = 'MA-02CSS1.000-CGS Shaft 1 Concrete Structure and minor appurtenances'
--AND MITIGATION = 'GV-General external visual inspection'
where SEQ        = 1 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_08
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_08" ("ASSET", "CB_NAME", "CB_STATUS", "CB_STATUS_SYSTEM_COLOR", "ASSESSMENT_DATE", "ASSESSOR_NOTES", "ASSETID", "DATTYPE") AS 
  SELECT ASSET,
  CB_NAME,
  CB_STATUS,
  CASE
    WHEN UPPER(CB_STATUS) = 'NOT CONFIRMED'
    THEN 'IndianRed'
    WHEN UPPER(CB_STATUS) = 'CONFIRMED NOT IN PLACE'
    THEN 'SandyBrown'
    WHEN UPPER(CB_STATUS) = 'CONFIRMED IN PLACE'
    THEN 'OliveDrab'
  END CB_STATUS_SYSTEM_COLOR,
  ASSESSMENT_DATE,
  ASSESSOR_NOTES,
  ASSETID,
  DATTYPE
FROM
  (SELECT NA.NODE_ID
    || '-'
    || NA.NODE_DESC AS ASSET,
    CB.RBI_CB_NAME  AS CB_NAME,
    CASE
      WHEN CB_POF.RBI_CB_POF_CONFIRMED = 17801
      THEN 'NOT CONFIRMED'
      ELSE 'CONFIRMED '
        ||
        CASE
          WHEN CB_POF.RBI_CB_POF_PLACED = 0
          THEN 'NOT IN PLACE'
          ELSE 'IN PLACE'
        END
    END                                                               AS CB_STATUS,
    TO_CHAR(CB_POF.RBI_CB_POF_LAST_CONFIRMED, 'DD-MON-YYYY hh:mm:ss') AS ASSESSMENT_DATE,
    CB_POF.RBI_CB_POF_NOTES                                           AS ASSESSOR_NOTES,
    NA.REC_TAG                                                        AS ASSETID,
    TS1.TRE_DAT_TYPE                                                  AS DATTYPE,
    CB_POF.RBI_CB_POF_CONFIRMED_BY                                    AS ASSESSOR
  FROM (((TBL_RBI_CB_POF CB_POF
  INNER JOIN (TBL_RBI_POF POF
  INNER JOIN SYS_NODES_ATTRIB NA
  ON POF.RBI_POF_NODE_ID      = NA.REC_TAG)
  ON CB_POF.RBI_CB_POF_POF_ID = POF.RBI_POF_ID)
  INNER JOIN TBL_RBI_CB CB
  ON CB_POF.RBI_CB_POF_CB_ID = CB.RBI_CB_ID)
  INNER JOIN SYS_TREE_STRUC TS
  ON NA.REC_TAG = TS.TRE_DAT_TAG)
  INNER JOIN SYS_TREE_STRUC TS1
  ON TS.TRE_NOD_TAG_PAR = TS1.TRE_NOD_TAG
  )
ORDER BY ASSET,
  CB_NAME,
  ASSESSMENT_DATE WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_09
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_09" ("GROUPCODE", "GROUPNAME", "ASSETCODE", "ASSETNAME", "FAILURETHREATCODE", "FAILURETHREATNAME", "POFINITIAL", "POFNEW", "ASSESSMENTASSESSOR", "ASSESSMENTDATE", "NOTES", "ARULE", "BRULE", "CRULE", "DRULE", "ERULE", "ASSETID", "DATTYPE") AS 
  SELECT GROUPCODE,
  GROUPNAME,
  ASSETCODE,
  ASSETNAME,
  FAILURETHREATCODE,
  FAILURETHREATNAME,
  POFINITIAL,
  POFNEW,
  ASSESSMENTASSESSOR,
  ASSESSMENTDATE,
  NOTES,
  ARULE,
  BRULE,
  CRULE,
  DRULE,
  ERULE,
  ASSETID,
  DATTYPE
FROM
  (SELECT ASSETGROUP.NODE_ID      AS GROUPCODE,
    ASSETGROUP.NODE_DESC          AS GROUPNAME,
    ASSET.NODE_ID                 AS ASSETCODE,
    ASSET.NODE_DESC               AS ASSETNAME,
    TBL_ANOM_FT.FT_CODE           AS FAILURETHREATCODE,
    TBL_ANOM_FT.FT_NAME           AS FAILURETHREATNAME,
    IPOF.LKP_DESC_A               AS POFINITIAL,
    NPOF.LKP_DESC_A               AS POFNEW,
    TBL_USERS.USER_NAME           AS ASSESSMENTASSESSOR,
    TBL_RBI_POF.RBI_POF_CONF_DATE AS ASSESSMENTDATE,
    TBL_RBI_POF.RBI_POF_POF_NOTES AS NOTES,
    TBL_RBI_POF.RBI_POF_NPOF_A    AS ARULE,
    TBL_RBI_POF.RBI_POF_NPOF_B    AS BRULE,
    TBL_RBI_POF.RBI_POF_NPOF_C    AS CRULE,
    TBL_RBI_POF.RBI_POF_NPOF_D    AS DRULE,
    TBL_RBI_POF.RBI_POF_NPOF_E    AS ERULE,
    ASSET.REC_TAG                 AS ASSETID,
    SYS_TREE_STRUC.TRE_DAT_TYPE   AS DATTYPE
  FROM ((((TBL_RBI_POF
  INNER JOIN (((SYS_NODES_ATTRIB ASSET
  INNER JOIN SYS_TREE_STRUC
  ON ASSET.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG)
  INNER JOIN SYS_TREE_STRUC SYS_TREE_STRUC_1
  ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC_1.TRE_NOD_TAG)
  INNER JOIN SYS_NODES_ATTRIB ASSETGROUP
  ON SYS_TREE_STRUC_1.TRE_DAT_TAG = ASSETGROUP.REC_TAG)
  ON TBL_RBI_POF.RBI_POF_NODE_ID  = ASSET.REC_TAG)
  INNER JOIN TBL_ANOM_FT
  ON TBL_RBI_POF.RBI_POF_FT_ID = TBL_ANOM_FT.FT_ID)
  LEFT JOIN TBL_USERS
  ON TBL_RBI_POF.RBI_POF_CONF_BY = TBL_USERS.USER_ID)
  INNER JOIN SYS_LOOKUPS NPOF
  ON TBL_RBI_POF.RBI_POF_NPOF = NPOF.LKP_ID)
  INNER JOIN SYS_LOOKUPS IPOF
  ON TBL_RBI_POF.RBI_POF_IPOF       = IPOF.LKP_ID
  WHERE SYS_TREE_STRUC.TRE_DAT_TYPE = 1 
  ORDER BY SYS_TREE_STRUC.TRE_NOD_LOC,
    GROUPCODE,
    GROUPNAME,
    ASSETCODE,
    ASSETNAME,
    FAILURETHREATCODE,
    FAILURETHREATNAME,
    POFINITIAL,
    POFNEW,
    ASSESSMENTASSESSOR,
    ASSESSMENTDATE,
    NOTES,
    ARULE,
    BRULE,
    CRULE,
    DRULE,
    ERULE
  )
ORDER BY GROUPCODE,
  GROUPNAME,
  ASSETCODE,
  ASSETNAME,
  FAILURETHREATCODE,
  FAILURETHREATNAME;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_10
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_10" ("ASSET_GROUP", "ASSET", "FAILURE_THREAT", "ASSESSMENT_DATE", "NOTES", "MITIGATION", "MITIGATION_TYPE", "FREQUENCY", "TIME_INTERVAL_MONTHS", "ASSETID", "DATTYPE") AS 
  SELECT ASSET_GROUP,
  ASSET,
  FAILURE_THREAT,
  ASSESSMENT_DATE,
  NOTES,
  MITIGATION,
  MITIGATION_TYPE,
  FREQUENCY,
  TIME_INTERVAL_MONTHS,
  ASSETID,
  DATTYPE
FROM
  (SELECT ASSETGROUP.NODE_ID
    || '-'
    || ASSETGROUP.NODE_DESC AS ASSET_GROUP,
    ASSET.NODE_ID
    || '-'
    || ASSET.NODE_DESC AS ASSET,
    TBL_ANOM_FT.FT_CODE
    || '-'
    || TBL_ANOM_FT.FT_NAME                                         AS FAILURE_THREAT,
    TO_CHAR(TBL_RBI_POF.RBI_POF_CONF_DATE, 'DD-MON-YYYY HH:MM:SS') AS ASSESSMENT_DATE,
    TBL_RBI_POF.RBI_POF_POF_NOTES                                  AS NOTES,
    TBL_RBI_MIT.RBI_MIT_CODE
    || '-'
    || TBL_RBI_MIT.RBI_MIT_DESC AS MITIGATION,
    MIT_TYPE.LKP_DESC_A
    || '-'
    || MIT_TYPE.LKP_DESC_B AS MITIGATION_TYPE,
    FREQ.LKP_DESC_A
    || '-'
    || FREQ.LKP_DESC_B          AS FREQUENCY,
    ASSET.REC_TAG               AS ASSETID,
    SYS_TREE_STRUC.TRE_DAT_TYPE AS DATTYPE,
    (
    CASE
      WHEN TBL_RBI_MIT_POF.RBI_MIT_POF_FRT_ID = 14031
      THEN TBL_RBI_MIT_POF.RBI_MIT_POF_TBI
      WHEN TBL_RBI_MIT_POF.RBI_MIT_POF_FRT_ID != 14031
      THEN NULL
    END) AS TIME_INTERVAL_MONTHS
  FROM (((((TBL_RBI_POF
  INNER JOIN ((SYS_NODES_ATTRIB ASSET
  INNER JOIN SYS_TREE_STRUC
  ON ASSET.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG)
  LEFT JOIN SYS_NODES_ATTRIB ASSETGROUP
  ON ASSET.NODE_ASSET_TYPE       = ASSETGROUP.REC_TAG)
  ON TBL_RBI_POF.RBI_POF_NODE_ID = ASSET.REC_TAG)
  INNER JOIN TBL_ANOM_FT
  ON TBL_RBI_POF.RBI_POF_FT_ID = TBL_ANOM_FT.FT_ID)
  LEFT JOIN TBL_RBI_MIT_POF
  ON TBL_RBI_POF.RBI_POF_ID = TBL_RBI_MIT_POF.RBI_MIT_POF_POF_ID)
  LEFT JOIN TBL_RBI_MIT
  ON TBL_RBI_MIT_POF.RBI_MIT_POF_MIT_ID = TBL_RBI_MIT.RBI_MIT_ID)
  LEFT JOIN SYS_LOOKUPS MIT_TYPE
  ON TBL_RBI_MIT.RBI_MIT_TYPE_ID = MIT_TYPE.LKP_ID)
  LEFT JOIN SYS_LOOKUPS FREQ
  ON TBL_RBI_MIT_POF.RBI_MIT_POF_FRT_ID = FREQ.LKP_ID
  )
ORDER BY FAILURE_THREAT,
  MITIGATION WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_11
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_11" ("ASSET_GROUP", "ASSET", "MITIGATION", "FAILURE_TREAT", "FREQNAME", "DUE_DATE", "DUE_DATE_SYSTEM_COLOR", "ASSETID", "IN_RBI_WORKSCOPE", "FONT_SYSTEM_COLOR", "FONT_STYLE_COLOR", "FONT_WEIGHT_COLOR", "DATTYPE", "FREQUENCY_TYPE", "MITIGATION_TYPE") AS 
  SELECT ASSET_GROUP,
  ASSET,
  MITIGATION,
  FAILURE_TREAT,
  FREQNAME,
  DUE_DATE,
  DUE_DATE_SYSTEM_COLOR,
  ASSETID,
  CASE
    WHEN INRBIWORKSCOPE = 'NO'
    THEN 'X'
    ELSE '//'
  END IN_RBI_WORKSCOPE,
  CASE
    WHEN INRBIWORKSCOPE = 'NO'
    THEN 'Black'
    ELSE 'Blue'
  END FONT_SYSTEM_COLOR,
  CASE
    WHEN INRBIWORKSCOPE = 'NO'
    THEN 'Italic'
    ELSE 'Normal'
  END FONT_STYLE_COLOR,
  CASE
    WHEN INRBIWORKSCOPE = 'NO'
    THEN 'Normal'
    ELSE 'Bold'
  END FONT_WEIGHT_COLOR,
  DATTYPE, 
  FREQUENCYTYPEID FREQUENCY_TYPE, 
  MITIGATIONTYPEID MITIGATION_TYPE
FROM
  (SELECT '('
    || T1.GROUPCODE
    || ')'
    || T1.GROUPNAME AS ASSET_GROUP,
    '('
    || T1.ASSETCODE
    || ')'
    || T1.ASSETNAME AS ASSET,
    '('
    || T1.MITIGATIONCODE
    || ')'
    || T1.MITIGATIONNAME AS MITIGATION,
    '('
    || T1.FAILURETHREATCODE
    || ')'
    || T1.FAILURETHREATNAME AS FAILURE_TREAT,
    T1.FREQNAME,
    CASE
      WHEN T1.SYSTEMFIELD = '1/1/1111'
      OR T1.SYSTEMFIELD   = '2/2/2222'
      OR T1.SYSTEMFIELD   = '3/3/3333'
      OR T1.SYSTEMFIELD   = '4/4/4444'
      THEN T1.DUEDATE
      ELSE '('
        || T1.FREQNAME
        || ')'
        || T1.SYSTEMFIELD
    END DUE_DATE,
    CASE
      WHEN T1.DUEDATECOLOR = 'RED'
      THEN 'IndianRed'
      WHEN T1.DUEDATECOLOR = 'ORANGE'
      THEN 'SandyBrown'
      ELSE 'OliveDrab'
    END DUE_DATE_SYSTEM_COLOR,
    CASE
      WHEN T1.SCE = 1
      THEN 'YES (SCE)'
      WHEN T1.DUEDATECOLOR = 'RED'
      THEN 'YES'
      WHEN T1.DUEDATECOLOR = 'ORANGE'
      AND T1.DUEDATE      != 'CONTINUOUS'
      THEN 'YES'
      ELSE 'NO'
    END INRBIWORKSCOPE,
    T1.ASSETID,
    T1.DATTYPE, 
    T1.FREQUENCYTYPEID,
    T1.MITIGATIONTYPEID 
  FROM
    (SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
      SYS_Q_RPT_RBI_COMMON.GROUPNAME,
      SYS_Q_RPT_RBI_COMMON.ASSETCODE,
      SYS_Q_RPT_RBI_COMMON.ASSETNAME,
      SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
      SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
      SYS_Q_RPT_RBI_COMMON.FREQNAME,
      SYS_Q_RPT_RBI_COMMON.FAILURETHREATNAME,
      SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE,
      SYS_Q_RPT_RBI_COMMON.RBFF,
      SYS_Q_RPT_RBI_COMMON.LASTRECORD,
      SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF,
      SYS_Q_RPT_RBI_COMMON.SCE,
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
        THEN 'N/A'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
            THEN 'CONTINUOUS'
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
            THEN 'AD-HOC'
            ELSE
              CASE
                WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
                OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -2
                THEN 'IMMEDIATE ACTION'
                ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF))
              END
          END
      END DUEDATE,
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
        THEN '4/4/4444'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
            THEN '1/1/1111'
            WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
            THEN '2/2/2222'
            ELSE
              CASE
                WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
                OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -1
                THEN '3/3/3333'
                ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF))
              END
          END
      END SYSTEMFIELD,
      SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
      SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
      SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
      SYS_Q_RPT_RBI_COMMON.ASSETID,
      SYS_Q_RPT_RBI_COMMON.DATTYPE,
      CASE
        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF) = -1
        THEN 'GREEN'
        ELSE
          CASE
            WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID) = 14033
            THEN 'ORANGE'
            WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID) = 14032
            THEN 'RED'
            ELSE
              CASE
                WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
                THEN 'RED'
                WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -2
                THEN 'RED'
                ELSE
                  CASE
                    WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF)) < ADD_MONTHS(TO_DATE(SYSDATE), 12)
                    THEN
                      CASE
                        WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF)) < TO_DATE(SYSDATE)
                        THEN 'RED'
                        ELSE 'ORANGE'
                      END
                    ELSE 'GREEN'
                  END
              END
          END
      END DUEDATECOLOR
    FROM SYS_Q_RPT_RBI_COMMON
    ) T1
  ) INNER JOIN
  (SELECT SYS_TREE_STRUC.TRE_DAT_TAG
  FROM SYS_TREE_STRUC
  INNER JOIN SYS_NODES_ATTRIB
  ON SYS_TREE_STRUC.TRE_DAT_TAG                 = SYS_NODES_ATTRIB.REC_TAG
  WHERE SYS_TREE_STRUC.TRE_DAT_TYPE             = 1
    START WITH SYS_TREE_STRUC.TRE_DAT_TAG       = 8956
    CONNECT BY Prior SYS_TREE_STRUC.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG_PAR
  ) T2 ON T2.TRE_DAT_TAG                        = ASSETID
WHERE DATTYPE                                   = 1 
AND (FREQUENCYTYPEID                            = 14030
OR FREQUENCYTYPEID                              = 14031
OR FREQUENCYTYPEID                              = 14032
OR FREQUENCYTYPEID                              = 14033)
ORDER BY ASSET_GROUP,
  ASSET,
  MITIGATION,
  FAILURE_TREAT WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_11_A
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_11_A" ("ASSETCODE", "ASSETNAME", "MITIGATIONCODE", "MITIGATIONNAME", "FREQCODE", "FREQNAME", "RBFF", "LASTRECORD", "INTERVALYRS", "SCE", "DUEDATE", "SYSTEMFIELD", "DUEDATECOLOR", "INRBIWORKSCOPE", "GROUPCODE", "GROUPNAME", "ASSETID", "DATTYPE") AS 
  SELECT T1.ASSETCODE,
  T1.ASSETNAME,
  T1.MITIGATIONCODE,
  T1.MITIGATIONNAME,
  T1.FREQCODE,
  T1.FREQNAME,
  T1.RBFF,
  T1.LASTRECORD,
  T1.INTERVALYRS,
  T1.SCE,
  T1.DUEDATE,
  T1.SYSTEMFIELD,
  T1.DUEDATECOLOR,
  CASE
    WHEN T1.SCE = 1
    THEN 'YES (SCE)'
    WHEN T1.DUEDATECOLOR = 'RED'
    THEN 'YES'
    WHEN T1.DUEDATECOLOR = 'ORANGE'
    AND T1.DUEDATE      != 'Continuous'
    THEN 'YES'
    ELSE 'NO'
  END INRBIWORKSCOPE,
  T1.GROUPCODE,
  T1.GROUPNAME,
  T1.ASSETID,
  T1.DATTYPE
FROM
  (SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
    SYS_Q_RPT_RBI_COMMON.GROUPNAME,
    SYS_Q_RPT_RBI_COMMON.ASSETCODE,
    SYS_Q_RPT_RBI_COMMON.ASSETNAME,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
    SYS_Q_RPT_RBI_COMMON.FREQCODE,
    SYS_Q_RPT_RBI_COMMON.FREQNAME,
    SYS_Q_RPT_RBI_COMMON.RBFF,
    SYS_Q_RPT_RBI_COMMON.LASTRECORD,
    SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
    SYS_Q_RPT_RBI_COMMON.SCE,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
      THEN 'N/A'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
          THEN 'Continuous'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
          THEN 'Ad Hoc'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
              THEN 'Immediate Action'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
            END
        END
    END DUEDATE,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
      THEN '4/4/4444'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
          THEN '1/1/1111'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
          THEN '2/2/2222'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
              THEN '3/3/3333'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
            END
        END
    END SYSTEMFIELD,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
    SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
    SYS_Q_RPT_RBI_COMMON.ASSETID,
    SYS_Q_RPT_RBI_COMMON.DATTYPE,
    CASE
      WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'N/A'
      THEN 'GREEN'
      ELSE
        CASE
          WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'C'
          THEN 'ORANGE'
          WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'A'
          THEN 'RED'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              THEN 'RED'
              WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'IMMEDIATE ACTION'
              THEN 'RED'
              ELSE
                CASE
                  WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < ADD_MONTHS(SysDate, 12)
                  THEN
                    CASE
                      WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < SysDate
                      THEN 'RED'
                      ELSE 'ORANGE'
                    END
                  ELSE 'GREEN'
                END
            END
        END
    END DUEDATECOLOR
  FROM SYS_Q_RPT_RBI_COMMON
  GROUP BY SYS_Q_RPT_RBI_COMMON.GROUPCODE,
    SYS_Q_RPT_RBI_COMMON.GROUPNAME,
    SYS_Q_RPT_RBI_COMMON.ASSETCODE,
    SYS_Q_RPT_RBI_COMMON.ASSETNAME,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
    SYS_Q_RPT_RBI_COMMON.FREQCODE,
    SYS_Q_RPT_RBI_COMMON.FREQNAME,
    SYS_Q_RPT_RBI_COMMON.RBFF,
    SYS_Q_RPT_RBI_COMMON.LASTRECORD,
    SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
    SYS_Q_RPT_RBI_COMMON.SCE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
    SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
    SYS_Q_RPT_RBI_COMMON.ASSETID,
    SYS_Q_RPT_RBI_COMMON.DATTYPE
  ) T1 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_11_B
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_11_B" ("ASSETCODE", "ASSETNAME", "MITIGATIONCODE", "MITIGATIONNAME", "FREQCODE", "FREQNAME", "RBFF", "LASTRECORD", "INTERVALYRS", "SCE", "DUEDATE", "SYSTEMFIELD", "DUEDATECOLOR", "INRBIWORKSCOPE", "GROUPCODE", "GROUPNAME", "ASSETID", "DATTYPE") AS 
  SELECT T1.ASSETCODE,
  T1.ASSETNAME,
  T1.MITIGATIONCODE,
  T1.MITIGATIONNAME,
  T1.FREQCODE,
  T1.FREQNAME,
  T1.RBFF,
  T1.LASTRECORD,
  T1.INTERVALYRS,
  T1.SCE,
  T1.DUEDATE,
  T1.SYSTEMFIELD,
  T1.DUEDATECOLOR,
  CASE
    WHEN T1.SCE = 1
    THEN 'YES (SCE)'
    WHEN T1.DUEDATECOLOR = 'RED'
    THEN 'YES'
    WHEN T1.DUEDATECOLOR = 'ORANGE'
    AND T1.DUEDATE      != 'Continuous'
    THEN 'YES'
    ELSE 'NO'
  END INRBIWORKSCOPE,
  T1.GROUPCODE,
  T1.GROUPNAME,
  T1.ASSETID,
  T1.DATTYPE
FROM
  (SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
    SYS_Q_RPT_RBI_COMMON.GROUPNAME,
    SYS_Q_RPT_RBI_COMMON.ASSETCODE,
    SYS_Q_RPT_RBI_COMMON.ASSETNAME,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
    SYS_Q_RPT_RBI_COMMON.FREQCODE,
    SYS_Q_RPT_RBI_COMMON.FREQNAME,
    SYS_Q_RPT_RBI_COMMON.RBFF,
    SYS_Q_RPT_RBI_COMMON.LASTRECORD,
    SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
    SYS_Q_RPT_RBI_COMMON.SCE,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
      THEN 'N/A'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
          THEN 'Continuous'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
          THEN 'Ad Hoc'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
              THEN 'Immediate Action'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
            END
        END
    END DUEDATE,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
      THEN '4/4/4444'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
          THEN '1/1/1111'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
          THEN '2/2/2222'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
              THEN '3/3/3333'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
            END
        END
    END SYSTEMFIELD,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
    SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
    SYS_Q_RPT_RBI_COMMON.ASSETID,
    SYS_Q_RPT_RBI_COMMON.DATTYPE,
    CASE
      WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'N/A'
      THEN 'GREEN'
      ELSE
        CASE
          WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'C'
          THEN 'ORANGE'
          WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'A'
          THEN 'RED'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              THEN 'RED'
              WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'IMMEDIATE ACTION'
              THEN 'RED'
              ELSE
                CASE
                  WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < ADD_MONTHS(SysDate, 12)
                  THEN
                    CASE
                      WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < SysDate
                      THEN 'RED'
                      ELSE 'ORANGE'
                    END
                  ELSE 'GREEN'
                END
            END
        END
    END DUEDATECOLOR
  FROM SYS_Q_RPT_RBI_COMMON
  GROUP BY SYS_Q_RPT_RBI_COMMON.GROUPCODE,
    SYS_Q_RPT_RBI_COMMON.GROUPNAME,
    SYS_Q_RPT_RBI_COMMON.ASSETCODE,
    SYS_Q_RPT_RBI_COMMON.ASSETNAME,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
    SYS_Q_RPT_RBI_COMMON.FREQCODE,
    SYS_Q_RPT_RBI_COMMON.FREQNAME,
    SYS_Q_RPT_RBI_COMMON.RBFF,
    SYS_Q_RPT_RBI_COMMON.LASTRECORD,
    SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
    SYS_Q_RPT_RBI_COMMON.SCE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
    SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
    SYS_Q_RPT_RBI_COMMON.ASSETID,
    SYS_Q_RPT_RBI_COMMON.DATTYPE
  ) T1
WHERE T1.FREQUENCYTYPEID = 14030 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_11_C
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_11_C" ("ASSETCODE", "ASSETNAME", "MITIGATIONCODE", "MITIGATIONNAME", "FREQCODE", "FREQNAME", "RBFF", "LASTRECORD", "INTERVALYRS", "SCE", "DUEDATE", "SYSTEMFIELD", "DUEDATECOLOR", "INRBIWORKSCOPE", "GROUPCODE", "GROUPNAME", "ASSETID", "DATTYPE") AS 
  SELECT T1.ASSETCODE,
  T1.ASSETNAME,
  T1.MITIGATIONCODE,
  T1.MITIGATIONNAME,
  T1.FREQCODE,
  T1.FREQNAME,
  T1.RBFF,
  T1.LASTRECORD,
  T1.INTERVALYRS,
  T1.SCE,
  T1.DUEDATE,
  T1.SYSTEMFIELD,
  T1.DUEDATECOLOR,
  CASE
    WHEN T1.SCE = 1
    THEN 'YES (SCE)'
    WHEN T1.DUEDATECOLOR = 'RED'
    THEN 'YES'
    WHEN T1.DUEDATECOLOR = 'ORANGE'
    AND T1.DUEDATE      != 'Continuous'
    THEN 'YES'
    ELSE 'NO'
  END INRBIWORKSCOPE,
  T1.GROUPCODE,
  T1.GROUPNAME,
  T1.ASSETID,
  T1.DATTYPE
FROM
  (SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
    SYS_Q_RPT_RBI_COMMON.GROUPNAME,
    SYS_Q_RPT_RBI_COMMON.ASSETCODE,
    SYS_Q_RPT_RBI_COMMON.ASSETNAME,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
    SYS_Q_RPT_RBI_COMMON.FREQCODE,
    SYS_Q_RPT_RBI_COMMON.FREQNAME,
    SYS_Q_RPT_RBI_COMMON.RBFF,
    SYS_Q_RPT_RBI_COMMON.LASTRECORD,
    SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
    SYS_Q_RPT_RBI_COMMON.SCE,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
      THEN 'N/A'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
          THEN 'Continuous'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
          THEN 'Ad Hoc'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
              THEN 'Immediate Action'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
            END
        END
    END DUEDATE,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
      THEN '4/4/4444'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
          THEN '1/1/1111'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
          THEN '2/2/2222'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
              THEN '3/3/3333'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
            END
        END
    END SYSTEMFIELD,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
    SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
    SYS_Q_RPT_RBI_COMMON.ASSETID,
    SYS_Q_RPT_RBI_COMMON.DATTYPE,
    CASE
      WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'N/A'
      THEN 'GREEN'
      ELSE
        CASE
          WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'C'
          THEN 'ORANGE'
          WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'A'
          THEN 'RED'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              THEN 'RED'
              WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'IMMEDIATE ACTION'
              THEN 'RED'
              ELSE
                CASE
                  WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < ADD_MONTHS(SysDate, 12)
                  THEN
                    CASE
                      WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < SysDate
                      THEN 'RED'
                      ELSE 'ORANGE'
                    END
                  ELSE 'GREEN'
                END
            END
        END
    END DUEDATECOLOR
  FROM SYS_Q_RPT_RBI_COMMON
  GROUP BY SYS_Q_RPT_RBI_COMMON.GROUPCODE,
    SYS_Q_RPT_RBI_COMMON.GROUPNAME,
    SYS_Q_RPT_RBI_COMMON.ASSETCODE,
    SYS_Q_RPT_RBI_COMMON.ASSETNAME,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
    SYS_Q_RPT_RBI_COMMON.FREQCODE,
    SYS_Q_RPT_RBI_COMMON.FREQNAME,
    SYS_Q_RPT_RBI_COMMON.RBFF,
    SYS_Q_RPT_RBI_COMMON.LASTRECORD,
    SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
    SYS_Q_RPT_RBI_COMMON.SCE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
    SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
    SYS_Q_RPT_RBI_COMMON.ASSETID,
    SYS_Q_RPT_RBI_COMMON.DATTYPE
  ) T1
WHERE T1.FREQUENCYTYPEID = 14031 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_11_D
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_11_D" ("ASSETCODE", "ASSETNAME", "MITIGATIONCODE", "MITIGATIONNAME", "FREQCODE", "FREQNAME", "RBFF", "LASTRECORD", "INTERVALYRS", "SCE", "DUEDATE", "SYSTEMFIELD", "DUEDATECOLOR", "INRBIWORKSCOPE", "GROUPCODE", "GROUPNAME", "ASSETID", "DATTYPE") AS 
  SELECT T1.ASSETCODE,
  T1.ASSETNAME,
  T1.MITIGATIONCODE,
  T1.MITIGATIONNAME,
  T1.FREQCODE,
  T1.FREQNAME,
  T1.RBFF,
  T1.LASTRECORD,
  T1.INTERVALYRS,
  T1.SCE,
  T1.DUEDATE,
  T1.SYSTEMFIELD,
  T1.DUEDATECOLOR,
  CASE
    WHEN T1.SCE = 1
    THEN 'YES (SCE)'
    WHEN T1.DUEDATECOLOR = 'RED'
    THEN 'YES'
    WHEN T1.DUEDATECOLOR = 'ORANGE'
    AND T1.DUEDATE      != 'Continuous'
    THEN 'YES'
    ELSE 'NO'
  END INRBIWORKSCOPE,
  T1.GROUPCODE,
  T1.GROUPNAME,
  T1.ASSETID,
  T1.DATTYPE
FROM
  (SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
    SYS_Q_RPT_RBI_COMMON.GROUPNAME,
    SYS_Q_RPT_RBI_COMMON.ASSETCODE,
    SYS_Q_RPT_RBI_COMMON.ASSETNAME,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
    SYS_Q_RPT_RBI_COMMON.FREQCODE,
    SYS_Q_RPT_RBI_COMMON.FREQNAME,
    SYS_Q_RPT_RBI_COMMON.RBFF,
    SYS_Q_RPT_RBI_COMMON.LASTRECORD,
    SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
    SYS_Q_RPT_RBI_COMMON.SCE,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
      THEN 'N/A'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
          THEN 'Continuous'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
          THEN 'Ad Hoc'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
              THEN 'Immediate Action'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
            END
        END
    END DUEDATE,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
      THEN '4/4/4444'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
          THEN '1/1/1111'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
          THEN '2/2/2222'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
              THEN '3/3/3333'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
            END
        END
    END SYSTEMFIELD,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
    SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
    SYS_Q_RPT_RBI_COMMON.ASSETID,
    SYS_Q_RPT_RBI_COMMON.DATTYPE,
    CASE
      WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'N/A'
      THEN 'GREEN'
      ELSE
        CASE
          WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'C'
          THEN 'ORANGE'
          WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'A'
          THEN 'RED'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              THEN 'RED'
              WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'IMMEDIATE ACTION'
              THEN 'RED'
              ELSE
                CASE
                  WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < ADD_MONTHS(SysDate, 12)
                  THEN
                    CASE
                      WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < SysDate
                      THEN 'RED'
                      ELSE 'ORANGE'
                    END
                  ELSE 'GREEN'
                END
            END
        END
    END DUEDATECOLOR
  FROM SYS_Q_RPT_RBI_COMMON
  GROUP BY SYS_Q_RPT_RBI_COMMON.GROUPCODE,
    SYS_Q_RPT_RBI_COMMON.GROUPNAME,
    SYS_Q_RPT_RBI_COMMON.ASSETCODE,
    SYS_Q_RPT_RBI_COMMON.ASSETNAME,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
    SYS_Q_RPT_RBI_COMMON.FREQCODE,
    SYS_Q_RPT_RBI_COMMON.FREQNAME,
    SYS_Q_RPT_RBI_COMMON.RBFF,
    SYS_Q_RPT_RBI_COMMON.LASTRECORD,
    SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
    SYS_Q_RPT_RBI_COMMON.SCE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
    SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
    SYS_Q_RPT_RBI_COMMON.ASSETID,
    SYS_Q_RPT_RBI_COMMON.DATTYPE
  ) T1
WHERE T1.FREQUENCYTYPEID = 14032 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_11_E
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_11_E" ("ASSETCODE", "ASSETNAME", "MITIGATIONCODE", "MITIGATIONNAME", "FREQCODE", "FREQNAME", "RBFF", "LASTRECORD", "INTERVALYRS", "SCE", "DUEDATE", "SYSTEMFIELD", "DUEDATECOLOR", "INRBIWORKSCOPE", "GROUPCODE", "GROUPNAME", "ASSETID", "DATTYPE") AS 
  SELECT T1.ASSETCODE,
  T1.ASSETNAME,
  T1.MITIGATIONCODE,
  T1.MITIGATIONNAME,
  T1.FREQCODE,
  T1.FREQNAME,
  T1.RBFF,
  T1.LASTRECORD,
  T1.INTERVALYRS,
  T1.SCE,
  T1.DUEDATE,
  T1.SYSTEMFIELD,
  T1.DUEDATECOLOR,
  CASE
    WHEN T1.SCE = 1
    THEN 'YES (SCE)'
    WHEN T1.DUEDATECOLOR = 'RED'
    THEN 'YES'
    WHEN T1.DUEDATECOLOR = 'ORANGE'
    AND T1.DUEDATE      != 'Continuous'
    THEN 'YES'
    ELSE 'NO'
  END INRBIWORKSCOPE,
  T1.GROUPCODE,
  T1.GROUPNAME,
  T1.ASSETID,
  T1.DATTYPE
FROM
  (SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
    SYS_Q_RPT_RBI_COMMON.GROUPNAME,
    SYS_Q_RPT_RBI_COMMON.ASSETCODE,
    SYS_Q_RPT_RBI_COMMON.ASSETNAME,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
    SYS_Q_RPT_RBI_COMMON.FREQCODE,
    SYS_Q_RPT_RBI_COMMON.FREQNAME,
    SYS_Q_RPT_RBI_COMMON.RBFF,
    SYS_Q_RPT_RBI_COMMON.LASTRECORD,
    SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
    SYS_Q_RPT_RBI_COMMON.SCE,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
      THEN 'N/A'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
          THEN 'Continuous'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
          THEN 'Ad Hoc'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
              THEN 'Immediate Action'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
            END
        END
    END DUEDATE,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
      THEN '4/4/4444'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
          THEN '1/1/1111'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
          THEN '2/2/2222'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
              THEN '3/3/3333'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
            END
        END
    END SYSTEMFIELD,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
    SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
    SYS_Q_RPT_RBI_COMMON.ASSETID,
    SYS_Q_RPT_RBI_COMMON.DATTYPE,
    CASE
      WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'N/A'
      THEN 'GREEN'
      ELSE
        CASE
          WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'C'
          THEN 'ORANGE'
          WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'A'
          THEN 'RED'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              THEN 'RED'
              WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'IMMEDIATE ACTION'
              THEN 'RED'
              ELSE
                CASE
                  WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < ADD_MONTHS(SysDate, 12)
                  THEN
                    CASE
                      WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < SysDate
                      THEN 'RED'
                      ELSE 'ORANGE'
                    END
                  ELSE 'GREEN'
                END
            END
        END
    END DUEDATECOLOR
  FROM SYS_Q_RPT_RBI_COMMON
  GROUP BY SYS_Q_RPT_RBI_COMMON.GROUPCODE,
    SYS_Q_RPT_RBI_COMMON.GROUPNAME,
    SYS_Q_RPT_RBI_COMMON.ASSETCODE,
    SYS_Q_RPT_RBI_COMMON.ASSETNAME,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
    SYS_Q_RPT_RBI_COMMON.FREQCODE,
    SYS_Q_RPT_RBI_COMMON.FREQNAME,
    SYS_Q_RPT_RBI_COMMON.RBFF,
    SYS_Q_RPT_RBI_COMMON.LASTRECORD,
    SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
    SYS_Q_RPT_RBI_COMMON.SCE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
    SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
    SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
    SYS_Q_RPT_RBI_COMMON.ASSETID,
    SYS_Q_RPT_RBI_COMMON.DATTYPE
  ) T1
WHERE T1.FREQUENCYTYPEID = 14033 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_12
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_12" ("ASSET_GROUP", "ASSET", "MITIGATION", "FAILURE_TREAT", "DUE_DATE", "DUE_DATE_SYSTEM_COLOR", "ASSETID", "DATTYPE", "FREQUENCY_TYPE", "MITIGATION_TYPE") AS 
  SELECT '('
                || T2.GROUPCODE
                || ')'
                || T2.GROUPNAME AS ASSET_GROUP,
                '('
                || T2.ASSETCODE
                || ')'
                || T2.ASSETNAME AS ASSET,
                '('
                || T2.MITIGATIONCODE
                || ')'
                || T2.MITIGATIONNAME AS MITIGATION,
                '('
                || T2.FAILURETHREATCODE
                || ')'
                || T2.FAILURETHREATNAME AS FAILURE_TREAT,
                CASE
                  WHEN T2.SYSTEMFIELD = '1/1/1111'
                  OR T2.SYSTEMFIELD   = '2/2/2222'
                  OR T2.SYSTEMFIELD   = '3/3/3333'
                  OR T2.SYSTEMFIELD   = '4/4/4444'
                  THEN T2.DUEDATE
                  ELSE T2.SYSTEMFIELD
                END DUE_DATE,
                CASE
                  WHEN T2.DUEDATECOLOR = 'RED'
                  THEN 'IndianRed'
                  WHEN T2.DUEDATECOLOR = 'ORANGE'
                  THEN 'SandyBrown'
                  ELSE 'OliveDrab'
                END DUE_DATE_SYSTEM_COLOR,
                T2.ASSETID,
                T2.DATTYPE,
                T2.FREQUENCYTYPEID FREQUENCY_TYPE,
                T2.MITIGATIONTYPEID MITIGATION_TYPE 
              FROM
                (SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
                  SYS_Q_RPT_RBI_COMMON.GROUPNAME,
                  SYS_Q_RPT_RBI_COMMON.ASSETCODE,
                  SYS_Q_RPT_RBI_COMMON.ASSETNAME,
                  SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
                  SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
                  SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE,
                  SYS_Q_RPT_RBI_COMMON.FAILURETHREATNAME,
                  SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID,
                  SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPEID,
                  SYS_Q_RPT_RBI_COMMON.FREQNAME,
                  SYS_Q_RPT_RBI_COMMON.RBFF,
                  SYS_Q_RPT_RBI_COMMON.LASTRECORD,
                  SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF,
                  SYS_Q_RPT_RBI_COMMON.SCE,
                  CASE
                    WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
                    THEN 'N/A'
                    ELSE
                      CASE
                        WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
                        THEN 'CONTINUOUS'
                        WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
                        THEN 'AD-HOC'
                        ELSE
                          CASE
                            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
                            OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -2
                            THEN 'IMMEDIATE ACTION'
                            ELSE 
                              CASE WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD IS NOT NULL THEN
                                TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF))
                              END
                          END
                      END
                  END DUEDATE,
                  CASE
                    WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
                    THEN '4/4/4444'
                    ELSE
                      CASE
                        WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
                        THEN '1/1/1111'
                        WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
                        THEN '2/2/2222'
                        ELSE
                          CASE
                            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
                            OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -1
                            THEN '3/3/3333'
                            ELSE 
                              CASE WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD IS NOT NULL THEN
                                TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF))
                              END
                          END
                      END
                  END SYSTEMFIELD,
                  CASE
                    WHEN UPPER(SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF) = -1
                    THEN 'GREEN'
                    ELSE
                      CASE
                        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID) = 14033
                        THEN 'ORANGE'
                        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID) = 14032
                        THEN 'RED'
                        ELSE
                          CASE
                            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
                            THEN 'RED'
                            WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -2
                            THEN 'RED'
                            ELSE
                              CASE WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD IS NOT NULL THEN
                                CASE
                                  WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF)) < ADD_MONTHS(TO_DATE(SYSDATE), 12)
                                  THEN
                                    CASE
                                      WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF)) < TO_DATE(SYSDATE) 
                                      THEN 'RED'
                                      ELSE 'ORANGE'
                                    END
                                  ELSE 'GREEN'
                                END
                              END
                          END
                      END
                  END DUEDATECOLOR,
                  SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
                  SYS_Q_RPT_RBI_COMMON.ASSETID,
                  SYS_Q_RPT_RBI_COMMON.DATTYPE
                FROM SYS_Q_RPT_RBI_COMMON
                ) T2 
          INNER JOIN
            (SELECT SYS_TREE_STRUC.TRE_DAT_TAG
            FROM SYS_TREE_STRUC
            INNER JOIN SYS_NODES_ATTRIB
            ON SYS_TREE_STRUC.TRE_DAT_TAG                 = SYS_NODES_ATTRIB.REC_TAG
            WHERE SYS_TREE_STRUC.TRE_DAT_TYPE             = 1 
              START WITH SYS_TREE_STRUC.TRE_DAT_TAG       = 8956 
              CONNECT BY Prior SYS_TREE_STRUC.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG_PAR
            ) T1 ON T1.TRE_DAT_TAG                        = ASSETID  WHERE DATTYPE=1 ORDER BY ASSET_GROUP,
              ASSET,
              MITIGATION,
              FAILURE_TREAT WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_12_A
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_12_A" ("GROUPCODE", "GROUPNAME", "ASSETCODE", "ASSETNAME", "MITIGATIONCODE", "MITIGATIONNAME", "FAILURETHREATCODE", "FAILURETHREATNAME", "FREQCODE", "FREQNAME", "RBFF", "LASTRECORD", "INTERVALYRS", "SCE", "DUEDATE", "SYSTEMFIELD", "DUEDATECOLOR", "MITIGATIONTYPE", "ASSETID", "DATTYPE") AS 
  SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
  SYS_Q_RPT_RBI_COMMON.GROUPNAME,
  SYS_Q_RPT_RBI_COMMON.ASSETCODE,
  SYS_Q_RPT_RBI_COMMON.ASSETNAME,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATNAME,
  SYS_Q_RPT_RBI_COMMON.FREQCODE,
  SYS_Q_RPT_RBI_COMMON.FREQNAME,
  SYS_Q_RPT_RBI_COMMON.RBFF,
  SYS_Q_RPT_RBI_COMMON.LASTRECORD,
  SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
  SYS_Q_RPT_RBI_COMMON.SCE,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
    THEN 'N/A'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
        THEN 'Continuous'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
        THEN 'Ad Hoc'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
            THEN 'Immediate Action'
            ELSE TO_CHAR(to_date(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
          END
      END
  END DueDate,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
    THEN '4/4/4444'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
        THEN '1/1/1111'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
        THEN '2/2/2222'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
            THEN '3/3/3333'
            ELSE TO_CHAR(to_date(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
          END
      END
  END SystemField,
  CASE
    WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'N/A'
    THEN 'GREEN'
    ELSE
      CASE
        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'C'
        THEN 'ORANGE'
        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'A'
        THEN 'RED'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            THEN 'RED'
            WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'IMMEDIATE ACTION'
            THEN 'RED'
            ELSE
              CASE
                WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < ADD_MONTHS(SysDate, 12)
                THEN
                  CASE
                    WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < SysDate
                    THEN 'RED'
                    ELSE 'ORANGE'
                  END
                ELSE 'GREEN'
              END
          END
      END
  END DUEDATECOLOR,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
  SYS_Q_RPT_RBI_COMMON.ASSETID,
  SYS_Q_RPT_RBI_COMMON.DATTYPE
FROM SYS_Q_RPT_RBI_COMMON
ORDER BY SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_12_B
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_12_B" ("GROUPCODE", "GROUPNAME", "ASSETCODE", "ASSETNAME", "MITIGATIONCODE", "MITIGATIONNAME", "FAILURETHREATCODE", "FAILURETHREATNAME", "FREQCODE", "FREQNAME", "RBFF", "LASTRECORD", "INTERVALYRS", "SCE", "DUEDATE", "SYSTEMFIELD", "DUEDATECOLOR", "MITIGATIONTYPE", "ASSETID", "DATTYPE") AS 
  SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
  SYS_Q_RPT_RBI_COMMON.GROUPNAME,
  SYS_Q_RPT_RBI_COMMON.ASSETCODE,
  SYS_Q_RPT_RBI_COMMON.ASSETNAME,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATNAME,
  SYS_Q_RPT_RBI_COMMON.FREQCODE,
  SYS_Q_RPT_RBI_COMMON.FREQNAME,
  SYS_Q_RPT_RBI_COMMON.RBFF,
  SYS_Q_RPT_RBI_COMMON.LASTRECORD,
  SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
  SYS_Q_RPT_RBI_COMMON.SCE,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
    THEN 'N/A'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
        THEN 'Continuous'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
        THEN 'Ad Hoc'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
            THEN 'Immediate Action'
            ELSE TO_CHAR(to_date(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
          END
      END
  END DueDate,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
    THEN '4/4/4444'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
        THEN '1/1/1111'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
        THEN '2/2/2222'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
            THEN '3/3/3333'
            ELSE TO_CHAR(to_date(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
          END
      END
  END SystemField,
  CASE
    WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'N/A'
    THEN 'GREEN'
    ELSE
      CASE
        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'C'
        THEN 'ORANGE'
        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'A'
        THEN 'RED'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            THEN 'RED'
            WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'IMMEDIATE ACTION'
            THEN 'RED'
            ELSE
              CASE
                WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < ADD_MONTHS(SysDate, 12)
                THEN
                  CASE
                    WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < SysDate
                    THEN 'RED'
                    ELSE 'ORANGE'
                  END
                ELSE 'GREEN'
              END
          END
      END
  END DUEDATECOLOR,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
  SYS_Q_RPT_RBI_COMMON.ASSETID,
  SYS_Q_RPT_RBI_COMMON.DATTYPE
FROM SYS_Q_RPT_RBI_COMMON 
WHERE FREQUENCYTYPEID = 14030
ORDER BY SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_12_C
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_12_C" ("GROUPCODE", "GROUPNAME", "ASSETCODE", "ASSETNAME", "MITIGATIONCODE", "MITIGATIONNAME", "FAILURETHREATCODE", "FAILURETHREATNAME", "FREQCODE", "FREQNAME", "RBFF", "LASTRECORD", "INTERVALYRS", "SCE", "DUEDATE", "SYSTEMFIELD", "DUEDATECOLOR", "MITIGATIONTYPE", "ASSETID", "DATTYPE") AS 
  SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
  SYS_Q_RPT_RBI_COMMON.GROUPNAME,
  SYS_Q_RPT_RBI_COMMON.ASSETCODE,
  SYS_Q_RPT_RBI_COMMON.ASSETNAME,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATNAME,
  SYS_Q_RPT_RBI_COMMON.FREQCODE,
  SYS_Q_RPT_RBI_COMMON.FREQNAME,
  SYS_Q_RPT_RBI_COMMON.RBFF,
  SYS_Q_RPT_RBI_COMMON.LASTRECORD,
  SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
  SYS_Q_RPT_RBI_COMMON.SCE,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
    THEN 'N/A'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
        THEN 'Continuous'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
        THEN 'Ad Hoc'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
            THEN 'Immediate Action'
            ELSE TO_CHAR(to_date(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
          END
      END
  END DueDate,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
    THEN '4/4/4444'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
        THEN '1/1/1111'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
        THEN '2/2/2222'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
            THEN '3/3/3333'
            ELSE TO_CHAR(to_date(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
          END
      END
  END SystemField,
  CASE
    WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'N/A'
    THEN 'GREEN'
    ELSE
      CASE
        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'C'
        THEN 'ORANGE'
        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'A'
        THEN 'RED'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            THEN 'RED'
            WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'IMMEDIATE ACTION'
            THEN 'RED'
            ELSE
              CASE
                WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < ADD_MONTHS(SysDate, 12)
                THEN
                  CASE
                    WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < SysDate
                    THEN 'RED'
                    ELSE 'ORANGE'
                  END
                ELSE 'GREEN'
              END
          END
      END
  END DUEDATECOLOR,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
  SYS_Q_RPT_RBI_COMMON.ASSETID,
  SYS_Q_RPT_RBI_COMMON.DATTYPE
FROM SYS_Q_RPT_RBI_COMMON 
WHERE FREQUENCYTYPEID = 14031
ORDER BY SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_12_D
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_12_D" ("GROUPCODE", "GROUPNAME", "ASSETCODE", "ASSETNAME", "MITIGATIONCODE", "MITIGATIONNAME", "FAILURETHREATCODE", "FAILURETHREATNAME", "FREQCODE", "FREQNAME", "RBFF", "LASTRECORD", "INTERVALYRS", "SCE", "DUEDATE", "SYSTEMFIELD", "DUEDATECOLOR", "MITIGATIONTYPE", "ASSETID", "DATTYPE") AS 
  SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
  SYS_Q_RPT_RBI_COMMON.GROUPNAME,
  SYS_Q_RPT_RBI_COMMON.ASSETCODE,
  SYS_Q_RPT_RBI_COMMON.ASSETNAME,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATNAME,
  SYS_Q_RPT_RBI_COMMON.FREQCODE,
  SYS_Q_RPT_RBI_COMMON.FREQNAME,
  SYS_Q_RPT_RBI_COMMON.RBFF,
  SYS_Q_RPT_RBI_COMMON.LASTRECORD,
  SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
  SYS_Q_RPT_RBI_COMMON.SCE,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
    THEN 'N/A'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
        THEN 'Continuous'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
        THEN 'Ad Hoc'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
            THEN 'Immediate Action'
            ELSE TO_CHAR(to_date(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
          END
      END
  END DueDate,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
    THEN '4/4/4444'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
        THEN '1/1/1111'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
        THEN '2/2/2222'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
            THEN '3/3/3333'
            ELSE TO_CHAR(to_date(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
          END
      END
  END SystemField,
  CASE
    WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'N/A'
    THEN 'GREEN'
    ELSE
      CASE
        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'C'
        THEN 'ORANGE'
        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'A'
        THEN 'RED'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            THEN 'RED'
            WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'IMMEDIATE ACTION'
            THEN 'RED'
            ELSE
              CASE
                WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < ADD_MONTHS(SysDate, 12)
                THEN
                  CASE
                    WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < SysDate
                    THEN 'RED'
                    ELSE 'ORANGE'
                  END
                ELSE 'GREEN'
              END
          END
      END
  END DUEDATECOLOR,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
  SYS_Q_RPT_RBI_COMMON.ASSETID,
  SYS_Q_RPT_RBI_COMMON.DATTYPE
FROM SYS_Q_RPT_RBI_COMMON 
WHERE FREQUENCYTYPEID = 14032
ORDER BY SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_12_E
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_12_E" ("GROUPCODE", "GROUPNAME", "ASSETCODE", "ASSETNAME", "MITIGATIONCODE", "MITIGATIONNAME", "FAILURETHREATCODE", "FAILURETHREATNAME", "FREQCODE", "FREQNAME", "RBFF", "LASTRECORD", "INTERVALYRS", "SCE", "DUEDATE", "SYSTEMFIELD", "DUEDATECOLOR", "MITIGATIONTYPE", "ASSETID", "DATTYPE") AS 
  SELECT SYS_Q_RPT_RBI_COMMON.GROUPCODE,
  SYS_Q_RPT_RBI_COMMON.GROUPNAME,
  SYS_Q_RPT_RBI_COMMON.ASSETCODE,
  SYS_Q_RPT_RBI_COMMON.ASSETNAME,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATNAME,
  SYS_Q_RPT_RBI_COMMON.FREQCODE,
  SYS_Q_RPT_RBI_COMMON.FREQNAME,
  SYS_Q_RPT_RBI_COMMON.RBFF,
  SYS_Q_RPT_RBI_COMMON.LASTRECORD,
  SYS_Q_RPT_RBI_COMMON.INTERVALYRS,
  SYS_Q_RPT_RBI_COMMON.SCE,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
    THEN 'N/A'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
        THEN 'Continuous'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
        THEN 'Ad Hoc'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
            THEN 'Immediate Action'
            ELSE TO_CHAR(to_date(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
          END
      END
  END DueDate,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.INTERVALYRS = 'N/A'
    THEN '4/4/4444'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'C'
        THEN '1/1/1111'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQCODE = 'A'
        THEN '2/2/2222'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.INTERVALYRS  = 'Immediate Action'
            THEN '3/3/3333'
            ELSE TO_CHAR(to_date(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS))
          END
      END
  END SystemField,
  CASE
    WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'N/A'
    THEN 'GREEN'
    ELSE
      CASE
        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'C'
        THEN 'ORANGE'
        WHEN UPPER(SYS_Q_RPT_RBI_COMMON.FREQCODE) = 'A'
        THEN 'RED'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            THEN 'RED'
            WHEN UPPER(SYS_Q_RPT_RBI_COMMON.INTERVALYRS) = 'IMMEDIATE ACTION'
            THEN 'RED'
            ELSE
              CASE
                WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < ADD_MONTHS(SysDate, 12)
                THEN
                  CASE
                    WHEN (TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.INTERVALYRS)) < SysDate
                    THEN 'RED'
                    ELSE 'ORANGE'
                  END
                ELSE 'GREEN'
              END
          END
      END
  END DUEDATECOLOR,
  SYS_Q_RPT_RBI_COMMON.MITIGATIONTYPE,
  SYS_Q_RPT_RBI_COMMON.ASSETID,
  SYS_Q_RPT_RBI_COMMON.DATTYPE
FROM SYS_Q_RPT_RBI_COMMON 
WHERE FREQUENCYTYPEID = 14033
ORDER BY SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE,
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_13
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_13" ("ASSET_GROUP", "ASSET", "MITIGATION", "FAILURE_TREAT", "RBFF", "FREQUENCY_TYPE", "CONFIDENCE_STATUS", "LAST_RECORD", "NEW_RISK", "ORIGINAL_RISK", "MTBF", "DUE_DATE_SYSTEM_COLOR", "ARL_OR_MTBF", "YEARS_INTERVAL", "DUE_DATE", "ASSETID", "DATTYPE") AS 
  SELECT T1.ASSET_GROUP,
  T1.ASSET,
  T1.MITIGATION,
  T1.FAILURE_TREAT,
  T1.RBFF,
  T1.FREQUENCY_TYPE,
  T1.CONFIDENCE_STATUS,
  (CASE WHEN T1.LASTRECORD = '1/1/1111' THEN 'NO RECORD' 
  ELSE T1.LASTRECORD END) LAST_RECORD,
  T1.NEW_RISK,
  T1.ORIGINAL_RISK,
  T1.MTBF,
  CASE
    WHEN TO_DATE(T1.LASTRECORD, 'DD/MM/YYYY') <= TO_DATE(SYSDATE, 'DD/MM/YYYY')  
    AND TO_DATE(T1.LASTRECORD, 'DD/MM/YYYY')  >= TO_DATE(SysDate - 7, 'DD/MM/YYYY') THEN 'OliveDrab'
    ELSE
      CASE 
        WHEN T1.SYSTEMFIELD IS NOT NULL THEN
          CASE
            WHEN T1.SYSTEMFIELD = '1/1/1111' THEN 'SandyBrown' 
            WHEN T1.SYSTEMFIELD = '2/2/2222' OR T1.SYSTEMFIELD   = '3/3/3333' THEN 'IndianRed'
            WHEN T1.SYSTEMFIELD = '4/4/4444' THEN 'OliveDrab' 
            ELSE
              CASE 
                WHEN TO_DATE(T1.SYSTEMFIELD, 'DD/MM/YYYY') < TO_DATE(ADD_MONTHS(SysDate, 12), 'DD/MM/YYYY') THEN
                  CASE
                    WHEN TO_DATE(T1.SYSTEMFIELD, 'DD/MM/YYYY') < TO_DATE(SysDate, 'DD/MM/YYYY') THEN 'IndianRed'
                    ELSE 'SandyBrown'
                  END
                ELSE 
                  CASE WHEN T1.RBFF = '**' THEN 'IndianRed' 
                  ELSE
                    'OliveDrab'
                  END
              END
            END
          ELSE NULL
        END
      END DUE_DATE_SYSTEM_COLOR,
  T1.ARL_OR_MTBF,
  T1.YEARS_INTERVAL,
  T1.DUEDATE AS DUE_DATE,
  T1.ASSETID,
  T1.DATTYPE
FROM
  (SELECT '('
    || SYS_Q_RPT_RBI_COMMON.GROUPCODE
    || ')'
    || SYS_Q_RPT_RBI_COMMON.GROUPNAME AS ASSET_GROUP,
    '('
    || SYS_Q_RPT_RBI_COMMON.ASSETCODE
    || ')'
    || SYS_Q_RPT_RBI_COMMON.ASSETNAME AS ASSET,
    '('
    || SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE
    || ')'
    || SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME AS MITIGATION,
    '('
    || SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE
    || ')'
    || SYS_Q_RPT_RBI_COMMON.FAILURETHREATNAME AS FAILURE_TREAT,
    SYS_Q_RPT_RBI_COMMON.RBFF,
    SYS_Q_RPT_RBI_COMMON.LASTRECORD,
    SYS_Q_RPT_RBI_COMMON.FREQNAME                AS FREQUENCY_TYPE,
    SYS_Q_RPT_RBI_COMMON.RBI_POF_CONF_STATUS_SYS AS CONFIDENCE_STATUS,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/11/1111'
      THEN 'NO RECORD'
      ELSE SYS_Q_RPT_RBI_COMMON.LASTRECORD
    END LAST_RECORD,
    SYS_Q_RPT_RBI_COMMON.RISKNEW      AS NEW_RISK,
    SYS_Q_RPT_RBI_COMMON.RISKORIGINAL AS ORIGINAL_RISK,
    SYS_Q_RPT_RBI_COMMON.RBI_POF_MTBF AS MTBF,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.RBI_POF_MTBF = SYS_Q_RPT_RBI_COMMON.ARLYRS
      THEN NVL(SYS_Q_RPT_RBI_COMMON.RBI_POF_MTBF, 0)
        || ' YEARS (A)'
      ELSE NVL(SYS_Q_RPT_RBI_COMMON.RBI_POF_MTBF, 0)
        || ' YEARS (M)'
    END ARL_OR_MTBF,
    SYS_Q_RPT_RBI_COMMON.ARLYRS AS ARL_YEARS,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
      THEN 'N/A'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
          THEN 'CONTINUOUS'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
          THEN 'AD-HOC'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -2 OR SYS_Q_RPT_RBI_COMMON.RBFF = '**' 
              THEN 'IMMEDIATE ACTION'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF))
            END
        END
    END DUEDATE,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
      THEN '4/4/4444'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
          THEN '1/1/1111'
          WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
          THEN '2/2/2222'
          ELSE
            CASE
              WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
              OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -1
              THEN '3/3/3333'
              ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF))
            END
        END
    END SYSTEMFIELD,
    CASE
      WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
      THEN 'CONTINUOUS'
      ELSE
        CASE
          WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
          THEN 'N/A'
          WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -2
          THEN 'IMMEDIATE ACTION'
          ELSE TO_CHAR(SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF)
            || ' YEARS'
        END
    END YEARS_INTERVAL,
    SYS_Q_RPT_RBI_COMMON.ASSETID,
    SYS_Q_RPT_RBI_COMMON.DATTYPE
  FROM SYS_Q_RPT_RBI_COMMON
  ) T1
ORDER BY T1.ASSET_GROUP,
  T1.ASSET,
  T1.MITIGATION,
  T1.FAILURE_TREAT WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_14
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_14" ("ASSET_GROUP", "ASSET", "MITIGATION", "FAILURE_TREAT", "RBFF", "FREQUENCY_TYPE", "CONFIDENCE_STATUS", "LAST_RECORD", "NEW_RISK", "ORIGINAL_RISK", "MTBF", "ARL_OR_MTBF", "ARL_YEARS", "DUEDATE", "SYSTEMFIELD", "YEARS_INTERVAL", "ASSETID", "DATTYPE") AS 
  SELECT 
  '(' || SYS_Q_RPT_RBI_COMMON.GROUPCODE || ')' ||
  SYS_Q_RPT_RBI_COMMON.GROUPNAME AS ASSET_GROUP, 
  '(' || SYS_Q_RPT_RBI_COMMON.ASSETCODE || ')' ||
  SYS_Q_RPT_RBI_COMMON.ASSETNAME AS ASSET, 
  '(' || SYS_Q_RPT_RBI_COMMON.MITIGATIONCODE || ')' ||
  SYS_Q_RPT_RBI_COMMON.MITIGATIONNAME  AS MITIGATION, 
  '(' || SYS_Q_RPT_RBI_COMMON.FAILURETHREATCODE || ')' ||
  SYS_Q_RPT_RBI_COMMON.FAILURETHREATNAME AS FAILURE_TREAT,
  SYS_Q_RPT_RBI_COMMON.RBFF,
  SYS_Q_RPT_RBI_COMMON.FREQNAME AS FREQUENCY_TYPE,
  SYS_Q_RPT_RBI_COMMON.RBI_POF_CONF_STATUS_SYS AS CONFIDENCE_STATUS,
  CASE 
    WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/11/1111' 
    THEN 'NO RECORD'
    ELSE SYS_Q_RPT_RBI_COMMON.LASTRECORD
  END LAST_RECORD,
  SYS_Q_RPT_RBI_COMMON.RISKNEW AS NEW_RISK,
  SYS_Q_RPT_RBI_COMMON.RISKORIGINAL AS ORIGINAL_RISK,
  SYS_Q_RPT_RBI_COMMON.RBI_POF_MTBF AS MTBF,
  CASE 
    WHEN SYS_Q_RPT_RBI_COMMON.RBI_POF_MTBF = SYS_Q_RPT_RBI_COMMON.ARLYRS 
    THEN SYS_Q_RPT_RBI_COMMON.RBI_POF_MTBF || ' YEARS (A)' 
    ELSE SYS_Q_RPT_RBI_COMMON.RBI_POF_MTBF || ' YEARS (M)' 
  END ARL_OR_MTBF,
  SYS_Q_RPT_RBI_COMMON.ARLYRS AS ARL_YEARS,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
    THEN 'N/A'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
        THEN 'CONTINUOUS'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
        THEN 'AD-HOC'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -2
            THEN 'IMMEDIATE ACTION'
            ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF))
          END
      END
  END DUEDATE,
  CASE
    WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
    THEN '4/4/4444'
    ELSE
      CASE
        WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033
        THEN '1/1/1111'
        WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14032
        THEN '2/2/2222'
        ELSE
          CASE
            WHEN SYS_Q_RPT_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF  = -1
            THEN '3/3/3333'
            ELSE TO_CHAR(TO_DATE(SYS_Q_RPT_RBI_COMMON.LASTRECORD) + (365 * SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF))
          END
      END
  END SYSTEMFIELD,
  CASE 
    WHEN SYS_Q_RPT_RBI_COMMON.FREQUENCYTYPEID = 14033 
      THEN 'CONTINUOUS'
    ELSE 
      CASE
      WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -1
      THEN 'N/A'
      WHEN SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF = -2
      THEN 'IMMEDIATE ACTION'
      ELSE TO_CHAR(SYS_Q_RPT_RBI_COMMON.ARL_OR_MTBF) || ' YEARS'
      END
    END YEARS_INTERVAL,

  SYS_Q_RPT_RBI_COMMON.ASSETID,
  SYS_Q_RPT_RBI_COMMON.DATTYPE
FROM SYS_Q_RPT_RBI_COMMON;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RBI_COMMON
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RBI_COMMON" ("GROUPCODE", "GROUPNAME", "PARENTASSETCODE", "PARENTASSETNAME", "ASSETCODE", "ASSETNAME", "FAILURETHREATCODE", "FAILURETHREATNAME", "TIMEINTERVALMONTHS", "CONFIRMBY", "CONFIRMDATE", "NOTES", "RBFF", "RBI_POF_CONF_STATUS", "RBI_POF_CONF_STATUS_SYS", "RISKNEW", "RISKORIGINAL", "ARLYRS", "LASTRECORD", "RBI_POF_MTBF", "ARL_OR_MTBF", "SCE", "MITIGATIONCODE", "MITIGATIONNAME", "MITIGATIONTYPE", "MITIGATIONTYPEID", "FREQUENCYTYPEID", "FREQNAME", "ASSETID", "DATTYPE") AS 
  SELECT ASSETGROUP.NODE_ID          AS GROUPCODE,
  ASSETGROUP.NODE_DESC             AS GROUPNAME,
  ASSETPARENT.NODE_ID              AS PARENTASSETCODE,
  ASSETPARENT.NODE_DESC            AS PARENTASSETNAME,
  ASSET.NODE_ID                    AS ASSETCODE,
  ASSET.NODE_DESC                  AS ASSETNAME,
  TBL_ANOM_FT.FT_CODE              AS FAILURETHREATCODE,
  TBL_ANOM_FT.FT_NAME              AS FAILURETHREATNAME,
  V_TBL_RBI_MITPOF.RBI_MIT_POF_TBI AS TIMEINTERVALMONTHS,
  V_TBL_RBI_POF.RBI_POF_CONF_BY    AS CONFIRMBY,
  V_TBL_RBI_POF.RBI_POF_CONF_DATE  AS CONFIRMDATE,
  V_TBL_RBI_POF.RBI_POF_POF_NOTES  AS NOTES,
  TBL_RBI_RBFF.RBFF                AS RBFF,
  V_TBL_RBI_POF.RBI_POF_CONF_STATUS,
  UPPER(V_TBL_RBI_POF.RBI_POF_CONF_STATUS_SYS) AS RBI_POF_CONF_STATUS_SYS,
  V_TBL_RBI_POF.RBI_POF_NPOF_SYS_1
  || TBL_RBI_COF.RBI_COF_OVERALL AS RISKNEW,
  V_TBL_RBI_POF.RBI_POF_IPOF_SYS_1
  || TBL_RBI_COF.RBI_COF_OVERALL  AS RISKORIGINAL,
  V_TBL_RBI_POF.RBI_POF_ARL_YEARS AS ARLYRS,
  CASE
    WHEN V_TBL_RBI_MITPOF.RBI_MIT_POF_L_INS IS NULL
    THEN '1/1/1111'
    ELSE TO_CHAR(V_TBL_RBI_MITPOF.RBI_MIT_POF_L_INS)
  END AS LASTRECORD,
  V_TBL_RBI_POF.RBI_POF_MTBF,
  ROUND(
  CASE
    WHEN V_TBL_RBI_MITPOF.RBI_MIT_POF_FRT_ID = 14031
    THEN NVL(V_TBL_RBI_MITPOF.RBI_MIT_POF_TBI, 0) / 12
    WHEN V_TBL_RBI_MITPOF.RBI_MIT_POF_FRT_ID = 14030
    THEN
      CASE
        WHEN TBL_RBI_RBFF.RBFF = 'N/R'
        THEN -1
        WHEN TBL_RBI_RBFF.RBFF = '**'
        THEN -2
        WHEN TBL_RBI_RBFF.RBFF = '*'
        THEN 1
        ELSE TBL_RBI_RBFF.RBFF * (
          CASE
            WHEN V_TBL_RBI_POF.RBI_POF_ARL_YEARS > V_TBL_RBI_POF.RBI_POF_MTBF
            THEN V_TBL_RBI_POF.RBI_POF_ARL_YEARS
            ELSE V_TBL_RBI_POF.RBI_POF_MTBF
          END)
      END
    ELSE NULL
  END, 3)                                 AS ARL_OR_MTBF,
  ASSET.SCE                               AS SCE,
  V_TBL_RBI_MIT.RBI_MIT_CODE              AS MITIGATIONCODE,
  V_TBL_RBI_MIT.RBI_MIT_DESC              AS MITIGATIONNAME,
  V_TBL_RBI_MIT.RBI_MIT_TYPE_NAME         AS MITIGATIONTYPE,
  V_TBL_RBI_MIT.RBI_MIT_TYPE_ID           AS MITIGATIONTYPEID,
  V_TBL_RBI_MITPOF.RBI_MIT_POF_FRT_ID     AS FREQUENCYTYPEID,
  V_TBL_RBI_MITPOF.RBI_MIT_POF_FRT_ID_SYS AS FREQNAME,
  ASSET.REC_TAG                           AS ASSETID,
  SYS_TREE_STRUC.TRE_DAT_TYPE             AS DATTYPE
FROM (((((V_TBL_RBI_POF
INNER JOIN ((((SYS_NODES_ATTRIB ASSET
INNER JOIN SYS_TREE_STRUC
ON ASSET.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG)
INNER JOIN SYS_TREE_STRUC SYS_TREE_STRUC_1
ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC_1.TRE_NOD_TAG)
INNER JOIN SYS_NODES_ATTRIB ASSETPARENT
ON SYS_TREE_STRUC_1.TRE_DAT_TAG = ASSETPARENT.REC_TAG)
LEFT JOIN SYS_NODES_ATTRIB ASSETGROUP
ON ASSET.NODE_ASSET_TYPE         = ASSETGROUP.REC_TAG)
ON V_TBL_RBI_POF.RBI_POF_NODE_ID = ASSET.REC_TAG)
INNER JOIN V_TBL_RBI_MITPOF
ON V_TBL_RBI_POF.RBI_POF_ID = V_TBL_RBI_MITPOF.RBI_MIT_POF_POF_ID)
INNER JOIN V_TBL_RBI_MIT
ON V_TBL_RBI_MITPOF.RBI_MIT_POF_MIT_ID = V_TBL_RBI_MIT.RBI_MIT_ID)
INNER JOIN TBL_ANOM_FT
ON V_TBL_RBI_POF.RBI_POF_FT_ID = TBL_ANOM_FT.FT_ID)
INNER JOIN TBL_RBI_RBFF
ON V_TBL_RBI_POF.RBI_POF_CONF_STATUS = TBL_RBI_RBFF.RBFF_CONF_STATUS)
INNER JOIN TBL_RBI_COF
ON ASSET.REC_TAG                  = TBL_RBI_COF.RBI_COF_NODE_ID
AND TBL_RBI_COF.RBI_COF_OVERALL   = TBL_RBI_RBFF.RBFF_COF_OVERALL
WHERE SYS_TREE_STRUC.TRE_DAT_TYPE = 1
WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RED_COUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RED_COUNT" ("RED") AS 
  SELECT
 Count(AN_CURR_CLASS) AS Red
FROM
 TBL_ANOM_MAIN
WHERE
 TBL_ANOM_MAIN.AN_CURR_CLASS=8472;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RED_DATE_COUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RED_DATE_COUNT" ("DATERAISED", "RED") AS 
  SELECT
 DateRaised,
 COUNT(Red) Red
FROM (SELECT
 AN_RAISED_DATE AS DateRaised,
 SYS_LOOKUPS.LKP_DESC_B AS Red
FROM
 TBL_ANOM_MAIN INNER JOIN SYS_LOOKUPS
 ON TBL_ANOM_MAIN.AN_CURR_CLASS = SYS_LOOKUPS.LKP_ID
WHERE
 TBL_ANOM_MAIN.AN_CURR_CLASS=8472
ORDER BY
 SYS_LOOKUPS.LKP_ID
)GROUP BY
 DateRaised;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RF_01
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RF_01" ("ASSETCODE", "ASSETTITLE", "DESCRIPTION", "REF_CATEGORY", "FULLPATH", "DATTYPE", "REF_TYPE", "ASSETID") AS 
  SELECT NODAT.NODE_ID          AS ASSETCODE,
  NODAT.NODE_DESC             AS ASSETTITLE,
  RF.RF_DESC                  AS DESCRIPTION,
  NVL(LU2.LKP_DESC_B, '')              AS REF_CATEGORY,
  NVL(LU2.LKP_DESC_B, '')              AS FULLPATH,
  SYS_TREE_STRUC.TRE_DAT_TYPE AS DATTYPE,
  LU1.LKP_DESC_B              AS REF_TYPE,
  NODAT.REC_TAG               AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (((SYS_NODES_ATTRIB NODAT
LEFT JOIN TBL_REFERENCE_FILES RF
ON NODAT.REC_TAG = RF.RF_ASSET)
LEFT JOIN SYS_LOOKUPS LU1
ON RF.RF_TYPE = LU1.LKP_ID)
LEFT JOIN SYS_LOOKUPS LU2
ON RF.RF_PATH                 = LU2.LKP_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG = NODAT.REC_TAG
INNER JOIN SYS_TREE_STRUC SYS_TREE_STRUC2
ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC2.TRE_NOD_TAG
INNER JOIN SYS_NODES_ATTRIB
ON SYS_TREE_STRUC2.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RF_02
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RF_02" ("ASSETCODE", "ASSETTITLE", "DESCRIPTION", "CATEGORY", "FULLPATH", "DATTYPE", "TYPE", "ASSETID") AS 
  SELECT NODAT.NODE_ID          AS ASSETCODE,
  NODAT.NODE_DESC             AS ASSETTITLE,
  RF.RF_DESC                  AS DESCRIPTION,
  LU2.LKP_DESC_B              AS CATEGORY,
  LU2.LKP_DESC_B              AS FULLPATH,
  SYS_TREE_STRUC.TRE_DAT_TYPE AS DATTYPE,
  LU1.LKP_DESC_B              AS TYPE,
  NODAT.REC_TAG               AS ASSETID
FROM SYS_TREE_STRUC
INNER JOIN (((SYS_NODES_ATTRIB NODAT
LEFT JOIN TBL_REFERENCE_FILES RF
ON NODAT.REC_TAG = RF.RF_ASSET)
LEFT JOIN SYS_LOOKUPS LU1
ON RF.RF_TYPE = LU1.LKP_ID)
LEFT JOIN SYS_LOOKUPS LU2
ON RF.RF_PATH                 = LU2.LKP_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG = NODAT.REC_TAG
INNER JOIN SYS_TREE_STRUC SYS_TREE_STRUC1
ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC1.TRE_NOD_TAG
INNER JOIN SYS_NODES_ATTRIB
ON SYS_TREE_STRUC1.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_RF_03
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_RF_03" ("ASSETCODE", "ASSETTITLE", "DESCRIPTION", "CATEGORY", "FULLPATH", "DATTYPE", "ASSETID", "TYPE") AS 
  SELECT NODAT.NODE_ID           AS ASSETCODE,
  NODAT.NODE_DESC              AS ASSETTITLE,
  RF.RF_DESC                   AS DESCRIPTION,
  LU2.LKP_DESC_B               AS CATEGORY,
  LU2.LKP_DESC_B               AS FULLPATH,
  SYS_TREE_STRUC1.TRE_DAT_TYPE AS DATTYPE,
  SYS_NODES_ATTRIB.REC_TAG     AS ASSETID,
  LU1.LKP_DESC_B               AS TYPE
FROM SYS_TREE_STRUC
INNER JOIN (((SYS_NODES_ATTRIB NODAT
LEFT JOIN TBL_REFERENCE_FILES RF
ON NODAT.REC_TAG = RF.RF_ASSET)
LEFT JOIN SYS_LOOKUPS LU1
ON RF.RF_TYPE = LU1.LKP_ID)
LEFT JOIN SYS_LOOKUPS LU2
ON RF.RF_PATH                 = LU2.LKP_ID)
ON SYS_TREE_STRUC.TRE_DAT_TAG = NODAT.REC_TAG
INNER JOIN SYS_TREE_STRUC SYS_TREE_STRUC1
ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC1.TRE_NOD_TAG
INNER JOIN SYS_NODES_ATTRIB
ON SYS_TREE_STRUC1.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_SV_01
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_SV_01" ("SURVEYTITLE", "SURVEYTYPE", "STARTDATE", "ENDDATE", "CONTRACTOR") AS 
  SELECT
 SVY_MAIN.SVY_MAIN_TITLE  AS SurveyTitle,
        SYS_LOOKUPS.LKP_DESC_B       AS SurveyType,
        SVY_MAIN.SVY_MAIN_DATE_START AS StartDate,
        SVY_MAIN.SVY_MAIN_DATE_END   AS EndDate,
        SVY_MAIN.SYV_MAIN_CONTRACTOR AS Contractor
FROM
 SYS_LOOKUPS RIGHT JOIN TBL_SVY_MAIN  SVY_MAIN
 ON SYS_LOOKUPS.LKP_ID = SVY_MAIN.SVY_MAIN_TYPE_LKP_ID
WITH READ ONLY;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_SV_05
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_SV_05" ("GROUPCODE", "GROUPNAME", "ASSETCODE", "ASSETNAME", "ASSETLOCATION", "SURVEYEVENT", "LATESTINSPECTIONYEAR", "SURVEYCOUNT", "LATESTINSPECTIONDATE") AS 
  SELECT 
 NA1.NODE_ID AS GroupCode, 
 NA1.NODE_DESC AS GroupName, 
 NA.NODE_ID AS AssetCode, 
 NA.NODE_DESC AS AssetName, 
 TS.TRE_NOD_LOC AS AssetLocation, 
 TBL_SVY_EVENT.SVY_EVT_DESC AS SurveyEvent, 
 EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME) AS LatestInspectionYear, 
 Count(EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME)) AS SurveyCount, 
 Max(SVY_POS.SVY_POS_DATE_TIME) AS LatestInspectionDate 
FROM 
 (((((TBL_SVY_HEADER SVY_HDR LEFT JOIN TBL_SVY_POSITION SVY_POS 
 ON SVY_HDR.SVY_HDR_START_POS_ID = SVY_POS.SVY_POS_ID) 
 INNER JOIN SYS_NODES_ATTRIB NA 
 ON SVY_HDR.SVY_HDR_NOD_ID = NA.REC_TAG) 
 INNER JOIN SYS_TREE_STRUC TS 
 ON NA.REC_TAG = TS.TRE_DAT_TAG) 
 INNER JOIN SYS_TREE_STRUC TS1 
 ON TS.TRE_NOD_TAG_PAR = TS1.TRE_NOD_TAG) 
 INNER JOIN SYS_NODES_ATTRIB NA1 
 ON TS1.TRE_DAT_TAG = NA1.REC_TAG) 
 LEFT JOIN TBL_SVY_EVENT 
 ON SVY_HDR.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID 
WHERE 
 TS.TRE_DAT_TYPE=1 AND EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME) Is Not Null 
GROUP BY 
 NA1.NODE_ID, NA1.NODE_DESC, NA.NODE_ID, 
 NA.NODE_DESC, TS.TRE_NOD_LOC, TBL_SVY_EVENT.SVY_EVT_DESC, 
 EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME);
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_SV_05_N
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_SV_05_N" ("GROUPCODE", "GROUPNAME", "ASSETCODE", "ASSETNAME", "ASSETLOCATION", "SURVEYEVENT", "LATESTINSPECTIONYEAR", "SURVEYCOUNT", "LATESTINSPECTIONDATE") AS 
  SELECT 
 NA1.NODE_ID AS GroupCode, 
 NA1.NODE_DESC AS GroupName, 
 NA.NODE_ID AS AssetCode, 
 NA.NODE_DESC AS AssetName, 
 TS.TRE_NOD_LOC AS AssetLocation, 
 TBL_SVY_EVENT.SVY_EVT_DESC AS SurveyEvent, 
 EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME) AS LatestInspectionYear, 
 Count(EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME)) AS SurveyCount, 
 TO_CHAR(Max(SVY_POS.SVY_POS_DATE_TIME),'DD-MON') AS LatestInspectionDate 
FROM 
 (((((TBL_SVY_HEADER SVY_HDR LEFT JOIN TBL_SVY_POSITION SVY_POS 
 ON SVY_HDR.SVY_HDR_START_POS_ID = SVY_POS.SVY_POS_ID) 
 INNER JOIN SYS_NODES_ATTRIB NA 
 ON SVY_HDR.SVY_HDR_NOD_ID = NA.REC_TAG) 
 INNER JOIN SYS_TREE_STRUC TS 
 ON NA.REC_TAG = TS.TRE_DAT_TAG) 
 INNER JOIN SYS_TREE_STRUC TS1 
 ON TS.TRE_NOD_TAG_PAR = TS1.TRE_NOD_TAG) 
 INNER JOIN SYS_NODES_ATTRIB NA1 
 ON TS1.TRE_DAT_TAG = NA1.REC_TAG) 
 LEFT JOIN TBL_SVY_EVENT 
 ON SVY_HDR.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID 
WHERE 
 TS.TRE_DAT_TYPE=1 AND EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME) Is Not Null 
GROUP BY 
 NA1.NODE_ID, NA1.NODE_DESC, NA.NODE_ID, 
 NA.NODE_DESC, TS.TRE_NOD_LOC, TBL_SVY_EVENT.SVY_EVT_DESC, 
 EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME);
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_SV_06
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_SV_06" ("GROUPCODE", "GROUPNAME", "ASSETCODE", "ASSETNAME", "ASSETLOCATION", "SURVEYEVENT", "SURVEYCOUNT", "LATESTINSPECTIONDATE", "CAMPAIGN") AS 
  SELECT NA1.NODE_ID                  AS GroupCode,
  NA1.NODE_DESC                     AS GroupName,
  NA.NODE_ID                        AS AssetCode,
  NA.NODE_DESC                      AS AssetName,
  TS.TRE_NOD_LOC                    AS AssetLocation,
  TBL_SVY_EVENT.SVY_EVT_DESC        AS SurveyEvent,
  COUNT(TBL_SVY_EVENT.SVY_EVT_DESC) AS SurveyCount,
  MAX(SVY_POS.SVY_POS_DATE_TIME)    AS LatestInspectionDate,
  TBL_SVY_MAIN.SVY_MAIN_TITLE       AS Campaign
FROM (((((TBL_SVY_HEADER SVY_HDR
LEFT JOIN TBL_SVY_POSITION SVY_POS
ON SVY_HDR.SVY_HDR_START_POS_ID = SVY_POS.SVY_POS_ID)
INNER JOIN SYS_NODES_ATTRIB NA
ON SVY_HDR.SVY_HDR_NOD_ID = NA.REC_TAG)
INNER JOIN SYS_TREE_STRUC TS
ON NA.REC_TAG = TS.TRE_DAT_TAG)
INNER JOIN SYS_TREE_STRUC TS1
ON TS.TRE_NOD_TAG_PAR = TS1.TRE_NOD_TAG)
INNER JOIN SYS_NODES_ATTRIB NA1
ON TS1.TRE_DAT_TAG = NA1.REC_TAG)
LEFT JOIN TBL_SVY_EVENT
ON SVY_HDR.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN TBL_SVY_MAIN
ON SVY_HDR.SVY_HDR_MAIN_ID      = TBL_SVY_MAIN.SVY_MAIN_ID
WHERE TS.TRE_DAT_TYPE           = 1
AND TBL_SVY_EVENT.SVY_EVT_DESC IS NOT NULL
GROUP BY NA1.NODE_ID,
  NA1.NODE_DESC,
  NA.NODE_ID,
  NA.NODE_DESC,
  TS.TRE_NOD_LOC,
  TBL_SVY_EVENT.SVY_EVT_DESC,
  TBL_SVY_MAIN.SVY_MAIN_TITLE;
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_SV_ALL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_SV_ALL" ("ASSETCODE", "ASSETTITLE", "EVENT", "STARTEASTING", "ENDEASTING", "STARTNORTHING", "ENDNORTHING", "STARTDATE", "STARTKP", "ENDKP", "SURVEYCOMMENTS", "SURVEYTITLE", "ASSETLOCATION") AS 
  SELECT
 AssetCode,
        AssetTitle,
        Event,
        StartEasting,
        EndEasting,
        StartNorthing,
        EndNorthing,
        StartDate,
        StartKP,
        EndKP,
        SurveyComments,
        SurveyTitle,
        AssetLocation
FROM (SELECT
 NODAT.NODE_ID     AS AssetCode,
        NODAT.NODE_DESC           AS AssetTitle,
        SVY_EVENT.SVY_EVT_DESC    AS Event,
        STARTNOW.SVY_POS_EASTING   AS StartEasting,
        ENDDO.SVY_POS_EASTING     AS EndEasting,
        STARTNOW.SVY_POS_NORTHING  AS StartNorthing,
        ENDDO.SVY_POS_NORTHING    AS EndNorthing,
        STARTNOW.SVY_POS_DATE_TIME AS StartDate,
        STARTNOW.SVY_POS_KP        AS StartKP,
        ENDDO.SVY_POS_KP          AS EndKP,
        SVY_HDR.SVY_HDR_COMMENT   AS SurveyComments,
        SVY_MAIN.SVY_MAIN_TITLE   AS SurveyTitle,
        SYS_TREE_STRUC.TRE_NOD_LOC AS AssetLocation
FROM
 SYS_TREE_STRUC INNER JOIN (
  SYS_NODES_ATTRIB NODAT INNER JOIN
          (((TBL_SVY_EVENT SVY_EVENT INNER JOIN
                         (TBL_SVY_HEADER SVY_HDR INNER JOIN
    TBL_SVY_MAIN SVY_MAIN
                                ON SVY_HDR.SVY_HDR_MAIN_ID=SVY_MAIN.SVY_MAIN_ID)
                        ON SVY_EVENT.SVY_EVT_ID=SVY_HDR.SVY_HDR_EVT_ID)
                 INNER JOIN TBL_SVY_POSITION STARTNOW
                 ON SVY_HDR.SVY_HDR_START_POS_ID=STARTNOW.SVY_POS_ID)
          INNER JOIN TBL_SVY_POSITION ENDDO
   ON SVY_HDR.SVY_HDR_END_POS_ID=ENDDO.SVY_POS_ID)
  ON NODAT.REC_TAG=SVY_HDR.SVY_HDR_NOD_ID)
 ON SYS_TREE_STRUC.TRE_DAT_TAG = NODAT.REC_TAG
WHERE
 SYS_TREE_STRUC.TRE_DAT_TYPE=1
);
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_SV_N
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_SV_N" ("GROUPCODE", "GROUPNAME", "ASSETCODE", "ASSETNAME", "ASSETLOCATION", "SURVEYEVENT", "LATESTINSPECTIONYEAR", "SURVEYCOUNT", "LATESTINSPECTIONDATE") AS 
  SELECT 
 NA1.NODE_ID AS GroupCode, 
 NA1.NODE_DESC AS GroupName, 
 NA.NODE_ID AS AssetCode, 
 NA.NODE_DESC AS AssetName, 
 TS.TRE_NOD_LOC AS AssetLocation, 
 TBL_SVY_EVENT.SVY_EVT_DESC AS SurveyEvent, 
 EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME) AS LatestInspectionYear, 
 Count(EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME)) AS SurveyCount, 
 Max(SVY_POS.SVY_POS_DATE_TIME) AS LatestInspectionDate 
FROM 
 (((((TBL_SVY_HEADER SVY_HDR LEFT JOIN TBL_SVY_POSITION SVY_POS 
 ON SVY_HDR.SVY_HDR_START_POS_ID = SVY_POS.SVY_POS_ID) 
 INNER JOIN SYS_NODES_ATTRIB NA 
 ON SVY_HDR.SVY_HDR_NOD_ID = NA.REC_TAG) 
 INNER JOIN SYS_TREE_STRUC TS 
 ON NA.REC_TAG = TS.TRE_DAT_TAG) 
 INNER JOIN SYS_TREE_STRUC TS1 
 ON TS.TRE_NOD_TAG_PAR = TS1.TRE_NOD_TAG) 
 INNER JOIN SYS_NODES_ATTRIB NA1 
 ON TS1.TRE_DAT_TAG = NA1.REC_TAG) 
 LEFT JOIN TBL_SVY_EVENT 
 ON SVY_HDR.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID 
WHERE 
 TS.TRE_DAT_TYPE=1 AND EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME) Is Not Null 
GROUP BY 
 NA1.NODE_ID, NA1.NODE_DESC, NA.NODE_ID, 
 NA.NODE_DESC, TS.TRE_NOD_LOC, TBL_SVY_EVENT.SVY_EVT_DESC, 
 EXTRACT(YEAR FROM SVY_POS.SVY_POS_DATE_TIME);
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_SV_NYCOL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_SV_NYCOL" ("LatestInspectionYear") AS 
  select listagg(LatestInspectionYear, ',') within group (order by LatestInspectionYear)
from (
   select distinct LatestInspectionYear 
   from SYS_Q_RPT_SV_05
);
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_SV_NYCOL_EVNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_SV_NYCOL_EVNT" ("SURVEYEVENT") AS 
  select listagg('''' || SURVEYEVENT || '''' || ' as ' || REPLACE(REPLACE(SURVEYEVENT,' ','_'),'-',''), ',') within group (order by SURVEYEVENT) as SURVEYEVENT
from (
   select distinct SURVEYEVENT 
   from SYS_Q_RPT_SV_05
);
--------------------------------------------------------
--  DDL for View SYS_Q_RPT_SV_NYCOL_EVNT_C
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."SYS_Q_RPT_SV_NYCOL_EVNT_C" ("SURVEYEVENT") AS 
  select listagg(REPLACE(REPLACE(SURVEYEVENT,' ','_'),'-',''), ',') within group (order by SURVEYEVENT) as SURVEYEVENT
from (
   select distinct SURVEYEVENT 
   from SYS_Q_RPT_SV_05
);
--------------------------------------------------------
--  DDL for View V_ACTIVE_USERS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ACTIVE_USERS" ("USER_ID", "USER_NAME") AS 
  SELECT TBL_USERS.USER_ID,
  TBL_USERS.USER_NAME
FROM TBL_USERS
INNER JOIN TBL_USER_PARAMS
ON TBL_USERS.USER_ID                = TBL_USER_PARAMS.USER_ID
WHERE (TBL_USER_PARAMS.PARAM_LKP_ID = 8050)
OR (TBL_USER_PARAMS.PARAM_LKP_ID    = 8051)
OR (TBL_USER_PARAMS.PARAM_LKP_ID    = 8052)
ORDER BY TBL_USERS.USER_NAME WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_AIF_TBL_ANOM_ACT_ITEMS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_AIF_TBL_ANOM_ACT_ITEMS" ("BUSS_UNIT", "LEVEL1_NODE_ID", "LEVEL1_NODE_DESC", "LEVEL2_NODE_ID", "LEVEL2_NODE_DESC", "LEVEL3_NODE_ID", "LEVEL3_NODE_DESC", "NODE_ID", "NODE_DESC", "AN_REF", "AI_REF_NO", "AI_ACT_PARTY1", "AI_ACT_PARTY2", "AI_TARGET_DATE", "AI_ACT_START_DATE", "AI_ACT_END_DATE", "AI_MHOURS", "AI_STAT_SYS", "AI_DETAILS", "AI_NOTES", "AI_UPDATED_DATE", "AI_RAISED_DATE", "AI_RAISED_BY_SYS", "AI_UPDATED_BY_SYS", "AI_TITLE", "AI_PRIORITY_SYS", "AN_RAISED_BY", "AN_RAISED_DATE", "AI_ACT_PARTY1_ID", "AI_ACT_PARTY2_ID") AS 
  SELECT
     T1.BUSS_UNIT,
     T1.LEVEL1_NODE_ID,
     T1.LEVEL1_NODE_DESC,
     T1.LEVEL2_NODE_ID,
     T1.LEVEL2_NODE_DESC,
     T1.LEVEL3_NODE_ID,
     T1.LEVEL3_NODE_DESC,
     T1.NODE_ID,
     T1.NODE_DESC,
     T1.AN_REF,
     T1.AI_REF_NO,
     T1.AI_ACT_PARTY1,
     T1.AI_ACT_PARTY2,
     T1.AI_TARGET_DATE,
     T1.AI_ACT_START_DATE,
     T1.AI_ACT_END_DATE,
     T1.AI_MHOURS,
     T1.AI_STAT_SYS,
     T1.AI_DETAILS,
     T1.AI_NOTES,
     T1.AI_UPDATED_DATE,
     T1.AI_RAISED_DATE,
     T1.AI_RAISED_BY_SYS,
     T1.AI_UPDATED_BY_SYS,
     T1.AI_TITLE,
     T1.AI_PRIORITY_SYS,
     T1.AN_RAISED_BY,
     T1.AN_RAISED_DATE,
     V_TBL_USERS_EMAIL1.MAX_PARAM_TEXT       AS AI_ACT_PARTY1_ID,
     IMSA.V_TBL_USERS_EMAIL.MAX_PARAM_TEXT   AS AI_ACT_PARTY2_ID
 FROM
     (
         SELECT
             *
         FROM
             V_AIF_TBL_ANOM_ACT_ITEMS_SUB_1
     ) T1
     LEFT JOIN IMSA.V_TBL_USERS_EMAIL ON T1.AI_ACT_PARTY1 = IMSA.V_TBL_USERS_EMAIL.USER_NAME
     LEFT JOIN IMSA.V_TBL_USERS_EMAIL V_TBL_USERS_EMAIL1 ON T1.AI_ACT_PARTY2 = V_TBL_USERS_EMAIL1.USER_NAME
 ORDER BY
     T1.AN_REF DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_AIF_TBL_ANOM_ACT_ITEMS_SUB_1
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_AIF_TBL_ANOM_ACT_ITEMS_SUB_1" ("BUSS_UNIT", "LEVEL1_NODE_ID", "LEVEL1_NODE_DESC", "LEVEL2_NODE_ID", "LEVEL2_NODE_DESC", "LEVEL3_NODE_ID", "LEVEL3_NODE_DESC", "NODE_ID", "NODE_DESC", "AN_REF", "AI_REF_NO", "AI_ACT_PARTY1", "AI_ACT_PARTY2", "AI_TARGET_DATE", "AI_ACT_START_DATE", "AI_ACT_END_DATE", "AI_MHOURS", "AI_STAT_SYS", "AI_DETAILS", "AI_NOTES", "AI_UPDATED_DATE", "AI_RAISED_DATE", "AI_RAISED_BY_SYS", "AI_UPDATED_BY_SYS", "AI_TITLE", "AI_PRIORITY_SYS", "AN_RAISED_BY", "AN_RAISED_DATE") AS 
  SELECT
     CASE
         WHEN T1.LEVEL2_NODE_ID = 'SE' THEN 'GOM'
         WHEN T1.LEVEL2_NODE_ID = 'BR' THEN 'BRAZIL'
         ELSE 'NON-SHELL'
     END AS BUSS_UNIT,
     T1.LEVEL1_NODE_ID,
     T1.LEVEL1_NODE_ID
     || ' - '
     || T1.LEVEL1_NODE_DESC AS LEVEL1_NODE_DESC,
     T1.LEVEL2_NODE_ID,
     T1.LEVEL2_NODE_ID
     || ' - '
     || T1.LEVEL2_NODE_DESC AS LEVEL2_NODE_DESC,
     T1.LEVEL3_NODE_ID,
     T1.LEVEL3_NODE_ID
     || ' - '
     || T1.LEVEL3_NODE_DESC AS LEVEL3_NODE_DESC,
     T2.NODE_ID,
     T2.NODE_DESC,
     T2.AN_REF,
     T2.AI_REF_NO,
     T2.AI_ACT_PARTY1,
     T2.AI_ACT_PARTY2,
     T2.AI_TARGET_DATE,
     T2.AI_ACT_START_DATE,
     T2.AI_ACT_END_DATE,
     T2.AI_MHOURS,
     T2.AI_STAT_SYS,
     T2.AI_DETAILS,
     T2.AI_NOTES,
     T2.AI_UPDATED_DATE,
     T2.AI_RAISED_DATE,
     T2.AI_RAISED_BY_SYS,
     T2.AI_UPDATED_BY_SYS,
     T2.AI_TITLE,
     T2.AI_PRIORITY_SYS,
     T2.AN_RAISED_BY,
     T2.AN_RAISED_DATE
 FROM
     (
         SELECT
             V_TBL_ANOM_MAIN.AN_ID,
             V_TBL_ANOM_MAIN.AN_ASSET_ID,
             V_TBL_ANOM_ACT_ITEMS.AN_REF,
             V_TBL_ANOM_ACT_ITEMS.AI_ID,
             V_TBL_ANOM_ACT_ITEMS.AI_REF_NO,
             V_TBL_ANOM_ACT_ITEMS.AI_ACT_PARTY1,
             V_TBL_ANOM_ACT_ITEMS.AI_ACT_PARTY2,
             V_TBL_ANOM_ACT_ITEMS.AI_TARGET_DATE,
             V_TBL_ANOM_ACT_ITEMS.AI_ACT_START_DATE,
             V_TBL_ANOM_ACT_ITEMS.AI_ACT_END_DATE,
             V_TBL_ANOM_ACT_ITEMS.AI_MHOURS,
             V_TBL_ANOM_ACT_ITEMS.AI_STAT,
             V_TBL_ANOM_ACT_ITEMS.AI_STAT_SYS,
             V_TBL_ANOM_ACT_ITEMS.AI_NO,
             V_TBL_ANOM_ACT_ITEMS.AI_AN_ID,
             V_TBL_ANOM_ACT_ITEMS.AI_DETAILS,
             V_TBL_ANOM_ACT_ITEMS.AI_NOTES,
             V_TBL_ANOM_ACT_ITEMS.AI_UPDATED_DATE,
             V_TBL_ANOM_ACT_ITEMS.AI_RAISED_BY,
             V_TBL_ANOM_ACT_ITEMS.AI_RAISED_DATE,
             V_TBL_ANOM_ACT_ITEMS.AI_UPDATED_BY,
             V_TBL_ANOM_ACT_ITEMS.AI_RAISED_BY_SYS,
             V_TBL_ANOM_ACT_ITEMS.AI_UPDATED_BY_SYS,
             V_TBL_ANOM_ACT_ITEMS.AI_TITLE,
             V_TBL_ANOM_ACT_ITEMS.AI_PRIORITY,
             V_TBL_ANOM_ACT_ITEMS.AI_PRIORITY_SYS,
             V_TBL_ANOM_ACT_ITEMS.AN_RAISED_BY,
             V_TBL_ANOM_ACT_ITEMS.AN_RAISED_DATE,
             V_TBL_ANOM_ACT_ITEMS.NODE_ID,
             V_TBL_ANOM_ACT_ITEMS.NODE_DESC
         FROM
             V_TBL_ANOM_MAIN
             INNER JOIN V_TBL_ANOM_ACT_ITEMS ON V_TBL_ANOM_MAIN.AN_ID = V_TBL_ANOM_ACT_ITEMS.AI_AN_ID
     ) T2
     INNER JOIN (
         SELECT
             SYS_TREE_STRUC.TRE_DAT_TAG,
             LEVEL   AS L,
             CONNECT_BY_ROOT SYS_NODES_ATTRIB.NODE_ID AS LEVEL1_NODE_ID,
             CONNECT_BY_ROOT SYS_NODES_ATTRIB.NODE_DESC AS LEVEL1_NODE_DESC,
             LTRIM(RTRIM(SYS_CONNECT_BY_PATH(CASE
                 WHEN LEVEL = 2 THEN SYS_NODES_ATTRIB.NODE_ID
                 ELSE NULL
             END,'>'),'>'),'>') AS LEVEL2_NODE_ID,
             LTRIM(RTRIM(SYS_CONNECT_BY_PATH(CASE
                 WHEN LEVEL = 2 THEN SYS_NODES_ATTRIB.NODE_DESC
                 ELSE NULL
             END,'>'),'>'),'>') AS LEVEL2_NODE_DESC,
             LTRIM(RTRIM(SYS_CONNECT_BY_PATH(CASE
                 WHEN LEVEL = 3 THEN SYS_NODES_ATTRIB.NODE_ID
                 ELSE NULL
             END,'>'),'>'),'>') AS LEVEL3_NODE_ID,
             LTRIM(RTRIM(SYS_CONNECT_BY_PATH(CASE
                 WHEN LEVEL = 3 THEN SYS_NODES_ATTRIB.NODE_DESC
                 ELSE NULL
             END,'>'),'>'),'>') AS LEVEL3_NODE_DESC
         FROM
             SYS_TREE_STRUC
             INNER JOIN SYS_NODES_ATTRIB ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
         WHERE
             SYS_TREE_STRUC.TRE_DAT_TYPE = 1
         START WITH
             SYS_TREE_STRUC.TRE_DAT_TAG = 45488
         CONNECT BY
             PRIOR SYS_TREE_STRUC.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG_PAR
     ) T1 ON T1.TRE_DAT_TAG = T2.AN_ASSET_ID
 GROUP BY
     CASE
         WHEN T1.LEVEL2_NODE_ID = 'SE' THEN 'GOM'
         WHEN T1.LEVEL2_NODE_ID = 'BR' THEN 'BRAZIL'
         ELSE 'NON-SHELL'
     END,
     T1.LEVEL1_NODE_ID,
     T1.LEVEL1_NODE_ID
     || ' - '
     || T1.LEVEL1_NODE_DESC,
     T1.LEVEL2_NODE_ID,
     T1.LEVEL2_NODE_ID
     || ' - '
     || T1.LEVEL2_NODE_DESC,
     T1.LEVEL3_NODE_ID,
     T1.LEVEL3_NODE_ID
     || ' - '
     || T1.LEVEL3_NODE_DESC,
     T2.NODE_ID,
     T2.NODE_DESC,
     T2.AN_REF,
     T2.AI_REF_NO,
     T2.AI_ACT_PARTY1,
     T2.AI_ACT_PARTY2,
     T2.AI_TARGET_DATE,
     T2.AI_ACT_START_DATE,
     T2.AI_ACT_END_DATE,
     T2.AI_MHOURS,
     T2.AI_STAT_SYS,
     T2.AI_DETAILS,
     T2.AI_NOTES,
     T2.AI_UPDATED_DATE,
     T2.AI_RAISED_DATE,
     T2.AI_RAISED_BY_SYS,
     T2.AI_UPDATED_BY_SYS,
     T2.AI_TITLE,
     T2.AI_PRIORITY_SYS,
     T2.AN_RAISED_BY,
     T2.AN_RAISED_DATE,
     T2.AN_ID
 ORDER BY
     T2.AN_ID DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_AIF_TBL_ANOM_MAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_AIF_TBL_ANOM_MAIN" ("BUSS_UNIT", "LEVEL1_NODE_ID", "LEVEL1_NODE_DESC", "LEVEL2_NODE_ID", "LEVEL2_NODE_DESC", "LEVEL3_NODE_ID", "LEVEL3_NODE_DESC", "NODE_ID", "NODE_DESC", "AN_REF", "AN_ACT_BY_DATE_MAX", "AN_ACT_BY_DATE", "ANTYPE_NAME", "ANTYPE_GROUP_SYS", "AN_STATUS_SYS", "AN_RAISED_BY", "AN_RAISED_DATE", "AN_ORIG_CLASS_SYS", "AN_CURR_CLASS_SYS", "AN_REVNO", "AN_ASS_DATE", "AN_ASS_BY", "AN_ACT_PARTY", "AN_MAINT_REQ_SYS", "AN_WO_REF", "AN_WO_STATUS", "AN_DATE_IDENT", "AN_ACT_REQ", "AN_EQ_FAILURE", "AN_TA_APPROVED", "AN_TA_NAME", "AN_TA_APPR_DATE", "AN_ORIG_AVAIL_CLASS_SYS", "AN_CURR_AVAIL_CLASS_SYS", "AN_AVAIL_UPD_DATE", "AN_AVAIL_UPD_BY", "AN_UPD_DATE", "AN_UPD_BY", "AN_FNCR_REQUIRED", "AN_FNCR", "AN_LIFE_TERM_SYS", "AN_PORTFOLIO_APPL", "AN_RISK_RANK_SEVERITY_SYS", "AN_RISK_RANK_SEVERITY_SYS_2", "AN_RISK_RANK_LIKELIHOOD_SYS", "AN_RISK_RANK_LIKELIHOOD_SYS_2", "AN_RISK_RANK_SYS", "AN_START_EAST", "AN_END_EAST", "AN_DESC", "AN_START_NORTH", "AN_END_NORTH", "AN_RECCMD", "AN_ASSMNT", "AN_DELETED", "AN_AVAIL_COMMENTS", "AN_TITLE", "AN_ATTACHMENTS", "AN_RISK_RANK_COMMENTS", "AN_ASIS_STATUS", "AN_PT_SUPPORT", "AN_ASIS_STATUS_SYS", "AN_WO_STATUS_SYS", "NODE_GROUP", "PS_CODES", "AN_UPD_BY_ID", "AN_RAISED_BY_ID") AS 
  SELECT
     T1.BUSS_UNIT,
     T1.LEVEL1_NODE_ID,
     T1.LEVEL1_NODE_DESC,
     T1.LEVEL2_NODE_ID,
     T1.LEVEL2_NODE_DESC,
     T1.LEVEL3_NODE_ID,
     T1.LEVEL3_NODE_DESC,
     T1.NODE_ID,
     T1.NODE_DESC,
     T1.AN_REF,
     T1.AN_ACT_BY_DATE_MAX,
     T1.AN_ACT_BY_DATE,
     T1.ANTYPE_NAME,
     T1.ANTYPE_GROUP_SYS,
     T1.AN_STATUS_SYS,
     T1.AN_RAISED_BY,
     T1.AN_RAISED_DATE,
     T1.AN_ORIG_CLASS_SYS,
     T1.AN_CURR_CLASS_SYS,
     T1.AN_REVNO,
     T1.AN_ASS_DATE,
     T1.AN_ASS_BY,
     T1.AN_ACT_PARTY,
     T1.AN_MAINT_REQ_SYS,
     T1.AN_WO_REF,
     T1.AN_WO_STATUS,
     T1.AN_DATE_IDENT,
     T1.AN_ACT_REQ,
     T1.AN_EQ_FAILURE,
     T1.AN_TA_APPROVED,
     T1.AN_TA_NAME,
     T1.AN_TA_APPR_DATE,
     T1.AN_ORIG_AVAIL_CLASS_SYS,
     T1.AN_CURR_AVAIL_CLASS_SYS,
     T1.AN_AVAIL_UPD_DATE,
     T1.AN_AVAIL_UPD_BY,
     T1.AN_UPD_DATE,
     T1.AN_UPD_BY,
     T1.AN_FNCR_REQUIRED,
     T1.AN_FNCR,
     T1.AN_LIFE_TERM_SYS,
     T1.AN_PORTFOLIO_APPL,
     T1.AN_RISK_RANK_SEVERITY_SYS,
     T1.AN_RISK_RANK_SEVERITY_SYS_2,
     T1.AN_RISK_RANK_LIKELIHOOD_SYS,
     T1.AN_RISK_RANK_LIKELIHOOD_SYS_2,
     T1.AN_RISK_RANK_SYS,
     T1.AN_START_EAST,
     T1.AN_END_EAST,
     T1.AN_DESC,
     T1.AN_START_NORTH,
     T1.AN_END_NORTH,
     T1.AN_RECCMD,
     T1.AN_ASSMNT,
     T1.AN_DELETED,
     T1.AN_AVAIL_COMMENTS,
     T1.AN_TITLE,
     T1.AN_ATTACHMENTS,
     T1.AN_RISK_RANK_COMMENTS,
     T1.AN_ASIS_STATUS,
     T1.AN_PT_SUPPORT,
     T1.AN_ASIS_STATUS_SYS,
     T1.AN_WO_STATUS_SYS,
     T1.NODE_GROUP,
     T1.PS_CODES,
     V_TBL_USERS_EMAIL.MAX_PARAM_TEXT    AS AN_UPD_BY_ID,
     V_TBL_USERS_EMAIL1.MAX_PARAM_TEXT   AS AN_RAISED_BY_ID
 FROM
     (
         SELECT
             V_AIF_TBL_ANOM_MAIN_SUB_1.BUSS_UNIT,
             V_AIF_TBL_ANOM_MAIN_SUB_1.LEVEL1_NODE_ID,
             V_AIF_TBL_ANOM_MAIN_SUB_1.LEVEL1_NODE_DESC,
             V_AIF_TBL_ANOM_MAIN_SUB_1.LEVEL2_NODE_ID,
             V_AIF_TBL_ANOM_MAIN_SUB_1.LEVEL2_NODE_DESC,
             V_AIF_TBL_ANOM_MAIN_SUB_1.LEVEL3_NODE_ID,
             V_AIF_TBL_ANOM_MAIN_SUB_1.LEVEL3_NODE_DESC,
             V_AIF_TBL_ANOM_MAIN_SUB_1.NODE_ID,
             V_AIF_TBL_ANOM_MAIN_SUB_1.NODE_DESC,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_REF,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ACT_BY_DATE_MAX,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ACT_BY_DATE,
             V_AIF_TBL_ANOM_MAIN_SUB_1.ANTYPE_NAME,
             V_AIF_TBL_ANOM_MAIN_SUB_1.ANTYPE_GROUP_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_STATUS_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_RAISED_BY,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_RAISED_DATE,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ORIG_CLASS_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_CURR_CLASS_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_REVNO,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ASS_DATE,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ASS_BY,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ACT_PARTY,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_MAINT_REQ_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_WO_REF,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_WO_STATUS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_DATE_IDENT,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ACT_REQ,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_EQ_FAILURE,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_TA_APPROVED,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_TA_NAME,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_TA_APPR_DATE,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ORIG_AVAIL_CLASS_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_CURR_AVAIL_CLASS_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_AVAIL_UPD_DATE,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_AVAIL_UPD_BY,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_UPD_DATE,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_UPD_BY,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_FNCR_REQUIRED,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_FNCR,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_LIFE_TERM_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_PORTFOLIO_APPL,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_RISK_RANK_SEVERITY_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_RISK_RANK_SEVERITY_SYS_2,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_RISK_RANK_LIKELIHOOD_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_RISK_RANK_LIKELIHOOD_SYS_2,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_RISK_RANK_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_START_EAST,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_END_EAST,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_DESC,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_START_NORTH,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_END_NORTH,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_RECCMD,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ASSMNT,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_DELETED,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_AVAIL_COMMENTS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_TITLE,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ATTACHMENTS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_RISK_RANK_COMMENTS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ASIS_STATUS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_PT_SUPPORT,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_ASIS_STATUS_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.AN_WO_STATUS_SYS,
             V_AIF_TBL_ANOM_MAIN_SUB_1.NODE_GROUP,
             V_AIF_TBL_ANOM_MAIN_SUB_1.PS_CODES
         FROM
             V_AIF_TBL_ANOM_MAIN_SUB_1
     ) T1
     LEFT JOIN V_TBL_USERS_EMAIL ON T1.AN_UPD_BY = V_TBL_USERS_EMAIL.USER_NAME
     LEFT JOIN V_TBL_USERS_EMAIL V_TBL_USERS_EMAIL1 ON T1.AN_RAISED_BY = V_TBL_USERS_EMAIL1.USER_NAME
 ORDER BY
     T1.AN_REF DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_AIF_TBL_ANOM_MAIN_SUB_1
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_AIF_TBL_ANOM_MAIN_SUB_1" ("BUSS_UNIT", "LEVEL1_NODE_ID", "LEVEL1_NODE_DESC", "LEVEL2_NODE_ID", "LEVEL2_NODE_DESC", "LEVEL3_NODE_ID", "LEVEL3_NODE_DESC", "NODE_ID", "NODE_DESC", "AN_REF", "AN_ACT_BY_DATE_MAX", "AN_ACT_BY_DATE", "ANTYPE_NAME", "ANTYPE_GROUP_SYS", "AN_STATUS_SYS", "AN_RAISED_BY", "AN_RAISED_DATE", "AN_ORIG_CLASS_SYS", "AN_CURR_CLASS_SYS", "AN_REVNO", "AN_ASS_DATE", "AN_ASS_BY", "AN_ACT_PARTY", "AN_MAINT_REQ_SYS", "AN_WO_REF", "AN_WO_STATUS", "AN_DATE_IDENT", "AN_ACT_REQ", "AN_EQ_FAILURE", "AN_TA_APPROVED", "AN_TA_NAME", "AN_TA_APPR_DATE", "AN_ORIG_AVAIL_CLASS_SYS", "AN_CURR_AVAIL_CLASS_SYS", "AN_AVAIL_UPD_DATE", "AN_AVAIL_UPD_BY", "AN_UPD_DATE", "AN_UPD_BY", "AN_FNCR_REQUIRED", "AN_FNCR", "AN_LIFE_TERM_SYS", "AN_PORTFOLIO_APPL", "AN_RISK_RANK_SEVERITY_SYS", "AN_RISK_RANK_SEVERITY_SYS_2", "AN_RISK_RANK_LIKELIHOOD_SYS", "AN_RISK_RANK_LIKELIHOOD_SYS_2", "AN_RISK_RANK_SYS", "AN_START_EAST", "AN_END_EAST", "AN_DESC", "AN_START_NORTH", "AN_END_NORTH", "AN_RECCMD", "AN_ASSMNT", "AN_DELETED", "AN_AVAIL_COMMENTS", "AN_TITLE", "AN_ATTACHMENTS", "AN_RISK_RANK_COMMENTS", "AN_ASIS_STATUS", "AN_PT_SUPPORT", "AN_ASIS_STATUS_SYS", "AN_WO_STATUS_SYS", "NODE_GROUP", "PS_CODES") AS 
  SELECT
     CASE
         WHEN T1.LEVEL2_NODE_ID = 'SE' THEN 'GOM'
         WHEN T1.LEVEL2_NODE_ID = 'BR' THEN 'BRAZIL'
         ELSE 'NON-SHELL'
     END AS BUSS_UNIT,
     T1.LEVEL1_NODE_ID,
     T1.LEVEL1_NODE_ID
     || ' - '
     || T1.LEVEL1_NODE_DESC AS LEVEL1_NODE_DESC,
     T1.LEVEL2_NODE_ID,
     T1.LEVEL2_NODE_ID
     || ' - '
     || T1.LEVEL2_NODE_DESC AS LEVEL2_NODE_DESC,
     T1.LEVEL3_NODE_ID,
     T1.LEVEL3_NODE_ID
     || ' - '
     || T1.LEVEL3_NODE_DESC AS LEVEL3_NODE_DESC,
     T2.NODE_ID,
     T2.NODE_DESC,
     T2.AN_REF,
     T2.AN_ACT_BY_DATE_MAX,
     T2.AN_ACT_BY_DATE,
     T2.ANTYPE_NAME,
     T2.ANTYPE_GROUP_SYS,
     T2.AN_STATUS_SYS,
     T2.AN_RAISED_BY,
     T2.AN_RAISED_DATE,
     T2.AN_ORIG_CLASS_SYS,
     T2.AN_CURR_CLASS_SYS,
     T2.AN_REVNO,
     T2.AN_ASS_DATE,
     T2.AN_ASS_BY,
     T2.AN_ACT_PARTY,
     T2.AN_MAINT_REQ_SYS,
     T2.AN_WO_REF,
     T2.AN_WO_STATUS,
     T2.AN_DATE_IDENT,
     T2.AN_ACT_REQ,
     T2.AN_EQ_FAILURE,
     T2.AN_TA_APPROVED,
     T2.AN_TA_NAME,
     T2.AN_TA_APPR_DATE,
     T2.AN_ORIG_AVAIL_CLASS_SYS,
     T2.AN_CURR_AVAIL_CLASS_SYS,
     T2.AN_AVAIL_UPD_DATE,
     T2.AN_AVAIL_UPD_BY,
     T2.AN_UPD_DATE,
     T2.AN_UPD_BY,
     T2.AN_FNCR_REQUIRED,
     T2.AN_FNCR,
     T2.AN_LIFE_TERM_SYS,
     T2.AN_PORTFOLIO_APPL,
     T2.AN_RISK_RANK_SEVERITY_SYS,
     T2.AN_RISK_RANK_SEVERITY_SYS_2,
     T2.AN_RISK_RANK_LIKELIHOOD_SYS,
     T2.AN_RISK_RANK_LIKELIHOOD_SYS_2,
     T2.AN_RISK_RANK_SYS,
     T2.AN_START_EAST,
     T2.AN_END_EAST,
     T2.AN_DESC,
     T2.AN_START_NORTH,
     T2.AN_END_NORTH,
     T2.AN_RECCMD,
     T2.AN_ASSMNT,
     T2.AN_DELETED,
     T2.AN_AVAIL_COMMENTS,
     T2.AN_TITLE,
     T2.AN_ATTACHMENTS,
     T2.AN_RISK_RANK_COMMENTS,
     T2.AN_ASIS_STATUS,
     T2.AN_PT_SUPPORT,
     T2.AN_ASIS_STATUS_SYS,
     T2.AN_WO_STATUS_SYS,
     T2.NODE_GROUP,
     T2.PS_CODES
 FROM
     (
         SELECT
             V_TBL_ANOM_MAIN.AN_ID,
             V_TBL_ANOM_MAIN.AN_ASSET_ID,
             V_TBL_ANOM_MAIN.AN_REF,
             V_TBL_ANOM_MAIN.NODE_ID,
             V_TBL_ANOM_MAIN.NODE_DESC,
             V_TBL_ANOM_MAIN.AN_ACT_BY_DATE_MAX,
             V_TBL_ANOM_MAIN.AN_ACT_BY_DATE,
             V_TBL_ANOM_MAIN.AN_TYPE,
             V_TBL_ANOM_MAIN.ANTYPE_NAME,
             V_TBL_ANOM_MAIN.ANTYPE_GROUP,
             V_TBL_ANOM_MAIN.ANTYPE_GROUP_SYS,
             V_TBL_ANOM_MAIN.AN_STATUS,
             V_TBL_ANOM_MAIN.AN_STATUS_SYS,
             V_TBL_ANOM_MAIN.AN_RAISED_BY,
             V_TBL_ANOM_MAIN.AN_RAISED_DATE,
             V_TBL_ANOM_MAIN.AN_ORIG_CLASS,
             V_TBL_ANOM_MAIN.AN_ORIG_CLASS_SYS,
             V_TBL_ANOM_MAIN.AN_CURR_CLASS,
             V_TBL_ANOM_MAIN.AN_CURR_CLASS_SYS,
             V_TBL_ANOM_MAIN.AN_REVNO,
             V_TBL_ANOM_MAIN.AN_ASS_DATE,
             V_TBL_ANOM_MAIN.AN_ASS_BY,
             V_TBL_ANOM_MAIN.AN_ACT_PARTY,
             V_TBL_ANOM_MAIN.AN_MAINT_REQ,
             V_TBL_ANOM_MAIN.AN_MAINT_REQ_SYS,
             V_TBL_ANOM_MAIN.AN_WO_REF,
             V_TBL_ANOM_MAIN.AN_WO_STATUS,
             V_TBL_ANOM_MAIN.AN_DATE_IDENT,
             V_TBL_ANOM_MAIN.AN_ACT_REQ,
             V_TBL_ANOM_MAIN.AN_EQ_FAILURE,
             V_TBL_ANOM_MAIN.AN_TA_APPROVED,
             V_TBL_ANOM_MAIN.AN_TA_NAME,
             V_TBL_ANOM_MAIN.AN_TA_APPR_DATE,
             V_TBL_ANOM_MAIN.AN_ORIG_AVAIL_CLASS,
             V_TBL_ANOM_MAIN.AN_ORIG_AVAIL_CLASS_SYS,
             V_TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS,
             V_TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS_SYS,
             V_TBL_ANOM_MAIN.AN_AVAIL_UPD_DATE,
             V_TBL_ANOM_MAIN.AN_AVAIL_UPD_BY,
             V_TBL_ANOM_MAIN.AN_UPD_DATE,
             V_TBL_ANOM_MAIN.AN_UPD_BY,
             V_TBL_ANOM_MAIN.AN_FNCR_REQUIRED,
             V_TBL_ANOM_MAIN.AN_FNCR,
             V_TBL_ANOM_MAIN.AN_LIFE_TERM,
             V_TBL_ANOM_MAIN.AN_LIFE_TERM_SYS,
             V_TBL_ANOM_MAIN.AN_PORTFOLIO_APPL,
             V_TBL_ANOM_MAIN.AN_RISK_RANK_SEVERITY,
             V_TBL_ANOM_MAIN.AN_RISK_RANK_SEVERITY_SYS,
             V_TBL_ANOM_MAIN.AN_RISK_RANK_SEVERITY_SYS_2,
             V_TBL_ANOM_MAIN.AN_RISK_RANK_LIKELIHOOD,
             V_TBL_ANOM_MAIN.AN_RISK_RANK_LIKELIHOOD_SYS,
             V_TBL_ANOM_MAIN.AN_RISK_RANK_LIKELIHOOD_SYS_2,
             V_TBL_ANOM_MAIN.AN_RISK_RANK_SYS,
             V_TBL_ANOM_MAIN.AN_START_EAST,
             V_TBL_ANOM_MAIN.AN_END_EAST,
             V_TBL_ANOM_MAIN.AN_DESC,
             V_TBL_ANOM_MAIN.AN_START_NORTH,
             V_TBL_ANOM_MAIN.AN_END_NORTH,
             V_TBL_ANOM_MAIN.AN_RECCMD,
             V_TBL_ANOM_MAIN.AN_ASSMNT,
             V_TBL_ANOM_MAIN.AN_DELETED,
             V_TBL_ANOM_MAIN.AN_AVAIL_COMMENTS,
             V_TBL_ANOM_MAIN.AN_TITLE,
             V_TBL_ANOM_MAIN.AN_ATTACHMENTS,
             V_TBL_ANOM_MAIN.AN_RISK_RANK_COMMENTS,
             V_TBL_ANOM_MAIN.AN_ASIS_STATUS,
             V_TBL_ANOM_MAIN.AN_PT_SUPPORT,
             V_TBL_ANOM_MAIN.AN_ASIS_STATUS_SYS,
             V_TBL_ANOM_MAIN.AN_ASIS,
             V_TBL_ANOM_MAIN.AN_WO_STATUS_SYS,
             V_TBL_ANOM_MAIN.NODE_GROUP,
             V_TBL_ANOM_MAIN.PS_CODES
         FROM
             V_TBL_ANOM_MAIN LEFT
             JOIN V_TBL_ANOM_ACT_ITEMS ON V_TBL_ANOM_MAIN.AN_ID = V_TBL_ANOM_ACT_ITEMS.AI_AN_ID
     ) T2
     INNER JOIN (
         SELECT
             SYS_TREE_STRUC.TRE_DAT_TAG,
             LEVEL   AS L,
             CONNECT_BY_ROOT SYS_NODES_ATTRIB.NODE_ID AS LEVEL1_NODE_ID,
             CONNECT_BY_ROOT SYS_NODES_ATTRIB.NODE_DESC AS LEVEL1_NODE_DESC,
             LTRIM(RTRIM(SYS_CONNECT_BY_PATH(CASE
                 WHEN LEVEL = 2 THEN SYS_NODES_ATTRIB.NODE_ID
                 ELSE NULL
             END,'>'),'>'),'>') AS LEVEL2_NODE_ID,
             LTRIM(RTRIM(SYS_CONNECT_BY_PATH(CASE
                 WHEN LEVEL = 2 THEN SYS_NODES_ATTRIB.NODE_DESC
                 ELSE NULL
             END,'>'),'>'),'>') AS LEVEL2_NODE_DESC,
             LTRIM(RTRIM(SYS_CONNECT_BY_PATH(CASE
                 WHEN LEVEL = 3 THEN SYS_NODES_ATTRIB.NODE_ID
                 ELSE NULL
             END,'>'),'>'),'>') AS LEVEL3_NODE_ID,
             LTRIM(RTRIM(SYS_CONNECT_BY_PATH(CASE
                 WHEN LEVEL = 3 THEN SYS_NODES_ATTRIB.NODE_DESC
                 ELSE NULL
             END,'>'),'>'),'>') AS LEVEL3_NODE_DESC
         FROM
             SYS_TREE_STRUC
             INNER JOIN SYS_NODES_ATTRIB ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
         WHERE
             SYS_TREE_STRUC.TRE_DAT_TYPE = 1
         START WITH
             SYS_TREE_STRUC.TRE_DAT_TAG = 45488
         CONNECT BY
             PRIOR SYS_TREE_STRUC.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG_PAR
     ) T1 ON T1.TRE_DAT_TAG = T2.AN_ASSET_ID
 GROUP BY
     CASE
         WHEN T1.LEVEL2_NODE_ID = 'SE' THEN 'GOM'
         WHEN T1.LEVEL2_NODE_ID = 'BR' THEN 'BRAZIL'
         ELSE 'NON-SHELL'
     END,
     T1.LEVEL1_NODE_ID,
     T1.LEVEL1_NODE_ID
     || ' - '
     || T1.LEVEL1_NODE_DESC,
     T1.LEVEL2_NODE_ID,
     T1.LEVEL2_NODE_ID
     || ' - '
     || T1.LEVEL2_NODE_DESC,
     T1.LEVEL3_NODE_ID,
     T1.LEVEL3_NODE_ID
     || ' - '
     || T1.LEVEL3_NODE_DESC,
     T2.NODE_ID,
     T2.NODE_DESC,
     T2.AN_REF,
     T2.AN_ACT_BY_DATE_MAX,
     T2.AN_ACT_BY_DATE,
     T2.ANTYPE_NAME,
     T2.ANTYPE_GROUP_SYS,
     T2.AN_STATUS_SYS,
     T2.AN_RAISED_BY,
     T2.AN_RAISED_DATE,
     T2.AN_ORIG_CLASS_SYS,
     T2.AN_CURR_CLASS_SYS,
     T2.AN_REVNO,
     T2.AN_ASS_DATE,
     T2.AN_ASS_BY,
     T2.AN_ACT_PARTY,
     T2.AN_MAINT_REQ_SYS,
     T2.AN_WO_REF,
     T2.AN_WO_STATUS,
     T2.AN_DATE_IDENT,
     T2.AN_ACT_REQ,
     T2.AN_EQ_FAILURE,
     T2.AN_TA_APPROVED,
     T2.AN_TA_NAME,
     T2.AN_TA_APPR_DATE,
     T2.AN_ORIG_AVAIL_CLASS_SYS,
     T2.AN_CURR_AVAIL_CLASS_SYS,
     T2.AN_AVAIL_UPD_DATE,
     T2.AN_AVAIL_UPD_BY,
     T2.AN_UPD_DATE,
     T2.AN_UPD_BY,
     T2.AN_FNCR_REQUIRED,
     T2.AN_FNCR,
     T2.AN_LIFE_TERM_SYS,
     T2.AN_PORTFOLIO_APPL,
     T2.AN_RISK_RANK_SEVERITY_SYS,
     T2.AN_RISK_RANK_SEVERITY_SYS_2,
     T2.AN_RISK_RANK_LIKELIHOOD_SYS,
     T2.AN_RISK_RANK_LIKELIHOOD_SYS_2,
     T2.AN_RISK_RANK_SYS,
     T2.AN_START_EAST,
     T2.AN_END_EAST,
     T2.AN_DESC,
     T2.AN_START_NORTH,
     T2.AN_END_NORTH,
     T2.AN_RECCMD,
     T2.AN_ASSMNT,
     T2.AN_DELETED,
     T2.AN_AVAIL_COMMENTS,
     T2.AN_TITLE,
     T2.AN_ATTACHMENTS,
     T2.AN_RISK_RANK_COMMENTS,
     T2.AN_ASIS_STATUS,
     T2.AN_PT_SUPPORT,
     T2.AN_ASIS_STATUS_SYS,
     T2.AN_WO_STATUS_SYS,
     T2.NODE_GROUP,
     T2.PS_CODES,
     T2.AN_ID
 ORDER BY
     T2.AN_ID DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_AD_HOC_WORK
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_AD_HOC_WORK" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "JOB_TITLE", "STEP_NO", "JOB_COMPLETED_THIS_STEP", "ACTION", "COMMENT_OR_RESULT") AS 
  SELECT TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC       AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       - TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 - TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 - TBL_SVY_POSITION_START.SVY_POS_EASTING) * (0 - TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                       - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 - TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 - TBL_SVY_POSITION_END.SVY_POS_EASTING) * (0 - TBL_SVY_POSITION_END.SVY_POS_EASTING)         AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_MEMO_A                  AS JOB_TITLE,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS STEP_NO,
  TBL_SVY_HEADER.SVY_YESNO_A                 AS JOB_COMPLETED_THIS_STEP,
  TBL_SVY_HEADER.SVY_MEMO_B                  AS ACTION,
  TBL_SVY_HEADER.SVY_MEMO_C                  AS COMMENT_OR_RESULT
FROM TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 2;
--------------------------------------------------------
--  DDL for View V_ARCGIS_ADD_FEATURE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_ADD_FEATURE" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "FEATURE_DESCRIPTION", "FEATURE_TYPE", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "SVY_HDR_NOD_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR") AS 
  SELECT TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC       AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       - TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 - TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 - TBL_SVY_POSITION_START.SVY_POS_EASTING) * (0 - TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                       - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 - TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 - TBL_SVY_POSITION_END.SVY_POS_EASTING) * (0 - TBL_SVY_POSITION_END.SVY_POS_EASTING)         AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS FEATURE_DESCRIPTION,
  TBL_SVY_HEADER.SVY_TEXT_B                  AS FEATURE_TYPE,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS SVY_HDR_NOD_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR
FROM TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON TBL_SVY_HEADER.SVY_HDR_COLOUR   = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 1;
--------------------------------------------------------
--  DDL for View V_ARCGIS_ANODE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_ANODE" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "ANODE_TYPE", "ACTIVEV", "SECUREV", "ANODE_WASTAGEV", "MARINE_GROWTHV", "PRODUCTS_BULKV") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS ANODE_TYPE,
  TBL_SVY_HEADER.SVY_YESNO_A                  AS ACTIVEV,
  TBL_SVY_HEADER.SVY_YESNO_B                 AS SECUREV,
  TBL_SVY_HEADER.SVY_INTEGER_A                  AS ANODE_WASTAGEV,
  TBL_SVY_HEADER.SVY_INTEGER_B                  AS MARINE_GROWTHV,
  TBL_SVY_HEADER.SVY_INTEGER_C                  AS PRODUCTS_BULKV
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 3;
--------------------------------------------------------
--  DDL for View V_ARCGIS_ANODE_ICCP
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_ANODE_ICCP" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "ANODE_TYPE", "SECUREV", "DIELECTRIC_SHIELDV", "MARINE_GROWTHV") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS ANODE_TYPE,
  TBL_SVY_HEADER.SVY_YESNO_A                  AS SECUREV,
  TBL_SVY_HEADER.SVY_YESNO_B                 AS DIELECTRIC_SHEILDV,
  TBL_SVY_HEADER.SVY_TEXT_B                  AS MARINE_GROWTHV
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 43;
--------------------------------------------------------
--  DDL for View V_ARCGIS_ANOM_MAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_ANOM_MAIN" ("AN_ID", "AN_REF", "ASSET_ID", "NODE_ID", "NODE_DESC", "AN_TYPE", "ANTYPE_NAME", "ANTYPE_GROUP", "ANTYPE_GROUP_SYS", "AN_STATUS", "AN_STATUS_SYS", "AN_RAISED_BY", "AN_RAISED_DATE", "AN_ORIG_CLASS", "AN_ORIG_CLASS_SYS", "AN_CURR_CLASS", "AN_CURR_CLASS_SYS", "AN_REVNO", "AN_ASS_DATE", "AN_ASS_BY", "AN_ACT_BY_DATE", "AN_ACT_PARTY", "AN_MAINT_REQ", "AN_MAINT_REQ_SYS", "AN_WO_REF", "AN_WO_STATUS", "AN_DATE_IDENT", "AN_ACT_REQ", "AN_EQ_FAILURE", "AN_TA_APPROVED", "AN_TA_NAME", "AN_TA_APPR_DATE", "AN_ORIG_AVAIL_CLASS", "AN_ORIG_AVAIL_CLASS_SYS", "AN_CURR_AVAIL_CLASS", "AN_CURR_AVAIL_CLASS_SYS", "AN_AVAIL_UPD_DATE", "AN_AVAIL_UPD_BY", "AN_UPD_DATE", "AN_UPD_BY", "AN_FNCR_REQUIRED", "AN_FNCR", "AN_LIFE_TERM", "AN_LIFE_TERM_SYS", "AN_PORTFOLIO_APPL", "AN_RISK_RANK_SEVERITY", "AN_RISK_RANK_SEVERITY_SYS", "AN_RISK_RANK_SEVERITY_SYS_2", "AN_RISK_RANK_LIKELIHOOD", "AN_RISK_RANK_LIKELIHOOD_SYS", "AN_RISK_RANK_LIKELIHOOD_SYS_2", "AN_RISK_RANK_SYS", "AN_START_EAST", "AN_END_EAST", "AN_DESC", "AN_START_NORTH", "AN_END_NORTH", "AN_RECCMD", "AN_ASSMNT", "AN_DELETED", "AN_AVAIL_COMMENTS", "AN_TITLE", "AN_ATTACHMENTS", "AN_RISK_RANK_COMMENTS", "ITV_DATE_MOBIL", "ITV_TYPE", "ITV_TYPE_SYS", "ITV_VESSEL_TYPE", "ITV_VESSEL_TYPE_SYS", "ITV_TIME_PLAN_PROC", "ITV_TIME_MOBIL", "ITV_TIME_ACTUAL", "ITV_AFE_COST", "ITV_ACTUAL_COST", "ITV_DATE_ACTUAL_COST", "ITV_WBS_NUMBER", "ITV_UPDATED", "ITV_UPDATED_BY", "ITV_SUMMARY", "ITV_VESSEL_NAME", "ITV_LEARNING", "ITV_AFE_SHELL_SHARE", "ITV_VESSEL_DAY_RATE", "ITV_WELL_DOWNTIME", "AN_ASIS_STATUS", "AN_PT_SUPPORT", "AN_ASIS_STATUS_SYS", "AN_ASIS", "AN_WO_STATUS_SYS", "NODE_GROUP") AS 
  SELECT TBL_ANOM_MAIN.AN_ID,
  TBL_ANOM_MAIN.AN_REF,
  SYS_NODES_ATTRIB.REC_TAG AS ASSET_ID,
  SYS_NODES_ATTRIB.NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID || ' - ' || SYS_NODES_ATTRIB.NODE_DESC) AS NODE_DESC,
  TBL_ANOM_MAIN.AN_TYPE,
  TBL_ANOM_TYPES.ANTYPE_NAME,
  TBL_ANOM_TYPES.ANTYPE_GROUP,
  SYS_LOOKUPS.LKP_DESC_B AS ANTYPE_GROUP_SYS,
  TBL_ANOM_MAIN.AN_STATUS,
  LOOKUPS_STATUS.LKP_DESC_B AS AN_STATUS_SYS,
  TBL_ANOM_MAIN.AN_RAISED_BY,
  TBL_ANOM_MAIN.AN_RAISED_DATE,
  TBL_ANOM_MAIN.AN_ORIG_CLASS,
  LOOKUPS_ORIG_CLASS.LKP_DESC_B AS AN_ORIG_CLASS_SYS,
  TBL_ANOM_MAIN.AN_CURR_CLASS,
  LOOKUPS_CURR_CLASS.LKP_DESC_B AS AN_CURR_CLASS_SYS,
  TBL_ANOM_MAIN.AN_REVNO,
  TBL_ANOM_MAIN.AN_ASS_DATE,
  TBL_ANOM_MAIN.AN_ASS_BY,
  TBL_ANOM_MAIN.AN_ACT_BY_DATE,
  TBL_ANOM_MAIN.AN_ACT_PARTY,
  TBL_ANOM_MAIN.AN_MAINT_REQ,
  LOOKUPS_MAINT_REQ.LKP_DESC_B AS AN_MAINT_REQ_SYS,
  TBL_ANOM_MAIN.AN_WO_REF,
  TBL_ANOM_MAIN.AN_WO_STATUS,
  TBL_ANOM_MAIN.AN_DATE_IDENT,
  TBL_ANOM_MAIN.AN_ACT_REQ,
  TBL_ANOM_MAIN.AN_EQ_FAILURE,
  TBL_ANOM_MAIN.AN_TA_APPROVED,
  TBL_ANOM_MAIN.AN_TA_NAME,
  TBL_ANOM_MAIN.AN_TA_APPR_DATE,
  TBL_ANOM_MAIN.AN_ORIG_AVAIL_CLASS,
  LOOKUPS_ORIG_AVAIL_CLASS.LKP_DESC_B AS AN_ORIG_AVAIL_CLASS_SYS,
  TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS,
  LOOKUPS_CURR_AVAIL_CLASS.LKP_DESC_B AS AN_CURR_AVAIL_CLASS_SYS,
  TBL_ANOM_MAIN.AN_AVAIL_UPD_DATE,
  TBL_ANOM_MAIN.AN_AVAIL_UPD_BY,
  TBL_ANOM_MAIN.AN_UPD_DATE,
  TBL_ANOM_MAIN.AN_UPD_BY,
  TBL_ANOM_MAIN.AN_FNCR_REQUIRED,
  TBL_ANOM_MAIN.AN_FNCR,
  TBL_ANOM_MAIN.AN_LIFE_TERM,
  LOOKUPS_LIFE_TERM.LKP_DESC_B AS AN_LIFE_TERM_SYS,
  TBL_ANOM_MAIN.AN_PORTFOLIO_APPL,
  TBL_ANOM_MAIN.AN_RISK_RANK_SEVERITY,
  LOOKUPS_RISK_RANK_SEVERITY.LKP_DESC_A AS AN_RISK_RANK_SEVERITY_SYS,
  LOOKUPS_RISK_RANK_SEVERITY.LKP_DESC_B AS AN_RISK_RANK_SEVERITY_SYS_2,
  TBL_ANOM_MAIN.AN_RISK_RANK_LIKELIHOOD,
  LOOKUPS_RISK_RANK_LIKELIHOOD.LKP_DESC_A AS AN_RISK_RANK_LIKELIHOOD_SYS,
  LOOKUPS_RISK_RANK_LIKELIHOOD.LKP_DESC_B AS AN_RISK_RANK_LIKELIHOOD_SYS_2,
  (LOOKUPS_RISK_RANK_SEVERITY.LKP_DESC_A
  || LOOKUPS_RISK_RANK_LIKELIHOOD.LKP_DESC_A) AS AN_RISK_RANK_SYS,
  TBL_ANOM_MAIN.AN_START_EAST,
  TBL_ANOM_MAIN.AN_END_EAST,
  TBL_ANOM_MAIN.AN_DESC,
  TBL_ANOM_MAIN.AN_START_NORTH,
  TBL_ANOM_MAIN.AN_END_NORTH,
  TBL_ANOM_MAIN.AN_RECCMD,
  TBL_ANOM_MAIN.AN_ASSMNT,
  TBL_ANOM_MAIN.AN_DELETED,
  TBL_ANOM_MAIN.AN_AVAIL_COMMENTS,
  TBL_ANOM_MAIN.AN_TITLE,
  TBL_ANOM_MAIN.AN_ATTACHMENTS,
  TBL_ANOM_MAIN.AN_RISK_RANK_COMMENTS,
  TBL_ANOM_MAIN.ITV_DATE_MOBIL,
  TBL_ANOM_MAIN.ITV_TYPE,
  LOOKUPS_ITV_TYPE.LKP_DESC_B AS ITV_TYPE_SYS,
  TBL_ANOM_MAIN.ITV_VESSEL_TYPE,
  LOOKUPS_VESSEL_TYPE.LKP_DESC_B AS ITV_VESSEL_TYPE_SYS,
  TBL_ANOM_MAIN.ITV_TIME_PLAN_PROC,
  TBL_ANOM_MAIN.ITV_TIME_MOBIL,
  TBL_ANOM_MAIN.ITV_TIME_ACTUAL,
  TBL_ANOM_MAIN.ITV_AFE_COST,
  TBL_ANOM_MAIN.ITV_ACTUAL_COST,
  TBL_ANOM_MAIN.ITV_DATE_ACTUAL_COST,
  TBL_ANOM_MAIN.ITV_WBS_NUMBER,
  TBL_ANOM_MAIN.ITV_UPDATED,
  TBL_ANOM_MAIN.ITV_UPDATED_BY,
  TBL_ANOM_MAIN.ITV_SUMMARY,
  TBL_ANOM_MAIN.ITV_VESSEL_NAME,
  TBL_ANOM_MAIN.ITV_LEARNING,
  TBL_ANOM_MAIN.ITV_AFE_SHELL_SHARE,
  TBL_ANOM_MAIN.ITV_VESSEL_DAY_RATE,
  TBL_ANOM_MAIN.ITV_WELL_DOWNTIME,
  TBL_ANOM_MAIN.AN_ASIS_STATUS,
  TBL_ANOM_MAIN.AN_PT_SUPPORT,
  SYS_LOOKUPS1.LKP_DESC_B AS AN_ASIS_STATUS_SYS,
  TBL_ANOM_MAIN.AN_ASIS,
  SYS_LOOKUPS2.LKP_DESC_B AS AN_WO_STATUS_SYS,
  SYS_NODES_ATTRIB.NODE_GROUP
FROM TBL_ANOM_MAIN
LEFT JOIN TBL_ANOM_TYPES
ON TBL_ANOM_MAIN.AN_TYPE = TBL_ANOM_TYPES.ANTYPE_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_STATUS
ON TBL_ANOM_MAIN.AN_STATUS = LOOKUPS_STATUS.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_ORIG_CLASS
ON TBL_ANOM_MAIN.AN_ORIG_CLASS = LOOKUPS_ORIG_CLASS.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CURR_CLASS
ON TBL_ANOM_MAIN.AN_CURR_CLASS = LOOKUPS_CURR_CLASS.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_MAINT_REQ
ON TBL_ANOM_MAIN.AN_MAINT_REQ = LOOKUPS_MAINT_REQ.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_ORIG_AVAIL_CLASS
ON TBL_ANOM_MAIN.AN_ORIG_AVAIL_CLASS = LOOKUPS_ORIG_AVAIL_CLASS.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CURR_AVAIL_CLASS
ON TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS = LOOKUPS_CURR_AVAIL_CLASS.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_LIFE_TERM
ON TBL_ANOM_MAIN.AN_LIFE_TERM = LOOKUPS_LIFE_TERM.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_RISK_RANK_SEVERITY
ON TBL_ANOM_MAIN.AN_RISK_RANK_SEVERITY = LOOKUPS_RISK_RANK_SEVERITY.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_RISK_RANK_LIKELIHOOD
ON TBL_ANOM_MAIN.AN_RISK_RANK_LIKELIHOOD = LOOKUPS_RISK_RANK_LIKELIHOOD.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_ITV_TYPE
ON TBL_ANOM_MAIN.ITV_TYPE = LOOKUPS_ITV_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_VESSEL_TYPE
ON TBL_ANOM_MAIN.ITV_VESSEL_TYPE = LOOKUPS_VESSEL_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS
ON TBL_ANOM_TYPES.ANTYPE_GROUP = SYS_LOOKUPS.LKP_ID
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A
INNER JOIN SYS_NODES_ATTRIB
ON SYS_NODES_ATTRIB.REC_TAG = LNK_AN_NODES.LNK_TAG_B
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON TBL_ANOM_MAIN.AN_ASIS_STATUS = SYS_LOOKUPS1.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS2
ON TBL_ANOM_MAIN.AN_WO_STATUS = SYS_LOOKUPS2.LKP_ID
ORDER BY TBL_ANOM_MAIN.AN_ID DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_BERM
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_BERM" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "PIPE_CRADLED", "AV_PIPE_BURIAL", "PIPE_COVERED", "BERM_EXTENT_L_R", "SPAN_HEIGHT", "INEFFECTIVE_SUPPORT") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_YESNO_A                  AS PIPE_CRADLED,
  TBL_SVY_HEADER.SVY_INTEGER_A                  AS AV_PIPE_BURIAL,
  TBL_SVY_HEADER.SVY_YESNO_B                 AS PIPE_COVERED,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS BERM_EXTENT_L_R,
  TBL_SVY_HEADER.SVY_SINGLE_A                  AS SPAN_HEIGHT,
  TBL_SVY_HEADER.SVY_YESNO_C                  AS INEFFECTIVE_SUPPORT
FROM
  TBL_SVY_HEADER
INNER JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
INNER JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
INNER JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 5;
--------------------------------------------------------
--  DDL for View V_ARCGIS_BOLTED_ITEM
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_BOLTED_ITEM" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "ITEM", "ALIGNED_AND_SECURE", "INTACT", "MOVEMENT", "ALL_STUDS_SEEN", "APPROX_NUMBER_OF_STUDS_SEEN", "STUD_PROTECTORS_IN_PLACE", "GREASE_BAND_IN_PLACE", "CONTINUITY_STRAP_SEEN", "OTHER_SEEN", "ALL_SEEN_SECURE") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS ITEM,
  TBL_SVY_HEADER.SVY_YESNO_A                  AS ALIGNED_AND_SECURE,
  TBL_SVY_HEADER.SVY_YESNO_B                 AS INTACT,
  TBL_SVY_HEADER.SVY_YESNO_C                  AS MOVEMENT,
  TBL_SVY_HEADER.SVY_YESNO_D                  AS ALL_STUDS_SEEN,
  TBL_SVY_HEADER.SVY_INTEGER_A                  AS APPROX_NUMBER_OF_STUDS_SEEN,
  TBL_SVY_HEADER.SVY_YESNO_E                  AS STUD_PROTECTORS_IN_PLACE,
  TBL_SVY_HEADER.SVY_YESNO_F                  AS GREASE_BAND_IN_PLACE,
  TBL_SVY_HEADER.SVY_YESNO_G                  AS CONTINUITY_STRAP_SEEN,
  TBL_SVY_HEADER.SVY_TEXT_B                  AS OTHER_SEEN,
  TBL_SVY_HEADER.SVY_YESNO_H                  AS ALL_SEEN_SECURE
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 6;
--------------------------------------------------------
--  DDL for View V_ARCGIS_BOLTED_ITEM_GVI
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_BOLTED_ITEM_GVI" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "ITEMV", "SECUREV", "INTACTV", "MOVEMENTV") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS ITEMV,
  TBL_SVY_HEADER.SVY_YESNO_A                  AS SECUREV,
  TBL_SVY_HEADER.SVY_YESNO_B                 AS INTACTV,
  TBL_SVY_HEADER.SVY_YESNO_C                  AS MOVEMENTV
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 44;
--------------------------------------------------------
--  DDL for View V_ARCGIS_BUCKLE_TRIGGER
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_BUCKLE_TRIGGER" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "LINE_CONNTACT", "PLATE_RDG") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_YESNO_A AS LINE_CONNTACT,
TBL_SVY_HEADER.SVY_SINGLE_A AS PLATE_RDG 

FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 56 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_BURIAL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_BURIAL" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "LEFT_BURIAL_PERCENTV", "RIGHT_BURIAL_PERCENTV", "PIPELINE_COVEREDV", "LEFT_OF_PIPEV", "LEFT_SCOUR", "RIGHT_SCOUR") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_INTEGER_A                  AS LEFT_BURIAL_PERCENTV,
  TBL_SVY_HEADER.SVY_INTEGER_B                  AS RIGHT_BURIAL_PERCENTV,
  TBL_SVY_HEADER.SVY_YESNO_A                 AS PIPELINE_COVEREDV,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS LEFT_OF_PIPEV,
  TBL_SVY_HEADER.SVY_INTEGER_C                  AS LEFT_SCOUR,
  TBL_SVY_HEADER.SVY_INTEGER_D                  AS RIGHT_SCOUR
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 7;
--------------------------------------------------------
--  DDL for View V_ARCGIS_BURIAL_STRUCTURE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_BURIAL_STRUCTURE" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "BURIAL_DEPTHV", "LOCATIONV", "EXTENTV") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_SINGLE_A                  AS BURIAL_DEPTHV,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS LOCATIONV,
  TBL_SVY_HEADER.SVY_TEXT_B                 AS EXTENTV 
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 45;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CHAIN_ANGLE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CHAIN_ANGLE" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "PRE_CLEANED", "CENTRE_LINK_NUMBER", "LINK_DEPTH", "ANGLE_RE_HORIZON", "METHOD", "ACCURACY", "ENVIRONMENTAL") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_YESNO_A                  AS PRE_CLEANED,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS CENTRE_LINK_NUMBER,
  TBL_SVY_HEADER.SVY_SINGLE_A                 AS LINK_DEPTH,
  TBL_SVY_HEADER.SVY_SINGLE_B                  AS ANGLE_RE_HORIZON,
  TBL_SVY_HEADER.SVY_TEXT_B                  AS METHOD,
  TBL_SVY_HEADER.SVY_TEXT_C                  AS ACCURACY,
  TBL_SVY_HEADER.SVY_YESNO_B                  AS ENVIRONMENTAL
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 8;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CHAIN_LINK_DIAMETER
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CHAIN_LINK_DIAMETER" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "CHAIN_IDV", "LINK_NOV", "LOC_1V", "MEASUREMENT_1V", "LOC_2V", "MEASUREMENT_2V", "LOC_3V", "MEASUREMENT_3V", "LOC_4V", "MEASUREMENT_4V", "LOC_5V", "MEASUREMENT_5V", "LOC_6V", "MEASUREMENT_6V", "LOC_7V", "MEASUREMENT_7V", "LOC_8V", "MEASUREMENT_8V") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS CHAIN_IDV,
  TBL_SVY_HEADER.SVY_TEXT_B                 AS LINK_NOV, 
  TBL_SVY_HEADER.SVY_TEXT_C                 AS LOC_1V, 
  TBL_SVY_HEADER.SVY_SINGLE_A                  AS MEASUREMENT_1V,
  TBL_SVY_HEADER.SVY_TEXT_D                 AS LOC_2V, 
  TBL_SVY_HEADER.SVY_SINGLE_B                  AS MEASUREMENT_2V,
  TBL_SVY_HEADER.SVY_TEXT_E                 AS LOC_3V, 
  TBL_SVY_HEADER.SVY_SINGLE_C                  AS MEASUREMENT_3V,
  TBL_SVY_HEADER.SVY_TEXT_F                 AS LOC_4V, 
  TBL_SVY_HEADER.SVY_SINGLE_D                  AS MEASUREMENT_4V,
  TBL_SVY_HEADER.SVY_TEXT_G                 AS LOC_5V, 
  TBL_SVY_HEADER.SVY_SINGLE_E                  AS MEASUREMENT_5V,
  TBL_SVY_HEADER.SVY_TEXT_H                 AS LOC_6V, 
  TBL_SVY_HEADER.SVY_SINGLE_F                  AS MEASUREMENT_6V,
  TBL_SVY_HEADER.SVY_TEXT_I                 AS LOC_7V, 
  TBL_SVY_HEADER.SVY_SINGLE_G                  AS MEASUREMENT_7V,
  TBL_SVY_HEADER.SVY_TEXT_J                 AS LOC_8V, 
  TBL_SVY_HEADER.SVY_SINGLE_H                  AS MEASUREMENT_8V
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 46;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CLEANING
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CLEANING" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "ITEM_OR_AREA", "CLEANING_STANDARD", "PURPOSE", "METHOD", "APPROX_RATE", "EQUIP_SPEC") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS ITEM_OR_AREA,
  TBL_SVY_HEADER.SVY_TEXT_B                  AS CLEANING_STANDARD,
  TBL_SVY_HEADER.SVY_TEXT_C                AS PURPOSE,
  TBL_SVY_HEADER.SVY_TEXT_D                  AS METHOD,
  TBL_SVY_HEADER.SVY_TEXT_E                  AS APPROX_RATE,
  TBL_SVY_HEADER.SVY_TEXT_F                  AS EQUIP_SPEC
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 9;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CMS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CMS" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "CMS_LOCATION", "CMS_SITE_OR_LINK_ID", "CMS_TOOL_ORIENTATION") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS CMS_LOCATION,
  TBL_SVY_HEADER.SVY_TEXT_B                  AS CMS_SITE_OR_LINK_ID,
  TBL_SVY_HEADER.SVY_TEXT_C                AS CMS_TOOL_ORIENTATION
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 10;
--------------------------------------------------------
--  DDL for View V_ARCGIS_COATING_INSUL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_COATING_INSUL" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "TYPICAL", "DESCRIPTION", "LEN", "WID", "HEI", "PRE_CLEANED") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_YESNO_A AS TYPICAL,
TBL_SVY_HEADER.SVY_TEXT_A AS DESCRIPTION,
TBL_SVY_HEADER.SVY_INTEGER_A AS LEN,
TBL_SVY_HEADER.SVY_INTEGER_B AS WID,
TBL_SVY_HEADER.SVY_INTEGER_C AS HEI,
TBL_SVY_HEADER.SVY_YESNO_B AS PRE_CLEANED
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 61 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_COATINGS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_COATINGS" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "TYPICAL", "SPECIFIC_ITEM", "COATING_APPARENT", "TOP_COLOUR_OR_CLADDING_TYPE", "COATING_INTACT", "DAMAGE_TYPE", "DETERIORATED_OR_DAMAGED", "BARE_METAL", "CORROSION_APPARENT", "PRE_CLEANED", "ANTIFOUL_COATING") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_YESNO_A                  AS TYPICAL,
TBL_SVY_HEADER.SVY_TEXT_A                  AS SPECIFIC_ITEM,
TBL_SVY_HEADER.SVY_YESNO_B                  AS COATING_APPARENT,
TBL_SVY_HEADER.SVY_TEXT_B                  AS TOP_COLOUR_OR_CLADDING_TYPE,
TBL_SVY_HEADER.SVY_YESNO_C                  AS COATING_INTACT,
TBL_SVY_HEADER.SVY_TEXT_C                  AS DAMAGE_TYPE,
TBL_SVY_HEADER.SVY_INTEGER_A                  AS DETERIORATED_OR_DAMAGED,
TBL_SVY_HEADER.SVY_INTEGER_B                  AS BARE_METAL,
TBL_SVY_HEADER.SVY_YESNO_D                  AS CORROSION_APPARENT,
TBL_SVY_HEADER.SVY_YESNO_E                  AS PRE_CLEANED,
TBL_SVY_HEADER.SVY_YESNO_F                  AS ANTIFOUL_COATING
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 11;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CONCRETE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CONCRETE" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "INSP_ITEMV", "METHODSV", "COMMENTV", "DRAWINGV", "DEFECTV", "LENGTHV", "WIDTHV", "DEPTHV", "POSV", "CAT_AV", "CAT_BV", "OTHERV", "CP_TAKENV") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS INSP_ITEMV,
  TBL_SVY_HEADER.SVY_TEXT_B                 AS METHODSV, 
  TBL_SVY_HEADER.SVY_MEMO_A                 AS COMMENTV, 
  TBL_SVY_HEADER.SVY_TEXT_C                 AS DRAWINGV, 
  TBL_SVY_HEADER.SVY_TEXT_D                 AS DEFECTV, 
  TBL_SVY_HEADER.SVY_SINGLE_A                  AS LENGTHV,
  TBL_SVY_HEADER.SVY_SINGLE_B                  AS WIDTHV,
  TBL_SVY_HEADER.SVY_SINGLE_C                  AS DEPTHV,
  TBL_SVY_HEADER.SVY_TEXT_E                 AS POSV, 
  TBL_SVY_HEADER.SVY_INTEGER_A                 AS CAT_AV, 
  TBL_SVY_HEADER.SVY_INTEGER_B                 AS CAT_BV, 
  TBL_SVY_HEADER.SVY_INTEGER_C                 AS OTHERV, 
  TBL_SVY_HEADER.SVY_YESNO_A                  AS CP_TAKENV
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 12;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CONNECTOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CONNECTOR" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "ITEM", "A_SECURE", "INTACT", "MOVEMENT", "CABLE_SEEN") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS ITEM,
TBL_SVY_HEADER.SVY_YESNO_A AS A_SECURE,
TBL_SVY_HEADER.SVY_YESNO_B AS INTACT,
TBL_SVY_HEADER.SVY_YESNO_C AS MOVEMENT,
TBL_SVY_HEADER.SVY_YESNO_D AS CABLE_SEEN
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 47 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CONTINUITY_STRAP
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CONTINUITY_STRAP" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "ATTACHED", "COMPONENT_ATTACHMENT_TYPE", "STRAP_TYPE", "CONDITION", "BURIED", "ATTACHED_TO_ANODE", "ANODE_ATTACHMENT_TYPE") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_YESNO_A AS ATTACHED,
TBL_SVY_HEADER.SVY_TEXT_A AS COMPONENT_ATTACHMENT_TYPE,
TBL_SVY_HEADER.SVY_TEXT_B AS STRAP_TYPE,
TBL_SVY_HEADER.SVY_TEXT_C AS CONDITION,
TBL_SVY_HEADER.SVY_TEXT_D AS BURIED,
TBL_SVY_HEADER.SVY_YESNO_B AS ATTACHED_TO_ANODE,
TBL_SVY_HEADER.SVY_TEXT_E AS ANODE_ATTACHMENT_TYPE
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 13;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CORROSION
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CORROSION" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "AREA_OR_ITEM", "CP_TAKEN", "PERCENT_CORROSION", "MAX_PIT_DEPTH", "MAX_PIT_DIAMETER") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS AREA_OR_ITEM,
TBL_SVY_HEADER.SVY_YESNO_A AS CP_TAKEN,
TBL_SVY_HEADER.SVY_SINGLE_A AS PERCENT_CORROSION,
TBL_SVY_HEADER.SVY_SINGLE_B AS MAX_PIT_DEPTH,
TBL_SVY_HEADER.SVY_SINGLE_C AS MAX_PIT_DIAMETER
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 14;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CP_CALIBRATION
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CP_CALIBRATION" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "OPERATOR", "DATE", "TIME", "CAL_NO", "ZINC_VOLTAGE", "STEEL_VOLTAGE", "AGCI_VOLTAGE", "CALIBRATION_POINT") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS OPERATOR,
TBL_SVY_HEADER.SVY_DATETIME_A AS "DATE",
TBL_SVY_HEADER.SVY_DATETIME_B AS TIME,
TBL_SVY_HEADER.SVY_TEXT_C AS CAL_NO,
TBL_SVY_HEADER.SVY_SINGLE_A AS ZINC_VOLTAGE,
TBL_SVY_HEADER.SVY_SINGLE_B AS STEEL_VOLTAGE,
TBL_SVY_HEADER.SVY_SINGLE_C AS AG_VOLTAGE,
TBL_SVY_HEADER.SVY_TEXT_B AS CALIBRATION_POINT
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 33;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CP_READING
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CP_READING" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "CP_LOCATION", "CP_READING_1", "CP_READING_2", "CP_READING_3", "CP_READING_4", "CP_READING_5", "CP_READING_6", "CP_READING_7", "CP_READING_8", "CP_READING_9", "CP_READING_10", "CP_READING_11", "CP_READING_12", "FG_READING", "PROX_READING") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS CP_LOCATION,
TBL_SVY_HEADER.SVY_SINGLE_A AS CP_READING_1,
TBL_SVY_HEADER.SVY_SINGLE_B AS CP_READING_2,
TBL_SVY_HEADER.SVY_SINGLE_C AS CP_READING_3,
TBL_SVY_HEADER.SVY_SINGLE_D AS CP_READING_4,
TBL_SVY_HEADER.SVY_SINGLE_E AS CP_READING_5,
TBL_SVY_HEADER.SVY_SINGLE_F AS CP_READING_6,
TBL_SVY_HEADER.SVY_SINGLE_G AS CP_READING_7,
TBL_SVY_HEADER.SVY_SINGLE_H AS CP_READING_8,
TBL_SVY_HEADER.SVY_SINGLE_I AS CP_READING_9,
TBL_SVY_HEADER.SVY_SINGLE_J AS CP_READING_10,
TBL_SVY_HEADER.SVY_SINGLE_K AS CP_READING_11,
TBL_SVY_HEADER.SVY_SINGLE_L AS CP_READING_12,
TBL_SVY_HEADER.SVY_SINGLE_M AS FG_READING,
TBL_SVY_HEADER.SVY_SINGLE_N AS PROX_READING
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 15;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CP_STEEL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CP_STEEL" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "CP_LOCATION", "CP_READING_1", "CP_READING_2", "CP_READING_3", "CP_READING_4", "CP_READING_5", "CP_READING_6", "CP_READING_7", "CP_READING_8", "CP_READING_9", "CP_READING_10", "CP_READING_11", "CP_READING_12", "FG_READING", "PROX_READING") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS CP_LOCATION,
TBL_SVY_HEADER.SVY_SINGLE_A AS CP_READING_1,
TBL_SVY_HEADER.SVY_SINGLE_B AS CP_READING_2,
TBL_SVY_HEADER.SVY_SINGLE_C AS CP_READING_3,
TBL_SVY_HEADER.SVY_SINGLE_D AS CP_READING_4,
TBL_SVY_HEADER.SVY_SINGLE_E AS CP_READING_5,
TBL_SVY_HEADER.SVY_SINGLE_F AS CP_READING_6,
TBL_SVY_HEADER.SVY_SINGLE_G AS CP_READING_7,
TBL_SVY_HEADER.SVY_SINGLE_H AS CP_READING_8,
TBL_SVY_HEADER.SVY_SINGLE_I AS CP_READING_9,
TBL_SVY_HEADER.SVY_SINGLE_J AS CP_READING_10,
TBL_SVY_HEADER.SVY_SINGLE_K AS CP_READING_11,
TBL_SVY_HEADER.SVY_SINGLE_L AS CP_READING_12,
TBL_SVY_HEADER.SVY_SINGLE_M AS FG_READING,
TBL_SVY_HEADER.SVY_SINGLE_N AS PROX_READING
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 34;
--------------------------------------------------------
--  DDL for View V_ARCGIS_CROSSING
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_CROSSING" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "HOW_MEASURED", "MIN_CLEARANCE", "WHAT_BETWEEN", "UPPER_LINE_IDV", "LOWER_LINE_IDV", "PREVIOUS_YEAR_DATA") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS HOW_MEASURED,
TBL_SVY_HEADER.SVY_TEXT_B AS MIN_CLEARANCE,
TBL_SVY_HEADER.SVY_TEXT_C AS WHAT_BETWEEN,
TBL_SVY_HEADER.SVY_TEXT_D AS UPPER_LINE_IDV,
TBL_SVY_HEADER.SVY_TEXT_E AS LOWER_LINE_IDV,
TBL_SVY_HEADER.SVY_TEXT_F AS PREVIOUS_YEAR_DATA
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 16;
--------------------------------------------------------
--  DDL for View V_ARCGIS_DAMAGE_LINEAR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_DAMAGE_LINEAR" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "COATING_TYPE", "CLOCK_POS", "DIMEN", "SCORE_ORIENTATION", "DAMAGE_TYPE", "DAMAGE_EXTENT", "PENETRATION_TO", "CP_TAKEN", "LEN") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS COATING_TYPE,
TBL_SVY_HEADER.SVY_TEXT_B AS CLOCK_POS,
TBL_SVY_HEADER.SVY_TEXT_C AS DIMEN,
TBL_SVY_HEADER.SVY_TEXT_D AS SCORE_ORIENTATION,
TBL_SVY_HEADER.SVY_TEXT_E AS DAMAGE_TYPE,
TBL_SVY_HEADER.SVY_TEXT_F AS DAMAGE_EXTENT,
TBL_SVY_HEADER.SVY_TEXT_G AS PENETRATION_TO,
TBL_SVY_HEADER.SVY_YESNO_A AS CP_TAKEN,
TBL_SVY_HEADER.SVY_SINGLE_A AS LEN
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 17 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_DAMAGE_STRUCTURE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_DAMAGE_STRUCTURE" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "DAMAGE_TYPE", "EXTENT", "PENETRATION_TO", "LEN", "WID", "HEI", "CP_TAKEN") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS DAMAGE_TYPE,
TBL_SVY_HEADER.SVY_TEXT_B AS EXTENT,
TBL_SVY_HEADER.SVY_TEXT_C AS PENETRATION_TO,
TBL_SVY_HEADER.SVY_SINGLE_A AS LEN,
TBL_SVY_HEADER.SVY_SINGLE_B AS WID,
TBL_SVY_HEADER.SVY_SINGLE_C AS HEI,
TBL_SVY_HEADER.SVY_YESNO_A AS CP_TAKEN 
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 48;
--------------------------------------------------------
--  DDL for View V_ARCGIS_DEBRIS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_DEBRIS" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "CONTACTV", "POSITION_AND_ORIENT", "MAX_DIMENSIONS", "DEBRIS_CODEC", "DAMAGE_CAUSEDV", "RECENTV", "REMOVEDV", "LEN", "WID", "HEI", "PROX") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_YESNO_A AS CONTACTV,
TBL_SVY_HEADER.SVY_TEXT_A AS POSITION_AND_ORIENT,
TBL_SVY_HEADER.SVY_TEXT_B AS MAX_DIMENSIONS,
TBL_SVY_HEADER.SVY_TEXT_C AS DEBRIS_CODEC,
TBL_SVY_HEADER.SVY_YESNO_B AS DAMAGE_CAUSEDV,
TBL_SVY_HEADER.SVY_YESNO_C AS RECENTV,
TBL_SVY_HEADER.SVY_YESNO_D AS REMOVEDV, 
TBL_SVY_HEADER.SVY_SINGLE_A AS LEN, 
TBL_SVY_HEADER.SVY_SINGLE_B AS WID, 
TBL_SVY_HEADER.SVY_SINGLE_C AS HEI, 
TBL_SVY_HEADER.SVY_SINGLE_D AS PROX 
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 18;
--------------------------------------------------------
--  DDL for View V_ARCGIS_DEBRIS_STRUC
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_DEBRIS_STRUC" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "DEB_TYPE", "DESC", "PROX", "LEN", "WID", "HEI", "DAMAGE_CAUSEDV", "RECENTV", "REMOVEDV") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS DEB_TYPE,
TBL_SVY_HEADER.SVY_TEXT_B AS DESCRIPTION,
TBL_SVY_HEADER.SVY_SINGLE_A AS PROX, 
TBL_SVY_HEADER.SVY_SINGLE_B AS LEN, 
TBL_SVY_HEADER.SVY_SINGLE_C AS WID, 
TBL_SVY_HEADER.SVY_SINGLE_D AS HEI,  
TBL_SVY_HEADER.SVY_YESNO_A AS DAMAGE_CAUSEDV,
TBL_SVY_HEADER.SVY_YESNO_B AS RECENTV,
TBL_SVY_HEADER.SVY_YESNO_C AS REMOVEDV  
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 49;
--------------------------------------------------------
--  DDL for View V_ARCGIS_DISPLACEMENT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_DISPLACEMENT" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "EXTENT_AND_DIRECTION", "EVIDENCED_BY", "MEASUREMENTS", "DISPLACED_ITEM") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS EXTENT_AND_DIRECTION,
TBL_SVY_HEADER.SVY_TEXT_B AS EVIDENCED_BY,
TBL_SVY_HEADER.SVY_TEXT_C AS MEASUREMENTS,
TBL_SVY_HEADER.SVY_TEXT_D AS DISPLACED_ITEM
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 19;
--------------------------------------------------------
--  DDL for View V_ARCGIS_DVI
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_DVI" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR 
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 50;
--------------------------------------------------------
--  DDL for View V_ARCGIS_ENGR_FEA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_ENGR_FEA" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "TYP") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS TYP

FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 55;
--------------------------------------------------------
--  DDL for View V_ARCGIS_ENVIRONMENT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_ENVIRONMENT" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "OBSERVATION", "ACTION_TAKEN", "TIDE_HEIGHT", "SWELL_HEIGHT", "SWELL_DIRECTIONC", "CURRENT_SPEED", "CURRENT_DIRECTIONC", "WIND_SPEED", "WIND_DIRECTIONC") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS OBSERVATION,
TBL_SVY_HEADER.SVY_TEXT_B AS ACTION_TAKEN,
TBL_SVY_HEADER.SVY_SINGLE_A AS TIDE_HEIGHT,
TBL_SVY_HEADER.SVY_SINGLE_B AS SWELL_HEIGHT,
TBL_SVY_HEADER.SVY_TEXT_C AS SWELL_DIRECTIONC,
TBL_SVY_HEADER.SVY_SINGLE_C AS CURRENT_SPEED,
TBL_SVY_HEADER.SVY_TEXT_D AS CURRENT_DIRECTIONC,
TBL_SVY_HEADER.SVY_SINGLE_D AS WIND_SPEED,
TBL_SVY_HEADER.SVY_TEXT_E AS WIND_DIRECTIONC
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 20;
--------------------------------------------------------
--  DDL for View V_ARCGIS_FEATURE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_FEATURE" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "FEATURE_DESCRIPTION", "FEATURE_TYPE", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR") AS 
  SELECT TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC       AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       - TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 - TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 - TBL_SVY_POSITION_START.SVY_POS_EASTING) * (0 - TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                       - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 - TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 - TBL_SVY_POSITION_END.SVY_POS_EASTING) * (0 - TBL_SVY_POSITION_END.SVY_POS_EASTING)         AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS FEATURE_DESCRIPTION,
  TBL_SVY_HEADER.SVY_TEXT_B                  AS FEATURE_TYPE,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR
FROM TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON TBL_SVY_HEADER.SVY_HDR_COLOUR   = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 1;
--------------------------------------------------------
--  DDL for View V_ARCGIS_FIELD_JOINT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_FIELD_JOINT" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "GOOD_CONDITION") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_YESNO_A AS GOOD_CONDITION
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 35;
--------------------------------------------------------
--  DDL for View V_ARCGIS_GROUT_BAG_SURVEY
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_GROUT_BAG_SURVEY" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "SUPPORTING_PIPELINE", "LEFT_OF_PIPE", "LEFT_SCOUR", "LEFT_WELL_FORMED", "LEFT_SCOUR_EXTENTS", "RIGHT_SCOUR", "RIGHT_WELL_FORMED", "RIGHT_SCOUR_EXTENTS") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_YESNO_A AS SUPPORTING_PIPELINE,
TBL_SVY_HEADER.SVY_TEXT_A AS LEFT_OF_PIPE,
TBL_SVY_HEADER.SVY_YESNO_B AS LEFT_SCOUR,
TBL_SVY_HEADER.SVY_YESNO_C AS LEFT_WELL_FORMED,
TBL_SVY_HEADER.SVY_SINGLE_A AS LEFT_SCOUR_EXTENTS,
TBL_SVY_HEADER.SVY_YESNO_D AS RIGHT_SCOUR,
TBL_SVY_HEADER.SVY_YESNO_E AS RIGHT_WELL_FORMED,
TBL_SVY_HEADER.SVY_SINGLE_B AS RIGHT_SCOUR_EXTENTS
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 36;
--------------------------------------------------------
--  DDL for View V_ARCGIS_GVI
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_GVI" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "GOOD_CONDITION") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING  +
  TBL_SVY_POSITION_END.SVY_POS_EASTING)    / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING +
  TBL_SVY_POSITION_END.SVY_POS_NORTHING)   / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_YESNO_A AS GOOD_CONDITION
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 37;
--------------------------------------------------------
--  DDL for View V_ARCGIS_HUB_ATTITUDE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_HUB_ATTITUDE" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "MEASUREMENT_LOC", "PITCH", "ROLL", "HEADING") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS MEASUREMENT_LOC,
TBL_SVY_HEADER.SVY_INTEGER_A AS PITCH,
TBL_SVY_HEADER.SVY_INTEGER_B AS ROLL,
TBL_SVY_HEADER.SVY_INTEGER_C AS HEADING 
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 57 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_HUB_TO_HUB
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_HUB_TO_HUB" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "FROM_HUB", "TO_HUB", "SLANT_RAGE", "HOR_DIST", "DEPTH_DIFF", "BEARING", "ALPHA", "BETA") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS FROM_HUB,
TBL_SVY_HEADER.SVY_TEXT_B AS TO_HUB,
TBL_SVY_HEADER.SVY_INTEGER_A AS SLANT_RAGE,
TBL_SVY_HEADER.SVY_INTEGER_B AS HOR_DIST,
TBL_SVY_HEADER.SVY_INTEGER_C AS DEPTH_DIFF,
TBL_SVY_HEADER.SVY_INTEGER_D AS BEARING,
TBL_SVY_HEADER.SVY_INTEGER_E AS ALPHA,
TBL_SVY_HEADER.SVY_INTEGER_F AS BETA 
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 58 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_LEAK
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_LEAK" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "LEAKING_ITEM", "SUBSTANCE", "POSITION", "APPROX_RATE", "SAMPLE_RECOVERED") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS LEAKING_ITEM,
TBL_SVY_HEADER.SVY_TEXT_B AS SUBSTANCE,
TBL_SVY_HEADER.SVY_TEXT_C AS POSITION,
TBL_SVY_HEADER.SVY_TEXT_D AS APPROX_RATE,
TBL_SVY_HEADER.SVY_YESNO_A AS SAMPLE_RECOVERED
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 21;
--------------------------------------------------------
--  DDL for View V_ARCGIS_LINE_DAMAGE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_LINE_DAMAGE" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "COATING_TYPE", "CLOCK_POSITION", "DIMENSIONS", "SCORE_ORIENT_AND_DEPTH", "DAMAGE_CP_TAKEN", "DAMAGE_TYPE", "EXTENT", "PENETRATION_TO") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS COATING_TYPE,
TBL_SVY_HEADER.SVY_TEXT_B AS CLOCK_POSITION,
TBL_SVY_HEADER.SVY_TEXT_C AS DIMENSIONS,
TBL_SVY_HEADER.SVY_TEXT_D AS SCORE_ORIENT_AND_DEPTH,
TBL_SVY_HEADER.SVY_YESNO_A AS DAMAGE_CP_TAKEN,
TBL_SVY_HEADER.SVY_TEXT_E AS DAMAGE_TYPE,
TBL_SVY_HEADER.SVY_TEXT_F AS EXTENT,
TBL_SVY_HEADER.SVY_TEXT_G AS PENETRATION_TO
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 38;
--------------------------------------------------------
--  DDL for View V_ARCGIS_LOCATION_FIX
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_LOCATION_FIX" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "NORTHINGS", "EASTINGS", "DEPTH", "ALTITUDE") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_INTEGER_A AS NORTHINGS,
TBL_SVY_HEADER.SVY_INTEGER_B AS EASTINGS,
TBL_SVY_HEADER.SVY_INTEGER_C AS DEPTH,
TBL_SVY_HEADER.SVY_INTEGER_D AS ALTITUDE
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 39;
--------------------------------------------------------
--  DDL for View V_ARCGIS_MARINE_GROWTH
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_MARINE_GROWTH" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "SOFT_TYPE", "SOFT_MAX", "SOFT_AV", "SOFT_COVER", "HARD_TYPE", "HARD_MAX", "HARD_AV", "HARD_COVER") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS SOFT_TYPE,
TBL_SVY_HEADER.SVY_SINGLE_A AS SOFT_MAX,
TBL_SVY_HEADER.SVY_SINGLE_B AS SOFT_AV,
TBL_SVY_HEADER.SVY_INTEGER_A AS SOFT_COVER,
TBL_SVY_HEADER.SVY_TEXT_B AS HARD_TYPE,
TBL_SVY_HEADER.SVY_SINGLE_C AS HARD_MAX,
TBL_SVY_HEADER.SVY_SINGLE_D AS HARD_AV,
TBL_SVY_HEADER.SVY_INTEGER_B AS HARD_COVER
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 22;
--------------------------------------------------------
--  DDL for View V_ARCGIS_MARINE_NDT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_MARINE_NDT" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "ITEM_OR_AREA", "NDT_TECHNIQUE", "DEFECT_SUMMARY", "DEFECT_MARKED", "OPERATOR_OR_INSPECTOR", "INSPECTOR_OR_DATA_RECORDER", "REPORT_REF", "OTHER_REF", "EQUIPMENT") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS ITEM_OR_AREA,
TBL_SVY_HEADER.SVY_TEXT_B AS NDT_TECHNIQUE,
TBL_SVY_HEADER.SVY_TEXT_C AS DEFECT_SUMMARY,
TBL_SVY_HEADER.SVY_TEXT_D AS DEFECT_MARKED,
TBL_SVY_HEADER.SVY_TEXT_E AS OPERATOR_OR_INSPECTOR,
TBL_SVY_HEADER.SVY_TEXT_F AS INSPECTOR_OR_DATA_RECORDER,
TBL_SVY_HEADER.SVY_TEXT_G AS REPORT_REF,
TBL_SVY_HEADER.SVY_TEXT_H AS OTHER_REF,
TBL_SVY_HEADER.SVY_TEXT_I AS EQUIPMENT
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 24;
--------------------------------------------------------
--  DDL for View V_ARCGIS_PLET_ALIGN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_PLET_ALIGN" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "SLIDING_POS", "EASTING", "NORTHING", "DATUM", "DISTANCE") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_INTEGER_A AS SLIDING_POS,
TBL_SVY_HEADER.SVY_INTEGER_B AS EASTING,
TBL_SVY_HEADER.SVY_INTEGER_C AS NORTHING,
TBL_SVY_HEADER.SVY_TEXT_A AS DATUM,
TBL_SVY_HEADER.SVY_INTEGER_D AS DISTANCE
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 59 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_ROCK_BERM
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_ROCK_BERM" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "PIPE_CRADLED", "AV_PIPE_BURIAL", "PIPE_COVERED", "BERM_EXTENT_L_R", "SPAN_HEIGHT", "INEFFECTIVE_SUPPORT") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
  TBL_SVY_HEADER.SVY_YESNO_A                  AS PIPE_CRADLED,
  TBL_SVY_HEADER.SVY_INTEGER_A                  AS AV_PIPE_BURIAL,
  TBL_SVY_HEADER.SVY_YESNO_B                 AS PIPE_COVERED,
  TBL_SVY_HEADER.SVY_TEXT_A                  AS BERM_EXTENT_L_R,
  TBL_SVY_HEADER.SVY_SINGLE_A                  AS SPAN_HEIGHT,
  TBL_SVY_HEADER.SVY_YESNO_C                  AS INEFFECTIVE_SUPPORT
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 5;
--------------------------------------------------------
--  DDL for View V_ARCGIS_ROV_ELEVATION
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_ROV_ELEVATION" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "MAX_HEIGHT_ABOVE_PIPELINE", "AV_HEIGHT_ABOVE_PIPELINE") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_INTEGER_A AS MAX_HEIGHT_ABOVE_PIPELINE,
TBL_SVY_HEADER.SVY_INTEGER_B AS AV_HEIGHT_ABOVE_PIPELINE
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 40;
--------------------------------------------------------
--  DDL for View V_ARCGIS_SCOUR_MEASUREMENT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_SCOUR_MEASUREMENT" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "SCOUR_LOCATION", "MEASUREMENT") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS SCOUR_LOCATION,
TBL_SVY_HEADER.SVY_SINGLE_A AS MEASUREMENT 

FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 52;
--------------------------------------------------------
--  DDL for View V_ARCGIS_SEABED
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_SEABED" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "SEABED_TYPEV") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS SEABED_TYPEV
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 41;
--------------------------------------------------------
--  DDL for View V_ARCGIS_SEAQUILL_SPAN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_SEAQUILL_SPAN" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "SOIL_TYPE_START", "SOIL_TYPE_END", "SOIL_TYPE_INTERMEDIATE", "MAX_SPAN_HEIGHT", "JP_KENNY_REFERENCE", "SPAN_LENGTH", "DVL_LENGTH", "MAX_SPAN_HEIGHT__AUTOMATED") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS SOIL_TYPE_START,
TBL_SVY_HEADER.SVY_TEXT_B AS SOIL_TYPE_END,
TBL_SVY_HEADER.SVY_TEXT_C AS SOIL_TYPE_INTERMEDIATE,
TBL_SVY_HEADER.SVY_INTEGER_A AS MAX_SPAN_HEIGHT,
TBL_SVY_HEADER.SVY_TEXT_D AS JP_KENNY_REFERENCE,
TBL_SVY_HEADER.SVY_SINGLE_A AS SPAN_LENGTH,
TBL_SVY_HEADER.SVY_SINGLE_B AS DVL_LENGTH,
TBL_SVY_HEADER.SVY_SINGLE_C AS MAX_SPAN_HEIGHT__AUTOMATED
FROM
  TBL_SVY_HEADER
INNER JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
INNER JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
INNER JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 25;
--------------------------------------------------------
--  DDL for View V_ARCGIS_SEAQUILL_SPAN_TDP
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_SEAQUILL_SPAN_TDP" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "SVY_HDR_NOD_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "KP", "DATE_AND_TIME", "TOUCHDOWN", "LENGTHV", "TDP_SEABEDV", "TDP_SUPPORTV") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS SVY_HDR_NOD_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_SINGLE_A AS KP,
TBL_SVY_HEADER.SVY_DATETIME_A AS DATE_AND_TIME,
TBL_SVY_HEADER.SVY_INTEGER_A AS TOUCHDOWN,
TBL_SVY_HEADER.SVY_TEXT_A AS LENGTHV,
TBL_SVY_HEADER.SVY_TEXT_B AS TDP_SEABEDV,
TBL_SVY_HEADER.SVY_TEXT_C AS TDP_SUPPORTV
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID;
--------------------------------------------------------
--  DDL for View V_ARCGIS_SETTLEMENT_MEA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_SETTLEMENT_MEA" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "MEASUREMENT_LOC", "DATUM", "DISTANCE") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS MEASUREMENT_LOC,
TBL_SVY_HEADER.SVY_TEXT_B AS DATUM,
TBL_SVY_HEADER.SVY_INTEGER_A AS DISTANCE
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 60 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_SPAN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_SPAN" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "SOIL_TYPE_START", "SOIL_TYPE_END", "SOIL_TYPE_INTERMEDIATE", "MAX_SPAN_HEIGHT", "JP_KENNY_REFERENCE", "SPAN_LENGTH", "DVL_LENGTH", "MAX_SPAN_HEIGHT_AUTOMATED") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS SOIL_TYPE_START,
TBL_SVY_HEADER.SVY_TEXT_B AS SOIL_TYPE_END,
TBL_SVY_HEADER.SVY_TEXT_C AS SOIL_TYPE_INTERMEDIATE,
TBL_SVY_HEADER.SVY_INTEGER_A AS MAX_SPAN_HEIGHT,
TBL_SVY_HEADER.SVY_TEXT_D AS JP_KENNY_REFERENCE,
TBL_SVY_HEADER.SVY_SINGLE_A AS SPAN_LENGTH,
TBL_SVY_HEADER.SVY_SINGLE_B AS DVL_LENGTH,
TBL_SVY_HEADER.SVY_SINGLE_C AS MAX_SPAN_HEIGHT_AUTOMATED
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 25;
--------------------------------------------------------
--  DDL for View V_ARCGIS_STABILISATION
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_STABILISATION" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "STABILISATION_TYPE", "CONFIGURATION", "SUPPORTS", "STABILISATION_IN_GOOD_CONDITI", "PROTECTION_TYPE", "ORIENTATION", "PROTECTION_IN_GOOD_CONDITION", "DISTANCE_FROM_PIPE") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS STABILISATION_TYPE,
TBL_SVY_HEADER.SVY_TEXT_B AS CONFIGURATION,
TBL_SVY_HEADER.SVY_YESNO_A AS SUPPORTS,
TBL_SVY_HEADER.SVY_YESNO_B AS STABILISATION_IN_GOOD_CONDITI,
TBL_SVY_HEADER.SVY_TEXT_C AS PROTECTION_TYPE,
TBL_SVY_HEADER.SVY_TEXT_D AS ORIENTATION,
TBL_SVY_HEADER.SVY_YESNO_C AS PROTECTION_IN_GOOD_CONDITION,
TBL_SVY_HEADER.SVY_SINGLE_A AS DISTANCE_FROM_PIPE
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 26;
--------------------------------------------------------
--  DDL for View V_ARCGIS_STATUS_CHECK
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_STATUS_CHECK" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "SPECIAL_INSTRUCTION_REVIEWED", "FOUND_AS_SPECIFIED") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_YESNO_A AS SPECIAL_INSTRUCTION_REVIEWED,
TBL_SVY_HEADER.SVY_YESNO_B AS FOUND_AS_SPECIFIED
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 27;
--------------------------------------------------------
--  DDL for View V_ARCGIS_STRUCTURAL_SCOUR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_STRUCTURAL_SCOUR" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "NO_SCOUR_APPARENT", "SCOUR_LOCATION", "EXTENT_OR_DESCRIPTION", "CLEARANCE_AND_LOCATION", "MEASUREMENT_METHOD", "MAX_SCOUR") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_YESNO_A AS NO_SCOUR_APPARENT,
TBL_SVY_HEADER.SVY_TEXT_A AS SCOUR_LOCATION,
TBL_SVY_HEADER.SVY_MEMO_A AS EXTENT_OR_DESCRIPTION,
TBL_SVY_HEADER.SVY_MEMO_B AS CLEARANCE_AND_LOCATION,
TBL_SVY_HEADER.SVY_TEXT_B AS MEASUREMENT_METHOD,
TBL_SVY_HEADER.SVY_SINGLE_A AS MAXSCOUR
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 28;
--------------------------------------------------------
--  DDL for View V_ARCGIS_SURVEY_NOTE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_SURVEY_NOTE" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "NOTE", "CATEGORY") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_MEMO_A AS NOTE,
TBL_SVY_HEADER.SVY_TEXT_A AS CATEGORY
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 42;
--------------------------------------------------------
--  DDL for View V_ARCGIS_VALVE_OPR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_VALVE_OPR" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "FOUND_STA", "TORQUE_TOOL", "CAL_DATE", "CO_WITNESS", "CAL_WITNESS", "BREAKOUT_TORQUE", "RUNNING_TORQUE", "CLOSING_TORQUE", "NO_TURNS", "START_TIME", "FUNC_DUR", "DIRECTION", "OPER_WITNESS", "TASK_PLAN_NAME", "TASK_PLAN_STEP", "LEFT_STA") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS FOUND_STA,
TBL_SVY_HEADER.SVY_TEXT_B AS TORQUE_TOOL,
TBL_SVY_HEADER.SVY_DATETIME_A AS CAL_DATE,
TBL_SVY_HEADER.SVY_TEXT_C AS CO_WITNESS,
TBL_SVY_HEADER.SVY_TEXT_D AS CAL_WITNESS,
TBL_SVY_HEADER.SVY_SINGLE_A AS BREAKOUT_TORQUE,
TBL_SVY_HEADER.SVY_SINGLE_B AS RUNNING_TORQUE,
TBL_SVY_HEADER.SVY_SINGLE_C AS CLOSING_TORQUE,
TBL_SVY_HEADER.SVY_TEXT_E AS NO_TURNS,
TBL_SVY_HEADER.SVY_DATETIME_B AS START_TIME,
TBL_SVY_HEADER.SVY_INTEGER_A AS FUNC_DUR,
TBL_SVY_HEADER.SVY_TEXT_F AS DIRECTION,
TBL_SVY_HEADER.SVY_TEXT_G AS OPER_WITNESS,
TBL_SVY_HEADER.SVY_TEXT_H AS TASK_PLAN_NAME,
TBL_SVY_HEADER.SVY_TEXT_I AS TASK_PLAN_STEP,
TBL_SVY_HEADER.SVY_TEXT_J AS LEFT_STA
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 54 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_WEAR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_WEAR" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "WEAR_SITE_LOCATION", "MEASURED_SECTION", "MEASUREMENT_1", "MEASUREMENT_2", "ACCURACY", "METHOD_OR_EQUIP_TYPE") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS WEAR_SITE_LOCATION,
TBL_SVY_HEADER.SVY_TEXT_B AS MEASURED_SECTION,
TBL_SVY_HEADER.SVY_SINGLE_A AS MEASUREMENT_1,
TBL_SVY_HEADER.SVY_SINGLE_B AS MEASUREMENT_2,
TBL_SVY_HEADER.SVY_TEXT_C AS ACCURACY,
TBL_SVY_HEADER.SVY_TEXT_D AS METHOD_OR_EQUIP_TYPE
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 29;
--------------------------------------------------------
--  DDL for View V_ARCGIS_WELD_CVI
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_WELD_CVI" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "ITEM_OR_AREA", "DEFECT_SUMMARY", "DEFECTS_MARKED", "DIVER_OR_INSPECTOR", "DATA_RECORDER", "REPORT_REF", "OTHER_REF") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS ITEM_OR_AREA,
TBL_SVY_HEADER.SVY_TEXT_B AS DEFECT_SUMMARY,
TBL_SVY_HEADER.SVY_TEXT_C AS DEFECTS_MARKED,
TBL_SVY_HEADER.SVY_TEXT_D AS DIVER_OR_INSPECTOR,
TBL_SVY_HEADER.SVY_TEXT_E AS DATA_RECORDER,
TBL_SVY_HEADER.SVY_TEXT_F AS REPORT_REF,
TBL_SVY_HEADER.SVY_TEXT_G AS OTHER_REF
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 30;
--------------------------------------------------------
--  DDL for View V_ARCGIS_WT_CALIBRATION
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_WT_CALIBRATION" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "CAL_NO", "DTE", "TME", "EXP_VAL_1", "ACT_VAL_1", "EXP_VAL_2", "ACT_VAL_2", "EXP_VAL_3", "ACT_VAL_3", "EXP_VAL_4", "ACT_VAL_4", "CAL_PT") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_TEXT_A AS CAL_NO,
TBL_SVY_HEADER.SVY_TEXT_B AS DTE,
TBL_SVY_HEADER.SVY_TEXT_C AS TME,
TBL_SVY_HEADER.SVY_SINGLE_A AS EXP_VAL_1,
TBL_SVY_HEADER.SVY_SINGLE_B AS ACT_VAL_1,
TBL_SVY_HEADER.SVY_SINGLE_C AS EXP_VAL_2,
TBL_SVY_HEADER.SVY_SINGLE_D AS ACT_VAL_2,
TBL_SVY_HEADER.SVY_SINGLE_E AS EXP_VAL_3,
TBL_SVY_HEADER.SVY_SINGLE_F AS ACT_VAL_3,
TBL_SVY_HEADER.SVY_SINGLE_G AS EXP_VAL_4,
TBL_SVY_HEADER.SVY_SINGLE_H AS ACT_VAL_4,
TBL_SVY_HEADER.SVY_TEXT_D AS CAL_PT 
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 53 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ARCGIS_WT_MEASUREMENT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ARCGIS_WT_MEASUREMENT" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "ASSET_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR", "PRE_CLEANED", "SITE_DTL", "MAPPING", "CAL_CHECK", "CAL_ACTUAL", "EQUIPMENT", "LOC_1", "MEASUREMENT_1", "LOC_2", "MEASUREMENT_2", "LOC_3", "MEASUREMENT_3") AS 
  SELECT
  TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC  AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                     - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 -
  TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING)  * (0 -
  TBL_SVY_POSITION_END.SVY_POS_EASTING) AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS ASSET_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR,
TBL_SVY_HEADER.SVY_YESNO_A AS PRE_CLEANED,
TBL_SVY_HEADER.SVY_TEXT_A AS SITE_DTL,
TBL_SVY_HEADER.SVY_YESNO_B AS MAPPING,
TBL_SVY_HEADER.SVY_SINGLE_D AS CAL_CHECK,
TBL_SVY_HEADER.SVY_SINGLE_E AS CAL_ACTUAL,
TBL_SVY_HEADER.SVY_TEXT_B AS EQUIPMENT,
TBL_SVY_HEADER.SVY_TEXT_C AS LOC_1,
TBL_SVY_HEADER.SVY_SINGLE_A AS MEASUREMENT_1,
TBL_SVY_HEADER.SVY_TEXT_D AS LOC_2,
TBL_SVY_HEADER.SVY_SINGLE_B AS MEASUREMENT_2,
TBL_SVY_HEADER.SVY_TEXT_E AS LOC_3,
TBL_SVY_HEADER.SVY_SINGLE_C AS MEASUREMENT_3 
FROM
  TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON
  TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON
  TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON
  TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON
  TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON
  TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON
  TBL_SVY_HEADER.SVY_HDR_COLOUR = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ID   = 31 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_ASSET_DIAGRAM
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_ASSET_DIAGRAM" ("REC_TAG", "NODE_DESC") AS 
  SELECT SYS_NODES_ATTRIB.REC_TAG,
  SYS_NODES_ATTRIB.NODE_DESC
FROM SYS_NODES_ATTRIB
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG       = SYS_TREE_STRUC.TRE_DAT_TAG
WHERE SYS_TREE_STRUC.TRE_DAT_TYPE = 1
AND SYS_NODES_ATTRIB.VUL_EQUT     = '1'
ORDER BY SYS_NODES_ATTRIB.NODE_DESC
  WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_BAB
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_BAB" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_BAC_BAC_REC_TYPE", "CHD_BAC_BAC_PSRB", "CHD_BAC_BAC_PGRB", "CHD_BAC_BAC_PNRB", "CHD_BAC_BAC_PNRSOB", "CHD_BAC_BAC_SSRB", "CHD_BAC_BAC_SGRB", "CHD_BAC_BAC_SNRB", "CHD_BAC_BAC_SNRSOB", "CHD_UPDATE_DATE", "CHD_BAC_BAC_REC_TYPE_TEXT") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_REC_TYPE,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_PSRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_PGRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_PNRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_PNRSOB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_SSRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_SGRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_SNRB,
  TBL_CHD_BAC_BAC.CHD_BAC_BAC_SNRSOB,
  TBL_CHD_BAC_BAC.CHD_UPDATE_DATE,
  SYS_LOOKUPS.LKP_DESC_B AS CHD_BAC_BAC_REC_TYPE_TEXT
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_BAC_BAC
ON TBL_CHD_BAC_BAC.CHD_BAC_BAC_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
LEFT JOIN SYS_LOOKUPS
ON TBL_CHD_BAC_BAC.CHD_BAC_BAC_REC_TYPE = SYS_LOOKUPS.LKP_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE     = 3 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_BABT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_BABT" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID
FROM V_TBL_CHD_HEADER
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE =7;
--------------------------------------------------------
--  DDL for View V_CH_BSW
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_BSW" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_HDR_TXT1", "CHD_HDR_INT", "CHD_HDR_DBL") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TXT1,
  V_TBL_CHD_HEADER.CHD_HDR_INT,
  V_TBL_CHD_HEADER.CHD_HDR_DBL
FROM V_TBL_CHD_HEADER
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 10;
--------------------------------------------------------
--  DDL for View V_CH_CC
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_CC" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_COUP_CORR_DT_INST", "CHD_COUP_CORR_DT_REM", "CHD_COUP_CORR_DAYS_EXP", "CHD_COUP_CORR_GEN_MPY", "CHD_COUP_CORR_PITTING_MPY", "CHD_UPDATE_DATE") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_COUP_CORR.CHD_COUP_CORR_DT_INST,
  TBL_CHD_COUP_CORR.CHD_COUP_CORR_DT_REM,
  TBL_CHD_COUP_CORR.CHD_COUP_CORR_DAYS_EXP,
  TBL_CHD_COUP_CORR.CHD_COUP_CORR_GEN_MPY,
  TBL_CHD_COUP_CORR.CHD_COUP_CORR_PITTING_MPY,
  TBL_CHD_COUP_CORR.CHD_UPDATE_DATE
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_COUP_CORR
ON TBL_CHD_COUP_CORR.CHD_COUP_CORR_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE   = 8 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_CD
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_CD" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_CHEM_QUAL_GNAME", "CHD_CHEM_QUAL_PNAME", "CHD_CHEM_QUAL_CNAME", "CHD_CHEM_QUAL_REC_T", "CHD_UPDATE_DATE", "CHD_CHEM_QUAL_GNAME_TEXT") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_GNAME,
  TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_PNAME,
  TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_CNAME,
  TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_REC_T,
  TBL_CHD_CHEM_QUAL.CHD_UPDATE_DATE,
  SYS_LOOKUPS.LKP_DESC_B AS CHD_CHEM_QUAL_GNAME_TEXT
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_CHEM_QUAL
ON TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
LEFT JOIN SYS_LOOKUPS
ON SYS_LOOKUPS.LKP_ID               = TBL_CHD_CHEM_QUAL.CHD_CHEM_QUAL_GNAME
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 17 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_CR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_CR" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_CHEM_RSD_GNAME", "CHD_CHEM_RSD_PNAME", "CHD_CHEM_RSD_CNAME", "CHD_CHEM_RSD_IPOINT", "CHD_CHEM_RSD_REC_T", "CHD_CHEM_RSD_ACT_RATE", "CHD_UPDATE_DATE", "CHD_CHEM_RSD_GNAME_TEXT") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_GNAME,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_PNAME,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_CNAME,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_IPOINT,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_REC_T,
  TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_ACT_RATE,
  TBL_CHD_CHEM_RSD.CHD_UPDATE_DATE,
  SYS_LOOKUPS.LKP_DESC_B AS CHD_CHEM_RSD_GNAME_TEXT
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_CHEM_RSD
ON TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
LEFT JOIN SYS_LOOKUPS
ON SYS_LOOKUPS.LKP_ID               = TBL_CHD_CHEM_RSD.CHD_CHEM_RSD_GNAME
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 20 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_CTR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_CTR" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_CHEM_TREAT_GNAME", "CHD_CHEM_TREAT_PNAME", "CHD_CHEM_TREAT_CNAME", "CHD_CHEM_TREAT_IPOINT", "CHD_CHEM_TREAT_REC_T", "CHD_CHEM_TREAT_ACT_RATE", "CHD_UPDATE_DATE", "CHD_CHEM_TREAT_REC_CON", "CHD_CHEM_TREAT_REC_CON_BASIS", "CHD_CHEM_TREAT_GNAME_TEXT", "CHD_CHEM_TREAT_BASIS_TEXT") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_GNAME,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_PNAME,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_CNAME,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_IPOINT,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_REC_T,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_ACT_RATE,
  TBL_CHD_CHEM_TREAT.CHD_UPDATE_DATE,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_REC_CON,
  TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_REC_CON_BASIS,
  SYS_LOOKUPS.LKP_DESC_B  AS CHD_CHEM_TREAT_GNAME_TEXT,
  SYS_LOOKUPS1.LKP_DESC_B AS CHD_CHEM_TREAT_BASIS_TEXT
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_CHEM_TREAT
ON TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
LEFT JOIN SYS_LOOKUPS
ON SYS_LOOKUPS.LKP_ID = TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_GNAME
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON SYS_LOOKUPS1.LKP_ID              = TBL_CHD_CHEM_TREAT.CHD_CHEM_TREAT_REC_CON_BASIS
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 16 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_FA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_FA" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "TRE_DAT_TYPE", "CHD_HDR_INT", "CHD_HDR_INT_NAME") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  V_TBL_CHD_HEADER.TRE_DAT_TYPE,
  V_TBL_CHD_HEADER.CHD_HDR_INT,
  SYS_LOOKUPS.LKP_DESC_B AS CHD_HDR_INT_NAME
FROM SYS_LOOKUPS
RIGHT JOIN V_TBL_CHD_HEADER
ON SYS_LOOKUPS.LKP_GRP_ID = V_TBL_CHD_HEADER.CHD_HDR_INT WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_FS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_FS" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID
FROM V_TBL_CHD_HEADER
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 18 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_GA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_GA" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_GLY_TSS", "CHD_GLY_THC", "CHD_GLY_TDS", "CHD_GLY_PH", "CHD_GLY_FOAMING", "CHD_GLY_FOAMING_TIME", "CHD_GLY_H2O", "CHD_GLY_IRON", "CHD_GLY_CALCIUM", "CHD_GLY_POTASSIUM", "CHD_GLY_MAGNESIUM", "CHD_GLY_SODIUM", "CHD_GLY_SPGR", "CHD_GLY_CHLORIDE", "CHD_GLY_FLASH", "CHD_GLY_MEG", "CHD_GLY_DEG", "CHD_GLY_TEG", "CHD_GLY_TTEG", "CHD_GLY_OTHER", "CHD_GLY_RESID", "CHD_GLY_APP", "CHD_UPDATE_DATE") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_GLY.CHD_GLY_TSS,
  TBL_CHD_GLY.CHD_GLY_THC,
  TBL_CHD_GLY.CHD_GLY_TDS,
  TBL_CHD_GLY.CHD_GLY_PH,
  TBL_CHD_GLY.CHD_GLY_FOAMING,
  TBL_CHD_GLY.CHD_GLY_FOAMING_TIME,
  TBL_CHD_GLY.CHD_GLY_H2O,
  TBL_CHD_GLY.CHD_GLY_IRON,
  TBL_CHD_GLY.CHD_GLY_CALCIUM,
  TBL_CHD_GLY.CHD_GLY_POTASSIUM,
  TBL_CHD_GLY.CHD_GLY_MAGNESIUM,
  TBL_CHD_GLY.CHD_GLY_SODIUM,
  TBL_CHD_GLY.CHD_GLY_SPGR,
  TBL_CHD_GLY.CHD_GLY_CHLORIDE,
  TBL_CHD_GLY.CHD_GLY_FLASH,
  TBL_CHD_GLY.CHD_GLY_MEG,
  TBL_CHD_GLY.CHD_GLY_DEG,
  TBL_CHD_GLY.CHD_GLY_TEG,
  TBL_CHD_GLY.CHD_GLY_TTEG,
  TBL_CHD_GLY.CHD_GLY_OTHER,
  TBL_CHD_GLY.CHD_GLY_RESID,
  TBL_CHD_GLY.CHD_GLY_APP,
  TBL_CHD_GLY.CHD_UPDATE_DATE
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_GLY
ON TBL_CHD_GLY.CHD_GLY_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 12 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_HC
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_HC" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_GAP_CO2", "CHD_GAP_H2S", "CHD_UPDATE_DATE") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_GAP.CHD_GAP_CO2,
  TBL_CHD_GAP.CHD_GAP_H2S,
  TBL_CHD_GAP.CHD_UPDATE_DATE
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_GAP
ON TBL_CHD_GAP.CHD_GAP_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 1 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_HFA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_HFA" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_HFA_DTAKEN", "CHD_HFA_DREC", "CHD_HFA_DTESTED", "CHD_HFA_DISSUED", "CHD_HFA_REP_TO", "CHD_HFA_EMAIL_FAX", "CHD_HFA_FNAME", "CHD_HFA_SOURCE", "CHD_HFA_INSTSITE", "CHD_HFA_CHK_FILT", "CHD_HFA_ELIM_SRC", "CHD_HFA_SUB_ADD_SAMP", "CHD_HFA_COLOR", "CHD_HFA_GLYCOL", "CHD_HFA_LIQ_COR", "CHD_HFA_PH", "CHD_HFA_COND", "CHD_HFA_WATER_H", "CHD_HFA_SPGR", "CHD_HFA_BAC_CNT", "CHD_HFA_FUNGI_CNT", "CHD_HFA_COLOR_R", "CHD_HFA_GLYCOL_R", "CHD_HFA_LIQ_COR_R", "CHD_HFA_PH_R", "CHD_HFA_COND_R", "CHD_HFA_WATER_H_R", "CHD_HFA_SPGR_R", "CHD_HFA_BAC_CNT_R", "CHD_HFA_FUNGI_CNT_R", "CHD_HFA_SIL", "CHD_HFA_ELAS", "CHD_HFA_FIBERS", "CHD_HFA_PREC", "CHD_HFA_GEL", "CHD_HFA_NAS_CL", "CHD_HFA_OIL", "CHD_HFA_YELL_MET", "CHD_HFA_BLK_MET", "CHD_HFA_BRT_MET", "CHD_HFA_GREASE", "CHD_HFA_RUST", "CHD_HFA_OLIG", "CHD_HFA_SILICA", "CHD_HFA_OTHERS", "CHD_HFA_OTHERS_R", "CHD_HFA_PASS_FAIL", "CHD_UPDATE_DATE") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_HFA.CHD_HFA_DTAKEN,
  TBL_CHD_HFA.CHD_HFA_DREC,
  TBL_CHD_HFA.CHD_HFA_DTESTED,
  TBL_CHD_HFA.CHD_HFA_DISSUED,
  TBL_CHD_HFA.CHD_HFA_REP_TO,
  TBL_CHD_HFA.CHD_HFA_EMAIL_FAX,
  TBL_CHD_HFA.CHD_HFA_FNAME,
  TBL_CHD_HFA.CHD_HFA_SOURCE,
  TBL_CHD_HFA.CHD_HFA_INSTSITE,
  TBL_CHD_HFA.CHD_HFA_CHK_FILT,
  TBL_CHD_HFA.CHD_HFA_ELIM_SRC,
  TBL_CHD_HFA.CHD_HFA_SUB_ADD_SAMP,
  TBL_CHD_HFA.CHD_HFA_COLOR,
  TBL_CHD_HFA.CHD_HFA_GLYCOL,
  TBL_CHD_HFA.CHD_HFA_LIQ_COR,
  TBL_CHD_HFA.CHD_HFA_PH,
  TBL_CHD_HFA.CHD_HFA_COND,
  TBL_CHD_HFA.CHD_HFA_WATER_H,
  TBL_CHD_HFA.CHD_HFA_SPGR,
  TBL_CHD_HFA.CHD_HFA_BAC_CNT,
  TBL_CHD_HFA.CHD_HFA_FUNGI_CNT,
  TBL_CHD_HFA.CHD_HFA_COLOR_R,
  TBL_CHD_HFA.CHD_HFA_GLYCOL_R,
  TBL_CHD_HFA.CHD_HFA_LIQ_COR_R,
  TBL_CHD_HFA.CHD_HFA_PH_R,
  TBL_CHD_HFA.CHD_HFA_COND_R,
  TBL_CHD_HFA.CHD_HFA_WATER_H_R,
  TBL_CHD_HFA.CHD_HFA_SPGR_R,
  TBL_CHD_HFA.CHD_HFA_BAC_CNT_R,
  TBL_CHD_HFA.CHD_HFA_FUNGI_CNT_R,
  TBL_CHD_HFA.CHD_HFA_SIL,
  TBL_CHD_HFA.CHD_HFA_ELAS,
  TBL_CHD_HFA.CHD_HFA_FIBERS,
  TBL_CHD_HFA.CHD_HFA_PREC,
  TBL_CHD_HFA.CHD_HFA_GEL,
  TBL_CHD_HFA.CHD_HFA_NAS_CL,
  TBL_CHD_HFA.CHD_HFA_OIL,
  TBL_CHD_HFA.CHD_HFA_YELL_MET,
  TBL_CHD_HFA.CHD_HFA_BLK_MET,
  TBL_CHD_HFA.CHD_HFA_BRT_MET,
  TBL_CHD_HFA.CHD_HFA_GREASE,
  TBL_CHD_HFA.CHD_HFA_RUST,
  TBL_CHD_HFA.CHD_HFA_OLIG,
  TBL_CHD_HFA.CHD_HFA_SILICA,
  TBL_CHD_HFA.CHD_HFA_OTHERS,
  TBL_CHD_HFA.CHD_HFA_OTHERS_R,
  TBL_CHD_HFA.CHD_HFA_PASS_FAIL,
  TBL_CHD_HFA.CHD_UPDATE_DATE
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_HFA
ON TBL_CHD_HFA.CHD_HFA_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 19 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_OA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_OA" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_OWA_GRAVITY", "CHD_OWA_INHIBITOR", "CHD_OWA_CLOUD_PT", "CHD_OWA_POUR_PT", "CHD_OWA_PARAFFIN", "CHD_OWA_ASPHALTENE", "CHD_UPDATE_DATE") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_OWA.CHD_OWA_GRAVITY,
  TBL_CHD_OWA.CHD_OWA_INHIBITOR,
  TBL_CHD_OWA.CHD_OWA_CLOUD_PT,
  TBL_CHD_OWA.CHD_OWA_POUR_PT,
  TBL_CHD_OWA.CHD_OWA_PARAFFIN,
  TBL_CHD_OWA.CHD_OWA_ASPHALTENE,
  TBL_CHD_OWA.CHD_UPDATE_DATE
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_OWA
ON TBL_CHD_OWA.CHD_OWA_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 2 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_PWA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_PWA" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_PWA_SPGR", "CHD_PWA_TEMP", "CHD_PWA_HARDNESS", "CHD_PWA_TDS", "CHD_PWA_ACR", "CHD_PWA_TSS", "CHD_PWA_FE", "CHD_PWA_SULFATE", "CHD_PWA_PH", "CHD_PWA_O2", "CHD_PWA_H2S", "CHD_PWA_SODIUM", "CHD_PWA_CALCIUM", "CHD_PWA_MAGNESIUM", "CHD_PWA_BARIUM", "CHD_PWA_BROMIDE", "CHD_PWA_POTASSIUM", "CHD_PWA_MANGANESE", "CHD_PWA_IRONSOLID", "CHD_PWA_IRONDISS", "CHD_PWA_ZINC", "CHD_PWA_CHLORIDE", "CHD_PWA_CARBONATE", "CHD_PWA_BICARB", "CHD_PWA_SCALETEN", "CHD_PWA_RESQTY", "CHD_PWA_CONQTY", "CHD_UPDATE_DATE", "CHD_PWA_TA", "CHD_PWA_TA_NAME", "CHD_PWA_TOTL_ALKALI", "CHD_PWA_CO2") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_PWA.CHD_PWA_SPGR,
  TBL_CHD_PWA.CHD_PWA_TEMP,
  TBL_CHD_PWA.CHD_PWA_HARDNESS,
  TBL_CHD_PWA.CHD_PWA_TDS,
  TBL_CHD_PWA.CHD_PWA_ACR,
  TBL_CHD_PWA.CHD_PWA_TSS,
  TBL_CHD_PWA.CHD_PWA_FE,
  TBL_CHD_PWA.CHD_PWA_SULFATE,
  TBL_CHD_PWA.CHD_PWA_PH,
  TBL_CHD_PWA.CHD_PWA_O2,
  TBL_CHD_PWA.CHD_PWA_H2S,
  TBL_CHD_PWA.CHD_PWA_SODIUM,
  TBL_CHD_PWA.CHD_PWA_CALCIUM,
  TBL_CHD_PWA.CHD_PWA_MAGNESIUM,
  TBL_CHD_PWA.CHD_PWA_BARIUM,
  TBL_CHD_PWA.CHD_PWA_BROMIDE,
  TBL_CHD_PWA.CHD_PWA_POTASSIUM,
  TBL_CHD_PWA.CHD_PWA_MANGANESE,
  TBL_CHD_PWA.CHD_PWA_IRONSOLID,
  TBL_CHD_PWA.CHD_PWA_IRONDISS,
  TBL_CHD_PWA.CHD_PWA_ZINC,
  TBL_CHD_PWA.CHD_PWA_CHLORIDE,
  TBL_CHD_PWA.CHD_PWA_CARBONATE,
  TBL_CHD_PWA.CHD_PWA_BICARB,
  TBL_CHD_PWA.CHD_PWA_SCALETEN,
  TBL_CHD_PWA.CHD_PWA_RESQTY,
  TBL_CHD_PWA.CHD_PWA_CONQTY,
  TBL_CHD_PWA.CHD_UPDATE_DATE,
  TBL_CHD_PWA.CHD_PWA_TA,
  TBL_CHD_PWA.CHD_PWA_TA_NAME,
  TBL_CHD_PWA.CHD_PWA_TOTL_ALKALI,
  TBL_CHD_PWA.CHD_PWA_CO2
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_PWA
ON TBL_CHD_PWA.CHD_PWA_ID           = V_TBL_CHD_HEADER.CHD_HDR_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 4 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_SA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_SA" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_HDR_INT", "CHD_HDR_INT_TEXT") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_INT,
  SYS_LOOKUPS.LKP_DESC_B AS CHD_HDR_INT_TEXT
FROM V_TBL_CHD_HEADER
LEFT JOIN SYS_LOOKUPS
ON SYS_LOOKUPS.LKP_ID = V_TBL_CHD_HEADER.CHD_HDR_INT
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 5 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_SC
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_SC" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_COUP_SC_DT_INST", "CHD_COUP_SC_DT_REM", "CHD_COUP_SC_DAYS_EXP", "CHD_COUP_SC_WTGN", "CHD_COUP_SC_WTGN_DY", "CHD_UPDATE_DATE") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_DT_INST,
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_DT_REM,
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_DAYS_EXP,
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_WTGN,
  TBL_CHD_COUP_SCALE.CHD_COUP_SC_WTGN_DY,
  TBL_CHD_COUP_SCALE.CHD_UPDATE_DATE
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_COUP_SCALE
ON TBL_CHD_COUP_SCALE.CHD_COUP_SC_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE  = 9 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_WHRU
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_WHRU" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_WHRU_WHRU_OI", "CHD_WHRU_WHRU_PH", "CHD_WHRU_WHRU_NIT", "CHD_UPDATE_DATE") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_WHRU_WHRU.CHD_WHRU_WHRU_OI,
  TBL_CHD_WHRU_WHRU.CHD_WHRU_WHRU_PH,
  TBL_CHD_WHRU_WHRU.CHD_WHRU_WHRU_NIT,
  TBL_CHD_WHRU_WHRU.CHD_UPDATE_DATE
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_WHRU_WHRU
ON TBL_CHD_WHRU_WHRU.CHD_WHRU_WHRU_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE   = 13 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_WHRUJ
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_WHRUJ" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_WHRU_JACKET_OI", "CHD_WHRU_JACKET_PH", "CHD_WHRU_JACKET_SUL", "CHD_UPDATE_DATE") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_WHRU_JACKET.CHD_WHRU_JACKET_OI,
  TBL_CHD_WHRU_JACKET.CHD_WHRU_JACKET_PH,
  TBL_CHD_WHRU_JACKET.CHD_WHRU_JACKET_SUL,
  TBL_CHD_WHRU_JACKET.CHD_UPDATE_DATE
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_WHRU_JACKET
ON TBL_CHD_WHRU_JACKET.CHD_WHRU_JACKET_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE       = 14 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_WHRUWA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_WHRUWA" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_WHRU_WATER_TDS", "CHD_WHRU_WATER_TSS", "CHD_WHRU_WATER_IRON", "CHD_WHRU_WATER_SPGR", "CHD_WHRU_WATER_COND", "CHD_WHRU_WATER_HARDNESS", "CHD_WHRU_WATER_SODIUM", "CHD_WHRU_WATER_CALCIUM", "CHD_WHRU_WATER_PH", "CHD_WHRU_WATER_TEMP", "CHD_WHRU_WATER_MAGNESIUM", "CHD_WHRU_WATER_CHLORIDE", "CHD_WHRU_WATER_SULFATE", "CHD_UPDATE_DATE") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_TDS,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_TSS,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_IRON,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_SPGR,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_COND,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_HARDNESS,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_SODIUM,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_CALCIUM,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_PH,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_TEMP,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_MAGNESIUM,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_CHLORIDE,
  TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_SULFATE,
  TBL_CHD_WHRU_WATER.CHD_UPDATE_DATE
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_WHRU_WATER
ON TBL_CHD_WHRU_WATER.CHD_WHRU_WATER_ID = V_TBL_CHD_HEADER.CHD_HDR_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 15 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_CH_WQA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_CH_WQA" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "CHD_WQA_OP_INIT", "CHD_WQA_EST_RATE", "CHD_WQA_O2", "CHD_WQA_FIELD_IR", "CHD_WQA_LAB_IR", "CHD_WQA_WSO_IR", "CHD_WQA_MNLY_IR", "CHD_WQA_MNLY_LAB", "CHD_UPDATE_DATE") AS 
  SELECT V_TBL_CHD_HEADER.CHD_HDR_ID,
  V_TBL_CHD_HEADER.CHD_HDR_TYPE,
  V_TBL_CHD_HEADER.LOCATION,
  V_TBL_CHD_HEADER.ASSET_DESC,
  V_TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  V_TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  V_TBL_CHD_HEADER.STATUS,
  V_TBL_CHD_HEADER.VENDOR,
  V_TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  V_TBL_CHD_HEADER.STATUS_ID,
  V_TBL_CHD_HEADER.VENDOR_ID,
  TBL_CHD_WQA.CHD_WQA_OP_INIT,
  TBL_CHD_WQA.CHD_WQA_EST_RATE,
  TBL_CHD_WQA.CHD_WQA_O2,
  TBL_CHD_WQA.CHD_WQA_FIELD_IR,
  TBL_CHD_WQA.CHD_WQA_LAB_IR,
  TBL_CHD_WQA.CHD_WQA_WSO_IR,
  TBL_CHD_WQA.CHD_WQA_MNLY_IR,
  TBL_CHD_WQA.CHD_WQA_MNLY_LAB,
  TBL_CHD_WQA.CHD_UPDATE_DATE
FROM V_TBL_CHD_HEADER
INNER JOIN TBL_CHD_WQA
ON TBL_CHD_WQA.CHD_WQA_ID           = V_TBL_CHD_HEADER.CHD_HDR_ID
WHERE V_TBL_CHD_HEADER.CHD_HDR_TYPE = 11 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_DATABASE_PROPERTIES
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_DATABASE_PROPERTIES" ("PROPERTY_NAME", "PROPERTY_VALUE", "DESCRIPTION") AS 
  SELECT PROPERTY_NAME, PROPERTY_VALUE, DESCRIPTION FROM DATABASE_PROPERTIES WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_EWIMS_LIST
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_EWIMS_LIST" ("IMSA ID", "WELL DESCRIPTION", "UWI") AS 
  SELECT DD.DD_ASSET  AS "IMSA ID",
  NA.NODE_ID
  || ' - '
  || NA.NODE_DESC AS "WELL DESCRIPTION", 
  DD.DD_PARAM_VALUE AS UWI
FROM TBL_DESIGN_DATA_MAIN DD
INNER JOIN SYS_NODES_ATTRIB NA
ON DD.DD_ASSET    = NA.REC_TAG
WHERE DD.DD_PARAM = 402;
--------------------------------------------------------
--  DDL for View V_LNK_AN_CA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_AN_CA" ("CA_ID", "AN_ID", "NODE_DESC", "AN_REF", "AN_TITLE", "AN_RAISED_DATE", "AN_CURR_CLASS_SYS", "AN_STATUS_SYS") AS 
  SELECT LNK_AN_CA.LNK_TAG_B      AS CA_ID,
  V_TBL_ANOM_MAIN.AN_ID          AS AN_ID,
  V_TBL_ANOM_MAIN.NODE_DESC      AS NODE_DESC,
  V_TBL_ANOM_MAIN.AN_REF         AS AN_REF,
  V_TBL_ANOM_MAIN.AN_TITLE       AS AN_TITLE,
  V_TBL_ANOM_MAIN.AN_RAISED_DATE AS AN_RAISED_DATE,
  V_TBL_ANOM_MAIN.AN_CURR_CLASS_SYS  AS AN_CURR_CLASS_SYS,
  V_TBL_ANOM_MAIN.AN_STATUS_SYS  AS AN_STATUS_SYS
FROM V_TBL_ANOM_MAIN
INNER JOIN LNK_AN_CA
ON LNK_AN_CA.LNK_TAG_A = V_TBL_ANOM_MAIN.AN_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_AN_FT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_AN_FT" ("AN_ID", "FT_ID", "FT_CODE", "FT_NAME", "FT_GROUP", "FT_GROUP_SYS", "FT_TYPE", "FT_TYPE_SYS", "FT_CORR_REL", "FT_DESC") AS 
  SELECT LNK_AN_FT.LNK_TAG_B AS AN_ID,
  V_TBL_ANOM_FT.FT_ID,
  V_TBL_ANOM_FT.FT_CODE,
  V_TBL_ANOM_FT.FT_NAME,
  V_TBL_ANOM_FT.FT_GROUP,
  V_TBL_ANOM_FT.FT_GROUP_SYS,
  V_TBL_ANOM_FT.FT_TYPE,
  V_TBL_ANOM_FT.FT_TYPE_SYS,
  V_TBL_ANOM_FT.FT_CORR_REL,
  V_TBL_ANOM_FT.FT_DESC
FROM V_TBL_ANOM_FT
INNER JOIN LNK_AN_FT
ON LNK_AN_FT.LNK_TAG_A = V_TBL_ANOM_FT.FT_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_AN_FT_ALL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_AN_FT_ALL" ("AN_ID", "FT_ID", "FT_CODE", "FT_NAME", "FT_GROUP_SYS", "FT_TYPE_SYS", "FT_CORR_REL", "FT_DESC") AS 
  SELECT LNK_AN_FT.LNK_TAG_B AS AN_ID,
  TBL_ANOM_FT.FT_ID,
  TBL_ANOM_FT.FT_CODE,
  TBL_ANOM_FT.FT_NAME,
  LOOKUPS_FT_GROUP.LKP_DESC_B AS FT_GROUP_SYS,
  LOOKUPS_FT_TYPE.LKP_DESC_B  AS FT_TYPE_SYS,
  TBL_ANOM_FT.FT_CORR_REL,
  TBL_ANOM_FT.FT_DESC
FROM TBL_ANOM_FT
LEFT JOIN SYS_LOOKUPS LOOKUPS_FT_GROUP
ON TBL_ANOM_FT.FT_GROUP = LOOKUPS_FT_GROUP.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_FT_TYPE
ON TBL_ANOM_FT.FT_TYPE = LOOKUPS_FT_TYPE.LKP_ID
LEFT JOIN LNK_AN_FT
ON LNK_AN_FT.LNK_TAG_A = TBL_ANOM_FT.FT_ID
ORDER BY AN_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_AN_SVY
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_AN_SVY" ("SVY_HDR_ID", "AN_ID", "NODE_DESC", "AN_REF", "AN_TITLE", "AN_RAISED_DATE", "AN_CURR_CLASS_SYS", "AN_STATUS_SYS") AS 
  SELECT LNK_AN_SVY.LNK_TAG_B      AS SVY_HDR_ID,
  V_TBL_ANOM_MAIN.AN_ID          AS AN_ID,
  V_TBL_ANOM_MAIN.NODE_DESC      AS NODE_DESC,
  V_TBL_ANOM_MAIN.AN_REF         AS AN_REF,
  V_TBL_ANOM_MAIN.AN_TITLE       AS AN_TITLE,
  V_TBL_ANOM_MAIN.AN_RAISED_DATE AS AN_RAISED_DATE,
  V_TBL_ANOM_MAIN.AN_CURR_CLASS_SYS  AS AN_CURR_CLASS_SYS,
  V_TBL_ANOM_MAIN.AN_STATUS_SYS  AS AN_STATUS_SYS
FROM V_TBL_ANOM_MAIN
INNER JOIN LNK_AN_SVY
ON LNK_AN_SVY.LNK_TAG_A = V_TBL_ANOM_MAIN.AN_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_CHEM_PFD_REF
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_CHEM_PFD_REF" ("CHD_HDR_ID", "REF_ID", "RF_DESC", "RF_REVDATE", "RF_TYPE_SYS", "RF_CLASS_SYS", "RF_PATH_SYS", "RF_FULLFILE") AS 
  SELECT LNK_CHEM_PFD_REF.LNK_TAG_B AS CHD_HDR_ID,
  LNK_CHEM_PFD_REF.LNK_TAG_A      AS REF_ID,
  TBL_REFERENCE_FILES.RF_DESC,
  TBL_REFERENCE_FILES.RF_REVDATE,
  LOOKUPS_TYPE.LKP_DESC_B AS RF_TYPE_SYS,
  LOOKUPS_CLASS.LKP_DESC_B AS RF_CLASS_SYS,
  LOOKUPS_PATH.LKP_MEMO_1 AS RF_PATH_SYS,
 (CASE 
    --IMSA DOCUMENT, IMSA PHOTO, IMSA VIDEO, IMSA DRAWING
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8204 OR TBL_REFERENCE_FILES.RF_TYPE = 8205 OR TBL_REFERENCE_FILES.RF_TYPE = 8206 
    OR TBL_REFERENCE_FILES.RF_TYPE = 8207 THEN
      TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1) || '\' || TBL_REFERENCE_FILES.RF_FILENAME
    --LIVELINK DOCUMENT, LIVELINK FOLDER, LIVELINK ALIAS
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8200 OR TBL_REFERENCE_FILES.RF_TYPE = 8201 OR TBL_REFERENCE_FILES.RF_TYPE = 8202 THEN
      TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1) || TBL_REFERENCE_FILES.RF_LLID
    --EXTERNAL URL, FMS HYPERLINK, LIVELINK URL
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8208 OR TBL_REFERENCE_FILES.RF_TYPE = 8209 OR TBL_REFERENCE_FILES.RF_TYPE = 8203 THEN
      TBL_REFERENCE_FILES.RF_FILENAME
  END) AS RF_FULLFILE  
FROM TBL_REFERENCE_FILES
INNER JOIN LNK_CHEM_PFD_REF
ON LNK_CHEM_PFD_REF.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_PATH
ON TBL_REFERENCE_FILES.RF_PATH = LOOKUPS_PATH.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_TYPE
ON TBL_REFERENCE_FILES.RF_TYPE = LOOKUPS_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CLASS
ON TBL_REFERENCE_FILES.RF_CLASS = LOOKUPS_CLASS.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_CHEM_REF
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_CHEM_REF" ("CHD_HDR_ID", "REF_ID", "RF_DESC", "RF_REVDATE", "RF_TYPE_SYS", "RF_CLASS_SYS", "RF_PATH_SYS", "RF_FULLFILE") AS 
  SELECT LNK_CHEM_REF.LNK_TAG_B AS CHD_HDR_ID,
  LNK_CHEM_REF.LNK_TAG_A      AS REF_ID,
  TBL_REFERENCE_FILES.RF_DESC,
  TBL_REFERENCE_FILES.RF_REVDATE,
  LOOKUPS_TYPE.LKP_DESC_B AS RF_TYPE_SYS,
  LOOKUPS_CLASS.LKP_DESC_B AS RF_CLASS_SYS,
  LOOKUPS_PATH.LKP_MEMO_1 AS RF_PATH_SYS,
 (CASE 
    --IMSA DOCUMENT, IMSA PHOTO, IMSA VIDEO, IMSA DRAWING
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8204 OR TBL_REFERENCE_FILES.RF_TYPE = 8205 OR TBL_REFERENCE_FILES.RF_TYPE = 8206 
    OR TBL_REFERENCE_FILES.RF_TYPE = 8207 THEN
      TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1) || '\' || TBL_REFERENCE_FILES.RF_FILENAME
    --LIVELINK DOCUMENT, LIVELINK FOLDER, LIVELINK ALIAS
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8200 OR TBL_REFERENCE_FILES.RF_TYPE = 8201 OR TBL_REFERENCE_FILES.RF_TYPE = 8202 THEN
      TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1) || TBL_REFERENCE_FILES.RF_LLID
    --EXTERNAL URL, FMS HYPERLINK, LIVELINK URL
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8208 OR TBL_REFERENCE_FILES.RF_TYPE = 8209 OR TBL_REFERENCE_FILES.RF_TYPE = 8203 THEN
      TBL_REFERENCE_FILES.RF_FILENAME
  END) AS RF_FULLFILE  
FROM TBL_REFERENCE_FILES
INNER JOIN LNK_CHEM_REF
ON LNK_CHEM_REF.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_PATH
ON TBL_REFERENCE_FILES.RF_PATH = LOOKUPS_PATH.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_TYPE
ON TBL_REFERENCE_FILES.RF_TYPE = LOOKUPS_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CLASS
ON TBL_REFERENCE_FILES.RF_CLASS = LOOKUPS_CLASS.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_CHEM_SR_REF
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_CHEM_SR_REF" ("CHD_HDR_ID", "REF_ID", "RF_DESC", "RF_REVDATE", "RF_TYPE_SYS", "RF_CLASS_SYS", "RF_PATH_SYS", "RF_FULLFILE") AS 
  SELECT LNK_CHEM_SR_REF.LNK_TAG_B AS CHD_HDR_ID,
  LNK_CHEM_SR_REF.LNK_TAG_A      AS REF_ID,
  TBL_REFERENCE_FILES.RF_DESC,
  TBL_REFERENCE_FILES.RF_REVDATE,
  LOOKUPS_TYPE.LKP_DESC_B AS RF_TYPE_SYS,
  LOOKUPS_CLASS.LKP_DESC_B AS RF_CLASS_SYS,
  LOOKUPS_PATH.LKP_MEMO_1 AS RF_PATH_SYS,
 (CASE 
    --IMSA DOCUMENT, IMSA PHOTO, IMSA VIDEO, IMSA DRAWING
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8204 OR TBL_REFERENCE_FILES.RF_TYPE = 8205 OR TBL_REFERENCE_FILES.RF_TYPE = 8206 
    OR TBL_REFERENCE_FILES.RF_TYPE = 8207 THEN
      TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1) || '\' || TBL_REFERENCE_FILES.RF_FILENAME
    --LIVELINK DOCUMENT, LIVELINK FOLDER, LIVELINK ALIAS
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8200 OR TBL_REFERENCE_FILES.RF_TYPE = 8201 OR TBL_REFERENCE_FILES.RF_TYPE = 8202 THEN
      TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1) || TBL_REFERENCE_FILES.RF_LLID
    --EXTERNAL URL, FMS HYPERLINK, LIVELINK URL
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8208 OR TBL_REFERENCE_FILES.RF_TYPE = 8209 OR TBL_REFERENCE_FILES.RF_TYPE = 8203 THEN
      TBL_REFERENCE_FILES.RF_FILENAME
  END) AS RF_FULLFILE  
FROM TBL_REFERENCE_FILES
INNER JOIN LNK_CHEM_SR_REF
ON LNK_CHEM_SR_REF.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_PATH
ON TBL_REFERENCE_FILES.RF_PATH = LOOKUPS_PATH.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_TYPE
ON TBL_REFERENCE_FILES.RF_TYPE = LOOKUPS_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CLASS
ON TBL_REFERENCE_FILES.RF_CLASS = LOOKUPS_CLASS.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_CHEM_TREATINGMANUAL_REF
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_CHEM_TREATINGMANUAL_REF" ("CHD_HDR_ID", "REF_ID", "RF_DESC", "RF_REVDATE", "RF_TYPE_SYS", "RF_CLASS_SYS", "RF_PATH_SYS", "RF_FULLFILE") AS 
  SELECT LNK_CHEM_TREATINGMANUAL_REF.LNK_TAG_B AS CHD_HDR_ID,
  LNK_CHEM_TREATINGMANUAL_REF.LNK_TAG_A      AS REF_ID,
  TBL_REFERENCE_FILES.RF_DESC,
  TBL_REFERENCE_FILES.RF_REVDATE,
  LOOKUPS_TYPE.LKP_DESC_B AS RF_TYPE_SYS,
  LOOKUPS_CLASS.LKP_DESC_B AS RF_CLASS_SYS,
  LOOKUPS_PATH.LKP_MEMO_1 AS RF_PATH_SYS, 
(CASE 
    --IMSA DOCUMENT, IMSA PHOTO, IMSA VIDEO, IMSA DRAWING
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8204 OR TBL_REFERENCE_FILES.RF_TYPE = 8205 OR TBL_REFERENCE_FILES.RF_TYPE = 8206 
    OR TBL_REFERENCE_FILES.RF_TYPE = 8207 THEN
      TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1) || '\' || TBL_REFERENCE_FILES.RF_FILENAME
    --LIVELINK DOCUMENT, LIVELINK FOLDER, LIVELINK ALIAS
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8200 OR TBL_REFERENCE_FILES.RF_TYPE = 8201 OR TBL_REFERENCE_FILES.RF_TYPE = 8202 THEN
      TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1) || TBL_REFERENCE_FILES.RF_LLID
    --EXTERNAL URL, FMS HYPERLINK, LIVELINK URL
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8208 OR TBL_REFERENCE_FILES.RF_TYPE = 8209 OR TBL_REFERENCE_FILES.RF_TYPE = 8203 THEN
      TBL_REFERENCE_FILES.RF_FILENAME
  END) AS RF_FULLFILE  
FROM TBL_REFERENCE_FILES
INNER JOIN LNK_CHEM_TREATINGMANUAL_REF
ON LNK_CHEM_TREATINGMANUAL_REF.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_PATH
ON TBL_REFERENCE_FILES.RF_PATH = LOOKUPS_PATH.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_TYPE
ON TBL_REFERENCE_FILES.RF_TYPE = LOOKUPS_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CLASS
ON TBL_REFERENCE_FILES.RF_CLASS = LOOKUPS_CLASS.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_FT_SVY
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_FT_SVY" ("SVY_HDR_ID", "FT_ID", "FT_CODE", "FT_NAME", "FT_GROUP", "FT_GROUP_SYS", "FT_TYPE", "FT_TYPE_SYS", "FT_CORR_REL", "FT_DESC") AS 
  SELECT LNK_FT_SVY.LNK_TAG_B AS SVY_HDR_ID,
  V_TBL_ANOM_FT.FT_ID,
  V_TBL_ANOM_FT.FT_CODE,
  V_TBL_ANOM_FT.FT_NAME,
  V_TBL_ANOM_FT.FT_GROUP,
  V_TBL_ANOM_FT.FT_GROUP_SYS,
  V_TBL_ANOM_FT.FT_TYPE,
  V_TBL_ANOM_FT.FT_TYPE_SYS,
  V_TBL_ANOM_FT.FT_CORR_REL,
  V_TBL_ANOM_FT.FT_DESC
FROM V_TBL_ANOM_FT
INNER JOIN LNK_FT_SVY
ON LNK_FT_SVY.LNK_TAG_A = V_TBL_ANOM_FT.FT_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_REF_ANOMMAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_REF_ANOMMAIN" ("AN_ID", "REF_ID", "RF_DESC", "RF_TYPE_SYS", "RF_CLASS_SYS", "RF_PATH_SYS", "RF_FULLFILE", "RF_REVDATE") AS 
  SELECT LNK_REF_ANOMMAIN.LNK_TAG_B AS AN_ID,
  LNK_REF_ANOMMAIN.LNK_TAG_A      AS REF_ID,
  TBL_REFERENCE_FILES.RF_DESC,
  LOOKUPS_TYPE.LKP_DESC_B  AS RF_TYPE_SYS,
  LOOKUPS_CLASS.LKP_DESC_B AS RF_CLASS_SYS,
  LOOKUPS_PATH.LKP_MEMO_1  AS RF_PATH_SYS,
  (
  CASE
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8204
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8205
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8206
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8207
    THEN TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1)
      || '\'
      || TBL_REFERENCE_FILES.RF_FILENAME
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8200
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8201
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8202
    THEN TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1)
      || TBL_REFERENCE_FILES.RF_LLID
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8208
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8209
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8203
    THEN TBL_REFERENCE_FILES.RF_FILENAME
  END) AS RF_FULLFILE,
  TBL_REFERENCE_FILES.RF_REVDATE
FROM TBL_REFERENCE_FILES
INNER JOIN LNK_REF_ANOMMAIN
ON LNK_REF_ANOMMAIN.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_PATH
ON TBL_REFERENCE_FILES.RF_PATH = LOOKUPS_PATH.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_TYPE
ON TBL_REFERENCE_FILES.RF_TYPE = LOOKUPS_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CLASS
ON TBL_REFERENCE_FILES.RF_CLASS = LOOKUPS_CLASS.LKP_ID
INNER JOIN SYS_NODES_ATTRIB
ON SYS_NODES_ATTRIB.REC_TAG = TBL_REFERENCE_FILES.RF_ASSET WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_REF_ANOMMAIN_COUNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_REF_ANOMMAIN_COUNT" ("AN_ATTACHMENTS", "AN_ID") AS 
  SELECT COUNT(LNK_REF_ANOMMAIN.LNK_TAG_A) AN_ATTACHMENTS,
  LNK_REF_ANOMMAIN.LNK_TAG_B AN_ID 
FROM LNK_REF_ANOMMAIN
GROUP BY LNK_REF_ANOMMAIN.LNK_TAG_B WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_REF_ANOMMAIN_RF
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_REF_ANOMMAIN_RF" ("RF_ID", "AN_ID", "AN_REF", "AN_TITLE", "NODE_DESC", "AN_RAISED_DATE", "AN_DESC", "AN_STATUS_SYS", "AN_CURR_CLASS_SYS") AS 
  SELECT LNK_REF_ANOMMAIN.LNK_TAG_A AS RF_ID,
  V_TBL_ANOM_MAIN.AN_ID, 
  V_TBL_ANOM_MAIN.AN_REF,
  V_TBL_ANOM_MAIN.AN_TITLE, 
  V_TBL_ANOM_MAIN.NODE_DESC,
  V_TBL_ANOM_MAIN.AN_RAISED_DATE,
  V_TBL_ANOM_MAIN.AN_DESC,
  V_TBL_ANOM_MAIN.AN_STATUS_SYS,
  V_TBL_ANOM_MAIN.AN_CURR_CLASS_SYS
FROM V_TBL_ANOM_MAIN
INNER JOIN LNK_REF_ANOMMAIN
ON LNK_REF_ANOMMAIN.LNK_TAG_B = V_TBL_ANOM_MAIN.AN_ID;
--------------------------------------------------------
--  DDL for View V_LNK_REF_CA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_REF_CA" ("CA_ID", "REF_ID", "RF_DESC", "RF_TYPE_SYS", "RF_CLASS_SYS", "RF_PATH_SYS", "RF_FULLFILE", "RF_REVDATE") AS 
  SELECT LNK_REF_CA.LNK_TAG_B AS CA_ID,
  LNK_REF_CA.LNK_TAG_A      AS REF_ID,
  TBL_REFERENCE_FILES.RF_DESC,
  LOOKUPS_TYPE.LKP_DESC_B  AS RF_TYPE_SYS,
  LOOKUPS_CLASS.LKP_DESC_B AS RF_CLASS_SYS,
  LOOKUPS_PATH.LKP_MEMO_1  AS RF_PATH_SYS,
  (
  CASE
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8204
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8205
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8206
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8207
    THEN TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1)
      || '\'
      || TBL_REFERENCE_FILES.RF_FILENAME
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8200
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8201
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8202
    THEN TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1)
      || TBL_REFERENCE_FILES.RF_LLID
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8208
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8209
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8203
    THEN TBL_REFERENCE_FILES.RF_FILENAME
  END) AS RF_FULLFILE,
  TBL_REFERENCE_FILES.RF_REVDATE
FROM TBL_REFERENCE_FILES
INNER JOIN LNK_REF_CA
ON LNK_REF_CA.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_PATH
ON TBL_REFERENCE_FILES.RF_PATH = LOOKUPS_PATH.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_TYPE
ON TBL_REFERENCE_FILES.RF_TYPE = LOOKUPS_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CLASS
ON TBL_REFERENCE_FILES.RF_CLASS = LOOKUPS_CLASS.LKP_ID
INNER JOIN SYS_NODES_ATTRIB
ON SYS_NODES_ATTRIB.REC_TAG = TBL_REFERENCE_FILES.RF_ASSET WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_REF_DESIGNMAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_REF_DESIGNMAIN" ("DD_ID", "REF_ID", "RF_DESC", "RF_REVDATE", "RF_TYPE_SYS", "RF_CLASS_SYS", "RF_PATH_SYS", "RF_FULLFILE") AS 
  SELECT LNK_REF_DESIGNMAIN.LNK_TAG_B AS DD_ID,
  LNK_REF_DESIGNMAIN.LNK_TAG_A      AS REF_ID,
  TBL_REFERENCE_FILES.RF_DESC,
  TBL_REFERENCE_FILES.RF_REVDATE,
  LOOKUPS_TYPE.LKP_DESC_B  AS RF_TYPE_SYS,
  LOOKUPS_CLASS.LKP_DESC_B AS RF_CLASS_SYS,
  LOOKUPS_PATH.LKP_MEMO_1  AS RF_PATH_SYS,
 (CASE 
    --IMSA DOCUMENT, IMSA PHOTO, IMSA VIDEO, IMSA DRAWING
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8204 OR TBL_REFERENCE_FILES.RF_TYPE = 8205 OR TBL_REFERENCE_FILES.RF_TYPE = 8206 
    OR TBL_REFERENCE_FILES.RF_TYPE = 8207 THEN
      TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1) || '\' || TBL_REFERENCE_FILES.RF_FILENAME
    --LIVELINK DOCUMENT, LIVELINK FOLDER, LIVELINK ALIAS
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8200 OR TBL_REFERENCE_FILES.RF_TYPE = 8201 OR TBL_REFERENCE_FILES.RF_TYPE = 8202 THEN
      TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1) || TBL_REFERENCE_FILES.RF_LLID
    --EXTERNAL URL, FMS HYPERLINK, LIVELINK URL
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8208 OR TBL_REFERENCE_FILES.RF_TYPE = 8209 OR TBL_REFERENCE_FILES.RF_TYPE = 8203 THEN
      TBL_REFERENCE_FILES.RF_FILENAME
  END) AS RF_FULLFILE  
FROM TBL_REFERENCE_FILES
INNER JOIN LNK_REF_DESIGNMAIN
ON LNK_REF_DESIGNMAIN.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_PATH
ON TBL_REFERENCE_FILES.RF_PATH = LOOKUPS_PATH.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_TYPE
ON TBL_REFERENCE_FILES.RF_TYPE = LOOKUPS_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CLASS
ON TBL_REFERENCE_FILES.RF_CLASS = LOOKUPS_CLASS.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_REF_SVY
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_REF_SVY" ("SV_HDR_ID", "REF_ID", "RF_DESC", "RF_TYPE_SYS", "RF_CLASS_SYS", "RF_PATH_SYS", "RF_FULLFILE", "RF_REVDATE") AS 
  SELECT LNK_REF_SVY.LNK_TAG_B AS SV_HDR_ID,
  LNK_REF_SVY.LNK_TAG_A      AS REF_ID,
  TBL_REFERENCE_FILES.RF_DESC,
  LOOKUPS_TYPE.LKP_DESC_B  AS RF_TYPE_SYS,
  LOOKUPS_CLASS.LKP_DESC_B AS RF_CLASS_SYS,
  LOOKUPS_PATH.LKP_MEMO_1  AS RF_PATH_SYS,
  (
  CASE
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8204
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8205
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8206
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8207
    THEN TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1)
      || '\'
      || TBL_REFERENCE_FILES.RF_FILENAME
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8200
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8201
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8202
    THEN TO_CHAR(LOOKUPS_PATH.LKP_MEMO_1)
      || TBL_REFERENCE_FILES.RF_LLID
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8208
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8209
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8203
    THEN TBL_REFERENCE_FILES.RF_FILENAME
  END) AS RF_FULLFILE,
  TBL_REFERENCE_FILES.RF_REVDATE
FROM TBL_REFERENCE_FILES
INNER JOIN LNK_REF_SVY
ON LNK_REF_SVY.LNK_TAG_A = TBL_REFERENCE_FILES.RF_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_PATH
ON TBL_REFERENCE_FILES.RF_PATH = LOOKUPS_PATH.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_TYPE
ON TBL_REFERENCE_FILES.RF_TYPE = LOOKUPS_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CLASS
ON TBL_REFERENCE_FILES.RF_CLASS = LOOKUPS_CLASS.LKP_ID
INNER JOIN SYS_NODES_ATTRIB
ON SYS_NODES_ATTRIB.REC_TAG = TBL_REFERENCE_FILES.RF_ASSET;
--------------------------------------------------------
--  DDL for View V_LNK_REL_SVY
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_REL_SVY" ("SVY_HDR_ID", "SVY_HDR_ID_CHILD", "SVY_NODE_DESC", "SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_EVT_NUM", "SVY_HDR_COMMENT") AS 
  SELECT LNK_REL_SVY.LNK_TAG_A  AS SVY_HDR_ID,
  V_TBL_SVY_HEADER.SVY_HDR_ID AS SVY_HDR_ID_CHILD,
  V_TBL_SVY_HEADER.SVY_NODE_DESC,
  V_TBL_SVY_HEADER.SVY_HDR_SVY_TITLE_SYS,
  V_TBL_SVY_HEADER.SVY_HDR_EVT_NAME_SYS,
  V_TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  V_TBL_SVY_HEADER.SVY_HDR_COMMENT
FROM V_TBL_SVY_HEADER
INNER JOIN LNK_REL_SVY
ON LNK_REL_SVY.LNK_TAG_B = V_TBL_SVY_HEADER.SVY_HDR_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_RELAN_AN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_RELAN_AN" ("AN_ID", "AN_ID_CHILD", "AN_REF", "AN_TITLE", "NODE_DESC", "AN_RAISED_DATE", "AN_DESC", "AN_STATUS_SYS", "AN_CURR_CLASS_SYS") AS 
  SELECT LNK_RELAN_AN.LNK_TAG_B AS AN_ID,
  V_TBL_ANOM_MAIN.AN_ID       AS AN_ID_CHILD,
  V_TBL_ANOM_MAIN.AN_REF,
  V_TBL_ANOM_MAIN.AN_TITLE,
  V_TBL_ANOM_MAIN.NODE_DESC,
  V_TBL_ANOM_MAIN.AN_RAISED_DATE,
  V_TBL_ANOM_MAIN.AN_DESC,
  V_TBL_ANOM_MAIN.AN_STATUS_SYS,
  V_TBL_ANOM_MAIN.AN_CURR_CLASS_SYS
FROM V_TBL_ANOM_MAIN
INNER JOIN LNK_RELAN_AN
ON V_TBL_ANOM_MAIN.AN_ID = LNK_RELAN_AN.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_LNK_RELAN_AN_ALL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_LNK_RELAN_AN_ALL" ("AN_ID", "AN_ID_CHILD", "AN_REF", "NODE_DESC", "AN_RAISED_DATE", "AN_DESC", "AN_STATUS_SYS", "AN_CURR_CLASS_SYS") AS 
  SELECT AN_ID,
  AN_ID_CHILD,
  AN_REF,
  NODE_DESC,
  AN_RAISED_DATE,
  AN_DESC,
  AN_STATUS_SYS,
  AN_CURR_CLASS_SYS
FROM
  (SELECT LNK_RELAN_AN.LNK_TAG_A AS AN_ID,
    TBL_ANOM_MAIN.AN_ID          AS AN_ID_CHILD,
    TBL_ANOM_MAIN.AN_REF,
    SYS_NODES_ATTRIB.NODE_DESC,
    TBL_ANOM_MAIN.AN_RAISED_DATE,
    TBL_ANOM_MAIN.AN_DESC,
    LOOKUPS_SYS.LKP_DESC_B        AS AN_STATUS_SYS,
    LOOKUPS_CURR_CLASS.LKP_DESC_B AS AN_CURR_CLASS_SYS
  FROM LNK_RELAN_AN
  INNER JOIN TBL_ANOM_MAIN
  ON LNK_RELAN_AN.LNK_TAG_B = TBL_ANOM_MAIN.AN_ID
  INNER JOIN SYS_NODES_ATTRIB
  ON TBL_ANOM_MAIN.AN_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG
  LEFT JOIN SYS_LOOKUPS LOOKUPS_CURR_CLASS
  ON TBL_ANOM_MAIN.AN_CURR_CLASS = LOOKUPS_CURR_CLASS.LKP_ID
  LEFT JOIN SYS_LOOKUPS LOOKUPS_SYS
  ON TBL_ANOM_MAIN.AN_STATUS = LOOKUPS_SYS.LKP_ID
  UNION ALL
  SELECT LNK_RELAN_AN.LNK_TAG_A AS AN_ID,
    TBL_ANOM_MAIN.AN_ID         AS AN_ID_CHILD,
    TBL_ANOM_MAIN.AN_REF,
    SYS_NODES_ATTRIB.NODE_DESC,
    TBL_ANOM_MAIN.AN_RAISED_DATE,
    TBL_ANOM_MAIN.AN_DESC,
    LOOKUPS_SYS.LKP_DESC_B        AS AN_STATUS_SYS,
    LOOKUPS_CURR_CLASS.LKP_DESC_B AS AN_CURR_CLASS_SYS
  FROM LNK_RELAN_AN
  RIGHT JOIN TBL_ANOM_MAIN
  ON TBL_ANOM_MAIN.AN_ID = LNK_RELAN_AN.LNK_TAG_B
  INNER JOIN SYS_NODES_ATTRIB
  ON TBL_ANOM_MAIN.AN_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG
  LEFT JOIN SYS_LOOKUPS LOOKUPS_CURR_CLASS
  ON TBL_ANOM_MAIN.AN_CURR_CLASS = LOOKUPS_CURR_CLASS.LKP_ID
  LEFT JOIN SYS_LOOKUPS LOOKUPS_SYS
  ON TBL_ANOM_MAIN.AN_STATUS    = LOOKUPS_SYS.LKP_ID
  WHERE LNK_RELAN_AN.LNK_TAG_A IS NULL

UNION ALL
  SELECT LNK_RELAN_AN.LNK_TAG_B AS AN_ID,
    TBL_ANOM_MAIN.AN_ID          AS AN_ID_CHILD,
    TBL_ANOM_MAIN.AN_REF,
    SYS_NODES_ATTRIB.NODE_DESC,
    TBL_ANOM_MAIN.AN_RAISED_DATE,
    TBL_ANOM_MAIN.AN_DESC,
    LOOKUPS_SYS.LKP_DESC_B        AS AN_STATUS_SYS,
    LOOKUPS_CURR_CLASS.LKP_DESC_B AS AN_CURR_CLASS_SYS
  FROM LNK_RELAN_AN
  RIGHT JOIN TBL_ANOM_MAIN
  ON LNK_RELAN_AN.LNK_TAG_A = TBL_ANOM_MAIN.AN_ID
  INNER JOIN SYS_NODES_ATTRIB
  ON TBL_ANOM_MAIN.AN_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG
  LEFT JOIN SYS_LOOKUPS LOOKUPS_CURR_CLASS
  ON TBL_ANOM_MAIN.AN_CURR_CLASS = LOOKUPS_CURR_CLASS.LKP_ID
  LEFT JOIN SYS_LOOKUPS LOOKUPS_SYS
  ON TBL_ANOM_MAIN.AN_STATUS    = LOOKUPS_SYS.LKP_ID
  WHERE LNK_RELAN_AN.LNK_TAG_B IS NULL
  UNION ALL
  SELECT LNK_RELAN_AN.LNK_TAG_B AS AN_ID,
    TBL_ANOM_MAIN.AN_ID         AS AN_ID_CHILD,
    TBL_ANOM_MAIN.AN_REF,
    SYS_NODES_ATTRIB.NODE_DESC,
    TBL_ANOM_MAIN.AN_RAISED_DATE,
    TBL_ANOM_MAIN.AN_DESC,
    LOOKUPS_SYS.LKP_DESC_B        AS AN_STATUS_SYS,
    LOOKUPS_CURR_CLASS.LKP_DESC_B AS AN_CURR_CLASS_SYS
  FROM LNK_RELAN_AN
  RIGHT JOIN TBL_ANOM_MAIN
  ON LNK_RELAN_AN.LNK_TAG_A = TBL_ANOM_MAIN.AN_ID
  INNER JOIN SYS_NODES_ATTRIB
  ON TBL_ANOM_MAIN.AN_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG
  LEFT JOIN SYS_LOOKUPS LOOKUPS_CURR_CLASS
  ON TBL_ANOM_MAIN.AN_CURR_CLASS = LOOKUPS_CURR_CLASS.LKP_ID
  LEFT JOIN SYS_LOOKUPS LOOKUPS_SYS
  ON TBL_ANOM_MAIN.AN_STATUS    = LOOKUPS_SYS.LKP_ID
  WHERE LNK_RELAN_AN.LNK_TAG_B IS NULL
  )
  GROUP BY AN_ID,
  AN_ID_CHILD,
  AN_REF,
  NODE_DESC,
  AN_RAISED_DATE,
  AN_DESC,
  AN_STATUS_SYS,
  AN_CURR_CLASS_SYS WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_RSK_LOOKUPS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_RSK_LOOKUPS" ("LKP_DESC_A", "RSK_LKP") AS 
  SELECT LKP_DESC_A, RSK_LKP FROM 
(
SELECT LKP_DESC_A, (LKP_DESC_A || '-' || LKP_DESC_B) RSK_LKP FROM SYS_LOOKUPS WHERE LKP_GRP_ID=148 
UNION ALL 
SELECT LKP_DESC_A, (LKP_DESC_A || '-' || LKP_DESC_B) RSK_LKP FROM SYS_LOOKUPS WHERE LKP_GRP_ID=147
) WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_SPAN_SURVEYS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_SPAN_SURVEYS" ("SVY_MAIN_ID", "SVY_MAIN_TITLE", "SVY_PERIOD") AS 
  SELECT DISTINCT TBL_SVY_MAIN.SVY_MAIN_ID,
  TBL_SVY_MAIN.SVY_MAIN_TITLE,
  TO_CHAR(TBL_SVY_MAIN.SVY_MAIN_DATE_START, 'DD-MON-YYYY')
  || ' to '
  || TO_CHAR(TBL_SVY_MAIN.SVY_MAIN_DATE_END, 'DD-MON-YYYY') AS SVY_PERIOD
FROM TBL_SVY_MAIN
INNER JOIN TBL_SVY_HEADER
ON TBL_SVY_MAIN.SVY_MAIN_ID         = TBL_SVY_HEADER.SVY_HDR_MAIN_ID
WHERE (((
--62, 55 53 51 34 31 28, 29, 26, 23, 25, 19, 15, 14

--45 - 2004 24CEP, TPF1, TPF2
--24 - 2004 Span Rectification
--17 - 2003 TSR/GEP CP Survey
--16 - 2004 CALM Shallow Survey Q2
--12 - 2004 CALM Shallow Survey Q1
--11- 2003 CGS Internal Inspection
--10 - 2003 CALM Shallow Survey Q4
--9 - 2003 Malampaya IRM
--8 - 2003 CALM Shallow Survey Q1
--6 - 2003 Prelim GEP Sidescan Span Data
--5 - 2002 Span Rectification
--4 - 2001 CP Survey (SSPS)
--3 - 2002 TSR CP Survey
--2 - 2002 CALM Shallow Survey Q4
--1 - 2002 Malampaya IRM
--TBL_SVY_MAIN.SVY_MAIN_ID    <> 62 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 55 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 53 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 51 AND
--TBL_SVY_MAIN.SVY_MAIN_ID    <> 34 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 31 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 28 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 29 AND
--TBL_SVY_MAIN.SVY_MAIN_ID    <> 26 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 23 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 25 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 19 AND
--TBL_SVY_MAIN.SVY_MAIN_ID    <> 15 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 14)

TBL_SVY_MAIN.SVY_MAIN_ID    <> 45 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 24 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 17 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 16 AND
TBL_SVY_MAIN.SVY_MAIN_ID    <> 12 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 11 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 10 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 9 AND
TBL_SVY_MAIN.SVY_MAIN_ID    <> 8 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 6 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 5 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 4 AND
TBL_SVY_MAIN.SVY_MAIN_ID    <> 3 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 2 AND TBL_SVY_MAIN.SVY_MAIN_ID    <> 1)

AND (TBL_SVY_HEADER.SVY_HDR_EVT_ID = 25)) OR (TBL_SVY_MAIN.SVY_MAIN_ID        = 56)) 
ORDER BY TBL_SVY_MAIN.SVY_MAIN_ID DESC


WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_SYS_NODES_ATTRIB
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_SYS_NODES_ATTRIB" ("REC_TAG", "NODE_ID", "NODE_DESC", "NODE_GROUP", "NODE_CLASS", "NODE_TAG", "NODE_ASSET_TYPE", "SAP_REF", "SAP_TAG", "SAP_DESC", "REF_DWG", "SPLI", "VUL_EQUT", "VUL_CAT", "NODE_GROUP_B", "ITEM_TYPE", "OREDA_CLSS", "OREDA_SUBUNIT", "OREDA_CPNT", "LL_FOLDER_OBJID", "REC_UPDATED", "ITEM_TYPE_TAG", "ITEM_USED", "TRE_DAT_TYPE", "PAR_REC_TAG", "RBI_INCLUDE", "SCE") AS 
  SELECT SYS_NODES_ATTRIB.REC_TAG,
  SYS_NODES_ATTRIB.NODE_ID,
  SYS_NODES_ATTRIB.NODE_DESC,
  SYS_NODES_ATTRIB.NODE_GROUP,
  SYS_NODES_ATTRIB.NODE_CLASS,
  SYS_NODES_ATTRIB.NODE_TAG,
  SYS_NODES_ATTRIB.NODE_ASSET_TYPE,
  SYS_NODES_ATTRIB.SAP_REF,
  SYS_NODES_ATTRIB.SAP_TAG,
  SYS_NODES_ATTRIB.SAP_DESC,
  SYS_NODES_ATTRIB.REF_DWG,
  SYS_NODES_ATTRIB.SPLI,
  SYS_NODES_ATTRIB.VUL_EQUT,
  SYS_NODES_ATTRIB.VUL_CAT,
  SYS_NODES_ATTRIB.NODE_GROUP_B,
  SYS_NODES_ATTRIB.ITEM_TYPE,
  SYS_NODES_ATTRIB.OREDA_CLSS,
  SYS_NODES_ATTRIB.OREDA_SUBUNIT,
  SYS_NODES_ATTRIB.OREDA_CPNT,
  SYS_NODES_ATTRIB.LL_FOLDER_OBJID,
  SYS_NODES_ATTRIB.REC_UPDATED,
  SYS_NODES_ATTRIB.ITEM_TYPE_TAG,
  SYS_NODES_ATTRIB.ITEM_USED,
  SYS_TREE_STRUC.TRE_DAT_TYPE,
  NVL(SYS_NODES_ATTRIB1.REC_TAG, 0) AS PAR_REC_TAG,
  SYS_NODES_ATTRIB.RBI_INCLUDE,
  SYS_NODES_ATTRIB.SCE
FROM SYS_NODES_ATTRIB
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG = SYS_TREE_STRUC.TRE_DAT_TAG
LEFT JOIN SYS_TREE_STRUC SYS_TREE_STRUC1
ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC1.TRE_NOD_TAG
LEFT JOIN SYS_NODES_ATTRIB SYS_NODES_ATTRIB1
ON SYS_TREE_STRUC1.TRE_DAT_TAG = SYS_NODES_ATTRIB1.REC_TAG;
--------------------------------------------------------
--  DDL for View V_SYS_NODES_ATTRIB_ASSET_TYPE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_SYS_NODES_ATTRIB_ASSET_TYPE" ("ITEM_TYPE_TAG", "NODE_DESC") AS 
  SELECT DISTINCT SYS_NODES_ATTRIB.ITEM_TYPE_TAG,
  T1.NODE_DESC
FROM SYS_NODES_ATTRIB
INNER JOIN SYS_NODES_ATTRIB T1
ON SYS_NODES_ATTRIB.ITEM_TYPE_TAG = T1.REC_TAG WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TABLE_SPECS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TABLE_SPECS" ("TABLE_NAME", "COLUMN_NAME", "DATA_TYPE", "DATA_LENGTH", "NULLABLE", "SYSTEM_COL") AS 
  SELECT COLS.TABLE_NAME,
  COLS.COLUMN_NAME,
  COLS.DATA_TYPE,
  COLS.DATA_LENGTH,
  COLS.NULLABLE,
  CASE WHEN (INSTR(COLUMN_NAME, 'SYSTEM')) > 0 THEN 1 
  ELSE 0 
  END SYSTEM_COL
FROM COLS
ORDER BY COLS.COLUMN_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_ANOM_ACT_ITEMS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_ANOM_ACT_ITEMS" ("AI_ID", "AI_REF_NO", "AI_ACT_PARTY1", "AI_ACT_PARTY2", "AI_TARGET_DATE", "AI_ACT_START_DATE", "AI_ACT_END_DATE", "AI_MHOURS", "AI_STAT", "AI_STAT_SYS", "AI_NO", "AN_REF", "AI_AN_ID", "AI_DETAILS", "AI_NOTES", "AI_UPDATED_DATE", "AI_RAISED_BY", "AI_RAISED_DATE", "AI_UPDATED_BY", "AI_RAISED_BY_SYS", "AI_UPDATED_BY_SYS", "AI_TITLE", "AI_PRIORITY", "AI_PRIORITY_SYS", "AN_RAISED_BY", "AN_RAISED_DATE", "NODE_ID", "NODE_DESC") AS 
  SELECT
     tbl_anom_act_items.ai_id,
     tbl_anom_act_items.ai_ref_no,
     tbl_anom_act_items.ai_act_party1,
     tbl_anom_act_items.ai_act_party2,
     tbl_anom_act_items.ai_target_date,
     tbl_anom_act_items.ai_act_start_date,
     tbl_anom_act_items.ai_act_end_date,
     tbl_anom_act_items.ai_mhours,
     tbl_anom_act_items.ai_stat,
     sys_lookups.lkp_desc_b       ai_stat_sys,
     tbl_anom_act_items.ai_no,
     tbl_anom_main.an_ref,
     tbl_anom_act_items.ai_an_id,
     tbl_anom_act_items.ai_details,
     tbl_anom_act_items.ai_notes,
     tbl_anom_act_items.ai_updated_date,
     tbl_anom_act_items.ai_raised_by,
     tbl_anom_act_items.ai_raised_date,
     tbl_anom_act_items.ai_updated_by,
     users_raised_by.user_name    ai_raised_by_sys,
     users_updated_by.user_name   ai_updated_by_sys,
     tbl_anom_act_items.ai_title,
     tbl_anom_act_items.ai_priority,
     sys_lookups1.lkp_desc_b      AS ai_priority_sys,
     tbl_anom_main.an_raised_by,
     tbl_anom_main.an_raised_date,
     imsa.sys_nodes_attrib.node_id,
     imsa.sys_nodes_attrib.node_id || ' - ' || imsa.sys_nodes_attrib.node_desc as node_desc
 FROM
     tbl_anom_main
     INNER JOIN tbl_anom_act_items ON tbl_anom_main.an_id = tbl_anom_act_items.ai_an_id
     LEFT JOIN sys_lookups ON tbl_anom_act_items.ai_stat = sys_lookups.lkp_id
     LEFT JOIN tbl_users users_raised_by ON tbl_anom_act_items.ai_raised_by = users_raised_by.user_id
     LEFT JOIN tbl_users users_updated_by ON tbl_anom_act_items.ai_updated_by = users_updated_by.user_id
     LEFT JOIN sys_lookups sys_lookups1 ON tbl_anom_act_items.ai_priority = sys_lookups1.lkp_id
     INNER JOIN imsa.sys_nodes_attrib ON tbl_anom_main.an_asset_id = imsa.sys_nodes_attrib.rec_tag
 ORDER BY
     tbl_anom_act_items.ai_an_id;
--------------------------------------------------------
--  DDL for View V_TBL_ANOM_FT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_ANOM_FT" ("FT_ID", "FT_CODE", "FT_NAME", "FT_NAME_SYS", "FT_GROUP", "FT_GROUP_SYS", "FT_TYPE", "FT_TYPE_SYS", "FT_CORR_REL", "FT_DESC") AS 
  SELECT TBL_ANOM_FT.FT_ID,
  TBL_ANOM_FT.FT_CODE,
  TBL_ANOM_FT.FT_NAME,
  (TBL_ANOM_FT.FT_CODE || '-' || TBL_ANOM_FT.FT_NAME) AS FT_NAME_SYS,
  TBL_ANOM_FT.FT_GROUP,
  FT_GROUP.LKP_DESC_B AS FT_GROUP_SYS,
  TBL_ANOM_FT.FT_TYPE,
  SYS_LOOKUPS_FT_TYPE.LKP_DESC_B AS FT_TYPE_SYS,
  TBL_ANOM_FT.FT_CORR_REL,
  TBL_ANOM_FT.FT_DESC
FROM TBL_ANOM_FT
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS_FT_TYPE
ON TBL_ANOM_FT.FT_TYPE = SYS_LOOKUPS_FT_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS FT_GROUP
ON TBL_ANOM_FT.FT_GROUP = FT_GROUP.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_ANOM_MAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_ANOM_MAIN" ("AN_ID", "AN_ACT_BY_DATE_MAX", "AN_ACT_BY_DATE", "AN_REF", "AN_ASSET_ID", "NODE_ID", "NODE_DESC", "AN_TYPE", "ANTYPE_NAME", "ANTYPE_GROUP", "ANTYPE_GROUP_SYS", "AN_STATUS", "AN_STATUS_SYS", "AN_RAISED_BY", "AN_RAISED_DATE", "AN_ORIG_CLASS", "AN_ORIG_CLASS_SYS", "AN_CURR_CLASS", "AN_CURR_CLASS_SYS", "AN_REVNO", "AN_ASS_DATE", "AN_ASS_BY", "AN_ACT_PARTY", "AN_MAINT_REQ", "AN_MAINT_REQ_SYS", "AN_WO_REF", "AN_WO_STATUS", "AN_DATE_IDENT", "AN_ACT_REQ", "AN_EQ_FAILURE", "AN_TA_APPROVED", "AN_TA_NAME", "AN_TA_APPR_DATE", "AN_ORIG_AVAIL_CLASS", "AN_ORIG_AVAIL_CLASS_SYS", "AN_CURR_AVAIL_CLASS", "AN_CURR_AVAIL_CLASS_SYS", "AN_AVAIL_UPD_DATE", "AN_AVAIL_UPD_BY", "AN_UPD_DATE", "AN_UPD_BY", "AN_FNCR_REQUIRED", "AN_FNCR", "AN_LIFE_TERM", "AN_LIFE_TERM_SYS", "AN_PORTFOLIO_APPL", "AN_RISK_RANK_SEVERITY", "AN_RISK_RANK_SEVERITY_SYS", "AN_RISK_RANK_SEVERITY_SYS_2", "AN_RISK_RANK_LIKELIHOOD", "AN_RISK_RANK_LIKELIHOOD_SYS", "AN_RISK_RANK_LIKELIHOOD_SYS_2", "AN_RISK_RANK_SYS", "AN_START_EAST", "AN_END_EAST", "AN_DESC", "AN_START_NORTH", "AN_END_NORTH", "AN_RECCMD", "AN_ASSMNT", "AN_DELETED", "AN_AVAIL_COMMENTS", "AN_TITLE", "AN_ATTACHMENTS", "AN_RISK_RANK_COMMENTS", "ITV_DATE_MOBIL", "ITV_TYPE", "ITV_TYPE_SYS", "ITV_VESSEL_TYPE", "ITV_VESSEL_TYPE_SYS", "ITV_TIME_PLAN_PROC", "ITV_TIME_MOBIL", "ITV_TIME_ACTUAL", "ITV_AFE_COST", "ITV_ACTUAL_COST", "ITV_DATE_ACTUAL_COST", "ITV_WBS_NUMBER", "ITV_UPDATED", "ITV_UPDATED_BY", "ITV_SUMMARY", "ITV_VESSEL_NAME", "ITV_LEARNING", "ITV_AFE_SHELL_SHARE", "ITV_VESSEL_DAY_RATE", "ITV_WELL_DOWNTIME", "AN_ASIS_STATUS", "AN_PT_SUPPORT", "AN_ASIS_STATUS_SYS", "AN_ASIS", "AN_WO_STATUS_SYS", "NODE_GROUP", "PS_CODES") AS 
  SELECT TBL_ANOM_MAIN.AN_ID,
  (
  --CASE WHEN TBL_ANOM_MAIN.AN_CURR_CLASS = 8471 AND (TBL_ANOM_MAIN.AN_STATUS = 8450 OR TBL_ANOM_MAIN.AN_STATUS = 8452) THEN 
   -- CASE WHEN TBL_ANOM_MAIN.AN_STATUS = 8450 OR TBL_ANOM_MAIN.AN_STATUS = 8452 THEN 
    --CASE WHEN ((SELECT COUNT(AI_TARGET_DATE) FROM V_TBL_ANOM_ACT_ITEMS WHERE AI_AN_ID = TBL_ANOM_MAIN.AN_ID AND (AI_STAT = 8900 OR AI_STAT = 8902)) = 0) THEN
     -- TBL_ANOM_MAIN.AN_ACT_BY_DATE 
    --ELSE 
      (SELECT MAX(AI_TARGET_DATE) FROM V_TBL_ANOM_ACT_ITEMS WHERE AI_AN_ID = TBL_ANOM_MAIN.AN_ID AND (AI_STAT = 8900 OR AI_STAT = 8902))
   -- END
 -- ELSE 
 --   TBL_ANOM_MAIN.AN_ACT_BY_DATE
 -- END
  ) AS AN_ACT_BY_DATE_MAX, 
  TBL_ANOM_MAIN.AN_ACT_BY_DATE,
  TBL_ANOM_MAIN.AN_REF,
  SYS_NODES_ATTRIB.REC_TAG AS AN_ASSET_ID,
  SYS_NODES_ATTRIB.NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS NODE_DESC,
  TBL_ANOM_MAIN.AN_TYPE,
  TBL_ANOM_TYPES.ANTYPE_NAME,
  TBL_ANOM_TYPES.ANTYPE_GROUP,
  SYS_LOOKUPS.LKP_DESC_B AS ANTYPE_GROUP_SYS,
  TBL_ANOM_MAIN.AN_STATUS,
  LOOKUPS_STATUS.LKP_DESC_B AS AN_STATUS_SYS,
  TBL_ANOM_MAIN.AN_RAISED_BY,
  TBL_ANOM_MAIN.AN_RAISED_DATE,
  TBL_ANOM_MAIN.AN_ORIG_CLASS,
  LOOKUPS_ORIG_CLASS.LKP_DESC_B AS AN_ORIG_CLASS_SYS,
  TBL_ANOM_MAIN.AN_CURR_CLASS,
  LOOKUPS_CURR_CLASS.LKP_DESC_B AS AN_CURR_CLASS_SYS,
  TBL_ANOM_MAIN.AN_REVNO,
  TBL_ANOM_MAIN.AN_ASS_DATE,
  TBL_ANOM_MAIN.AN_ASS_BY,
  TBL_ANOM_MAIN.AN_ACT_PARTY,
  TBL_ANOM_MAIN.AN_MAINT_REQ,
  LOOKUPS_MAINT_REQ.LKP_DESC_B AS AN_MAINT_REQ_SYS,
  TBL_ANOM_MAIN.AN_WO_REF,
  TBL_ANOM_MAIN.AN_WO_STATUS,
  TBL_ANOM_MAIN.AN_DATE_IDENT,
  TBL_ANOM_MAIN.AN_ACT_REQ,
  TBL_ANOM_MAIN.AN_EQ_FAILURE,
  TBL_ANOM_MAIN.AN_TA_APPROVED,
  TBL_ANOM_MAIN.AN_TA_NAME,
  TBL_ANOM_MAIN.AN_TA_APPR_DATE,
  TBL_ANOM_MAIN.AN_ORIG_AVAIL_CLASS,
  LOOKUPS_ORIG_AVAIL_CLASS.LKP_DESC_B AS AN_ORIG_AVAIL_CLASS_SYS,
  TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS,
  LOOKUPS_CURR_AVAIL_CLASS.LKP_DESC_B AS AN_CURR_AVAIL_CLASS_SYS,
  TBL_ANOM_MAIN.AN_AVAIL_UPD_DATE,
  TBL_ANOM_MAIN.AN_AVAIL_UPD_BY,
  TBL_ANOM_MAIN.AN_UPD_DATE,
  TBL_ANOM_MAIN.AN_UPD_BY,
  TBL_ANOM_MAIN.AN_FNCR_REQUIRED,
  TBL_ANOM_MAIN.AN_FNCR,
  TBL_ANOM_MAIN.AN_LIFE_TERM,
  LOOKUPS_LIFE_TERM.LKP_DESC_B AS AN_LIFE_TERM_SYS,
  TBL_ANOM_MAIN.AN_PORTFOLIO_APPL,
  TBL_ANOM_MAIN.AN_RISK_RANK_SEVERITY,
  LOOKUPS_RISK_RANK_SEVERITY.LKP_DESC_A AS AN_RISK_RANK_SEVERITY_SYS,
  LOOKUPS_RISK_RANK_SEVERITY.LKP_DESC_B AS AN_RISK_RANK_SEVERITY_SYS_2,
  TBL_ANOM_MAIN.AN_RISK_RANK_LIKELIHOOD,
  LOOKUPS_RISK_RANK_LIKELIHOOD.LKP_DESC_A AS AN_RISK_RANK_LIKELIHOOD_SYS,
  LOOKUPS_RISK_RANK_LIKELIHOOD.LKP_DESC_B AS AN_RISK_RANK_LIKELIHOOD_SYS_2,
  (LOOKUPS_RISK_RANK_SEVERITY.LKP_DESC_A
  || LOOKUPS_RISK_RANK_LIKELIHOOD.LKP_DESC_A) AS AN_RISK_RANK_SYS,
  TBL_ANOM_MAIN.AN_START_EAST,
  TBL_ANOM_MAIN.AN_END_EAST,
  TBL_ANOM_MAIN.AN_DESC,
  TBL_ANOM_MAIN.AN_START_NORTH,
  TBL_ANOM_MAIN.AN_END_NORTH,
  TBL_ANOM_MAIN.AN_RECCMD,
  TBL_ANOM_MAIN.AN_ASSMNT,
  TBL_ANOM_MAIN.AN_DELETED,
  TBL_ANOM_MAIN.AN_AVAIL_COMMENTS,
  TBL_ANOM_MAIN.AN_TITLE,
  (SELECT COUNT(1) FROM V_LNK_REF_ANOMMAIN WHERE AN_ID = TBL_ANOM_MAIN.AN_ID) AS AN_ATTACHMENTS,
  TBL_ANOM_MAIN.AN_RISK_RANK_COMMENTS,
  TBL_ANOM_MAIN.ITV_DATE_MOBIL,
  TBL_ANOM_MAIN.ITV_TYPE,
  LOOKUPS_ITV_TYPE.LKP_DESC_B AS ITV_TYPE_SYS,
  TBL_ANOM_MAIN.ITV_VESSEL_TYPE,
  LOOKUPS_VESSEL_TYPE.LKP_DESC_B AS ITV_VESSEL_TYPE_SYS,
  TBL_ANOM_MAIN.ITV_TIME_PLAN_PROC,
  TBL_ANOM_MAIN.ITV_TIME_MOBIL,
  TBL_ANOM_MAIN.ITV_TIME_ACTUAL,
  TBL_ANOM_MAIN.ITV_AFE_COST,
  TBL_ANOM_MAIN.ITV_ACTUAL_COST,
  TBL_ANOM_MAIN.ITV_DATE_ACTUAL_COST,
  TBL_ANOM_MAIN.ITV_WBS_NUMBER,
  TBL_ANOM_MAIN.ITV_UPDATED,
  TBL_ANOM_MAIN.ITV_UPDATED_BY,
  TBL_ANOM_MAIN.ITV_SUMMARY,
  TBL_ANOM_MAIN.ITV_VESSEL_NAME,
  TBL_ANOM_MAIN.ITV_LEARNING,
  TBL_ANOM_MAIN.ITV_AFE_SHELL_SHARE,
  TBL_ANOM_MAIN.ITV_VESSEL_DAY_RATE,
  TBL_ANOM_MAIN.ITV_WELL_DOWNTIME,
  TBL_ANOM_MAIN.AN_ASIS_STATUS,
  TBL_ANOM_MAIN.AN_PT_SUPPORT,
  SYS_LOOKUPS1.LKP_DESC_B AS AN_ASIS_STATUS_SYS,
  TBL_ANOM_MAIN.AN_ASIS,
  SYS_LOOKUPS2.LKP_DESC_B AS AN_WO_STATUS_SYS,
  SYS_NODES_ATTRIB.NODE_GROUP,
  SYS_NODES_ATTRIB.PS_CODES
FROM TBL_ANOM_MAIN
LEFT JOIN TBL_ANOM_TYPES
ON TBL_ANOM_MAIN.AN_TYPE = TBL_ANOM_TYPES.ANTYPE_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_STATUS
ON TBL_ANOM_MAIN.AN_STATUS = LOOKUPS_STATUS.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_ORIG_CLASS
ON TBL_ANOM_MAIN.AN_ORIG_CLASS = LOOKUPS_ORIG_CLASS.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CURR_CLASS
ON TBL_ANOM_MAIN.AN_CURR_CLASS = LOOKUPS_CURR_CLASS.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_MAINT_REQ
ON TBL_ANOM_MAIN.AN_MAINT_REQ = LOOKUPS_MAINT_REQ.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_ORIG_AVAIL_CLASS
ON TBL_ANOM_MAIN.AN_ORIG_AVAIL_CLASS = LOOKUPS_ORIG_AVAIL_CLASS.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CURR_AVAIL_CLASS
ON TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS = LOOKUPS_CURR_AVAIL_CLASS.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_LIFE_TERM
ON TBL_ANOM_MAIN.AN_LIFE_TERM = LOOKUPS_LIFE_TERM.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_RISK_RANK_SEVERITY
ON TBL_ANOM_MAIN.AN_RISK_RANK_SEVERITY = LOOKUPS_RISK_RANK_SEVERITY.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_RISK_RANK_LIKELIHOOD
ON TBL_ANOM_MAIN.AN_RISK_RANK_LIKELIHOOD = LOOKUPS_RISK_RANK_LIKELIHOOD.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_ITV_TYPE
ON TBL_ANOM_MAIN.ITV_TYPE = LOOKUPS_ITV_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_VESSEL_TYPE
ON TBL_ANOM_MAIN.ITV_VESSEL_TYPE = LOOKUPS_VESSEL_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS
ON TBL_ANOM_TYPES.ANTYPE_GROUP = SYS_LOOKUPS.LKP_ID
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A
INNER JOIN SYS_NODES_ATTRIB
ON SYS_NODES_ATTRIB.REC_TAG = LNK_AN_NODES.LNK_TAG_B
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON TBL_ANOM_MAIN.AN_ASIS_STATUS = SYS_LOOKUPS1.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS2
ON TBL_ANOM_MAIN.AN_WO_STATUS    = SYS_LOOKUPS2.LKP_ID
WHERE (TBL_ANOM_MAIN.AN_DELETED IS NULL)
OR (TBL_ANOM_MAIN.AN_DELETED     = 0)
ORDER BY TBL_ANOM_MAIN.AN_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_ANOM_MAIN_ACT_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_ANOM_MAIN_ACT_COLOR" ("ACTION_COLOR", "ASSET_ID") AS 
  SELECT V_TBL_ANOM_MAIN.AN_CURR_CLASS ACTION_COLOR, 
  V_TBL_ANOM_MAIN.AN_ASSET_ID AS ASSET_ID
FROM V_TBL_ANOM_MAIN WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_ANOM_MAIN_ACTAVL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_ANOM_MAIN_ACTAVL_COLOR" ("ACTION_AVAIL_COLOR", "ASSET_ID") AS 
  SELECT (
  CASE
    WHEN V_TBL_ANOM_MAIN.AN_CURR_CLASS >= V_TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
    THEN V_TBL_ANOM_MAIN.AN_CURR_CLASS
    ELSE V_TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
  END) ACTION_AVAIL_COLOR,
  V_TBL_ANOM_MAIN.AN_ASSET_ID AS ASSET_ID
FROM V_TBL_ANOM_MAIN WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_ANOM_MAIN_AVAIL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_ANOM_MAIN_AVAIL_COLOR" ("AVAIL_COLOR", "ASSET_ID") AS 
  SELECT V_TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS AVAIL_COLOR,
  V_TBL_ANOM_MAIN.AN_ASSET_ID AS ASSET_ID
FROM V_TBL_ANOM_MAIN
WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_ANOM_MAIN_COM_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_ANOM_MAIN_COM_COLOR" ("COMPLIANCE_COLOR", "ASSET_ID") AS 
  SELECT V_TBL_CA.CA_STATUS_COLOR AS COMPLIANCE_COLOR,
  V_TBL_CA.CA_REC_TAG           AS ASSET_ID
FROM V_TBL_CA WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_ANOM_MAIN_RISK_POYNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_ANOM_MAIN_RISK_POYNT" ("RECORD_CONTROL", "REGION", "SITE_CODE", "RISK_RECORD_NUMBER", "RISK_TYPE", "TITLE", "RISK_SUMMARY", "MITIGATION_CONTROL_SUMMARY", "RECOVERY_SUMMARY", "STATUS", "AREA", "SC", "BARRIER", "PSCODE", "SCHEDULE_DATE", "ACTION_OWNER", "TARGET_DATE", "LAST_FINISH_DATE", "RAISED_BY", "DATE_RAISED", "TEAM1", "TEAM2", "TEAM3", "REVIEWER1", "REVIEWER2", "APPROVER", "HAZARD", "INITIAL_SCORE", "INITIAL_SV", "INITIAL_LH", "RESIDUAL_SCORE", "RESIDUAL_SV", "RESIDUAL_LH", "CONTROL", "CONTROL_TYPE", "ATTRIBUTE1", "ATTRIBUTE2", "ATTRIBUTE3", "AN_UPD_DATE", "AN_ID") AS 
  SELECT
     t2.record_control,
     t2.region,
     t2.site_code,
     t2.risk_record_number,
     t2.risk_type,
     t2.title,
     t2.risk_summary,
     t2.mitigation_control_summary,
     t2.recovery_summary,
     t2.status,
     t2.area,
     t2.sc,
     t2.barrier,
     t2.pscode,
     t2.schedule_date,
     t2.action_owner,
     t2.target_date,
     t2.last_finish_date,
     t2.raised_by,
     t2.date_raised,
     t2.team1,
     t2.team2,
     t2.team3,
     t2.reviewer1,
     t2.reviewer2,
     t2.approver,
     t2.hazard,
     t2.initial_score,
     t2.initial_sv,
     t2.initial_lh,
     t2.residual_score,
     t2.residual_sv,
     t2.residual_lh,
     t2.control,
     t2.control_type,
     t2.attribute1,
     t2.attribute2,
     t2.attribute3,
             CASE WHEN t2.an_upd_date IS NULL THEN
                 t2.an_raised_date
                 ELSE t2.an_upd_date
             END an_upd_date,

     t2.an_id
 FROM
     (
         SELECT
             NULL AS record_control,
             NULL AS region,
             'SUBSEA ES' AS site_code,
             v_tbl_anom_main.an_ref         AS risk_record_number,
             'PS' AS risk_type,
             v_tbl_anom_main.an_title       AS title,
             v_tbl_anom_main.antype_name
             || nvl2(v_tbl_anom_main.an_assmnt, (' - '
                                                    || v_tbl_anom_main.an_assmnt),'') AS risk_summary,
             NULL AS mitigation_control_summary,
             v_tbl_anom_main.an_reccmd      AS recovery_summary,
             upper(v_tbl_anom_main.an_status_sys) AS status,
             v_tbl_anom_main.node_desc      AS area,
             'Y' AS sc,
             'PC' AS barrier,
             v_tbl_anom_main.ps_codes       AS pscode,
             NULL AS schedule_date,
             v_tbl_anom_main.an_act_party   AS action_owner,
             TO_CHAR(v_tbl_anom_main.an_act_by_date,'YYYY-MM-DD HH24:MI:SS') AS target_date,
             NULL AS last_finish_date,
             v_tbl_anom_main.an_raised_by   AS raised_by,
             TO_CHAR(v_tbl_anom_main.an_raised_date,'YYYY-MM-DD HH24:MI:SS') AS date_raised,
             v_tbl_anom_main.an_raised_date,
             NULL AS team1,
             NULL AS team2,
             NULL AS team3,
             NULL AS reviewer1,
             NULL AS reviewer2,
             NULL AS approver,
             v_tbl_anom_main.an_desc        AS hazard,
             NULL AS initial_score,
             NULL AS initial_sv,
             NULL AS initial_lh,
             NULL AS residual_score,
             NULL AS residual_sv,
             NULL AS residual_lh,
             NULL AS control,
             NULL AS control_type,
             NULL AS attribute1,
             NULL AS attribute2,
             NULL AS attribute3,
             v_tbl_anom_main.an_upd_date,
             v_tbl_anom_main.an_id,
             v_tbl_anom_main.an_asset_id,
             COUNT(v_tbl_anom_act_items.ai_an_id)
         FROM
             v_tbl_anom_main
             INNER JOIN v_tbl_anom_act_items ON v_tbl_anom_main.an_id = v_tbl_anom_act_items.ai_an_id
         WHERE
             v_tbl_anom_main.ps_codes = 'PC006'
         GROUP BY
             NULL,
             'SUBSEA ES',
             v_tbl_anom_main.an_ref,
             'PS',
             v_tbl_anom_main.an_title,
             v_tbl_anom_main.antype_name
             || nvl2(v_tbl_anom_main.an_assmnt, (' - '
                                                    || v_tbl_anom_main.an_assmnt),''),
             v_tbl_anom_main.an_reccmd,
             upper(v_tbl_anom_main.an_status_sys),
             v_tbl_anom_main.node_desc,
             'Y',
             'PC',
             v_tbl_anom_main.ps_codes,
             v_tbl_anom_main.an_act_party,
             TO_CHAR(v_tbl_anom_main.an_act_by_date,'YYYY-MM-DD HH24:MI:SS'),
             v_tbl_anom_main.an_raised_by,
             TO_CHAR(v_tbl_anom_main.an_raised_date,'YYYY-MM-DD HH24:MI:SS'),
             v_tbl_anom_main.an_desc,
             v_tbl_anom_main.an_raised_date,
             v_tbl_anom_main.an_upd_date,
             v_tbl_anom_main.an_id,
             v_tbl_anom_main.an_asset_id
         HAVING
             COUNT(v_tbl_anom_act_items.ai_an_id) > 0
     ) t2
     INNER JOIN (
         SELECT
             sys_tree_struc.tre_dat_tag
         FROM
             sys_tree_struc
             INNER JOIN sys_nodes_attrib ON sys_tree_struc.tre_dat_tag = sys_nodes_attrib.rec_tag
         WHERE
             sys_tree_struc.tre_dat_type = 1
         START WITH
             sys_tree_struc.tre_dat_tag = 87694
         CONNECT BY
             PRIOR sys_tree_struc.tre_nod_tag = sys_tree_struc.tre_nod_tag_par
     ) t1 ON t1.tre_dat_tag = t2.an_asset_id
 ORDER BY
     t2.an_id DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_ARC_ANOM_MAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_ARC_ANOM_MAIN" ("AN_ID", "AN_REF", "AN_ASSET_ID", "AN_TYPE", "AN_STATUS", "AN_RAISED_BY", "AN_RAISED_DATE", "AN_ORIG_CLASS", "AN_CURR_CLASS", "AN_REVNO", "AN_ASS_DATE", "AN_ASS_BY", "AN_ACT_BY_DATE", "AN_ACT_PARTY", "AN_MAINT_REQ", "AN_WO_REF", "AN_WO_STATUS", "AN_DATE_IDENT", "AN_ACT_REQ", "AN_EQ_FAILURE", "AN_TA_APPROVED", "AN_TA_NAME", "AN_TA_APPR_DATE", "AN_ORIG_AVAIL_CLASS", "AN_CURR_AVAIL_CLASS", "AN_AVAIL_UPD_DATE", "AN_AVAIL_UPD_BY", "AN_UPD_DATE", "AN_UPD_BY", "AN_FNCR_REQUIRED", "AN_FNCR", "AN_LIFE_TERM", "AN_PORTFOLIO_APPL", "AN_RISK_RANK_SEVERITY", "AN_RISK_RANK_LIKELIHOOD", "AN_START_EAST", "AN_END_EAST", "AN_DESC", "AN_START_NORTH", "AN_END_NORTH", "AN_NOTIFICATION_REF", "AN_RECCMD", "AN_NOTIFICATION_STATUS", "AN_ASSMNT", "AN_DELETED", "AN_AVAIL_COMMENTS", "AN_TITLE", "AN_ATTACHMENTS", "AN_RISK_RANK_COMMENTS", "ITV_ANOM_REF", "ITV_DATE_MOBIL", "ITV_DATE_PROD_RSTO", "ITV_TYPE", "ITV_TIME_DIAGNOSTIC", "ITV_VESSEL_TYPE", "ITV_CATEGORY", "ITV_TIME_PLAN_PROC", "ITV_TIME_MOBIL", "ITV_TIME_ACTUAL", "ITV_TIME_DEMOB", "ITV_TTIME_WEATHER", "ITV_TTIME_ROV", "ITV_TTIME_VESSEL", "ITV_TTIME_VEND_EQPT", "ITV_TTIME_OTHER", "ITV_AFE_COST", "ITV_ACTUAL_COST", "ITV_DATE_ACTUAL_COST", "ITV_WBS_NUMBER", "ITV_UPDATED", "ITV_UPDATED_BY", "ITV_SUMMARY", "ITV_VESSEL_NAME", "ITV_PARENT_ANOM_REV", "ITV_LEARNING", "ITV_AFE_SHELL_SHARE", "ITV_VESSEL_DAY_RATE", "ITV_WELL_DOWNTIME", "NODE_ID", "NODE_DESC", "AN_CURR_AVAIL_CLASS_SYS", "AN_ORIG_AVAIL_CLASS_SYS", "AN_CURR_CLASS_SYS", "AN_ORIG_CLASS_SYS") AS 
  SELECT TBL_ARC_ANOM_MAIN.AN_ID,
  TBL_ARC_ANOM_MAIN.AN_REF,
  TBL_ARC_ANOM_MAIN.AN_ASSET_ID,
  TBL_ARC_ANOM_MAIN.AN_TYPE,
  TBL_ARC_ANOM_MAIN.AN_STATUS,
  TBL_ARC_ANOM_MAIN.AN_RAISED_BY,
  TBL_ARC_ANOM_MAIN.AN_RAISED_DATE,
  TBL_ARC_ANOM_MAIN.AN_ORIG_CLASS,
  TBL_ARC_ANOM_MAIN.AN_CURR_CLASS,
  TBL_ARC_ANOM_MAIN.AN_REVNO,
  TBL_ARC_ANOM_MAIN.AN_ASS_DATE,
  TBL_ARC_ANOM_MAIN.AN_ASS_BY,
  TBL_ARC_ANOM_MAIN.AN_ACT_BY_DATE,
  TBL_ARC_ANOM_MAIN.AN_ACT_PARTY,
  TBL_ARC_ANOM_MAIN.AN_MAINT_REQ,
  TBL_ARC_ANOM_MAIN.AN_WO_REF,
  TBL_ARC_ANOM_MAIN.AN_WO_STATUS,
  TBL_ARC_ANOM_MAIN.AN_DATE_IDENT,
  TBL_ARC_ANOM_MAIN.AN_ACT_REQ,
  TBL_ARC_ANOM_MAIN.AN_EQ_FAILURE,
  TBL_ARC_ANOM_MAIN.AN_TA_APPROVED,
  TBL_ARC_ANOM_MAIN.AN_TA_NAME,
  TBL_ARC_ANOM_MAIN.AN_TA_APPR_DATE,
  TBL_ARC_ANOM_MAIN.AN_ORIG_AVAIL_CLASS,
  TBL_ARC_ANOM_MAIN.AN_CURR_AVAIL_CLASS,
  TBL_ARC_ANOM_MAIN.AN_AVAIL_UPD_DATE,
  TBL_ARC_ANOM_MAIN.AN_AVAIL_UPD_BY,
  TBL_ARC_ANOM_MAIN.AN_UPD_DATE,
  TBL_ARC_ANOM_MAIN.AN_UPD_BY,
  TBL_ARC_ANOM_MAIN.AN_FNCR_REQUIRED,
  TBL_ARC_ANOM_MAIN.AN_FNCR,
  TBL_ARC_ANOM_MAIN.AN_LIFE_TERM,
  TBL_ARC_ANOM_MAIN.AN_PORTFOLIO_APPL,
  TBL_ARC_ANOM_MAIN.AN_RISK_RANK_SEVERITY,
  TBL_ARC_ANOM_MAIN.AN_RISK_RANK_LIKELIHOOD,
  TBL_ARC_ANOM_MAIN.AN_START_EAST,
  TBL_ARC_ANOM_MAIN.AN_END_EAST,
  TBL_ARC_ANOM_MAIN.AN_DESC,
  TBL_ARC_ANOM_MAIN.AN_START_NORTH,
  TBL_ARC_ANOM_MAIN.AN_END_NORTH,
  TBL_ARC_ANOM_MAIN.AN_NOTIFICATION_REF,
  TBL_ARC_ANOM_MAIN.AN_RECCMD,
  TBL_ARC_ANOM_MAIN.AN_NOTIFICATION_STATUS,
  TBL_ARC_ANOM_MAIN.AN_ASSMNT,
  TBL_ARC_ANOM_MAIN.AN_DELETED,
  TBL_ARC_ANOM_MAIN.AN_AVAIL_COMMENTS,
  TBL_ARC_ANOM_MAIN.AN_TITLE,
  TBL_ARC_ANOM_MAIN.AN_ATTACHMENTS,
  TBL_ARC_ANOM_MAIN.AN_RISK_RANK_COMMENTS,
  TBL_ARC_ANOM_MAIN.ITV_ANOM_REF,
  TBL_ARC_ANOM_MAIN.ITV_DATE_MOBIL,
  TBL_ARC_ANOM_MAIN.ITV_DATE_PROD_RSTO,
  TBL_ARC_ANOM_MAIN.ITV_TYPE,
  TBL_ARC_ANOM_MAIN.ITV_TIME_DIAGNOSTIC,
  TBL_ARC_ANOM_MAIN.ITV_VESSEL_TYPE,
  TBL_ARC_ANOM_MAIN.ITV_CATEGORY,
  TBL_ARC_ANOM_MAIN.ITV_TIME_PLAN_PROC,
  TBL_ARC_ANOM_MAIN.ITV_TIME_MOBIL,
  TBL_ARC_ANOM_MAIN.ITV_TIME_ACTUAL,
  TBL_ARC_ANOM_MAIN.ITV_TIME_DEMOB,
  TBL_ARC_ANOM_MAIN.ITV_TTIME_WEATHER,
  TBL_ARC_ANOM_MAIN.ITV_TTIME_ROV,
  TBL_ARC_ANOM_MAIN.ITV_TTIME_VESSEL,
  TBL_ARC_ANOM_MAIN.ITV_TTIME_VEND_EQPT,
  TBL_ARC_ANOM_MAIN.ITV_TTIME_OTHER,
  TBL_ARC_ANOM_MAIN.ITV_AFE_COST,
  TBL_ARC_ANOM_MAIN.ITV_ACTUAL_COST,
  TBL_ARC_ANOM_MAIN.ITV_DATE_ACTUAL_COST,
  TBL_ARC_ANOM_MAIN.ITV_WBS_NUMBER,
  TBL_ARC_ANOM_MAIN.ITV_UPDATED,
  TBL_ARC_ANOM_MAIN.ITV_UPDATED_BY,
  TBL_ARC_ANOM_MAIN.ITV_SUMMARY,
  TBL_ARC_ANOM_MAIN.ITV_VESSEL_NAME,
  TBL_ARC_ANOM_MAIN.ITV_PARENT_ANOM_REV,
  TBL_ARC_ANOM_MAIN.ITV_LEARNING,
  TBL_ARC_ANOM_MAIN.ITV_AFE_SHELL_SHARE,
  TBL_ARC_ANOM_MAIN.ITV_VESSEL_DAY_RATE,
  TBL_ARC_ANOM_MAIN.ITV_WELL_DOWNTIME,
  SYS_NODES_ATTRIB.NODE_ID,
  SYS_NODES_ATTRIB.NODE_DESC,
  CLS_AC.LKP_DESC_B AS AN_CURR_AVAIL_CLASS_SYS,
  CLS_AO.LKP_DESC_B AS AN_ORIG_AVAIL_CLASS_SYS,
  CLS_IC.LKP_DESC_B AS AN_CURR_CLASS_SYS,
  CLS_IO.LKP_DESC_B AS AN_ORIG_CLASS_SYS
FROM ((((TBL_ARC_ANOM_MAIN TBL_ARC_ANOM_MAIN
INNER JOIN SYS_NODES_ATTRIB SYS_NODES_ATTRIB
ON TBL_ARC_ANOM_MAIN.AN_ASSET_ID = SYS_NODES_ATTRIB.REC_TAG)
LEFT JOIN SYS_LOOKUPS CLS_IO
ON TBL_ARC_ANOM_MAIN.AN_ORIG_CLASS = CLS_IO.LKP_ID)
LEFT JOIN SYS_LOOKUPS CLS_IC
ON TBL_ARC_ANOM_MAIN.AN_CURR_CLASS = CLS_IC.LKP_ID)
LEFT JOIN SYS_LOOKUPS CLS_AO
ON TBL_ARC_ANOM_MAIN.AN_ORIG_AVAIL_CLASS = CLS_AO.LKP_ID)
LEFT JOIN SYS_LOOKUPS CLS_AC
ON TBL_ARC_ANOM_MAIN.AN_CURR_AVAIL_CLASS = CLS_AC.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CA" ("CA_ID", "CA_REC_TAG", "CA_NODE_ID", "CA_NODE_DESC", "CA_TASK_REF", "CA_TASK_DESC", "CA_TASK_FREQ", "CA_TASK_TYPE", "CA_TASK_TYPE_DESC", "CA_HRS_NEEDED", "CA_FREQ_JUST", "CA_NEXT_TARGET_DATE", "CA_LAST_DATE", "CA_TARGET_DATE", "CA_DEV_NEEDED", "CA_DEV_INITIATOR", "CA_DEV_APPROVER", "CA_RSK_ASS", "CA_DEV_MIT", "CA_LAFD", "CA_LAFD_DEV_1", "CA_LAFD_DEV_2", "CA_LAFD_DEV_NEEDED", "CA_LAFD_DEV_INITIATOR", "CA_LAFD_RSK_ASS", "CA_LAFD_MIT", "CA_LAFD_DEV_APPROVER", "CA_UPD_BY", "CA_UPD_DATE", "CA_SCE", "CA_STATUS_COLOR", "CA_STATUS_COLOR_SYS", "CA_TASK_FREQ_SYS", "PS_CODES") AS 
  SELECT
     ca_id,
     ca_rec_tag,
     ca_node_id,
     ( ca_node_id
       || ' - '
       || ca_node_desc ) AS ca_node_desc,
     ca_task_ref,
     ca_task_desc,
     ca_task_freq,
     ca_task_type,
     ca_task_type_desc,
     ca_hrs_needed,
     ca_freq_just,
     ca_next_target_date,
     ca_last_date,
     ca_target_date,
     ca_dev_needed,
     ca_dev_initiator,
     ca_dev_approver,
     ca_rsk_ass,
     ca_dev_mit,
     ca_lafd,
     ca_lafd_dev_1,
     ca_lafd_dev_2,
     ca_lafd_dev_needed,
     ca_lafd_dev_initiator,
     ca_lafd_rsk_ass,
     ca_lafd_mit,
     ca_lafd_dev_approver,
     ca_upd_by,
     ca_upd_date,
     ca_sce,
     ca_status_color,
     sys_lookups.lkp_desc_b   AS ca_status_color_sys,
     ca_task_freq_sys,
     ps_codes
 FROM
     (
         SELECT
             tbl_ca.ca_id,
             tbl_ca.ca_rec_tag,
             sys_nodes_attrib.node_id     AS ca_node_id,
             sys_nodes_attrib.node_desc   AS ca_node_desc,
             tbl_ca.ca_task_ref,
             tbl_ca.ca_task_desc,
             tbl_ca.ca_task_freq,
             tbl_ca.ca_task_type,
             sys_lookups.lkp_desc_b       AS ca_task_type_desc,
             tbl_ca.ca_hrs_needed,
             tbl_ca.ca_freq_just,
             tbl_ca.ca_next_target_date,
             tbl_ca.ca_last_date,
             tbl_ca.ca_target_date,
             tbl_ca.ca_dev_needed,
             tbl_ca.ca_dev_initiator,
             tbl_ca.ca_dev_approver,
             tbl_ca.ca_rsk_ass,
             tbl_ca.ca_dev_mit,
             ( CASE
                 WHEN tbl_ca.ca_lafd_dev_2 IS NOT NULL THEN tbl_ca.ca_lafd_dev_2
                 ELSE tbl_ca.ca_lafd_dev_1
             END ) AS ca_lafd,
             tbl_ca.ca_lafd_dev_1,
             tbl_ca.ca_lafd_dev_2,
             tbl_ca.ca_lafd_dev_needed,
             tbl_ca.ca_lafd_dev_initiator,
             tbl_ca.ca_lafd_rsk_ass,
             tbl_ca.ca_lafd_mit,
             tbl_ca.ca_lafd_dev_approver,
             tbl_ca.ca_upd_by,
             tbl_ca.ca_upd_date,
             ( CASE
                 WHEN ( nvl(tbl_ca.ca_dev_needed,0) <> 1
                        AND nvl(tbl_ca.ca_lafd_dev_needed,0) <> 1 ) THEN CASE
                     WHEN ( ( trunc(tbl_ca.ca_target_date) - trunc(SYSDATE) ) >= 0 )
                          AND ( ( trunc(tbl_ca.ca_target_date) - trunc(SYSDATE) ) <= 90 ) THEN 17741 --ORANGE
                     WHEN ( ( trunc(tbl_ca.ca_target_date) - trunc(SYSDATE) ) < 0 ) THEN 17742 --RED
                     ELSE 17740 --GREEN
                 END
                 ELSE CASE
                     WHEN ( NOT ( tbl_ca.ca_lafd_dev_1 IS NULL )
                                AND tbl_ca.ca_lafd_dev_2 IS NULL ) THEN CASE
                         WHEN ( trunc(SYSDATE) > trunc(tbl_ca.ca_lafd_dev_1) ) THEN 17742
                         ELSE 17743 --PURPLE
                     END
                     WHEN ( NOT ( tbl_ca.ca_lafd_dev_1 IS NULL )
                                AND NOT ( tbl_ca.ca_lafd_dev_2 IS NULL ) ) THEN CASE
                         WHEN ( trunc(SYSDATE) > trunc(tbl_ca.ca_lafd_dev_2) ) THEN 17742
                         ELSE 17743
                     END
                     WHEN ( tbl_ca.ca_lafd_dev_1 IS NULL
                            AND NOT ( tbl_ca.ca_lafd_dev_2 IS NULL ) ) THEN CASE
                         WHEN ( trunc(SYSDATE) > trunc(tbl_ca.ca_lafd_dev_2) ) THEN 17742
                         ELSE 17743
                     END
                     ELSE 17743
                 END
             END ) AS ca_status_color,
             tbl_ca.ca_sce                AS ca_sce,
             sys_lookups1.lkp_desc_b      AS ca_task_freq_sys,
             sys_nodes_attrib.ps_codes    AS ps_codes
         FROM
             tbl_ca
             INNER JOIN sys_nodes_attrib ON tbl_ca.ca_rec_tag = sys_nodes_attrib.rec_tag
             LEFT JOIN sys_lookups ON tbl_ca.ca_task_type = sys_lookups.lkp_id
             LEFT JOIN sys_lookups sys_lookups1 ON tbl_ca.ca_task_freq = sys_lookups1.lkp_id
         WHERE
             tbl_ca.ca_deleted IS NULL
     ) left
     JOIN sys_lookups ON ca_status_color = sys_lookups.lkp_id WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CA_ACT_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CA_ACT_COLOR" ("ACTION_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_CLASS ACTION_COLOR, 
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CA_ACTAVL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CA_ACTAVL_COLOR" ("ACTION_AVAIL_COLOR", "ASSET_ID") AS 
  SELECT (
  CASE
    WHEN TBL_ANOM_MAIN.AN_CURR_CLASS >= TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
    THEN TBL_ANOM_MAIN.AN_CURR_CLASS
    ELSE TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
  END) ACTION_AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CA_AVAIL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CA_AVAIL_COLOR" ("AVAIL_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CA_COM_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CA_COM_COLOR" ("COMPLIANCE_COLOR", "ASSET_ID") AS 
  SELECT V_TBL_CA.CA_STATUS_COLOR AS COMPLIANCE_COLOR,
  V_TBL_CA.CA_REC_TAG           AS ASSET_ID
FROM V_TBL_CA WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CA_READ
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CA_READ" ("CA_ID", "ASSET_ID", "ASSET_DESC", "LAST_DATE", "TARGET_COMPL_DATE", "NEXT_TO_NEXT_TARGET_DATE", "STATUS", "STATUS_DESC") AS 
  SELECT
     ca_id,
     ca_node_id               asset_id,
     ( ca_node_id
       || ' - '
       || ca_node_desc ) AS asset_desc,
     ca_last_date             AS last_date,
     ca_target_date           AS target_compl_date,
     ca_next_target_date      AS next_to_next_target_date,
     ca_status_color          status,
     sys_lookups.lkp_desc_b   AS status_desc
 FROM
     (
         SELECT
             tbl_ca.ca_id,
             tbl_ca.ca_rec_tag,
             sys_nodes_attrib.node_id     AS ca_node_id,
             sys_nodes_attrib.node_desc   AS ca_node_desc,
             tbl_ca.ca_task_ref,
             tbl_ca.ca_task_desc,
             tbl_ca.ca_task_freq,
             tbl_ca.ca_task_type,
             sys_lookups.lkp_desc_b       AS ca_task_type_desc,
             tbl_ca.ca_hrs_needed,
             tbl_ca.ca_freq_just,
             tbl_ca.ca_next_target_date,
             tbl_ca.ca_last_date,
             tbl_ca.ca_target_date,
             tbl_ca.ca_dev_needed,
             tbl_ca.ca_dev_initiator,
             tbl_ca.ca_dev_approver,
             tbl_ca.ca_rsk_ass,
             tbl_ca.ca_dev_mit,
             ( CASE
                 WHEN tbl_ca.ca_lafd_dev_2 IS NOT NULL THEN tbl_ca.ca_lafd_dev_2
                 ELSE tbl_ca.ca_lafd_dev_1
             END ) AS ca_lafd,
             tbl_ca.ca_lafd_dev_1,
             tbl_ca.ca_lafd_dev_2,
             tbl_ca.ca_lafd_dev_needed,
             tbl_ca.ca_lafd_dev_initiator,
             tbl_ca.ca_lafd_rsk_ass,
             tbl_ca.ca_lafd_mit,
             tbl_ca.ca_lafd_dev_approver,
             tbl_ca.ca_upd_by,
             tbl_ca.ca_upd_date,
             ( CASE
                 WHEN ( nvl(tbl_ca.ca_dev_needed,0) <> 1
                        AND nvl(tbl_ca.ca_lafd_dev_needed,0) <> 1 ) THEN CASE
                     WHEN ( ( trunc(tbl_ca.ca_target_date) - trunc(SYSDATE) ) >= 0 )
                          AND ( ( trunc(tbl_ca.ca_target_date) - trunc(SYSDATE) ) <= 90 ) THEN 17741
                     WHEN ( ( trunc(tbl_ca.ca_target_date) - trunc(SYSDATE) ) < 0 ) THEN 17742
                     ELSE 17740
                 END
                 ELSE CASE
                     WHEN ( NOT ( tbl_ca.ca_lafd_dev_1 IS NULL )
                                AND tbl_ca.ca_lafd_dev_2 IS NULL ) THEN CASE
                         WHEN ( trunc(SYSDATE) > trunc(tbl_ca.ca_lafd_dev_1) ) THEN 17742
                         ELSE 17743
                     END
                     WHEN ( NOT ( tbl_ca.ca_lafd_dev_1 IS NULL )
                                AND NOT ( tbl_ca.ca_lafd_dev_2 IS NULL ) ) THEN CASE
                         WHEN ( trunc(SYSDATE) > trunc(tbl_ca.ca_lafd_dev_2) ) THEN 17742
                         ELSE 17743
                     END
                     WHEN ( tbl_ca.ca_lafd_dev_1 IS NULL
                            AND NOT ( tbl_ca.ca_lafd_dev_2 IS NULL ) ) THEN CASE
                         WHEN ( trunc(SYSDATE) > trunc(tbl_ca.ca_lafd_dev_2) ) THEN 17742
                         ELSE 17743
                     END
                     ELSE 17743
                 END
             END ) AS ca_status_color,
             tbl_ca.ca_sce                AS ca_sce,
             sys_lookups1.lkp_desc_b      AS ca_task_freq_sys
         FROM
             tbl_ca
             INNER JOIN sys_nodes_attrib ON tbl_ca.ca_rec_tag = sys_nodes_attrib.rec_tag
             LEFT JOIN sys_lookups ON tbl_ca.ca_task_type = sys_lookups.lkp_id
             INNER JOIN sys_lookups sys_lookups1 ON tbl_ca.ca_task_freq = sys_lookups1.lkp_id
         WHERE
             tbl_ca.ca_deleted IS NULL
     ) left
     JOIN sys_lookups ON ca_status_color = sys_lookups.lkp_id WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CA_RISK_POYNT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CA_RISK_POYNT" ("SITE_CODE", "LOAD_DATE", "WORK_ORDER", "WORK_DESCRIPTION", "PRIORITY", "LATEST_FINISH_DATE", "JOB_PLAN", "MAINTENANCE_TYPE", "SAFETY_CRITICAL", "PS_CODES", "AREA_CODE", "STATUS", "ASSET_NUMBER", "WORK_ORDER_TYPE", "WORK_ORDER_HOURS", "CLOSED_DATE", "RA_ID", "ATTRIBUTE1", "ATTRIBUTE2", "ATTRIBUTE3", "ATTRIBUTE4", "ATTRIBUTE5", "CA_UPD_DATE", "CA_ID", "CA_STATUS_COLOR") AS 
  SELECT
     site_code,
     load_date,
     work_order,
     work_description,
     priority,
     latest_finish_date,
     job_plan,
     maintenance_type,
     safety_critical,
     ps_codes,
     area_code,
     status,
     asset_number,
     work_order_type,
     work_order_hours,
     closed_date,
     ra_id,
     attribute1,
     attribute2,
     attribute3,
     attribute4,
     attribute5,
     ca_upd_date,
     ca_id,
     ca_status_color
 FROM
     (
         SELECT
             t2.site_code,
             t2.load_date,
             t2.work_order,
             t2.work_description,
             t2.priority,
             t2.latest_finish_date,
             t2.job_plan,
             t2.maintenance_type,
             t2.safety_critical,
             t2.status,
             t2.area_code,
             t2.work_order_type,
             t2.work_order_hours,
             t2.closed_date,
             t2.ra_id,
             t2.attribute1,
             t2.attribute2,
             t2.attribute3,
             t2.attribute4,
             t2.attribute5,
             t2.ca_upd_date,
             t2.ca_id,
             t1.node_id
             || ' - '
             || t1.node_desc AS asset_number,
             t1.ps_codes,
             t2.ca_status_color
         FROM
             (
                 SELECT
                     'SUBSEA ES' AS site_code,
                     TO_CHAR(current_date,'YYYY-MM-DD HH24:MI:SS') AS load_date,
                     tbl_ca.ca_id   AS work_order,
                     tbl_ca.ca_task_ref
                     || ' - '
                     || tbl_ca.ca_task_desc AS work_description,
                     '4' AS priority,
                     TO_CHAR(tbl_ca.ca_target_date,'YYYY-MM-DD HH24:MI:SS') AS latest_finish_date,
                     NULL AS job_plan,
                     'PREVENTATIVE' AS maintenance_type,
                     'Y' AS safety_critical,
                     ( CASE
                         WHEN tbl_ca.ca_deleted IS NULL THEN 'OPEN'
                         ELSE 'CLOSED'
                     END ) AS status,
                     NULL AS area_code,
                     'INSPECTION' AS work_order_type,
                     NULL AS work_order_hours,
                     NULL AS closed_date,
                     NULL AS ra_id,
                     NULL AS attribute1,
                     NULL AS attribute2,
                     NULL AS attribute3,
                     NULL AS attribute4,
                     NULL AS attribute5,
                     ( CASE
                         WHEN ( nvl(tbl_ca.ca_dev_needed,0) <> 1
                                AND nvl(tbl_ca.ca_lafd_dev_needed,0) <> 1 ) THEN CASE
                             WHEN ( ( trunc(tbl_ca.ca_target_date) - trunc(SYSDATE) ) >= 0 )
                                  AND ( ( trunc(tbl_ca.ca_target_date) - trunc(SYSDATE) ) <= 90 ) THEN 17741
                             WHEN ( ( trunc(tbl_ca.ca_target_date) - trunc(SYSDATE) ) < 0 ) THEN 17742
                             ELSE 17740
                         END
                         ELSE CASE
                             WHEN ( NOT ( tbl_ca.ca_lafd_dev_1 IS NULL )
                                        AND tbl_ca.ca_lafd_dev_2 IS NULL ) THEN CASE
                                 WHEN ( trunc(SYSDATE) > trunc(tbl_ca.ca_lafd_dev_1) ) THEN 17742
                                 ELSE 17743
                             END
                             WHEN ( NOT ( tbl_ca.ca_lafd_dev_1 IS NULL )
                                        AND NOT ( tbl_ca.ca_lafd_dev_2 IS NULL ) ) THEN CASE
                                 WHEN ( trunc(SYSDATE) > trunc(tbl_ca.ca_lafd_dev_2) ) THEN 17742
                                 ELSE 17743
                             END
                             WHEN ( tbl_ca.ca_lafd_dev_1 IS NULL
                                    AND NOT ( tbl_ca.ca_lafd_dev_2 IS NULL ) ) THEN CASE
                                 WHEN ( trunc(SYSDATE) > trunc(tbl_ca.ca_lafd_dev_2) ) THEN 17742
                                 ELSE 17743
                             END
                             ELSE 17743
                         END
                     END ) AS ca_status_color,
                     tbl_ca.ca_upd_date,
                     tbl_ca.ca_id,
                     tbl_ca.ca_rec_tag
                 FROM
                     tbl_ca
             ) t2
             INNER JOIN (
                 SELECT
                     sys_tree_struc.tre_dat_tag,
                     sys_nodes_attrib.ps_codes,
                     sys_nodes_attrib.node_id,
                     sys_nodes_attrib.node_desc
                 FROM
                     sys_tree_struc
                     INNER JOIN sys_nodes_attrib ON sys_tree_struc.tre_dat_tag = sys_nodes_attrib.rec_tag
                 WHERE
                     sys_tree_struc.tre_dat_type = 1
                 START WITH
                     sys_tree_struc.tre_dat_tag = 87694
                 CONNECT BY
                     PRIOR sys_tree_struc.tre_nod_tag = sys_tree_struc.tre_nod_tag_par
             ) t1 ON t1.tre_dat_tag = t2.ca_rec_tag
         WHERE
             t1.ps_codes = 'PC006'
     )
 WHERE
     ( ca_status_color = 17743 )
     OR ( ca_status_color = 17742 )
 ORDER BY
     ca_id DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CA_TREE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CA_TREE" ("ASSET_ID", "NODE_ID", "NODE_DESC", "AVAIL_COLOR", "ACTION_COLOR", "ACTION_AVAIL_COLOR") AS 
  SELECT SYS_NODES_ATTRIB.REC_TAG ASSET_ID,
  SYS_NODES_ATTRIB.NODE_ID      NODE_ID,
  SYS_NODES_ATTRIB.NODE_DESC    NODE_DESC, 
  NVL(TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS, 8470)  AVAIL_COLOR,
  NVL(TBL_ANOM_MAIN.AN_CURR_CLASS, 8470) ACTION_COLOR,
  (CASE WHEN TBL_ANOM_MAIN.AN_CURR_CLASS >= TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS THEN 
    TBL_ANOM_MAIN.AN_CURR_CLASS 
  ELSE 
    NVL(TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS,8470)   
  END) ACTION_AVAIL_COLOR 
FROM TBL_ANOM_MAIN
RIGHT JOIN TBL_CA
ON TBL_CA.CA_REC_TAG = TBL_ANOM_MAIN.AN_ASSET_ID
INNER JOIN SYS_NODES_ATTRIB
ON TBL_CA.CA_REC_TAG = SYS_NODES_ATTRIB.REC_TAG WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CHD_HEADER
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CHD_HEADER" ("CHD_HDR_ID", "CHD_HDR_TYPE", "LOCATION", "ASSET_DESC", "CHD_HDR_SAMP_DATE", "CHD_HDR_COMMENTS", "STATUS", "VENDOR", "CHD_HDR_ASSET_ID", "STATUS_ID", "VENDOR_ID", "TRE_DAT_TYPE", "CHD_HDR_INT", "CHD_HDR_TXT1", "CHD_HDR_TXT2", "CHD_HDR_DBL", "CHD_HDR_LAST_UPDATE", "CHD_HDR_LAST_UPDATE_BY", "CHD_HDR_CLASS_OVERRIDE_DATE", "CHD_HDR_CLASS_OVERRIDE_BY", "CHD_HDR_UPDATE_DATE") AS 
  SELECT TBL_CHD_HEADER.CHD_HDR_ID,
  TBL_CHD_HEADER.CHD_HDR_TYPE,
  SYS_NODES_ATTRIB.NODE_DESC AS LOCATION,
  SYS_NODES_ATTRIB.NODE_DESC AS ASSET_DESC,
  TBL_CHD_HEADER.CHD_HDR_SAMP_DATE,
  TBL_CHD_HEADER.CHD_HDR_COMMENTS,
  SYS_LOOKUPS.LKP_DESC_B  AS STATUS,
  SYS_LOOKUPS1.LKP_DESC_B AS VENDOR,
  TBL_CHD_HEADER.CHD_HDR_ASSET_ID,
  SYS_LOOKUPS.LKP_ID  AS STATUS_ID,
  SYS_LOOKUPS1.LKP_ID AS VENDOR_ID,
  SYS_TREE_STRUC.TRE_DAT_TYPE,
  TBL_CHD_HEADER.CHD_HDR_INT,
  TBL_CHD_HEADER.CHD_HDR_TXT1,
  TBL_CHD_HEADER.CHD_HDR_TXT2,
  TBL_CHD_HEADER.CHD_HDR_DBL,
  TBL_CHD_HEADER.CHD_HDR_LAST_UPDATE,
  TBL_CHD_HEADER.CHD_HDR_LAST_UPDATE_BY,
  TBL_CHD_HEADER.CHD_HDR_CLASS_OVERRIDE_DATE,
  TBL_CHD_HEADER.CHD_HDR_CLASS_OVERRIDE_BY,
  TBL_CHD_HEADER.CHD_HDR_UPDATE_DATE
FROM SYS_LOOKUPS
RIGHT JOIN TBL_CHD_HEADER
ON SYS_LOOKUPS.LKP_ID = TBL_CHD_HEADER.CHD_HDR_STATUS
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON SYS_LOOKUPS1.LKP_ID = TBL_CHD_HEADER.CHD_HDR_ANA_VEND
INNER JOIN SYS_NODES_ATTRIB
ON SYS_NODES_ATTRIB.REC_TAG = TBL_CHD_HEADER.CHD_HDR_ASSET_ID
INNER JOIN SYS_TREE_STRUC
ON SYS_NODES_ATTRIB.REC_TAG       = SYS_TREE_STRUC.TRE_DAT_TAG
WHERE SYS_TREE_STRUC.TRE_DAT_TYPE = 1 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CHD_HEADER_ACT_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CHD_HEADER_ACT_COLOR" ("ACTION_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_CLASS ACTION_COLOR, 
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CHD_HEADER_ACTAVL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CHD_HEADER_ACTAVL_COLOR" ("ACTION_AVAIL_COLOR", "ASSET_ID") AS 
  SELECT (
  CASE
    WHEN TBL_ANOM_MAIN.AN_CURR_CLASS >= TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
    THEN TBL_ANOM_MAIN.AN_CURR_CLASS
    ELSE TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
  END) ACTION_AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CHD_HEADER_AVAIL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CHD_HEADER_AVAIL_COLOR" ("AVAIL_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CHD_HEADER_COM_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CHD_HEADER_COM_COLOR" ("COMPLIANCE_COLOR", "ASSET_ID") AS 
  SELECT V_TBL_CA.CA_STATUS_COLOR AS COMPLIANCE_COLOR,
  V_TBL_CA.CA_REC_TAG           AS ASSET_ID
FROM V_TBL_CA WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_CHEM_GATE_VALUES
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_CHEM_GATE_VALUES" ("CGV_ID", "CGV_FDD_ID", "NODE_DESC", "CGV_TYPE_LNG_A", "CGV_TYPE_STR_A", "CGV_TYPE_LNG_B", "CGV_TYPE_STR_B", "CGV_ORA", "CGV_ORA_E2", "CGV_RED_OPTR", "CGV_RED", "CGV_RED_E2", "CGV_UPDATE_DATE", "CGV_IS_GENERAL") AS 
  SELECT TBL_CHEM_GATE_VALUES.CGV_ID,
  TBL_CHEM_GATE_VALUES.CGV_FDD_ID,
  SYS_NODES_ATTRIB.NODE_DESC,
  TBL_CHEM_GATE_VALUES.CGV_TYPE_LNG_A,
  TBL_CHEM_GATE_VALUES.CGV_TYPE_STR_A,
  TBL_CHEM_GATE_VALUES.CGV_TYPE_LNG_B,
  TBL_CHEM_GATE_VALUES.CGV_TYPE_STR_B,
  TBL_CHEM_GATE_VALUES.CGV_ORA,
  TBL_CHEM_GATE_VALUES.CGV_ORA_E2,
  TBL_CHEM_GATE_VALUES.CGV_RED_OPTR,
  TBL_CHEM_GATE_VALUES.CGV_RED,
  TBL_CHEM_GATE_VALUES.CGV_RED_E2,
  TBL_CHEM_GATE_VALUES.CGV_UPDATE_DATE,
  TBL_CHEM_GATE_VALUES.CGV_IS_GENERAL
FROM SYS_NODES_ATTRIB
RIGHT JOIN TBL_CHEM_GATE_VALUES
ON TBL_CHEM_GATE_VALUES.CGV_NODE_ID = SYS_NODES_ATTRIB.REC_TAG WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_DESIGN_DATA_ACT_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_DESIGN_DATA_ACT_COLOR" ("ACTION_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_CLASS ACTION_COLOR, 
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_DESIGN_DATA_ACTAVL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_DESIGN_DATA_ACTAVL_COLOR" ("ACTION_AVAIL_COLOR", "ASSET_ID") AS 
  SELECT (
  CASE
    WHEN TBL_ANOM_MAIN.AN_CURR_CLASS >= TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
    THEN TBL_ANOM_MAIN.AN_CURR_CLASS
    ELSE TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
  END) ACTION_AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_DESIGN_DATA_AVAIL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_DESIGN_DATA_AVAIL_COLOR" ("AVAIL_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_DESIGN_DATA_COM_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_DESIGN_DATA_COM_COLOR" ("COMPLIANCE_COLOR", "ASSET_ID") AS 
  SELECT V_TBL_CA.CA_STATUS_COLOR AS COMPLIANCE_COLOR,
  V_TBL_CA.CA_REC_TAG           AS ASSET_ID
FROM V_TBL_CA WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_DESIGN_DATA_HIST
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_DESIGN_DATA_HIST" ("DD_HIST_ID", "DD_HIST_ASSET_ID", "DD_HIST_DATE", "DD_HIST_ASSET_FR", "DD_HIST_ASSET_TO", "DD_HIST_DESC", "DD_HIST_LOG_TYPE", "HIST_ASSET_SYS", "HIST_ASSET_FR_SYS", "HIST_ASSET_TO_SYS", "HIST_LOG_TYPE_SYS", "DD_HIST_USERNAME") AS 
  SELECT DD_HIST.DD_HIST_ID,
  DD_HIST.DD_HIST_ASSET_ID,
  DD_HIST.DD_HIST_DATE,
  DD_HIST.DD_HIST_ASSET_FR,
  DD_HIST.DD_HIST_ASSET_TO,
  DD_HIST.DD_HIST_DESC,
  DD_HIST.DD_HIST_LOG_TYPE,
  NA.NODE_ID || '-' 
  || NA.NODE_DESC AS HIST_ASSET_SYS,
  NA1.NODE_ID || '-' 
  || NA1.NODE_DESC AS HIST_ASSET_FR_SYS,
  NA2.NODE_ID
  || NA2.NODE_DESC       AS HIST_ASSET_TO_SYS,
  SYS_LOOKUPS.LKP_DESC_B AS HIST_LOG_TYPE_SYS,
  DD_HIST_USERNAME
FROM TBL_DESIGN_DATA_HISTORY DD_HIST
INNER JOIN SYS_NODES_ATTRIB NA
ON DD_HIST.DD_HIST_ASSET_ID = NA.REC_TAG
INNER JOIN SYS_LOOKUPS
ON DD_HIST.DD_HIST_LOG_TYPE = SYS_LOOKUPS.LKP_ID
INNER JOIN SYS_NODES_ATTRIB NA1
ON DD_HIST.DD_HIST_ASSET_FR = NA1.REC_TAG
INNER JOIN SYS_NODES_ATTRIB NA2
ON DD_HIST.DD_HIST_ASSET_TO = NA2.REC_TAG WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_DESIGN_DATA_KP
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_DESIGN_DATA_KP" ("DD_KP_PARAM_ID", "DD_PARAM_ID", "DD_KP_START", "DD_KP_END", "DD_KP_PARAM_VALUE", "DD_KP_PARAM_UNIT", "DD_KP_PARAM_UNIT_SYS") AS 
  SELECT DD_KP.DD_KP_PARAM_ID,
  DD_KP.DD_PARAM_ID,
  DD_KP.DD_KP_START,
  DD_KP.DD_KP_END,
  DD_KP.DD_KP_PARAM_VALUE,
  DD_KP.DD_KP_PARAM_UNIT,
  LKP.LKP_DESC_B AS DD_KP_PARAM_UNIT_SYS
FROM TBL_DESIGN_DATA_KP DD_KP
LEFT JOIN SYS_LOOKUPS LKP
ON DD_KP.DD_KP_PARAM_UNIT = LKP.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_DESIGN_DATA_MAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_DESIGN_DATA_MAIN" ("DD_ID", "DD_ASSET", "DD_PARAM", "DD_PARAM_VALUE", "DD_PARAM_UNIT", "DD_PARAM_NOTES", "DD_PARAM_REF", "DD_UPDATE_DATE", "DD_ASSET_SYS", "DD_PARAM_TYPE_SYS", "DD_PARAM_UNIT_SYS", "DD_PARAM_NAME", "DD_PARAM_TYPE") AS 
  SELECT 
  DD.DD_ID, 
  DD.DD_ASSET, 
  DD.DD_PARAM, 
  DD.DD_PARAM_VALUE, 
  DD.DD_PARAM_UNIT, 
  DD.DD_PARAM_NOTES, 
  DD.DD_PARAM_REF, 
  DD.DD_UPDATE_DATE, 
  NA.NODE_ID || ' - ' || NA.NODE_DESC AS DD_ASSET_SYS, 
  LKP.LKP_DESC_B AS DD_PARAM_TYPE_SYS, 
  LKP1.LKP_DESC_B AS DD_PARAM_UNIT_SYS, 
  DD_PRM.DD_PARAM_NAME, 
  DD_PRM.DD_PARAM_TYPE
FROM 
  (((TBL_DESIGN_DATA_MAIN DD INNER JOIN SYS_NODES_ATTRIB NA 
  ON DD.DD_ASSET = NA.REC_TAG) 
  LEFT JOIN SYS_LOOKUPS LKP1 
  ON DD.DD_PARAM_UNIT = LKP1.LKP_ID) 
  INNER JOIN TBL_DESIGN_DATA_PARAMS DD_PRM 
  ON DD.DD_PARAM = DD_PRM.DD_PARAM) 
  INNER JOIN SYS_LOOKUPS LKP 
  ON DD_PRM.DD_PARAM_TYPE = LKP.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_CB
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_CB" ("RBI_CB_ID", "RBI_CB_NAME") AS 
  SELECT TBL_RBI_CB.RBI_CB_ID,
  TBL_RBI_CB.RBI_CB_NAME
FROM TBL_RBI_CB;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_CBPOF
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_CBPOF" ("RBI_CB_POF_ID", "RBI_CB_POF_POF_ID", "RBI_POF_NODE_ID", "RBI_POF_NODE_DESC", "RBI_POF_FT_ID", "RBI_POF_FT_NAME", "RBI_CB_POF_CB_ID", "RBI_CB_NAME", "RBI_CB_POF_LAST_CONFIRMED", "RBI_CB_POF_CONFIRMED_BY", "RBI_CB_POF_NOTES", "RBI_CB_POF_PLACED", "RBI_CB_POF_CONFIRMED", "RBI_CB_POF_CONFIRMED_SYS_1", "RBI_CB_POF_CONFIRMED_SYS_2", "RBI_CB_POF_CONFIRMED_SYS_3") AS 
  SELECT TBL_RBI_CB_POF.RBI_CB_POF_ID,
  TBL_RBI_CB_POF.RBI_CB_POF_POF_ID,
  TBL_RBI_POF.RBI_POF_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS RBI_POF_NODE_DESC,
  TBL_RBI_POF.RBI_POF_FT_ID,
  (TBL_ANOM_FT.FT_CODE
  || ' - '
  || TBL_ANOM_FT.FT_NAME) AS RBI_POF_FT_NAME,
  TBL_RBI_CB_POF.RBI_CB_POF_CB_ID,
  TBL_RBI_CB.RBI_CB_NAME,
  TBL_RBI_CB_POF.RBI_CB_POF_LAST_CONFIRMED,
  TBL_RBI_CB_POF.RBI_CB_POF_CONFIRMED_BY,
  TBL_RBI_CB_POF.RBI_CB_POF_NOTES,
  TBL_RBI_CB_POF.RBI_CB_POF_PLACED,
  TBL_RBI_CB_POF.RBI_CB_POF_CONFIRMED,
  SYS_LOOKUPS.LKP_DESC_A AS RBI_CB_POF_CONFIRMED_SYS_1,
  SYS_LOOKUPS.LKP_DESC_B AS RBI_CB_POF_CONFIRMED_SYS_2,
  (SYS_LOOKUPS.LKP_DESC_A
  || '-'
  || SYS_LOOKUPS.LKP_DESC_B) AS RBI_CB_POF_CONFIRMED_SYS_3
FROM SYS_NODES_ATTRIB
INNER JOIN TBL_RBI_POF
ON TBL_RBI_POF.RBI_POF_NODE_ID = SYS_NODES_ATTRIB.REC_TAG
INNER JOIN TBL_RBI_CB_POF
ON TBL_RBI_CB_POF.RBI_CB_POF_POF_ID = TBL_RBI_POF.RBI_POF_ID
INNER JOIN TBL_RBI_CB
ON TBL_RBI_CB_POF.RBI_CB_POF_CB_ID = TBL_RBI_CB.RBI_CB_ID
INNER JOIN TBL_ANOM_FT
ON TBL_RBI_POF.RBI_POF_FT_ID = TBL_ANOM_FT.FT_ID
LEFT JOIN SYS_LOOKUPS
ON TBL_RBI_CB_POF.RBI_CB_POF_CONFIRMED = SYS_LOOKUPS.LKP_ID
ORDER BY RBI_POF_NODE_DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_COF
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_COF" ("RBI_COF_ID", "RBI_COF_NODE_ID", "RBI_COF_NODE_DESC", "RBI_COF_SCE", "RBI_COF_CE", "RBI_COF_SGS", "RBI_COF_HEALTH", "RBI_COF_HEALTH_SYS", "RBI_COF_SAFETY", "RBI_COF_SAFETY_SYS", "RBI_COF_ENV", "RBI_COF_ENV_SYS", "RBI_COF_ASSETS", "RBI_COF_ASSETS_SYS", "RBI_COF_REP", "RBI_COF_REP_SYS", "RBI_COF_OVERALL", "RBI_COF_COF_NOTES", "RBI_COF_UPDATE_DATE", "RBI_COF_NODE_HAZ_REF", "RBI_COF_UPDATE_BY") AS 
  SELECT TBL_RBI_COF.RBI_COF_ID,
  TBL_RBI_COF.RBI_COF_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS RBI_COF_NODE_DESC,
  SYS_NODES_ATTRIB.SCE AS RBI_COF_SCE,
  SYS_NODES_ATTRIB.CE AS RBI_COF_CE,
  SYS_NODES_ATTRIB.SGS AS RBI_COF_SGS,
  TBL_RBI_COF.RBI_COF_HEALTH,
  SYS_LOOKUPS.LKP_DESC_A AS RBI_COF_HEALTH_SYS,
  TBL_RBI_COF.RBI_COF_SAFETY,
  SYS_LOOKUPS1.LKP_DESC_A AS RBI_COF_SAFETY_SYS,
  TBL_RBI_COF.RBI_COF_ENV,
  SYS_LOOKUPS2.LKP_DESC_A AS RBI_COF_ENV_SYS,
  TBL_RBI_COF.RBI_COF_ASSETS,
  SYS_LOOKUPS3.LKP_DESC_A AS RBI_COF_ASSETS_SYS,
  TBL_RBI_COF.RBI_COF_REP,
  SYS_LOOKUPS4.LKP_DESC_A AS RBI_COF_REP_SYS,
  TBL_RBI_COF.RBI_COF_OVERALL,
  TBL_RBI_COF.RBI_COF_COF_NOTES,
  TBL_RBI_COF.RBI_COF_UPDATE_DATE,
  TBL_RBI_COF.RBI_COF_NODE_HAZ_REF,
  TBL_RBI_COF.RBI_COF_UPDATE_BY
FROM TBL_RBI_COF
INNER JOIN SYS_NODES_ATTRIB
ON SYS_NODES_ATTRIB.REC_TAG = TBL_RBI_COF.RBI_COF_NODE_ID
LEFT JOIN SYS_LOOKUPS
ON TBL_RBI_COF.RBI_COF_HEALTH = SYS_LOOKUPS.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON TBL_RBI_COF.RBI_COF_SAFETY = SYS_LOOKUPS1.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS2
ON TBL_RBI_COF.RBI_COF_ENV = SYS_LOOKUPS2.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS3
ON TBL_RBI_COF.RBI_COF_ASSETS = SYS_LOOKUPS3.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS4
ON TBL_RBI_COF.RBI_COF_REP = SYS_LOOKUPS4.LKP_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_COF_ACT_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_COF_ACT_COLOR" ("ACTION_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_CLASS ACTION_COLOR, 
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_COF_ACTAVL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_COF_ACTAVL_COLOR" ("ACTION_AVAIL_COLOR", "ASSET_ID") AS 
  SELECT (
  CASE
    WHEN TBL_ANOM_MAIN.AN_CURR_CLASS >= TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
    THEN TBL_ANOM_MAIN.AN_CURR_CLASS
    ELSE TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
  END) ACTION_AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_COF_AVAIL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_COF_AVAIL_COLOR" ("AVAIL_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_COF_COM_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_COF_COM_COLOR" ("COMPLIANCE_COLOR", "ASSET_ID") AS 
  SELECT V_TBL_CA.CA_STATUS_COLOR AS COMPLIANCE_COLOR,
  V_TBL_CA.CA_REC_TAG           AS ASSET_ID
FROM V_TBL_CA WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_COMMON
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_COMMON" ("RBI_MIT_POF_ID", "ASSETID", "RBI_MIT_POF_MIT_ID", "RBI_POF_FT_ID", "RBI_MIT_POF_FRT_ID", "RBI_MIT_POF_TBI", "RBFF", "ARLYRS", "RBI_POF_MTBF", "ARL_OR_MTBF", "LASTRECORD", "SCE") AS 
  SELECT TBL_RBI_MIT_POF.RBI_MIT_POF_ID,
  ASSET.REC_TAG AS ASSETID,
  TBL_RBI_MIT_POF.RBI_MIT_POF_MIT_ID,
  V_TBL_RBI_POF.RBI_POF_FT_ID,
  TBL_RBI_MIT_POF.RBI_MIT_POF_FRT_ID,
  TBL_RBI_MIT_POF.RBI_MIT_POF_TBI,
  TBL_RBI_RBFF.RBFF               AS RBFF,
  V_TBL_RBI_POF.RBI_POF_ARL_YEARS AS ARLYRS,
  V_TBL_RBI_POF.RBI_POF_MTBF,
  ROUND(
  CASE
    WHEN TBL_RBI_MIT_POF.RBI_MIT_POF_FRT_ID = 14031
    THEN NVL(TBL_RBI_MIT_POF.RBI_MIT_POF_TBI, 0) / 12
    WHEN TBL_RBI_MIT_POF.RBI_MIT_POF_FRT_ID = 14030
    THEN
      CASE
        WHEN TBL_RBI_RBFF.RBFF = 'N/R'
        THEN -1
        WHEN TBL_RBI_RBFF.RBFF = '**'
        THEN -2
        WHEN TBL_RBI_RBFF.RBFF = '*'
        THEN 1
        ELSE TBL_RBI_RBFF.RBFF * (
          CASE
            WHEN V_TBL_RBI_POF.RBI_POF_ARL_YEARS > V_TBL_RBI_POF.RBI_POF_MTBF
            THEN V_TBL_RBI_POF.RBI_POF_ARL_YEARS
            ELSE V_TBL_RBI_POF.RBI_POF_MTBF
          END)
      END
    ELSE NULL
  END, 3) AS ARL_OR_MTBF,
  CASE
    WHEN TBL_RBI_MIT_POF.RBI_MIT_POF_L_INS IS NULL
    THEN '1/1/1111'
    ELSE TO_CHAR(TBL_RBI_MIT_POF.RBI_MIT_POF_L_INS)
  END                     AS LASTRECORD,
  TBL_RBI_COF.RBI_COF_SCE AS SCE
FROM (((V_TBL_RBI_POF
INNER JOIN SYS_NODES_ATTRIB ASSET
ON V_TBL_RBI_POF.RBI_POF_NODE_ID = ASSET.REC_TAG)
INNER JOIN TBL_RBI_MIT_POF
ON V_TBL_RBI_POF.RBI_POF_ID = TBL_RBI_MIT_POF.RBI_MIT_POF_POF_ID)
INNER JOIN TBL_RBI_RBFF
ON V_TBL_RBI_POF.RBI_POF_CONF_STATUS = TBL_RBI_RBFF.RBFF_CONF_STATUS)
INNER JOIN TBL_RBI_COF
ON ASSET.REC_TAG                = TBL_RBI_COF.RBI_COF_NODE_ID
AND TBL_RBI_COF.RBI_COF_OVERALL = TBL_RBI_RBFF.RBFF_COF_OVERALL
WHERE (ASSET.NODE_CLASS         = 1
AND ASSET.RBI_INCLUDE           = 1)
OR (ASSET.RBI_INCLUDE           = -1) WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_CONF
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_CONF" ("RBI_POF_ID", "RBI_POF_NODE_ID", "RBI_POF_NODE_DESC", "RBI_POF_FT_ID", "RBI_POF_FT_NAME", "RBI_POF_CONF_COMMENT", "RBI_POF_CONF_STATUS", "RBI_POF_CONF_STATUS_SYS", "RBI_POF_CONF_BY", "RBI_POF_CONF_DATE", "RBI_POF_CONF_PREV_INS", "RBI_MIT_POF_L_INS_CONF", "RBI_MIT_POF_POF_ID") AS 
  SELECT TBL_RBI_POF.RBI_POF_ID,
  TBL_RBI_POF.RBI_POF_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS RBI_POF_NODE_DESC,
  TBL_RBI_POF.RBI_POF_FT_ID,
  (TBL_ANOM_FT.FT_CODE
  || ' - '
  || TBL_ANOM_FT.FT_NAME) AS RBI_POF_FT_NAME,
  TBL_RBI_POF.RBI_POF_CONF_COMMENT,
  TBL_RBI_POF.RBI_POF_CONF_STATUS,
  SYS_LOOKUPS8.LKP_DESC_B AS RBI_POF_CONF_STATUS_SYS,
  TBL_RBI_POF.RBI_POF_CONF_BY,
  TBL_RBI_POF.RBI_POF_CONF_DATE,
  TBL_RBI_POF.RBI_POF_CONF_PREV_INS,
  MAX(TBL_RBI_MIT_POF.RBI_MIT_POF_L_INS) AS RBI_MIT_POF_L_INS_CONF,
  TBL_RBI_MIT_POF.RBI_MIT_POF_POF_ID
FROM TBL_RBI_POF
INNER JOIN SYS_NODES_ATTRIB
ON SYS_NODES_ATTRIB.REC_TAG = TBL_RBI_POF.RBI_POF_NODE_ID
INNER JOIN TBL_ANOM_FT
ON TBL_RBI_POF.RBI_POF_FT_ID = TBL_ANOM_FT.FT_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS8
ON TBL_RBI_POF.RBI_POF_CONF_STATUS = SYS_LOOKUPS8.LKP_ID
INNER JOIN TBL_RBI_MIT_POF
ON TBL_RBI_MIT_POF.RBI_MIT_POF_POF_ID = TBL_RBI_POF.RBI_POF_ID
GROUP BY TBL_RBI_POF.RBI_POF_ID,
  TBL_RBI_POF.RBI_POF_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC),
  TBL_RBI_POF.RBI_POF_FT_ID,
  (TBL_ANOM_FT.FT_CODE
  || ' - '
  || TBL_ANOM_FT.FT_NAME),
  TBL_RBI_POF.RBI_POF_CONF_COMMENT,
  TBL_RBI_POF.RBI_POF_CONF_STATUS,
  SYS_LOOKUPS8.LKP_DESC_B,
  TBL_RBI_POF.RBI_POF_CONF_BY,
  TBL_RBI_POF.RBI_POF_CONF_DATE,
  TBL_RBI_POF.RBI_POF_CONF_PREV_INS,
  TBL_RBI_MIT_POF.RBI_MIT_POF_POF_ID
ORDER BY RBI_POF_NODE_DESC,
  RBI_POF_FT_NAME WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_MIT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_MIT" ("RBI_MIT_ID", "RBI_MIT_CODE", "RBI_MIT_DESC", "RBI_MIT_TYPE_ID", "RBI_MIT_TYPE_CODE", "RBI_MIT_TYPE_NAME") AS 
  SELECT TBL_RBI_MIT.RBI_MIT_ID,
  TBL_RBI_MIT.RBI_MIT_CODE,
  TBL_RBI_MIT.RBI_MIT_DESC,
  SYS_LOOKUPS.LKP_ID     AS RBI_MIT_TYPE_ID,
  SYS_LOOKUPS.LKP_DESC_A AS RBI_MIT_TYPE_CODE,
  SYS_LOOKUPS.LKP_DESC_B AS RBI_MIT_TYPE_NAME
FROM TBL_RBI_MIT
LEFT JOIN SYS_LOOKUPS
ON TBL_RBI_MIT.RBI_MIT_TYPE_ID = SYS_LOOKUPS.LKP_ID;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_MITPOF
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_MITPOF" ("RBI_POF_NODE_ID", "RBI_POF_NODE_DESC", "RBI_POF_FT_ID", "RBI_POF_FT_NAME", "RBI_MIT_POF_ID", "RBI_MIT_POF_POF_ID", "RBI_MIT_POF_FRT_ID", "RBI_MIT_POF_FRT_ID_SYS", "RBI_MIT_POF_TBI", "RBI_MIT_POF_E_INS", "RBI_MIT_POF_L_INS", "RBI_MIT_POF_MIT_ID", "RBI_MIT_CODE", "RBI_MIT_DESC", "RBI_MIT_DESC_SYS", "RBI_MIT_TYPE_ID", "RBI_MIT_TYPE_ID_SYS", "RBI_MIT_POF_DUE_DATE", "RBI_MIT_POF_UPD_DATE", "RBI_MIT_POF_UPD_BY") AS 
  SELECT TBL_RBI_POF.RBI_POF_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS RBI_POF_NODE_DESC,
  TBL_RBI_POF.RBI_POF_FT_ID,
  (TBL_ANOM_FT.FT_CODE
  || ' - '
  || TBL_ANOM_FT.FT_NAME) AS RBI_POF_FT_NAME,
  TBL_RBI_MIT_POF.RBI_MIT_POF_ID,
  TBL_RBI_MIT_POF.RBI_MIT_POF_POF_ID,
  TBL_RBI_MIT_POF.RBI_MIT_POF_FRT_ID,
  SYS_LOOKUPS.LKP_DESC_B AS RBI_MIT_POF_FRT_ID_SYS,
  TBL_RBI_MIT_POF.RBI_MIT_POF_TBI,
  TBL_RBI_MIT_POF.RBI_MIT_POF_E_INS,
  TBL_RBI_MIT_POF.RBI_MIT_POF_L_INS,
  TBL_RBI_MIT_POF.RBI_MIT_POF_MIT_ID,
  TBL_RBI_MIT.RBI_MIT_CODE,
  TBL_RBI_MIT.RBI_MIT_DESC,
  (TBL_RBI_MIT.RBI_MIT_CODE
  || '-'
  || TBL_RBI_MIT.RBI_MIT_DESC) AS RBI_MIT_DESC_SYS,
  TBL_RBI_MIT.RBI_MIT_TYPE_ID,
  SYS_LOOKUPS1.LKP_DESC_B AS RBI_MIT_TYPE_ID_SYS,
  CASE
    WHEN V_TBL_RBI_COMMON.ARL_OR_MTBF = -1
    THEN 'N/A'
    ELSE
      CASE
        WHEN V_TBL_RBI_COMMON.RBI_MIT_POF_FRT_ID = 14033
        THEN 'CONTINUOUS'
        WHEN V_TBL_RBI_COMMON.RBI_MIT_POF_FRT_ID = 14032
        THEN 'AD HOC'
        ELSE
          CASE
            WHEN V_TBL_RBI_COMMON.LASTRECORD = '1/1/1111'
            OR V_TBL_RBI_COMMON.ARL_OR_MTBF  = -2 OR V_TBL_RBI_COMMON.RBFF = '**'
            THEN 'IMMEDIATE ACTION'
            ELSE TO_CHAR(TO_DATE(V_TBL_RBI_COMMON.LASTRECORD) + (365 * V_TBL_RBI_COMMON.ARL_OR_MTBF))
          END
      END
  END RBI_MIT_POF_DUE_DATE,
  TBL_RBI_MIT_POF.RBI_MIT_POF_UPD_DATE,
  TBL_RBI_MIT_POF.RBI_MIT_POF_UPD_BY
FROM SYS_NODES_ATTRIB
INNER JOIN TBL_RBI_POF
ON TBL_RBI_POF.RBI_POF_NODE_ID = SYS_NODES_ATTRIB.REC_TAG
INNER JOIN TBL_ANOM_FT
ON TBL_RBI_POF.RBI_POF_FT_ID = TBL_ANOM_FT.FT_ID
INNER JOIN TBL_RBI_MIT_POF
ON TBL_RBI_MIT_POF.RBI_MIT_POF_POF_ID = TBL_RBI_POF.RBI_POF_ID
INNER JOIN TBL_RBI_MIT
ON TBL_RBI_MIT_POF.RBI_MIT_POF_MIT_ID = TBL_RBI_MIT.RBI_MIT_ID
LEFT JOIN SYS_LOOKUPS
ON TBL_RBI_MIT_POF.RBI_MIT_POF_FRT_ID = SYS_LOOKUPS.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON TBL_RBI_MIT.RBI_MIT_TYPE_ID = SYS_LOOKUPS1.LKP_ID
LEFT JOIN V_TBL_RBI_COMMON
ON TBL_RBI_MIT_POF.RBI_MIT_POF_ID = V_TBL_RBI_COMMON.RBI_MIT_POF_ID
ORDER BY RBI_POF_NODE_DESC WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_POF
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_POF" ("RBI_POF_ID", "RBI_POF_MTBF", "RBI_POF_OPR_YRS", "RBI_POF_DATE_INSTALLED", "RBI_POF_NODE_ID", "RBI_POF_NODE_DESC", "RBI_POF_FT_ID", "RBI_POF_FT_NAME", "FT_TYPE", "RBI_POF_IPOF", "RBI_POF_IPOF_SYS_1", "RBI_POF_IPOF_SYS_2", "RBI_POF_IPOF_SYS_3", "RBI_POF_IPOF_HEALTH", "RBI_POF_IPOF_HEALTH_SYS_1", "RBI_POF_IPOF_HEALTH_SYS_2", "RBI_POF_IPOF_HEALTH_SYS_3", "RBI_POF_IPOF_SAFETY", "RBI_POF_IPOF_SAFETY_SYS_1", "RBI_POF_IPOF_SAFETY_SYS_2", "RBI_POF_IPOF_SAFETY_SYS_3", "RBI_POF_IPOF_ENV", "RBI_POF_IPOF_ENV_SYS_1", "RBI_POF_IPOF_ENV_SYS_2", "RBI_POF_IPOF_ENV_SYS_3", "RBI_POF_IPOF_ASSET", "RBI_POF_IPOF_ASSET_SYS_1", "RBI_POF_IPOF_ASSET_SYS_2", "RBI_POF_IPOF_ASSET_SYS_3", "RBI_POF_IPOF_REP", "RBI_POF_IPOF_REP_SYS_1", "RBI_POF_IPOF_REP_SYS_2", "RBI_POF_IPOF_REP_SYS_3", "RBI_POF_NPOF", "RBI_POF_NPOF_SYS_1", "RBI_POF_NPOF_SYS_2", "RBI_POF_NPOF_SYS_3", "RBI_POF_NPOF_A", "RBI_POF_NPOF_B", "RBI_POF_NPOF_C", "RBI_POF_NPOF_D", "RBI_POF_NPOF_E", "RBI_POF_GUIDE", "RBI_POF_MIN_POF", "RBI_POF_CONF_COMMENT", "RBI_POF_CONF_STATUS", "RBI_POF_CONF_STATUS_SYS", "RBI_POF_CONF_BY", "RBI_POF_CONF_DATE", "RBI_POF_UPDATE_DATE", "RBI_POF_POF_NOTES", "RBI_POF_ASS_BY", "RBI_POF_ASS_DATE", "RBI_POF_CONF_PREV_INS", "RBI_POF_AN_CNT", "RBI_POF_ARL_YEARS") AS 
  SELECT V_TBL_RBI_POF_SUB_2.RBI_POF_ID,
 ROUND(
  CASE
    WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_DATE_INSTALLED IS NULL
    THEN
      CASE
        WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14000
        THEN (
          CASE
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 16
            THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
            ELSE 16
          END)
        WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14001
        THEN (
          CASE
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 8
            THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
            ELSE 8
          END)
        WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14002
        THEN (
          CASE
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 4
            THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
            ELSE 4
          END)
        WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14003
        THEN (
          CASE
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 2
            THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
            ELSE 2
          END)
        WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14004
        THEN (
          CASE
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 1
            THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
            ELSE 1
          END)
      END
    ELSE
      CASE
        WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_AN_CNT IS NOT NULL
        THEN
          CASE
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_AN_CNT > 0
            THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS / (NVL(V_TBL_RBI_POF_SUB_2.RBI_POF_AN_CNT, 0) + 1)
            ELSE
              CASE
                WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14000
                THEN (
                  CASE
                    WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 16
                    THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
                    ELSE 16
                  END)
                WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14001
                THEN (
                  CASE
                    WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 8
                    THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
                    ELSE 8
                  END)
                WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14002
                THEN (
                  CASE
                    WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 4
                    THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
                    ELSE 4
                  END)
                WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14003
                THEN (
                  CASE
                    WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 2
                    THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
                    ELSE 2
                  END)
                WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14004
                THEN (
                  CASE
                    WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 1
                    THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
                    ELSE 1
                  END)
              END
          END
        ELSE
          CASE
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14000
            THEN 16
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14001
            THEN 8
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14002
            THEN 4
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14003
            THEN 2
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14004
            THEN 1
            ELSE 99
          END
      END
  END, 2) RBI_POF_MTBF,
  V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS,
  V_TBL_RBI_POF_SUB_2.RBI_POF_DATE_INSTALLED,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NODE_ID,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NODE_DESC,
  V_TBL_RBI_POF_SUB_2.RBI_POF_FT_ID,
  V_TBL_RBI_POF_SUB_2.RBI_POF_FT_NAME,
  V_TBL_RBI_POF_SUB_2.FT_TYPE,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_HEALTH,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_HEALTH_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_HEALTH_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_HEALTH_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SAFETY,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SAFETY_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SAFETY_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SAFETY_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ENV,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ENV_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ENV_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ENV_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ASSET,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ASSET_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ASSET_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ASSET_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_REP,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_REP_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_REP_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_REP_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_A,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_B,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_C,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_D,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_E,
  V_TBL_RBI_POF_SUB_2.RBI_POF_GUIDE,
  V_TBL_RBI_POF_SUB_2.RBI_POF_MIN_POF,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_COMMENT,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_STATUS,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_STATUS_SYS,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_BY,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_DATE,
  V_TBL_RBI_POF_SUB_2.RBI_POF_UPDATE_DATE,
  V_TBL_RBI_POF_SUB_2.RBI_POF_POF_NOTES,
  V_TBL_RBI_POF_SUB_2.RBI_POF_ASS_BY,
  V_TBL_RBI_POF_SUB_2.RBI_POF_ASS_DATE,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_PREV_INS,
  CASE WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_AN_CNT IS NULL THEN 'UNKNOWN' ELSE  TO_CHAR(V_TBL_RBI_POF_SUB_2.RBI_POF_AN_CNT) END RBI_POF_AN_CNT,
  NVL(V_TBL_RBI_POF_SUB_2.RBI_POF_ARL_YEARS, '') RBI_POF_ARL_YEARS 
FROM V_TBL_RBI_POF_SUB_2 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_POF_AN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_POF_AN" ("RBI_POF_ID", "AN_ID", "AN_REF", "AN_RAISED_BY", "AN_RAISED_DATE", "AN_STATUS_SYS", "AN_TITLE") AS 
  SELECT TBL_RBI_POF.RBI_POF_ID,
  T1.AN_ID,
  T1.AN_REF,
  T1.AN_RAISED_BY,
  T1.AN_RAISED_DATE,
  T1.AN_STATUS_SYS,
  T1.AN_TITLE
FROM
  (SELECT V_TBL_ANOM_MAIN.AN_ASSET_ID,
    V_TBL_ANOM_MAIN.AN_STATUS,
    LNK_AN_FT.LNK_TAG_A AS FT_ID,
    V_TBL_ANOM_MAIN.AN_REF,
    V_TBL_ANOM_MAIN.AN_TYPE,
    V_TBL_ANOM_MAIN.AN_RAISED_BY,
    V_TBL_ANOM_MAIN.AN_RAISED_DATE,
    V_TBL_ANOM_MAIN.AN_STATUS_SYS,
    V_TBL_ANOM_MAIN.AN_ID,
    V_TBL_ANOM_MAIN.ANTYPE_NAME,
    V_TBL_ANOM_MAIN.AN_TITLE
  FROM V_TBL_ANOM_MAIN
  INNER JOIN LNK_AN_FT
  ON V_TBL_ANOM_MAIN.AN_ID = LNK_AN_FT.LNK_TAG_B
  ) T1
INNER JOIN TBL_RBI_POF
ON TBL_RBI_POF.RBI_POF_NODE_ID = T1.AN_ASSET_ID
AND TBL_RBI_POF.RBI_POF_FT_ID  = T1.FT_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_POF_OLD
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_POF_OLD" ("RBI_POF_ID", "RBI_POF_HIS_AN", "RBI_POF_FAIL_DATA", "RBI_POF_MTBF", "RBI_POF_OPR_YRS", "RBI_POF_YR_INSTALLED", "RBI_POF_NODE_ID", "RBI_POF_NODE_DESC", "RBI_POF_FT_ID", "RBI_POF_FT_NAME", "FT_TYPE", "RBI_POF_IPOF", "RBI_POF_IPOF_SYS_1", "RBI_POF_IPOF_SYS_2", "RBI_POF_IPOF_SYS_3", "RBI_POF_IPOF_HEALTH", "RBI_POF_IPOF_HEALTH_SYS_1", "RBI_POF_IPOF_HEALTH_SYS_2", "RBI_POF_IPOF_HEALTH_SYS_3", "RBI_POF_IPOF_SAFETY", "RBI_POF_IPOF_SAFETY_SYS_1", "RBI_POF_IPOF_SAFETY_SYS_2", "RBI_POF_IPOF_SAFETY_SYS_3", "RBI_POF_IPOF_ENV", "RBI_POF_IPOF_ENV_SYS_1", "RBI_POF_IPOF_ENV_SYS_2", "RBI_POF_IPOF_ENV_SYS_3", "RBI_POF_IPOF_ASSET", "RBI_POF_IPOF_ASSET_SYS_1", "RBI_POF_IPOF_ASSET_SYS_2", "RBI_POF_IPOF_ASSET_SYS_3", "RBI_POF_IPOF_REP", "RBI_POF_IPOF_REP_SYS_1", "RBI_POF_IPOF_REP_SYS_2", "RBI_POF_IPOF_REP_SYS_3", "RBI_POF_NPOF", "RBI_POF_NPOF_SYS_1", "RBI_POF_NPOF_SYS_2", "RBI_POF_NPOF_SYS_3", "RBI_POF_NPOF_A", "RBI_POF_NPOF_B", "RBI_POF_NPOF_C", "RBI_POF_NPOF_D", "RBI_POF_NPOF_E", "RBI_POF_GUIDE", "RBI_POF_MIN_POF", "RBI_POF_CONF_COMMENT", "RBI_POF_CONF_STATUS", "RBI_POF_CONF_STATUS_SYS", "RBI_POF_CONF_BY", "RBI_POF_CONF_DATE", "RBI_POF_UPDATE_DATE", "RBI_POF_POF_NOTES", "RBI_POF_ASS_BY", "RBI_POF_ASS_DATE", "RBI_POF_CONF_PREV_INS", "RBI_POF_AN_CNT", "RBI_POF_ARL_YEARS") AS 
  SELECT V_TBL_RBI_POF_SUB_2.RBI_POF_ID,
  (
  CASE
    WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_AN_CNT > 0
    THEN
      CASE
        WHEN (SELECT COUNT(V_TBL_RBI_POF_SUB_1.AN_ID)
          FROM V_TBL_RBI_POF_SUB_1
          WHERE V_TBL_RBI_POF_SUB_1.AN_ASSET_ID = V_TBL_RBI_POF_SUB_2.RBI_POF_NODE_ID
          AND V_TBL_RBI_POF_SUB_1.AN_FT_ID      = V_TBL_RBI_POF_SUB_2.RBI_POF_FT_ID
          AND (V_TBL_RBI_POF_SUB_1.AN_STATUS    = 8450
          OR V_TBL_RBI_POF_SUB_1.AN_STATUS      = 8452)) > 0
        THEN 'A'
        ELSE 'H'
      END
  END) RBI_POF_HIS_AN,
  NVL(V_TBL_RBI_POF_SUB_2.RBI_POF_FAIL_DATA, 0) AS RBI_POF_FAIL_DATA,
  (
  CASE
    WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_AN_CNT > 0
    THEN
      CASE
        WHEN (SELECT COUNT(V_TBL_RBI_POF_SUB_1.AN_ID)
          FROM V_TBL_RBI_POF_SUB_1
          WHERE (V_TBL_RBI_POF_SUB_1.AN_ASSET_ID = V_TBL_RBI_POF_SUB_2.RBI_POF_NODE_ID
          AND V_TBL_RBI_POF_SUB_1.AN_FT_ID       = V_TBL_RBI_POF_SUB_2.RBI_POF_FT_ID
          AND V_TBL_RBI_POF_SUB_1.AN_ORIG_CLASS  = 8472)
          OR (V_TBL_RBI_POF_SUB_1.AN_EQ_FAILURE  = 1)) > 0
        THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS / (NVL(V_TBL_RBI_POF_SUB_2.RBI_POF_FAIL_DATA, 0) + 1)
        ELSE
          CASE
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14000
            THEN (
              CASE
                WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 16
                THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
                ELSE 16
              END)
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14001
            THEN (
              CASE
                WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 8
                THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
                ELSE 8
              END)
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14002
            THEN (
              CASE
                WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 4
                THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
                ELSE 4
              END)
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14003
            THEN (
              CASE
                WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 2
                THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
                ELSE 2
              END)
            WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14004
            THEN (
              CASE
                WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS > 1
                THEN V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS
                ELSE 1
              END)
          END
      END
    ELSE
      CASE
        WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14000
        THEN 16
        WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14001
        THEN 8
        WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14002
        THEN 4
        WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14003
        THEN 2
        WHEN V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF = 14004
        THEN 1
        ELSE 
          0
      END
  END) RBI_POF_MTBF,
  V_TBL_RBI_POF_SUB_2.RBI_POF_OPR_YRS,
  V_TBL_RBI_POF_SUB_2.RBI_POF_YR_INSTALLED,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NODE_ID,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NODE_DESC,
  V_TBL_RBI_POF_SUB_2.RBI_POF_FT_ID,
  V_TBL_RBI_POF_SUB_2.RBI_POF_FT_NAME,
  V_TBL_RBI_POF_SUB_2.FT_TYPE,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_HEALTH,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_HEALTH_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_HEALTH_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_HEALTH_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SAFETY,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SAFETY_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SAFETY_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_SAFETY_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ENV,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ENV_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ENV_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ENV_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ASSET,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ASSET_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ASSET_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_ASSET_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_REP,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_REP_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_REP_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_IPOF_REP_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_SYS_1,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_SYS_2,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_SYS_3,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_A,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_B,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_C,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_D,
  V_TBL_RBI_POF_SUB_2.RBI_POF_NPOF_E,
  V_TBL_RBI_POF_SUB_2.RBI_POF_GUIDE,
  V_TBL_RBI_POF_SUB_2.RBI_POF_MIN_POF,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_COMMENT,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_STATUS,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_STATUS_SYS,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_BY,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_DATE,
  V_TBL_RBI_POF_SUB_2.RBI_POF_UPDATE_DATE,
  V_TBL_RBI_POF_SUB_2.RBI_POF_POF_NOTES,
  V_TBL_RBI_POF_SUB_2.RBI_POF_ASS_BY,
  V_TBL_RBI_POF_SUB_2.RBI_POF_ASS_DATE,
  V_TBL_RBI_POF_SUB_2.RBI_POF_CONF_PREV_INS,
  V_TBL_RBI_POF_SUB_2.RBI_POF_AN_CNT,
  NVL(V_TBL_RBI_POF_SUB_2.RBI_POF_ARL_YEARS, 0) RBI_POF_ARL_YEARS
FROM V_TBL_RBI_POF_SUB_2;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_POF_SUB
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_POF_SUB" ("AN_ID", "AN_ASSET_ID", "AN_FT_ID", "AN_STATUS") AS 
  SELECT TBL_ANOM_MAIN.AN_ID,
  TBL_ANOM_MAIN.AN_ASSET_ID,
  LNK_AN_FT.LNK_TAG_A AS AN_FT_ID,
  TBL_ANOM_MAIN.AN_STATUS
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_FT
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_FT.LNK_TAG_B WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_POF_SUB_1
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_POF_SUB_1" ("AN_ID", "AN_ASSET_ID", "AN_FT_ID", "AN_STATUS", "AN_ORIG_CLASS", "AN_EQ_FAILURE") AS 
  SELECT TBL_ANOM_MAIN.AN_ID,
  TBL_ANOM_MAIN.AN_ASSET_ID,
  LNK_AN_FT.LNK_TAG_A AS AN_FT_ID,
  TBL_ANOM_MAIN.AN_STATUS,
  TBL_ANOM_MAIN.AN_ORIG_CLASS,
  TBL_ANOM_MAIN.AN_EQ_FAILURE 
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_FT
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_FT.LNK_TAG_B WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_POF_SUB_2
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_POF_SUB_2" ("RBI_POF_ID", "RBI_POF_AN_CNT", "RBI_POF_DATE_INSTALLED", "RBI_POF_OPR_YRS", "RBI_POF_NODE_ID", "RBI_POF_NODE_DESC", "RBI_POF_FT_ID", "RBI_POF_FT_NAME", "FT_TYPE", "RBI_POF_IPOF", "RBI_POF_IPOF_SYS_1", "RBI_POF_IPOF_SYS_2", "RBI_POF_IPOF_SYS_3", "RBI_POF_IPOF_HEALTH", "RBI_POF_IPOF_HEALTH_SYS_1", "RBI_POF_IPOF_HEALTH_SYS_2", "RBI_POF_IPOF_HEALTH_SYS_3", "RBI_POF_IPOF_SAFETY", "RBI_POF_IPOF_SAFETY_SYS_1", "RBI_POF_IPOF_SAFETY_SYS_2", "RBI_POF_IPOF_SAFETY_SYS_3", "RBI_POF_IPOF_ENV", "RBI_POF_IPOF_ENV_SYS_1", "RBI_POF_IPOF_ENV_SYS_2", "RBI_POF_IPOF_ENV_SYS_3", "RBI_POF_IPOF_ASSET", "RBI_POF_IPOF_ASSET_SYS_1", "RBI_POF_IPOF_ASSET_SYS_2", "RBI_POF_IPOF_ASSET_SYS_3", "RBI_POF_IPOF_REP", "RBI_POF_IPOF_REP_SYS_1", "RBI_POF_IPOF_REP_SYS_2", "RBI_POF_IPOF_REP_SYS_3", "RBI_POF_NPOF", "RBI_POF_NPOF_SYS_1", "RBI_POF_NPOF_SYS_2", "RBI_POF_NPOF_SYS_3", "RBI_POF_NPOF_A", "RBI_POF_NPOF_B", "RBI_POF_NPOF_C", "RBI_POF_NPOF_D", "RBI_POF_NPOF_E", "RBI_POF_GUIDE", "RBI_POF_MIN_POF", "RBI_POF_CONF_COMMENT", "RBI_POF_CONF_STATUS", "RBI_POF_CONF_STATUS_SYS", "RBI_POF_CONF_BY", "RBI_POF_CONF_DATE", "RBI_POF_UPDATE_DATE", "RBI_POF_POF_NOTES", "RBI_POF_ASS_BY", "RBI_POF_ASS_DATE", "RBI_POF_CONF_PREV_INS", "RBI_POF_ARL_YEARS") AS 
  SELECT RBI_POF_ID,
  RBI_POF_AN_CNT,
  RBI_POF_DATE_INSTALLED,
  (CASE
      WHEN RBI_POF_DATE_INSTALLED IS NOT NULL  
      THEN ROUND(MONTHS_BETWEEN(SysDate, TO_DATE(RBI_POF_DATE_INSTALLED)) / 12, 1)
      ELSE 0
    END
  ) RBI_POF_OPR_YRS,
  RBI_POF_NODE_ID,
  RBI_POF_NODE_DESC,
  RBI_POF_FT_ID,
  RBI_POF_FT_NAME,
  FT_TYPE,
  RBI_POF_IPOF,
  RBI_POF_IPOF_SYS_1,
  RBI_POF_IPOF_SYS_2,
  RBI_POF_IPOF_SYS_3,
  RBI_POF_IPOF_HEALTH,
  RBI_POF_IPOF_HEALTH_SYS_1,
  RBI_POF_IPOF_HEALTH_SYS_2,
  RBI_POF_IPOF_HEALTH_SYS_3,
  RBI_POF_IPOF_SAFETY,
  RBI_POF_IPOF_SAFETY_SYS_1,
  RBI_POF_IPOF_SAFETY_SYS_2,
  RBI_POF_IPOF_SAFETY_SYS_3,
  RBI_POF_IPOF_ENV,
  RBI_POF_IPOF_ENV_SYS_1,
  RBI_POF_IPOF_ENV_SYS_2,
  RBI_POF_IPOF_ENV_SYS_3,
  RBI_POF_IPOF_ASSET,
  RBI_POF_IPOF_ASSET_SYS_1,
  RBI_POF_IPOF_ASSET_SYS_2,
  RBI_POF_IPOF_ASSET_SYS_3,
  RBI_POF_IPOF_REP,
  RBI_POF_IPOF_REP_SYS_1,
  RBI_POF_IPOF_REP_SYS_2,
  RBI_POF_IPOF_REP_SYS_3,
  RBI_POF_NPOF,
  RBI_POF_NPOF_SYS_1,
  RBI_POF_NPOF_SYS_2,
  RBI_POF_NPOF_SYS_3,
  RBI_POF_NPOF_A,
  RBI_POF_NPOF_B,
  RBI_POF_NPOF_C,
  RBI_POF_NPOF_D,
  RBI_POF_NPOF_E,
  RBI_POF_GUIDE,
  RBI_POF_MIN_POF,
  RBI_POF_CONF_COMMENT,
  RBI_POF_CONF_STATUS,
  RBI_POF_CONF_STATUS_SYS,
  RBI_POF_CONF_BY,
  RBI_POF_CONF_DATE,
  RBI_POF_UPDATE_DATE,
  RBI_POF_POF_NOTES,
  RBI_POF_ASS_BY,
  RBI_POF_ASS_DATE,
  RBI_POF_CONF_PREV_INS,
  RBI_POF_ARL_YEARS
FROM
  (SELECT TBL_RBI_POF.RBI_POF_ID,
    (
    CASE
      WHEN TBL_RBI_POF.RBI_POF_AN_CNT IS NULL
      THEN
        (SELECT COUNT(V_TBL_RBI_POF_SUB_1.AN_ID)
        FROM V_TBL_RBI_POF_SUB_1
        WHERE V_TBL_RBI_POF_SUB_1.AN_ASSET_ID = TBL_RBI_POF.RBI_POF_NODE_ID
        AND V_TBL_RBI_POF_SUB_1.AN_FT_ID      = TBL_RBI_POF.RBI_POF_FT_ID
        )
      ELSE TBL_RBI_POF.RBI_POF_AN_CNT
    END) RBI_POF_AN_CNT,
    (SELECT DISTINCT
      CASE
        WHEN SP_TODATE(MIN(TBL_DESIGN_DATA_MAIN.DD_PARAM_VALUE)) IS NOT NULL
        THEN TO_DATE(MIN(TBL_DESIGN_DATA_MAIN.DD_PARAM_VALUE), 'DD-MON-YYYY') 
        ELSE
          NULL 
      END
    FROM TBL_DESIGN_DATA_MAIN
    WHERE TBL_DESIGN_DATA_MAIN.DD_PARAM = 85
    AND TBL_DESIGN_DATA_MAIN.DD_ASSET   = TBL_RBI_POF.RBI_POF_NODE_ID
    ) RBI_POF_DATE_INSTALLED,
    TBL_RBI_POF.RBI_POF_NODE_ID,
    (SYS_NODES_ATTRIB.NODE_ID
    || ' - '
    || SYS_NODES_ATTRIB.NODE_DESC) AS RBI_POF_NODE_DESC,
    TBL_RBI_POF.RBI_POF_FT_ID,
    (TBL_ANOM_FT.FT_CODE
    || ' - '
    || TBL_ANOM_FT.FT_NAME) AS RBI_POF_FT_NAME,
    TBL_ANOM_FT.FT_TYPE,
    TBL_RBI_POF.RBI_POF_IPOF,
    SYS_LOOKUPS.LKP_DESC_A AS RBI_POF_IPOF_SYS_1,
    SYS_LOOKUPS.LKP_DESC_B AS RBI_POF_IPOF_SYS_2,
    (SYS_LOOKUPS.LKP_DESC_A
    || '-'
    || SYS_LOOKUPS.LKP_DESC_B) AS RBI_POF_IPOF_SYS_3,
    TBL_RBI_POF.RBI_POF_IPOF_HEALTH,
    SYS_LOOKUPS1.LKP_DESC_A AS RBI_POF_IPOF_HEALTH_SYS_1,
    SYS_LOOKUPS1.LKP_DESC_B AS RBI_POF_IPOF_HEALTH_SYS_2,
    (SYS_LOOKUPS1.LKP_DESC_A
    || '-'
    || SYS_LOOKUPS1.LKP_DESC_B) AS RBI_POF_IPOF_HEALTH_SYS_3,
    TBL_RBI_POF.RBI_POF_IPOF_SAFETY,
    SYS_LOOKUPS2.LKP_DESC_A AS RBI_POF_IPOF_SAFETY_SYS_1,
    SYS_LOOKUPS2.LKP_DESC_B AS RBI_POF_IPOF_SAFETY_SYS_2,
    (SYS_LOOKUPS2.LKP_DESC_A
    || '-'
    || SYS_LOOKUPS2.LKP_DESC_B) AS RBI_POF_IPOF_SAFETY_SYS_3,
    TBL_RBI_POF.RBI_POF_IPOF_ENV,
    SYS_LOOKUPS3.LKP_DESC_A AS RBI_POF_IPOF_ENV_SYS_1,
    SYS_LOOKUPS3.LKP_DESC_B AS RBI_POF_IPOF_ENV_SYS_2,
    (SYS_LOOKUPS3.LKP_DESC_A
    || '-'
    || SYS_LOOKUPS3.LKP_DESC_B) AS RBI_POF_IPOF_ENV_SYS_3,
    TBL_RBI_POF.RBI_POF_IPOF_ASSET,
    SYS_LOOKUPS4.LKP_DESC_A AS RBI_POF_IPOF_ASSET_SYS_1,
    SYS_LOOKUPS4.LKP_DESC_B AS RBI_POF_IPOF_ASSET_SYS_2,
    (SYS_LOOKUPS4.LKP_DESC_A
    || '-'
    || SYS_LOOKUPS4.LKP_DESC_B) AS RBI_POF_IPOF_ASSET_SYS_3,
    TBL_RBI_POF.RBI_POF_IPOF_REP,
    SYS_LOOKUPS5.LKP_DESC_A AS RBI_POF_IPOF_REP_SYS_1,
    SYS_LOOKUPS5.LKP_DESC_B AS RBI_POF_IPOF_REP_SYS_2,
    (SYS_LOOKUPS5.LKP_DESC_A
    || '-'
    || SYS_LOOKUPS5.LKP_DESC_B) AS RBI_POF_IPOF_REP_SYS_3,
    TBL_RBI_POF.RBI_POF_NPOF,
    SYS_LOOKUPS7.LKP_DESC_A AS RBI_POF_NPOF_SYS_1,
    SYS_LOOKUPS7.LKP_DESC_B AS RBI_POF_NPOF_SYS_2,
    (SYS_LOOKUPS7.LKP_DESC_A
    || '-'
    || SYS_LOOKUPS7.LKP_DESC_B) AS RBI_POF_NPOF_SYS_3,
    TBL_RBI_POF.RBI_POF_NPOF_A,
    TBL_RBI_POF.RBI_POF_NPOF_B,
    TBL_RBI_POF.RBI_POF_NPOF_C,
    TBL_RBI_POF.RBI_POF_NPOF_D,
    TBL_RBI_POF.RBI_POF_NPOF_E,
    ('Latest Probability Level-A'
    || CHR(10)
    || TBL_RBI_POF.RBI_POF_NPOF_A
    || CHR(10)
    || CHR(10)
    || 'Latest Probability Level-B'
    || CHR(10)
    || TBL_RBI_POF.RBI_POF_NPOF_B
    || CHR(10)
    || CHR(10)
    || 'Latest Probability Level-C'
    || CHR(10)
    || TBL_RBI_POF.RBI_POF_NPOF_C
    || CHR(10)
    || CHR(10)
    || 'Latest Probability Level-D'
    || CHR(10)
    || TBL_RBI_POF.RBI_POF_NPOF_D
    || CHR(10)
    || CHR(10)
    || 'Latest Probability Level-E'
    || CHR(10)
    || TBL_RBI_POF.RBI_POF_NPOF_E
    || CHR(10)
    || CHR(10)
    || 'Minimum POF without Controls and Barriers'
    || CHR(10)
    || TBL_RBI_POF.RBI_POF_MIN_POF) AS RBI_POF_GUIDE,
    TBL_RBI_POF.RBI_POF_MIN_POF,
    TBL_RBI_POF.RBI_POF_CONF_COMMENT,
    TBL_RBI_POF.RBI_POF_CONF_STATUS,
    SYS_LOOKUPS8.LKP_DESC_B AS RBI_POF_CONF_STATUS_SYS,
    TBL_RBI_POF.RBI_POF_CONF_BY,
    TBL_RBI_POF.RBI_POF_CONF_DATE,
    TBL_RBI_POF.RBI_POF_UPDATE_DATE,
    TBL_RBI_POF.RBI_POF_POF_NOTES,
    TBL_RBI_POF.RBI_POF_ASS_BY,
    TBL_RBI_POF.RBI_POF_ASS_DATE,
    TBL_RBI_POF.RBI_POF_CONF_PREV_INS,
    TBL_RBI_POF.RBI_POF_ARL_YEARS
  FROM TBL_RBI_POF
  INNER JOIN SYS_NODES_ATTRIB
  ON SYS_NODES_ATTRIB.REC_TAG = TBL_RBI_POF.RBI_POF_NODE_ID
  INNER JOIN TBL_ANOM_FT
  ON TBL_RBI_POF.RBI_POF_FT_ID = TBL_ANOM_FT.FT_ID
  LEFT JOIN SYS_LOOKUPS
  ON TBL_RBI_POF.RBI_POF_IPOF = SYS_LOOKUPS.LKP_ID
  LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
  ON TBL_RBI_POF.RBI_POF_IPOF_HEALTH = SYS_LOOKUPS1.LKP_ID
  LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS2
  ON TBL_RBI_POF.RBI_POF_IPOF_SAFETY = SYS_LOOKUPS2.LKP_ID
  LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS3
  ON TBL_RBI_POF.RBI_POF_IPOF_ENV = SYS_LOOKUPS3.LKP_ID
  LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS4
  ON TBL_RBI_POF.RBI_POF_IPOF_ASSET = SYS_LOOKUPS4.LKP_ID
  LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS5
  ON TBL_RBI_POF.RBI_POF_IPOF_REP = SYS_LOOKUPS5.LKP_ID
  LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS7
  ON TBL_RBI_POF.RBI_POF_NPOF = SYS_LOOKUPS7.LKP_ID
  LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS8
  ON TBL_RBI_POF.RBI_POF_CONF_STATUS = SYS_LOOKUPS8.LKP_ID
  )
ORDER BY RBI_POF_NODE_DESC,
  RBI_POF_FT_NAME WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_POF_SUB_2_OLD
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_POF_SUB_2_OLD" ("RBI_POF_ID", "RBI_POF_AN_CNT", "RBI_POF_YR_INSTALLED", "RBI_POF_OPR_YRS", "RBI_POF_FAIL_DATA", "RBI_POF_NODE_ID", "RBI_POF_NODE_DESC", "RBI_POF_FT_ID", "RBI_POF_FT_NAME", "FT_TYPE", "RBI_POF_IPOF", "RBI_POF_IPOF_SYS_1", "RBI_POF_IPOF_SYS_2", "RBI_POF_IPOF_SYS_3", "RBI_POF_IPOF_HEALTH", "RBI_POF_IPOF_HEALTH_SYS_1", "RBI_POF_IPOF_HEALTH_SYS_2", "RBI_POF_IPOF_HEALTH_SYS_3", "RBI_POF_IPOF_SAFETY", "RBI_POF_IPOF_SAFETY_SYS_1", "RBI_POF_IPOF_SAFETY_SYS_2", "RBI_POF_IPOF_SAFETY_SYS_3", "RBI_POF_IPOF_ENV", "RBI_POF_IPOF_ENV_SYS_1", "RBI_POF_IPOF_ENV_SYS_2", "RBI_POF_IPOF_ENV_SYS_3", "RBI_POF_IPOF_ASSET", "RBI_POF_IPOF_ASSET_SYS_1", "RBI_POF_IPOF_ASSET_SYS_2", "RBI_POF_IPOF_ASSET_SYS_3", "RBI_POF_IPOF_REP", "RBI_POF_IPOF_REP_SYS_1", "RBI_POF_IPOF_REP_SYS_2", "RBI_POF_IPOF_REP_SYS_3", "RBI_POF_NPOF", "RBI_POF_NPOF_SYS_1", "RBI_POF_NPOF_SYS_2", "RBI_POF_NPOF_SYS_3", "RBI_POF_NPOF_A", "RBI_POF_NPOF_B", "RBI_POF_NPOF_C", "RBI_POF_NPOF_D", "RBI_POF_NPOF_E", "RBI_POF_GUIDE", "RBI_POF_MIN_POF", "RBI_POF_CONF_COMMENT", "RBI_POF_CONF_STATUS", "RBI_POF_CONF_STATUS_SYS", "RBI_POF_CONF_BY", "RBI_POF_CONF_DATE", "RBI_POF_UPDATE_DATE", "RBI_POF_POF_NOTES", "RBI_POF_ASS_BY", "RBI_POF_ASS_DATE", "RBI_POF_CONF_PREV_INS", "RBI_POF_ARL_YEARS") AS 
  SELECT TBL_RBI_POF.RBI_POF_ID,
  (CASE WHEN TBL_RBI_POF.RBI_POF_AN_CNT IS NULL THEN 
    (SELECT COUNT(V_TBL_RBI_POF_SUB_1.AN_ID)
    FROM V_TBL_RBI_POF_SUB_1
    WHERE V_TBL_RBI_POF_SUB_1.AN_ASSET_ID = TBL_RBI_POF.RBI_POF_NODE_ID
    AND V_TBL_RBI_POF_SUB_1.AN_FT_ID      = TBL_RBI_POF.RBI_POF_FT_ID
    ) 
  ELSE 
    TBL_RBI_POF.RBI_POF_AN_CNT
  END) RBI_POF_AN_CNT,
  (SELECT
    CASE
      WHEN LENGTH(TRIM(TRANSLATE(TBL_DESIGN_DATA_MAIN.DD_PARAM_VALUE, '+-.0123456789', ' '))) IS NULL
      THEN TO_NUMBER(TBL_DESIGN_DATA_MAIN.DD_PARAM_VALUE)
      ELSE 0
    END
  FROM TBL_DESIGN_DATA_MAIN
  WHERE TBL_DESIGN_DATA_MAIN.DD_PARAM = 85
  AND TBL_DESIGN_DATA_MAIN.DD_ASSET   = TBL_RBI_POF.RBI_POF_NODE_ID
  ) RBI_POF_YR_INSTALLED,
  (SELECT
    CASE
      WHEN LENGTH(TRIM(TRANSLATE(TBL_DESIGN_DATA_MAIN.DD_PARAM_VALUE, '+-.0123456789', ' '))) IS NULL
      THEN FLOOR(MONTHS_BETWEEN(SysDate, TO_DATE(TBL_DESIGN_DATA_MAIN.DD_PARAM_VALUE
        || '-01-01', 'YYYY-MM-DD')) / 12)
      ELSE 0
    END
  FROM TBL_DESIGN_DATA_MAIN
  WHERE TBL_DESIGN_DATA_MAIN.DD_PARAM = 85
  AND TBL_DESIGN_DATA_MAIN.DD_ASSET   = TBL_RBI_POF.RBI_POF_NODE_ID
  ) RBI_POF_OPR_YRS,
  (
  CASE
    WHEN (SELECT COUNT(V_TBL_RBI_POF_SUB_1.AN_ID)
      FROM V_TBL_RBI_POF_SUB_1
      WHERE V_TBL_RBI_POF_SUB_1.AN_ASSET_ID = TBL_RBI_POF.RBI_POF_NODE_ID
      AND V_TBL_RBI_POF_SUB_1.AN_FT_ID      = TBL_RBI_POF.RBI_POF_FT_ID) > 0
    THEN
      (SELECT COUNT(V_TBL_RBI_POF_SUB_1.AN_ID)
      FROM V_TBL_RBI_POF_SUB_1
      WHERE V_TBL_RBI_POF_SUB_1.AN_ASSET_ID  = TBL_RBI_POF.RBI_POF_NODE_ID
      AND V_TBL_RBI_POF_SUB_1.AN_FT_ID       = TBL_RBI_POF.RBI_POF_FT_ID
      AND (V_TBL_RBI_POF_SUB_1.AN_ORIG_CLASS = 8472
      OR V_TBL_RBI_POF_SUB_1.AN_EQ_FAILURE   = 1)
      )
    ELSE NULL
  END) RBI_POF_FAIL_DATA,
  TBL_RBI_POF.RBI_POF_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS RBI_POF_NODE_DESC,
  TBL_RBI_POF.RBI_POF_FT_ID,
  (TBL_ANOM_FT.FT_CODE
  || ' - '
  || TBL_ANOM_FT.FT_NAME) AS RBI_POF_FT_NAME,
  TBL_ANOM_FT.FT_TYPE,
  TBL_RBI_POF.RBI_POF_IPOF,
  SYS_LOOKUPS.LKP_DESC_A AS RBI_POF_IPOF_SYS_1,
  SYS_LOOKUPS.LKP_DESC_B AS RBI_POF_IPOF_SYS_2,
  (SYS_LOOKUPS.LKP_DESC_A
  || '-'
  || SYS_LOOKUPS.LKP_DESC_B) AS RBI_POF_IPOF_SYS_3,
  TBL_RBI_POF.RBI_POF_IPOF_HEALTH,
  SYS_LOOKUPS1.LKP_DESC_A AS RBI_POF_IPOF_HEALTH_SYS_1,
  SYS_LOOKUPS1.LKP_DESC_B AS RBI_POF_IPOF_HEALTH_SYS_2,
  (SYS_LOOKUPS1.LKP_DESC_A
  || '-'
  || SYS_LOOKUPS1.LKP_DESC_B) AS RBI_POF_IPOF_HEALTH_SYS_3,
  TBL_RBI_POF.RBI_POF_IPOF_SAFETY,
  SYS_LOOKUPS2.LKP_DESC_A AS RBI_POF_IPOF_SAFETY_SYS_1,
  SYS_LOOKUPS2.LKP_DESC_B AS RBI_POF_IPOF_SAFETY_SYS_2,
  (SYS_LOOKUPS2.LKP_DESC_A
  || '-'
  || SYS_LOOKUPS2.LKP_DESC_B) AS RBI_POF_IPOF_SAFETY_SYS_3,
  TBL_RBI_POF.RBI_POF_IPOF_ENV,
  SYS_LOOKUPS3.LKP_DESC_A AS RBI_POF_IPOF_ENV_SYS_1,
  SYS_LOOKUPS3.LKP_DESC_B AS RBI_POF_IPOF_ENV_SYS_2,
  (SYS_LOOKUPS3.LKP_DESC_A
  || '-'
  || SYS_LOOKUPS3.LKP_DESC_B) AS RBI_POF_IPOF_ENV_SYS_3,
  TBL_RBI_POF.RBI_POF_IPOF_ASSET,
  SYS_LOOKUPS4.LKP_DESC_A AS RBI_POF_IPOF_ASSET_SYS_1,
  SYS_LOOKUPS4.LKP_DESC_B AS RBI_POF_IPOF_ASSET_SYS_2,
  (SYS_LOOKUPS4.LKP_DESC_A
  || '-'
  || SYS_LOOKUPS4.LKP_DESC_B) AS RBI_POF_IPOF_ASSET_SYS_3,
  TBL_RBI_POF.RBI_POF_IPOF_REP,
  SYS_LOOKUPS5.LKP_DESC_A AS RBI_POF_IPOF_REP_SYS_1,
  SYS_LOOKUPS5.LKP_DESC_B AS RBI_POF_IPOF_REP_SYS_2,
  (SYS_LOOKUPS5.LKP_DESC_A
  || '-'
  || SYS_LOOKUPS5.LKP_DESC_B) AS RBI_POF_IPOF_REP_SYS_3,
  TBL_RBI_POF.RBI_POF_NPOF,
  SYS_LOOKUPS7.LKP_DESC_A AS RBI_POF_NPOF_SYS_1,
  SYS_LOOKUPS7.LKP_DESC_B AS RBI_POF_NPOF_SYS_2,
  (SYS_LOOKUPS7.LKP_DESC_A
  || '-'
  || SYS_LOOKUPS7.LKP_DESC_B) AS RBI_POF_NPOF_SYS_3,
  TBL_RBI_POF.RBI_POF_NPOF_A,
  TBL_RBI_POF.RBI_POF_NPOF_B,
  TBL_RBI_POF.RBI_POF_NPOF_C,
  TBL_RBI_POF.RBI_POF_NPOF_D,
  TBL_RBI_POF.RBI_POF_NPOF_E,
  ('Latest Probability Level-A'
  || CHR(10)
  || TBL_RBI_POF.RBI_POF_NPOF_A
  || CHR(10)
  || CHR(10)
  || 'Latest Probability Level-B'
  || CHR(10)
  || TBL_RBI_POF.RBI_POF_NPOF_B
  || CHR(10)
  || CHR(10)
  || 'Latest Probability Level-C'
  || CHR(10)
  || TBL_RBI_POF.RBI_POF_NPOF_C
  || CHR(10)
  || CHR(10)
  || 'Latest Probability Level-D'
  || CHR(10)
  || TBL_RBI_POF.RBI_POF_NPOF_D
  || CHR(10)
  || CHR(10)
  || 'Latest Probability Level-E'
  || CHR(10)
  || TBL_RBI_POF.RBI_POF_NPOF_E
  || CHR(10)
  || CHR(10)
  || 'Minimum POF without Controls and Barriers'
  || CHR(10)
  || TBL_RBI_POF.RBI_POF_MIN_POF) AS RBI_POF_GUIDE,
  TBL_RBI_POF.RBI_POF_MIN_POF,
  TBL_RBI_POF.RBI_POF_CONF_COMMENT,
  TBL_RBI_POF.RBI_POF_CONF_STATUS,
  SYS_LOOKUPS8.LKP_DESC_B AS RBI_POF_CONF_STATUS_SYS,
  TBL_RBI_POF.RBI_POF_CONF_BY,
  TBL_RBI_POF.RBI_POF_CONF_DATE,
  TBL_RBI_POF.RBI_POF_UPDATE_DATE,
  TBL_RBI_POF.RBI_POF_POF_NOTES,
  TBL_RBI_POF.RBI_POF_ASS_BY,
  TBL_RBI_POF.RBI_POF_ASS_DATE,
  TBL_RBI_POF.RBI_POF_CONF_PREV_INS,
  TBL_RBI_POF.RBI_POF_ARL_YEARS
FROM TBL_RBI_POF
INNER JOIN SYS_NODES_ATTRIB
ON SYS_NODES_ATTRIB.REC_TAG = TBL_RBI_POF.RBI_POF_NODE_ID
INNER JOIN TBL_ANOM_FT
ON TBL_RBI_POF.RBI_POF_FT_ID = TBL_ANOM_FT.FT_ID
LEFT JOIN SYS_LOOKUPS
ON TBL_RBI_POF.RBI_POF_IPOF = SYS_LOOKUPS.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON TBL_RBI_POF.RBI_POF_IPOF_HEALTH = SYS_LOOKUPS1.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS2
ON TBL_RBI_POF.RBI_POF_IPOF_SAFETY = SYS_LOOKUPS2.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS3
ON TBL_RBI_POF.RBI_POF_IPOF_ENV = SYS_LOOKUPS3.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS4
ON TBL_RBI_POF.RBI_POF_IPOF_ASSET = SYS_LOOKUPS4.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS5
ON TBL_RBI_POF.RBI_POF_IPOF_REP = SYS_LOOKUPS5.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS7
ON TBL_RBI_POF.RBI_POF_NPOF = SYS_LOOKUPS7.LKP_ID
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS8
ON TBL_RBI_POF.RBI_POF_CONF_STATUS = SYS_LOOKUPS8.LKP_ID
ORDER BY RBI_POF_NODE_DESC,
  RBI_POF_FT_NAME;
--------------------------------------------------------
--  DDL for View V_TBL_RBI_RSK
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_RBI_RSK" ("RBI_POF_NODE_ID", "RBI_COF_ID", "RBI_POF_ID", "RBI_POF_NODE_DESC", "RBI_POF_FT_ID", "RBI_POF_FT_NAME", "RBI_POF_IPOF", "RBI_POF_IPOF_SYS_1", "RBI_POF_IPOF_SYS_3", "RBI_POF_NPOF", "RBI_POF_NPOF_SYS_1", "RBI_POF_NPOF_SYS_3", "RBI_COF_OVERALL", "FT_TYPE", "RBI_COF_HEALTH", "RBI_COF_HEALTH_SYS", "RBI_COF_SAFETY", "RBI_COF_SAFETY_SYS", "RBI_COF_ENV", "RBI_COF_ENV_SYS", "RBI_COF_ASSETS", "RBI_COF_ASSETS_SYS", "RBI_COF_REP", "RBI_COF_REP_SYS", "RBI_POF_POF_NOTES", "RBI_COF_COF_NOTES", "SCE") AS 
  SELECT V_TBL_RBI_POF.RBI_POF_NODE_ID,
  V_TBL_RBI_COF.RBI_COF_ID,
  V_TBL_RBI_POF.RBI_POF_ID,
  V_TBL_RBI_POF.RBI_POF_NODE_DESC,
  V_TBL_RBI_POF.RBI_POF_FT_ID,
  V_TBL_RBI_POF.RBI_POF_FT_NAME,
  V_TBL_RBI_POF.RBI_POF_IPOF,
  V_TBL_RBI_POF.RBI_POF_IPOF_SYS_1,
  V_TBL_RBI_POF.RBI_POF_IPOF_SYS_3,
  V_TBL_RBI_POF.RBI_POF_NPOF,
  V_TBL_RBI_POF.RBI_POF_NPOF_SYS_1,
  V_TBL_RBI_POF.RBI_POF_NPOF_SYS_3,
  V_TBL_RBI_COF.RBI_COF_OVERALL,
  V_TBL_RBI_POF.FT_TYPE,
  V_TBL_RBI_COF.RBI_COF_HEALTH,
  V_TBL_RBI_COF.RBI_COF_HEALTH_SYS,
  V_TBL_RBI_COF.RBI_COF_SAFETY,
  V_TBL_RBI_COF.RBI_COF_SAFETY_SYS,
  V_TBL_RBI_COF.RBI_COF_ENV,
  V_TBL_RBI_COF.RBI_COF_ENV_SYS,
  V_TBL_RBI_COF.RBI_COF_ASSETS,
  V_TBL_RBI_COF.RBI_COF_ASSETS_SYS,
  V_TBL_RBI_COF.RBI_COF_REP,
  V_TBL_RBI_COF.RBI_COF_REP_SYS,
  V_TBL_RBI_POF.RBI_POF_POF_NOTES,
  V_TBL_RBI_COF.RBI_COF_COF_NOTES,
  SYS_NODES_ATTRIB.SCE
FROM V_TBL_RBI_POF
LEFT JOIN V_TBL_RBI_COF
ON V_TBL_RBI_POF.RBI_POF_NODE_ID = V_TBL_RBI_COF.RBI_COF_NODE_ID
INNER JOIN SYS_NODES_ATTRIB
ON V_TBL_RBI_POF.RBI_POF_NODE_ID = SYS_NODES_ATTRIB.REC_TAG WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_REFERENCE_ACT_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_REFERENCE_ACT_COLOR" ("ACTION_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_CLASS ACTION_COLOR, 
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_REFERENCE_ACTAVL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_REFERENCE_ACTAVL_COLOR" ("ACTION_AVAIL_COLOR", "ASSET_ID") AS 
  SELECT (
  CASE
    WHEN TBL_ANOM_MAIN.AN_CURR_CLASS >= TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
    THEN TBL_ANOM_MAIN.AN_CURR_CLASS
    ELSE TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
  END) ACTION_AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_REFERENCE_AVAIL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_REFERENCE_AVAIL_COLOR" ("AVAIL_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_REFERENCE_COM_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_REFERENCE_COM_COLOR" ("COMPLIANCE_COLOR", "ASSET_ID") AS 
  SELECT V_TBL_CA.CA_STATUS_COLOR AS COMPLIANCE_COLOR,
  V_TBL_CA.CA_REC_TAG           AS ASSET_ID
FROM V_TBL_CA WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_REFERENCE_FILES
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_REFERENCE_FILES" ("RF_ID", "RF_DESC", "RF_TYPE", "RF_TYPE_SYS", "RF_CLASS", "RF_CLASS_SYS", "RF_UPLDATE", "RF_REF_NO", "RF_REVNO", "RF_REVDATE", "RF_FILENAME", "RF_PATH", "RF_PATH_SYS", "RF_PATH_SYS_2", "RF_REFNOX", "RF_CONTRACTOR", "RF_ASSET", "RF_ASSET_DESC", "RF_LLID", "RF_UPDBY", "RF_UPDDATE", "RF_NOTES", "RF_FULLFILE") AS 
  SELECT TBL_REFERENCE_FILES.RF_ID,
  TBL_REFERENCE_FILES.RF_DESC,
  TBL_REFERENCE_FILES.RF_TYPE,
  LOOKUPS_TYPE.LKP_DESC_B AS RF_TYPE_SYS,
  TBL_REFERENCE_FILES.RF_CLASS,
  LOOKUPS_CLASS.LKP_DESC_B AS RF_CLASS_SYS,
  TBL_REFERENCE_FILES.RF_UPLDATE,
  TBL_REFERENCE_FILES.RF_REF_NO,
  TBL_REFERENCE_FILES.RF_REVNO,
  TBL_REFERENCE_FILES.RF_REVDATE,
  TBL_REFERENCE_FILES.RF_FILENAME,
  TBL_REFERENCE_FILES.RF_PATH,
  LOOKUPS_PAT.LKP_DESC_B AS RF_PATH_SYS,
  LOOKUPS_PAT.LKP_MEMO_1 AS RF_PATH_SYS_2,
  TBL_REFERENCE_FILES.RF_REFNOX,
  TBL_REFERENCE_FILES.RF_CONTRACTOR,
  TBL_REFERENCE_FILES.RF_ASSET,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS RF_ASSET_DESC,
  TBL_REFERENCE_FILES.RF_LLID,
  TBL_REFERENCE_FILES.RF_UPDBY,
  TBL_REFERENCE_FILES.RF_UPDDATE,
  TBL_REFERENCE_FILES.RF_NOTES,
  (
  CASE
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8204
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8205
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8206
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8207
    THEN TO_CHAR(LOOKUPS_PAT.LKP_MEMO_1)
      || '\'
      || TBL_REFERENCE_FILES.RF_FILENAME
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8200
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8201
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8202
    THEN TO_CHAR(LOOKUPS_PAT.LKP_MEMO_1)
      || TBL_REFERENCE_FILES.RF_LLID
    WHEN TBL_REFERENCE_FILES.RF_TYPE = 8208
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8209
    OR TBL_REFERENCE_FILES.RF_TYPE   = 8203
    THEN TBL_REFERENCE_FILES.RF_FILENAME
  END) AS RF_FULLFILE
FROM TBL_REFERENCE_FILES
LEFT JOIN SYS_LOOKUPS LOOKUPS_TYPE
ON TBL_REFERENCE_FILES.RF_TYPE = LOOKUPS_TYPE.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_CLASS
ON TBL_REFERENCE_FILES.RF_CLASS = LOOKUPS_CLASS.LKP_ID
LEFT JOIN SYS_LOOKUPS LOOKUPS_PAT
ON TBL_REFERENCE_FILES.RF_PATH = LOOKUPS_PAT.LKP_ID
INNER JOIN SYS_NODES_ATTRIB
ON TBL_REFERENCE_FILES.RF_ASSET = SYS_NODES_ATTRIB.REC_TAG WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_SURV_TIEBACKS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_SURV_TIEBACKS" ("TB_HOST_ID", "TB_TIEBACK_ID", "TB_INI", "TB_ACTIVE") AS 
  SELECT 
    "TB_HOST_ID","TB_TIEBACK_ID","TB_INI","TB_ACTIVE" FROM TBL_SURV_TIEBACKS WHERE TB_ACTIVE = 1 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_SVY_EVENT
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_SVY_EVENT" ("SVY_EVT_ID", "SVY_EVT_DESC", "SVY_EVT_ACTIVE") AS 
  SELECT TBL_SVY_EVENT.SVY_EVT_ID,
  TBL_SVY_EVENT.SVY_EVT_DESC,
  TBL_SVY_EVENT.SVY_EVT_ACTIVE
FROM TBL_SVY_EVENT WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_SVY_HEADER
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_SVY_HEADER" ("SVY_HDR_SVY_TITLE_SYS", "SVY_HDR_EVT_NAME_SYS", "SVY_HDR_ID", "SVY_HDR_NODE_ID", "SVY_NODE_DESC", "SVY_HDR_EVT_NUM", "SVY_HDR_AVG_EASTING_SYS", "SVY_HDR_AVG_NORTHING_SYS", "S_SVY_HDR_DISTANCE_SYS", "E_SVY_HDR_DISTANCE_SYS", "SVY_HDR_RECORDER", "SVY_HDR_COMMENT", "SVY_HDR_UPDATE_DATE", "SVY_HDR_UPDATE_BY", "SVY_HDR_COLOUR_SYS", "SVY_HDR_ASS_DETAILS", "SVY_HDR_ASS_DATE", "SVY_HDR_ASS_BY", "SVY_HDR_ANOM_CODE", "SVY_HDR_ANOM_ID", "SVY_HDR_ANOM_COMMENT", "SVY_YESNO_A", "SVY_YESNO_B", "SVY_YESNO_C", "SVY_YESNO_D", "SVY_YESNO_E", "SVY_YESNO_F", "SVY_YESNO_G", "SVY_YESNO_H", "SVY_YESNO_I", "SVY_YESNO_J", "SVY_TEXT_A", "SVY_TEXT_B", "SVY_TEXT_C", "SVY_TEXT_D", "SVY_TEXT_E", "SVY_TEXT_F", "SVY_TEXT_G", "SVY_TEXT_H", "SVY_TEXT_I", "SVY_TEXT_J", "SVY_TEXT_K", "SVY_TEXT_L", "SVY_TEXT_M", "SVY_TEXT_N", "SVY_TEXT_O", "SVY_TEXT_P", "SVY_TEXT_Q", "SVY_MEMO_A", "SVY_MEMO_B", "SVY_MEMO_C", "SVY_MEMO_D", "SVY_INTEGER_A", "SVY_INTEGER_B", "SVY_INTEGER_C", "SVY_INTEGER_D", "SVY_INTEGER_E", "SVY_INTEGER_F", "SVY_SINGLE_A", "SVY_SINGLE_B", "SVY_SINGLE_C", "SVY_SINGLE_D", "SVY_SINGLE_E", "SVY_SINGLE_F", "SVY_SINGLE_G", "SVY_SINGLE_H", "SVY_SINGLE_I", "SVY_SINGLE_J", "SVY_SINGLE_K", "SVY_SINGLE_L", "SVY_SINGLE_M", "SVY_SINGLE_N", "SVY_DATETIME_A", "SVY_DATETIME_B", "SVY_DATETIME_C", "SVY_DATETIME_D", "SVY_DATETIME_E", "SVY_DATETIME_F", "SVY_HDR_EVT_ID", "SVY_HDR_MAIN_ID", "SVY_HDR_NOD_ID", "SVY_HDR_COLOUR", "S_SVY_POS_ID", "S_SVY_POS_DATE_TIME", "S_SVY_POS_KP", "S_SVY_POS_DEPTH", "S_SVY_POS_EASTING", "S_SVY_POS_NORTHING", "S_SVY_POS_VID_TAG", "S_SVY_POS_OFFSET", "S_SVY_POS_HEADING", "S_SVY_POS_PITCH", "S_SVY_POS_ROLL", "S_SVY_POS_ALTITUDE", "S_SVY_POS_TEMPERATURE", "S_SVY_POS_LONGITUDE", "S_SVY_POS_LATITUDE", "S_SVY_POS_XCOORD", "S_SVY_POS_YCOORD", "S_SVY_POS_ZCOORD", "S_SVY_POS_UPDATE_DATE", "S_SVY_POS_VIDEO_CTR", "E_SVY_POS_ID", "E_SVY_POS_DATE_TIME", "E_SVY_POS_KP", "E_SVY_POS_DEPTH", "E_SVY_POS_EASTING", "E_SVY_POS_NORTHING", "E_SVY_POS_VID_TAG", "E_SVY_POS_OFFSET", "E_SVY_POS_HEADING", "E_SVY_POS_PITCH", "E_SVY_POS_ROLL", "E_SVY_POS_ALTITUDE", "E_SVY_POS_TEMPERATURE", "E_SVY_POS_LONGITUDE", "E_SVY_POS_LATITUDE", "E_SVY_POS_XCOORD", "E_SVY_POS_YCOORD", "E_SVY_POS_ZCOORD", "E_SVY_POS_UPDATE_DATE", "E_SVY_POS_VIDEO_CTR") AS 
  SELECT TBL_SVY_MAIN.SVY_MAIN_TITLE AS SVY_HDR_SVY_TITLE_SYS,
  TBL_SVY_EVENT.SVY_EVT_DESC       AS SVY_HDR_EVT_NAME_SYS,
  TBL_SVY_HEADER.SVY_HDR_ID,
  SYS_NODES_ATTRIB.NODE_ID AS SVY_HDR_NODE_ID,
  (SYS_NODES_ATTRIB.NODE_ID
  || ' - '
  || SYS_NODES_ATTRIB.NODE_DESC) AS SVY_NODE_DESC,
  TBL_SVY_HEADER.SVY_HDR_EVT_NUM,
  (TBL_SVY_POSITION_START.SVY_POS_EASTING + NVL(TBL_SVY_POSITION_END.SVY_POS_EASTING,TBL_SVY_POSITION_START.SVY_POS_EASTING)) / 2 AS SVY_HDR_AVG_EASTING_SYS,
  (TBL_SVY_POSITION_START.SVY_POS_NORTHING + NVL(TBL_SVY_POSITION_END.SVY_POS_NORTHING, TBL_SVY_POSITION_START.SVY_POS_NORTHING)) / 2 AS SVY_HDR_AVG_NORTHING_SYS,
  (0                                       - TBL_SVY_POSITION_START.SVY_POS_NORTHING) * (0 - TBL_SVY_POSITION_START.SVY_POS_NORTHING) + (0 - TBL_SVY_POSITION_START.SVY_POS_EASTING) * (0 - TBL_SVY_POSITION_START.SVY_POS_EASTING) AS S_SVY_HDR_DISTANCE_SYS,
  (0                                       - TBL_SVY_POSITION_END.SVY_POS_NORTHING) * (0 - TBL_SVY_POSITION_END.SVY_POS_NORTHING) + (0 - TBL_SVY_POSITION_END.SVY_POS_EASTING) * (0 - TBL_SVY_POSITION_END.SVY_POS_EASTING)         AS E_SVY_HDR_DISTANCE_SYS,
  TBL_SVY_HEADER.SVY_HDR_RECORDER,
  TBL_SVY_HEADER.SVY_HDR_COMMENT,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_DATE,
  TBL_SVY_HEADER.SVY_HDR_UPDATE_BY,
  SYS_LOOKUPS1.LKP_DESC_B AS SVY_HDR_COLOUR_SYS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DETAILS,
  TBL_SVY_HEADER.SVY_HDR_ASS_DATE,
  TBL_SVY_HEADER.SVY_HDR_ASS_BY,
  TBL_SVY_HEADER.SVY_HDR_ANOM_CODE,
  TBL_SVY_HEADER.SVY_HDR_ANOM_ID,
  TBL_SVY_HEADER.SVY_HDR_ANOM_COMMENT,
  TBL_SVY_HEADER.SVY_YESNO_A,
  TBL_SVY_HEADER.SVY_YESNO_B,
  TBL_SVY_HEADER.SVY_YESNO_C,
  TBL_SVY_HEADER.SVY_YESNO_D,
  TBL_SVY_HEADER.SVY_YESNO_E,
  TBL_SVY_HEADER.SVY_YESNO_F,
  TBL_SVY_HEADER.SVY_YESNO_G,
  TBL_SVY_HEADER.SVY_YESNO_H,
  TBL_SVY_HEADER.SVY_YESNO_I,
  TBL_SVY_HEADER.SVY_YESNO_J,
  TBL_SVY_HEADER.SVY_TEXT_A,
  TBL_SVY_HEADER.SVY_TEXT_B,
  TBL_SVY_HEADER.SVY_TEXT_C,
  TBL_SVY_HEADER.SVY_TEXT_D,
  TBL_SVY_HEADER.SVY_TEXT_E,
  TBL_SVY_HEADER.SVY_TEXT_F,
  TBL_SVY_HEADER.SVY_TEXT_G,
  TBL_SVY_HEADER.SVY_TEXT_H,
  TBL_SVY_HEADER.SVY_TEXT_I,
  TBL_SVY_HEADER.SVY_TEXT_J,
  TBL_SVY_HEADER.SVY_TEXT_K,
  TBL_SVY_HEADER.SVY_TEXT_L,
  TBL_SVY_HEADER.SVY_TEXT_M,
  TBL_SVY_HEADER.SVY_TEXT_N,
  TBL_SVY_HEADER.SVY_TEXT_O,
  TBL_SVY_HEADER.SVY_TEXT_P,
  TBL_SVY_HEADER.SVY_TEXT_Q,
  TBL_SVY_HEADER.SVY_MEMO_A,
  TBL_SVY_HEADER.SVY_MEMO_B,
  TBL_SVY_HEADER.SVY_MEMO_C,
  TBL_SVY_HEADER.SVY_MEMO_D,
  TBL_SVY_HEADER.SVY_INTEGER_A,
  TBL_SVY_HEADER.SVY_INTEGER_B,
  TBL_SVY_HEADER.SVY_INTEGER_C,
  TBL_SVY_HEADER.SVY_INTEGER_D,
  TBL_SVY_HEADER.SVY_INTEGER_E,
  TBL_SVY_HEADER.SVY_INTEGER_F,
  TBL_SVY_HEADER.SVY_SINGLE_A,
  TBL_SVY_HEADER.SVY_SINGLE_B,
  TBL_SVY_HEADER.SVY_SINGLE_C,
  TBL_SVY_HEADER.SVY_SINGLE_D,
  TBL_SVY_HEADER.SVY_SINGLE_E,
  TBL_SVY_HEADER.SVY_SINGLE_F,
  TBL_SVY_HEADER.SVY_SINGLE_G,
  TBL_SVY_HEADER.SVY_SINGLE_H,
  TBL_SVY_HEADER.SVY_SINGLE_I,
  TBL_SVY_HEADER.SVY_SINGLE_J,
  TBL_SVY_HEADER.SVY_SINGLE_K,
  TBL_SVY_HEADER.SVY_SINGLE_L,
  TBL_SVY_HEADER.SVY_SINGLE_M,
  TBL_SVY_HEADER.SVY_SINGLE_N,
  TBL_SVY_HEADER.SVY_DATETIME_A,
  TBL_SVY_HEADER.SVY_DATETIME_B,
  TBL_SVY_HEADER.SVY_DATETIME_C,
  TBL_SVY_HEADER.SVY_DATETIME_D,
  TBL_SVY_HEADER.SVY_DATETIME_E,
  TBL_SVY_HEADER.SVY_DATETIME_F,
  TBL_SVY_EVENT.SVY_EVT_ID                   AS SVY_HDR_EVT_ID,
  TBL_SVY_MAIN.SVY_MAIN_ID                   AS SVY_HDR_MAIN_ID,
  SYS_NODES_ATTRIB.REC_TAG                   AS SVY_HDR_NOD_ID,
  SYS_LOOKUPS1.LKP_ID                        AS SVY_HDR_COLOUR,
  TBL_SVY_POSITION_START.SVY_POS_ID          AS S_SVY_POS_ID,
  TBL_SVY_POSITION_START.SVY_POS_DATE_TIME   AS S_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_START.SVY_POS_KP          AS S_SVY_POS_KP,
  TBL_SVY_POSITION_START.SVY_POS_DEPTH       AS S_SVY_POS_DEPTH,
  TBL_SVY_POSITION_START.SVY_POS_EASTING     AS S_SVY_POS_EASTING,
  TBL_SVY_POSITION_START.SVY_POS_NORTHING    AS S_SVY_POS_NORTHING,
  TBL_SVY_POSITION_START.SVY_POS_VID_TAG     AS S_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_START.SVY_POS_OFFSET      AS S_SVY_POS_OFFSET,
  TBL_SVY_POSITION_START.SVY_POS_HEADING     AS S_SVY_POS_HEADING,
  TBL_SVY_POSITION_START.SVY_POS_PITCH       AS S_SVY_POS_PITCH,
  TBL_SVY_POSITION_START.SVY_POS_ROLL        AS S_SVY_POS_ROLL,
  TBL_SVY_POSITION_START.SVY_POS_ALTITUDE    AS S_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_START.SVY_POS_TEMPERATURE AS S_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_START.SVY_POS_LONGITUDE   AS S_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_START.SVY_POS_LATITUDE    AS S_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_START.SVY_POS_XCOORD      AS S_SVY_POS_XCOORD,
  TBL_SVY_POSITION_START.SVY_POS_YCOORD      AS S_SVY_POS_YCOORD,
  TBL_SVY_POSITION_START.SVY_POS_ZCOORD      AS S_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_START.SVY_POS_UPDATE_DATE AS S_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_START.SVY_POS_VIDEO_CTR   AS S_SVY_POS_VIDEO_CTR,
  TBL_SVY_POSITION_END.SVY_POS_ID            AS E_SVY_POS_ID,
  TBL_SVY_POSITION_END.SVY_POS_DATE_TIME     AS E_SVY_POS_DATE_TIME,
  TBL_SVY_POSITION_END.SVY_POS_KP            AS E_SVY_POS_KP,
  TBL_SVY_POSITION_END.SVY_POS_DEPTH         AS E_SVY_POS_DEPTH,
  TBL_SVY_POSITION_END.SVY_POS_EASTING       AS E_SVY_POS_EASTING,
  TBL_SVY_POSITION_END.SVY_POS_NORTHING      AS E_SVY_POS_NORTHING,
  TBL_SVY_POSITION_END.SVY_POS_VID_TAG       AS E_SVY_POS_VID_TAG,
  TBL_SVY_POSITION_END.SVY_POS_OFFSET        AS E_SVY_POS_OFFSET,
  TBL_SVY_POSITION_END.SVY_POS_HEADING       AS E_SVY_POS_HEADING,
  TBL_SVY_POSITION_END.SVY_POS_PITCH         AS E_SVY_POS_PITCH,
  TBL_SVY_POSITION_END.SVY_POS_ROLL          AS E_SVY_POS_ROLL,
  TBL_SVY_POSITION_END.SVY_POS_ALTITUDE      AS E_SVY_POS_ALTITUDE,
  TBL_SVY_POSITION_END.SVY_POS_TEMPERATURE   AS E_SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION_END.SVY_POS_LONGITUDE     AS E_SVY_POS_LONGITUDE,
  TBL_SVY_POSITION_END.SVY_POS_LATITUDE      AS E_SVY_POS_LATITUDE,
  TBL_SVY_POSITION_END.SVY_POS_XCOORD        AS E_SVY_POS_XCOORD,
  TBL_SVY_POSITION_END.SVY_POS_YCOORD        AS E_SVY_POS_YCOORD,
  TBL_SVY_POSITION_END.SVY_POS_ZCOORD        AS E_SVY_POS_ZCOORD,
  TBL_SVY_POSITION_END.SVY_POS_UPDATE_DATE   AS E_SVY_POS_UPDATE_DATE,
  TBL_SVY_POSITION_END.SVY_POS_VIDEO_CTR     AS E_SVY_POS_VIDEO_CTR
FROM TBL_SVY_HEADER
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_START
ON TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION_START.SVY_POS_ID
LEFT JOIN TBL_SVY_POSITION TBL_SVY_POSITION_END
ON TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION_END.SVY_POS_ID
INNER JOIN TBL_SVY_MAIN
ON TBL_SVY_HEADER.SVY_HDR_MAIN_ID = TBL_SVY_MAIN.SVY_MAIN_ID
INNER JOIN TBL_SVY_EVENT
ON TBL_SVY_HEADER.SVY_HDR_EVT_ID = TBL_SVY_EVENT.SVY_EVT_ID
INNER JOIN SYS_NODES_ATTRIB
ON TBL_SVY_HEADER.SVY_HDR_NOD_ID = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_LOOKUPS SYS_LOOKUPS1
ON TBL_SVY_HEADER.SVY_HDR_COLOUR   = SYS_LOOKUPS1.LKP_ID
WHERE TBL_SVY_EVENT.SVY_EVT_ACTIVE = 1 WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_SVY_HEADER_ACT_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_SVY_HEADER_ACT_COLOR" ("ACTION_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_CLASS ACTION_COLOR, 
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_SVY_HEADER_ACTAVL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_SVY_HEADER_ACTAVL_COLOR" ("ACTION_AVAIL_COLOR", "ASSET_ID") AS 
  SELECT (
  CASE
    WHEN TBL_ANOM_MAIN.AN_CURR_CLASS >= TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
    THEN TBL_ANOM_MAIN.AN_CURR_CLASS
    ELSE TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS
  END) ACTION_AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_SVY_HEADER_AVAIL_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_SVY_HEADER_AVAIL_COLOR" ("AVAIL_COLOR", "ASSET_ID") AS 
  SELECT TBL_ANOM_MAIN.AN_CURR_AVAIL_CLASS AVAIL_COLOR,
  LNK_AN_NODES.LNK_TAG_B AS ASSET_ID
FROM TBL_ANOM_MAIN
INNER JOIN LNK_AN_NODES
ON TBL_ANOM_MAIN.AN_ID = LNK_AN_NODES.LNK_TAG_A WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_SVY_HEADER_COM_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_SVY_HEADER_COM_COLOR" ("COMPLIANCE_COLOR", "ASSET_ID") AS 
  SELECT V_TBL_CA.CA_STATUS_COLOR AS COMPLIANCE_COLOR,
  V_TBL_CA.CA_REC_TAG           AS ASSET_ID
FROM V_TBL_CA WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_SVY_MAIN
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_SVY_MAIN" ("SVY_MAIN_ID", "SVY_MAIN_TITLE", "SVY_MAIN_TYPE_LKP_ID", "SVY_MAIN_DATE_START", "SVY_MAIN_DATE_END", "SYV_MAIN_CONTRACTOR") AS 
  SELECT TBL_SVY_MAIN.SVY_MAIN_ID,
  TBL_SVY_MAIN.SVY_MAIN_TITLE,
  NVL(TO_CHAR(TBL_SVY_MAIN.SVY_MAIN_TYPE_LKP_ID), '-') AS SVY_MAIN_TYPE_LKP_ID,
  NVL(TO_CHAR(TBL_SVY_MAIN.SVY_MAIN_DATE_START), '-') AS SVY_MAIN_DATE_START,
  NVL(TO_CHAR(TBL_SVY_MAIN.SVY_MAIN_DATE_END), '-') AS SVY_MAIN_DATE_END,
  NVL(TO_CHAR(TBL_SVY_MAIN.SYV_MAIN_CONTRACTOR), '-') AS SYV_MAIN_CONTRACTOR 
FROM TBL_SVY_MAIN WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_SVY_POSITION_END
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_SVY_POSITION_END" ("SVY_HDR_ID", "SVY_POS_ID", "SVY_POS_DATE_TIME", "SVY_POS_KP", "SVY_POS_DEPTH", "SVY_POS_EASTING", "SVY_POS_NORTHING", "SVY_POS_VID_TAG", "SVY_POS_OFFSET", "SVY_POS_HEADING", "SVY_POS_PITCH", "SVY_POS_ROLL", "SVY_POS_ALTITUDE", "SVY_POS_TEMPERATURE", "SVY_POS_LONGITUDE", "SVY_POS_LATITUDE", "SVY_POS_XCOORD", "SVY_POS_YCOORD", "SVY_POS_ZCOORD", "SVY_POS_UPDATE_DATE") AS 
  SELECT TBL_SVY_HEADER.SVY_HDR_ID,
  TBL_SVY_POSITION.SVY_POS_ID,
  TBL_SVY_POSITION.SVY_POS_DATE_TIME,
  TBL_SVY_POSITION.SVY_POS_KP,
  TBL_SVY_POSITION.SVY_POS_DEPTH,
  TBL_SVY_POSITION.SVY_POS_EASTING,
  TBL_SVY_POSITION.SVY_POS_NORTHING,
  TBL_SVY_POSITION.SVY_POS_VID_TAG,
  TBL_SVY_POSITION.SVY_POS_OFFSET,
  TBL_SVY_POSITION.SVY_POS_HEADING,
  TBL_SVY_POSITION.SVY_POS_PITCH,
  TBL_SVY_POSITION.SVY_POS_ROLL,
  TBL_SVY_POSITION.SVY_POS_ALTITUDE,
  TBL_SVY_POSITION.SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION.SVY_POS_LONGITUDE,
  TBL_SVY_POSITION.SVY_POS_LATITUDE,
  TBL_SVY_POSITION.SVY_POS_XCOORD,
  TBL_SVY_POSITION.SVY_POS_YCOORD,
  TBL_SVY_POSITION.SVY_POS_ZCOORD,
  TBL_SVY_POSITION.SVY_POS_UPDATE_DATE
FROM TBL_SVY_HEADER
INNER JOIN TBL_SVY_POSITION
ON TBL_SVY_HEADER.SVY_HDR_END_POS_ID = TBL_SVY_POSITION.SVY_POS_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_SVY_POSITION_START
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_SVY_POSITION_START" ("SVY_HDR_ID", "SVY_POS_ID", "SVY_POS_DATE_TIME", "SVY_POS_KP", "SVY_POS_DEPTH", "SVY_POS_EASTING", "SVY_POS_NORTHING", "SVY_POS_VID_TAG", "SVY_POS_OFFSET", "SVY_POS_HEADING", "SVY_POS_PITCH", "SVY_POS_ROLL", "SVY_POS_ALTITUDE", "SVY_POS_TEMPERATURE", "SVY_POS_LONGITUDE", "SVY_POS_LATITUDE", "SVY_POS_XCOORD", "SVY_POS_YCOORD", "SVY_POS_ZCOORD", "SVY_POS_UPDATE_DATE") AS 
  SELECT TBL_SVY_HEADER.SVY_HDR_ID,
  TBL_SVY_POSITION.SVY_POS_ID,
  TBL_SVY_POSITION.SVY_POS_DATE_TIME,
  TBL_SVY_POSITION.SVY_POS_KP,
  TBL_SVY_POSITION.SVY_POS_DEPTH,
  TBL_SVY_POSITION.SVY_POS_EASTING,
  TBL_SVY_POSITION.SVY_POS_NORTHING,
  TBL_SVY_POSITION.SVY_POS_VID_TAG,
  TBL_SVY_POSITION.SVY_POS_OFFSET,
  TBL_SVY_POSITION.SVY_POS_HEADING,
  TBL_SVY_POSITION.SVY_POS_PITCH,
  TBL_SVY_POSITION.SVY_POS_ROLL,
  TBL_SVY_POSITION.SVY_POS_ALTITUDE,
  TBL_SVY_POSITION.SVY_POS_TEMPERATURE,
  TBL_SVY_POSITION.SVY_POS_LONGITUDE,
  TBL_SVY_POSITION.SVY_POS_LATITUDE,
  TBL_SVY_POSITION.SVY_POS_XCOORD,
  TBL_SVY_POSITION.SVY_POS_YCOORD,
  TBL_SVY_POSITION.SVY_POS_ZCOORD,
  TBL_SVY_POSITION.SVY_POS_UPDATE_DATE
FROM TBL_SVY_HEADER
INNER JOIN TBL_SVY_POSITION
ON TBL_SVY_HEADER.SVY_HDR_START_POS_ID = TBL_SVY_POSITION.SVY_POS_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_USER_COMMENTS
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_USER_COMMENTS" ("UC_ID", "UC_FORM_NAME", "UC_DATE_STAMP", "UC_RAISED_BY", "UC_COMPANY", "UC_STATUS", "UC_NOTES", "UC_RESPONSE", "UC_CLASSIFICATION", "UC_PRIORITY", "UC_STATUS_ID", "UC_CLASSIFICATION_ID", "UC_PRIORITY_ID") AS 
  SELECT TBL_USER_COMMENTS.UC_ID,
  TBL_USER_COMMENTS.UC_FORM_NAME,
  TBL_USER_COMMENTS.UC_DATE_STAMP,
  TBL_USER_COMMENTS.UC_RAISED_BY,
  TBL_USER_COMMENTS.UC_COMPANY,
  Status.LKP_DESC_B AS UC_STATUS,
  TBL_USER_COMMENTS.UC_NOTES,
  TBL_USER_COMMENTS.UC_RESPONSE,
  Classification.LKP_DESC_B AS UC_CLASSIFICATION,
  Priority.LKP_DESC_B       AS UC_PRIORITY,
  Status.LKP_ID             AS UC_STATUS_ID,
  Classification.LKP_ID     AS UC_CLASSIFICATION_ID,
  Priority.LKP_ID           AS UC_PRIORITY_ID
FROM TBL_USER_COMMENTS
LEFT JOIN SYS_LOOKUPS Status
ON TBL_USER_COMMENTS.UC_STATUS = Status.LKP_ID
LEFT JOIN SYS_LOOKUPS Classification
ON TBL_USER_COMMENTS.UC_CLASSIFICATION = Classification.LKP_ID
LEFT JOIN SYS_LOOKUPS Priority
ON TBL_USER_COMMENTS.UC_PRIORITY = Priority.LKP_ID;
--------------------------------------------------------
--  DDL for View V_TBL_USERS_AUTH
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_USERS_AUTH" ("USER_ID", "USER_NAME", "LOGIN_NAME", "USER_ROLE") AS 
  SELECT TBL_USERS.USER_ID,
  TBL_USERS.USER_NAME,
  UPPER(TBL_USER_PARAMS.PARAM_TEXT) AS LOGIN_NAME,
  UPPER(SYS_LOOKUPS.LKP_DESC_A)     AS USER_ROLE
FROM TBL_USER_PARAMS
RIGHT JOIN TBL_USERS
ON TBL_USERS.USER_ID = TBL_USER_PARAMS.USER_ID
LEFT JOIN TBL_USER_PARAMS TBL_USER_PARAMS1
ON TBL_USERS.USER_ID = TBL_USER_PARAMS1.USER_ID
LEFT JOIN SYS_LOOKUPS
ON TBL_USER_PARAMS1.PARAM_LKP_ID = SYS_LOOKUPS.LKP_ID
WHERE TBL_USER_PARAMS.PARAM_ID   = 8000
AND SYS_LOOKUPS.LKP_GRP_ID       = 8001
ORDER BY TBL_USERS.USER_ID WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TBL_USERS_EMAIL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TBL_USERS_EMAIL" ("USER_ID", "USER_NAME", "MAX_PARAM_TEXT", "MAX_USER_PARAM_ID") AS 
  SELECT
     TBL_USERS.USER_ID,
     TBL_USERS.USER_NAME,
     MAX(TBL_USER_PARAMS.PARAM_TEXT) AS MAX_PARAM_TEXT,
     MAX(TBL_USER_PARAMS.USER_PARAM_ID) AS MAX_USER_PARAM_ID
 FROM
     TBL_USERS
     INNER JOIN TBL_USER_PARAMS ON TBL_USERS.USER_ID = TBL_USER_PARAMS.USER_ID
 WHERE
     TBL_USER_PARAMS.PARAM_ID = 8003
 GROUP BY
     TBL_USERS.USER_ID,
     TBL_USERS.USER_NAME
 ORDER BY
     TBL_USERS.USER_NAME WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TREE_COLOR
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TREE_COLOR" ("TRE_DAT_TAG", "TRE_DAT_TAG_PAR", "NODE_ID", "NODE_DESC", "MAX_COLOR", "IS_PAR", "ITEM_USED") AS 
  SELECT SYS_TREE_STRUC.TRE_DAT_TAG,
  SYS_TREE_STRUC_PAR.TRE_DAT_TAG AS TRE_DAT_TAG_PAR,
  SYS_NODES_ATTRIB.NODE_ID,
  SYS_NODES_ATTRIB.NODE_DESC,
  SYS_LOOKUPS.LKP_DESC_B              AS MAX_COLOR,
  SYS_TREE_STRUC_LEAF.TRE_NOD_TAG_PAR AS IS_PAR,
  SYS_NODES_ATTRIB.ITEM_USED
FROM
  (SELECT TMP_ID TRE_NOD_TAG,
    MAX(MAX_COLOR) MAX_COLOR
  FROM
    (SELECT TRE_NOD_TAG,
      TRE_NOD_TAG_PAR,
      MAX_COLOR,
      CONNECT_BY_ROOT TRE_NOD_TAG TMP_ID
    FROM
      (SELECT SYS_TREE_STRUC.TRE_NOD_TAG,
        SYS_TREE_STRUC.TRE_NOD_TAG_PAR,
        NVL(MAX(TBL_ANOM_MAIN.AN_CURR_CLASS), 8469) MAX_COLOR,
        SYS_TREE_STRUC.TRE_DAT_TAG,
        SYS_TREE_STRUC_PAR.TRE_DAT_TAG AS TRE_DAT_TAG_PAR
      FROM TBL_ANOM_MAIN
      RIGHT JOIN SYS_TREE_STRUC
      ON SYS_TREE_STRUC.TRE_DAT_TAG = TBL_ANOM_MAIN.AN_ASSET_ID
      LEFT JOIN SYS_TREE_STRUC SYS_TREE_STRUC_PAR
      ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC_PAR.TRE_NOD_TAG
      WHERE SYS_TREE_STRUC.TRE_DAT_TYPE = 1
      GROUP BY SYS_TREE_STRUC.TRE_NOD_TAG,
        SYS_TREE_STRUC.TRE_NOD_TAG_PAR,
        SYS_TREE_STRUC.TRE_DAT_TAG,
        SYS_TREE_STRUC_PAR.TRE_DAT_TAG
      )
      START WITH NVL(TRE_DAT_TAG_PAR, 0) = 45488
      CONNECT BY PRIOR TRE_DAT_TAG       = TRE_DAT_TAG_PAR
    )
  GROUP BY TMP_ID
  ORDER BY 1
  ) T1
INNER JOIN SYS_TREE_STRUC
ON T1.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG
LEFT JOIN SYS_TREE_STRUC SYS_TREE_STRUC_PAR
ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC_PAR.TRE_NOD_TAG
INNER JOIN SYS_NODES_ATTRIB
ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_TREE_STRUC SYS_TREE_STRUC_LEAF
ON SYS_TREE_STRUC.TRE_NOD_TAG = SYS_TREE_STRUC_LEAF.TRE_NOD_TAG_PAR
LEFT JOIN SYS_LOOKUPS
ON T1.MAX_COLOR = SYS_LOOKUPS.LKP_ID
GROUP BY SYS_TREE_STRUC.TRE_DAT_TAG,
  SYS_TREE_STRUC_PAR.TRE_DAT_TAG,
  SYS_NODES_ATTRIB.NODE_ID,
  SYS_NODES_ATTRIB.NODE_DESC,
  SYS_LOOKUPS.LKP_DESC_B,
  SYS_TREE_STRUC_LEAF.TRE_NOD_TAG_PAR,
  SYS_TREE_STRUC.TRE_NOD_ORDER,
  SYS_NODES_ATTRIB.ITEM_USED
ORDER BY SYS_TREE_STRUC.TRE_NOD_ORDER WITH READ ONLY;
--------------------------------------------------------
--  DDL for View V_TREE_COLOR_BY_LEVEL
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TREE_COLOR_BY_LEVEL" ("TRE_DAT_TAG", "MAX_COLOR", "ITEM_USED") AS 
  SELECT T2.TRE_DAT_TAG,
  T2.MAX_COLOR,
  SYS_NODES_ATTRIB.ITEM_USED
FROM
  (SELECT SYS_TREE_STRUC.TRE_DAT_TAG,
    SYS_TREE_STRUC_PAR.TRE_DAT_TAG AS TRE_DAT_TAG_PAR,
    SYS_LOOKUPS.LKP_DESC_B         AS MAX_COLOR
  FROM
    (SELECT TMP_ID TRE_NOD_TAG,
      MAX(MAX_COLOR) MAX_COLOR
    FROM
      (SELECT TRE_NOD_TAG,
        TRE_NOD_TAG_PAR,
        MAX_COLOR,
        CONNECT_BY_ROOT TRE_NOD_TAG TMP_ID
      FROM
        (SELECT SYS_TREE_STRUC.TRE_NOD_TAG,
          SYS_TREE_STRUC.TRE_NOD_TAG_PAR,
          NVL(MAX(TBL_ANOM_MAIN.AN_CURR_CLASS), 0) MAX_COLOR,
          SYS_TREE_STRUC.TRE_DAT_TAG,
          SYS_TREE_STRUC_PAR.TRE_DAT_TAG AS TRE_DAT_TAG_PAR
        FROM TBL_ANOM_MAIN
        RIGHT JOIN SYS_TREE_STRUC
        ON SYS_TREE_STRUC.TRE_DAT_TAG = TBL_ANOM_MAIN.AN_ASSET_ID
        LEFT JOIN SYS_TREE_STRUC SYS_TREE_STRUC_PAR
        ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC_PAR.TRE_NOD_TAG
        WHERE SYS_TREE_STRUC.TRE_DAT_TYPE = 1
        GROUP BY SYS_TREE_STRUC.TRE_NOD_TAG,
          SYS_TREE_STRUC.TRE_NOD_TAG_PAR,
          SYS_TREE_STRUC.TRE_DAT_TAG,
          SYS_TREE_STRUC_PAR.TRE_DAT_TAG
        )
        CONNECT BY PRIOR TRE_DAT_TAG = TRE_DAT_TAG_PAR
      )
    GROUP BY TMP_ID
    ORDER BY 1
    ) T1
  INNER JOIN SYS_TREE_STRUC
  ON T1.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG
  LEFT JOIN SYS_TREE_STRUC SYS_TREE_STRUC_PAR
  ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC_PAR.TRE_NOD_TAG
  LEFT JOIN SYS_LOOKUPS
  ON T1.MAX_COLOR = SYS_LOOKUPS.LKP_ID
  GROUP BY SYS_TREE_STRUC.TRE_DAT_TAG,
    SYS_TREE_STRUC_PAR.TRE_DAT_TAG,
    SYS_LOOKUPS.LKP_DESC_B
  ) T2
INNER JOIN SYS_NODES_ATTRIB
ON T2.TRE_DAT_TAG           = SYS_NODES_ATTRIB.REC_TAG
  START WITH T2.TRE_DAT_TAG = 45601
  CONNECT BY T2.TRE_DAT_TAG = PRIOR T2.TRE_DAT_TAG_PAR;
--------------------------------------------------------
--  DDL for View V_TREE_COLOR_BY_TAG
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."V_TREE_COLOR_BY_TAG" ("TRE_DAT_TAG", "MAX_COLOR", "ITEM_USED") AS 
  SELECT SYS_TREE_STRUC.TRE_DAT_TAG,
  SYS_LOOKUPS.LKP_DESC_B AS MAX_COLOR,
  SYS_NODES_ATTRIB.ITEM_USED 
FROM
  (SELECT TMP_ID TRE_NOD_TAG,
    MAX(MAX_COLOR) MAX_COLOR
  FROM
    (SELECT TRE_NOD_TAG,
      TRE_NOD_TAG_PAR,
      MAX_COLOR,
      Connect_By_Root TRE_NOD_TAG TMP_ID
    FROM
      (SELECT SYS_TREE_STRUC.TRE_NOD_TAG,
        SYS_TREE_STRUC.TRE_NOD_TAG_PAR,
        NVL(MAX(TBL_ANOM_MAIN.AN_CURR_CLASS), 0) MAX_COLOR,
        SYS_TREE_STRUC.TRE_DAT_TAG,
        SYS_TREE_STRUC_PAR.TRE_DAT_TAG AS TRE_DAT_TAG_PAR
      FROM TBL_ANOM_MAIN
      RIGHT JOIN SYS_TREE_STRUC
      ON SYS_TREE_STRUC.TRE_DAT_TAG = TBL_ANOM_MAIN.AN_ASSET_ID
      LEFT JOIN SYS_TREE_STRUC SYS_TREE_STRUC_PAR
      ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC_PAR.TRE_NOD_TAG
      WHERE SYS_TREE_STRUC.TRE_DAT_TYPE = 2
      GROUP BY SYS_TREE_STRUC.TRE_NOD_TAG,
        SYS_TREE_STRUC.TRE_NOD_TAG_PAR,
        SYS_TREE_STRUC.TRE_DAT_TAG,
        SYS_TREE_STRUC_PAR.TRE_DAT_TAG
      )
      CONNECT BY Prior TRE_NOD_TAG = TRE_NOD_TAG_PAR
    )
  GROUP BY TMP_ID
  ORDER BY 1
  ) T1
INNER JOIN SYS_TREE_STRUC
ON T1.TRE_NOD_TAG = SYS_TREE_STRUC.TRE_NOD_TAG
LEFT JOIN SYS_TREE_STRUC SYS_TREE_STRUC_PAR
ON SYS_TREE_STRUC.TRE_NOD_TAG_PAR = SYS_TREE_STRUC_PAR.TRE_NOD_TAG
INNER JOIN SYS_NODES_ATTRIB
ON SYS_TREE_STRUC.TRE_DAT_TAG = SYS_NODES_ATTRIB.REC_TAG
LEFT JOIN SYS_TREE_STRUC SYS_TREE_STRUC_LEAF
ON SYS_TREE_STRUC.TRE_NOD_TAG = SYS_TREE_STRUC_LEAF.TRE_NOD_TAG_PAR
RIGHT JOIN SYS_LOOKUPS
ON T1.MAX_COLOR = SYS_LOOKUPS.LKP_ID
GROUP BY SYS_TREE_STRUC.TRE_DAT_TAG,
  SYS_NODES_ATTRIB.ITEM_USED,
  SYS_LOOKUPS.LKP_DESC_B
HAVING (SYS_TREE_STRUC.TRE_DAT_TAG = 8956)
OR (SYS_TREE_STRUC.TRE_DAT_TAG     = 6562)
OR (SYS_TREE_STRUC.TRE_DAT_TAG     = 6623)
OR (SYS_TREE_STRUC.TRE_DAT_TAG     = 9708);
--------------------------------------------------------
--  DDL for View VW_CHEMDB_PWA_DATA
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "IMSA"."VW_CHEMDB_PWA_DATA" ("SAMPLING_LOCATION", "SAMPLE_DATE", "SPECIFIC_GRAVITY", "TEMPERATURE", "HARDNESS", "TOTAL_DISSOLVED_SOLID", "ANION_CATION_RATIO", "TOTAL_SUSPENDED_SOLID", "SULFATE", "SCALING_TENDENCY", "RESISTIVITY_QTY", "PH", "O2", "H2S", "SODIUM", "CALCIUM", "MAGNESIUM", "BROMIDE", "POTASSIUM", "CONDUCTIVITY_QTY", "MANGANESE", "ZINC", "IRON_SOLID", "IRON_DISSOLVED", "BARIUM", "CHLORIDE", "CARBONATE", "BICARBONATE", "CHEMICAL_STATUS") AS 
  SELECT
 NA.NODE_DESC AS Sampling_Location,
 to_char(CHD_HDR.CHD_HDR_SAMP_DATE, 'DD/MM/YYYY') AS Sample_Date,
 CHD_PWA.CHD_PWA_SPGR AS Specific_Gravity,
 CHD_PWA.CHD_PWA_TEMP AS Temperature,
 CHD_PWA.CHD_PWA_HARDNESS AS Hardness,
 CHD_PWA.CHD_PWA_TDS AS Total_Dissolved_Solid,
 CHD_PWA.CHD_PWA_ACR AS Anion_Cation_Ratio,
 CHD_PWA.CHD_PWA_TSS AS Total_Suspended_Solid,
 CHD_PWA.CHD_PWA_SULFATE AS Sulfate,
 CHD_PWA.CHD_PWA_SCALETEN AS Scaling_Tendency,
 CHD_PWA.CHD_PWA_RESQTY AS Resistivity_Qty,
 CHD_PWA.CHD_PWA_PH AS PH,
 CHD_PWA.CHD_PWA_O2 AS o2,
 CHD_PWA.CHD_PWA_H2S AS H2s,
 CHD_PWA.CHD_PWA_SODIUM AS Sodium,
 CHD_PWA.CHD_PWA_CALCIUM AS Calcium,
 CHD_PWA.CHD_PWA_MAGNESIUM AS Magnesium,
 CHD_PWA.CHD_PWA_BROMIDE AS Bromide,
 CHD_PWA.CHD_PWA_POTASSIUM AS Potassium,
 CHD_PWA.CHD_PWA_CONQTY AS Conductivity_Qty,
 CHD_PWA.CHD_PWA_MANGANESE AS Manganese,
 CHD_PWA.CHD_PWA_ZINC AS Zinc,
 CHD_PWA.CHD_PWA_IRONSOLID AS Iron_Solid,
 CHD_PWA.CHD_PWA_IRONDISS AS Iron_dissolved,
 CHD_PWA.CHD_PWA_BARIUM AS Barium,
 CHD_PWA.CHD_PWA_CHLORIDE AS Chloride,
 CHD_PWA.CHD_PWA_CARBONATE AS Carbonate,
 CHD_PWA.CHD_PWA_BICARB AS Bicarbonate,
 LKP.LKP_DESC_B AS Chemical_Status
FROM
 ((TBL_CHD_HEADER CHD_HDR
 INNER JOIN TBL_CHD_PWA CHD_PWA
 ON CHD_HDR.CHD_HDR_ID = CHD_PWA.CHD_PWA_ID)
 LEFT JOIN SYS_LOOKUPS LKP
 ON CHD_HDR.CHD_HDR_STATUS = LKP.LKP_ID)
 LEFT JOIN SYS_NODES_ATTRIB NA
 ON CHD_HDR.CHD_HDR_ASSET_ID = NA.REC_TAG
WITH READ ONLY;
